/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded chunks
/******/ 	// "0" means "already loaded"
/******/ 	var installedChunks = {
/******/ 		"main": 0
/******/ 	};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// The chunk loading function for additional chunks
/******/ 	// Since all referenced chunks are already included
/******/ 	// in this file, this function is empty here.
/******/ 	__webpack_require__.e = function requireEnsure() {
/******/ 		return Promise.resolve();
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/dist/";
/******/
/******/ 	// uncaught error handler for webpack runtime
/******/ 	__webpack_require__.oe = function(err) {
/******/ 		process.nextTick(function() {
/******/ 			throw err; // catch this error by using import().catch()
/******/ 		});
/******/ 	};
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/rhodonite.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/shaderity/dist/index.js":
/*!**********************************************!*\
  !*** ./node_modules/shaderity/dist/index.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Reflection {\n    constructor() {\n        this.attributes = [];\n        this.varyings = [];\n        this.uniforms = [];\n    }\n    get attributesNames() {\n        return this.attributes.map((attribute) => { return attribute.name; });\n    }\n    get attributesSemantics() {\n        return this.attributes.map((attribute) => { return attribute.semantic; });\n    }\n    get attributesTypes() {\n        return this.attributes.map((attribute) => { return attribute.type; });\n    }\n}\nexports.Reflection = Reflection;\n;\nclass Shaderity {\n    constructor() {\n        this.__attributeSemanticsMap = new Map();\n        this.__uniformSemanticsMap = new Map();\n        this.__attributeSemanticsMap.set('position', 'POSITION');\n        this.__attributeSemanticsMap.set('color', 'COLOR_0');\n        this.__attributeSemanticsMap.set('texcoord', 'TEXCOORD_0');\n        this.__attributeSemanticsMap.set('normal', 'NORMAL');\n        this.__attributeSemanticsMap.set('tangent', 'TANGENT');\n        this.__attributeSemanticsMap.set('joint', 'JOINTS_0');\n        this.__attributeSemanticsMap.set('bone', 'JOINTS_0');\n        this.__attributeSemanticsMap.set('weight', 'WEIGHTS_0');\n        this.__uniformSemanticsMap.set('worldmatrix', 'WorldMatrix');\n        this.__uniformSemanticsMap.set('normalmatrix', 'NormalMatrix');\n        this.__uniformSemanticsMap.set('viewmatrix', 'ViewMatrix');\n        this.__uniformSemanticsMap.set('projectionmatrix', 'ProjectionMatrix');\n        this.__uniformSemanticsMap.set('modelviewmatrix', 'ModelViewMatrix');\n    }\n    static getInstance() {\n        if (!this.__instance) {\n            this.__instance = new Shaderity();\n        }\n        return this.__instance;\n    }\n    addAttributeSemanticsMap(map) {\n        this.__attributeSemanticsMap = new Map([...this.__attributeSemanticsMap, ...map]);\n    }\n    addUniformSemanticsMap(map) {\n        this.__uniformSemanticsMap = new Map([...this.__uniformSemanticsMap, ...map]);\n    }\n    isVertexShader(obj) {\n        if (obj.shaderStage === 'vertex') {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    isFragmentShader(obj) {\n        if (obj.shaderStage === 'fragment' || obj.shaderStage === 'pixel') {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    isPixelShader(obj) {\n        return this.isFragmentShader(obj);\n    }\n    _replaceRow(inout_splitedSource, inReg, inAsES1) {\n        for (let i = 0; i < inout_splitedSource.length; i++) {\n            inout_splitedSource[i] = inout_splitedSource[i].replace(inReg, inAsES1);\n        }\n    }\n    _convertIn(obj, inout_splitedSource) {\n        const inReg = /^(?![\\/])[\\t ]*in[\\t ]+(\\w+[\\t ]*\\w+[\\t ]*;)/;\n        let inAsES1 = function (match, p1) {\n            return 'attribute ' + p1;\n        };\n        if (this.isFragmentShader(obj)) {\n            inAsES1 = function (match, p1) {\n                return 'varying ' + p1;\n            };\n        }\n        this._replaceRow(inout_splitedSource, inReg, inAsES1);\n        return inout_splitedSource;\n    }\n    _convertOut(obj, inout_splitedSource) {\n        const inReg = /^(?![\\/])[\\t ]*out[\\t ]+(\\w+[\\t ]*\\w+[\\t ]*;)/;\n        let inAsES1 = function (match, p1) {\n            return 'varying ' + p1;\n        };\n        this._replaceRow(inout_splitedSource, inReg, inAsES1);\n        return inout_splitedSource;\n    }\n    _createUniformSamplerMap(inout_splitedSource, row_i) {\n        const uniformSamplerMap = new Map();\n        for (let i = 0; i < row_i; i++) {\n            const row = inout_splitedSource[i];\n            const match = row.match(/^(?![\\/])[\\t ]*\\w*[\\t ]*(sampler\\w+)[\\t ]+(\\w+)/);\n            if (match) {\n                const samplerType = match[1];\n                const name = match[2];\n                uniformSamplerMap.set(name, samplerType);\n            }\n        }\n        return uniformSamplerMap;\n    }\n    _convertAttribute(obj, inout_splitedSource) {\n        const inReg = /^(?![\\/])[\\t ]*attribute[\\t ]+/g;\n        let inAsES3 = 'in ';\n        this._replaceRow(inout_splitedSource, inReg, inAsES3);\n        return inout_splitedSource;\n    }\n    _convertVarying(obj, inout_splitedSource) {\n        const inReg = /^(?![\\/])[\\t ]*varying[\\t ]+/g;\n        let inAsES3 = 'out ';\n        if (this.isFragmentShader(obj)) {\n            inAsES3 = 'in ';\n        }\n        this._replaceRow(inout_splitedSource, inReg, inAsES3);\n        return inout_splitedSource;\n    }\n    _regSymbols() {\n        return `[!\"#$%&'()\\*\\+\\-\\.,\\/:;<=>?@\\[\\\\\\]^` + '`{|}~\\t\\n ]';\n    }\n    _convertTexture2D(obj, inout_splitedSource) {\n        const sbl = this._regSymbols();\n        const reg = new RegExp(`(${sbl}+)(texture2D)(${sbl}+)`, 'g');\n        let inAsES3 = 'texture';\n        this._replaceRow(inout_splitedSource, reg, '$1' + inAsES3 + '$3');\n        return inout_splitedSource;\n    }\n    _convertTextureCube(obj, inout_splitedSource) {\n        const sbl = this._regSymbols();\n        const reg = new RegExp(`(${sbl}+)(textureCube)(${sbl}+)`, 'g');\n        let inAsES3 = 'texture';\n        this._replaceRow(inout_splitedSource, reg, '$1' + inAsES3 + '$3');\n        return inout_splitedSource;\n    }\n    _convertTexture2DProd(obj, inout_splitedSource) {\n        const sbl = this._regSymbols();\n        const reg = new RegExp(`(${sbl}+)(texture2DProj)(${sbl}+)`, 'g');\n        let inAsES3 = 'textureProj';\n        this._replaceRow(inout_splitedSource, reg, '$1' + inAsES3 + '$3');\n        return inout_splitedSource;\n    }\n    copyShaderityObject(obj) {\n        const copiedObj = {\n            code: obj.code,\n            shaderStage: obj.shaderStage\n        };\n        return copiedObj;\n    }\n    _convertTextureFunctionToES1(inout_splitedSource) {\n        const sbl = this._regSymbols();\n        for (let i = 0; i < inout_splitedSource.length; i++) {\n            const row = inout_splitedSource[i];\n            let reg = new RegExp(`(${sbl}+)(textureProj)(${sbl}+)`, 'g');\n            let match = row.match(/textureProj[\\t ]*\\([\\t ]*(\\w+),/);\n            if (match) {\n                const name = match[1];\n                const uniformSamplerMap = this._createUniformSamplerMap(inout_splitedSource, i);\n                const samplerType = uniformSamplerMap.get(name);\n                if (samplerType != null) {\n                    let textureFunc = '';\n                    switch (samplerType) {\n                        case 'sampler2D':\n                            textureFunc = 'texture2DProj';\n                            break;\n                        case 'sampler3D':\n                            textureFunc = 'texture3DProj';\n                            break;\n                        default: console.log('not found');\n                    }\n                    inout_splitedSource[i] = inout_splitedSource[i].replace(reg, '$1' + textureFunc + '$3');\n                }\n                continue;\n            }\n            reg = new RegExp(`(${sbl}+)(texture)(${sbl}+)`, 'g');\n            match = row.match(/texture[\\t ]*\\([\\t ]*(\\w+),/);\n            if (match) {\n                const name = match[1];\n                const uniformSamplerMap = this._createUniformSamplerMap(inout_splitedSource, i);\n                const samplerType = uniformSamplerMap.get(name);\n                if (samplerType != null) {\n                    let textureFunc = '';\n                    switch (samplerType) {\n                        case 'sampler2D':\n                            textureFunc = 'texture2D';\n                            break;\n                        case 'sampler3D':\n                            textureFunc = 'texture3D';\n                            break;\n                        case 'samplerCube':\n                            textureFunc = 'textureCube';\n                            break;\n                        default: console.log('not found');\n                    }\n                    inout_splitedSource[i] = inout_splitedSource[i].replace(reg, '$1' + textureFunc + '$3');\n                }\n            }\n        }\n        return inout_splitedSource;\n    }\n    transformToGLSLES1(obj) {\n        const copy = this.copyShaderityObject(obj);\n        let splited = this._splitShaderCode(obj.code);\n        this._convertIn(obj, splited);\n        this._convertOut(obj, splited);\n        splited = this._convertTextureFunctionToES1(splited);\n        copy.code = this._joinSplitedRow(splited);\n        return copy;\n    }\n    transformToGLSLES3(obj) {\n        const copy = this.copyShaderityObject(obj);\n        let splited = this._splitShaderCode(obj.code);\n        this._convertAttribute(obj, splited);\n        this._convertVarying(obj, splited);\n        this._convertTexture2D(obj, splited);\n        this._convertTextureCube(obj, splited);\n        this._convertTexture2DProd(obj, splited);\n        copy.code = this._joinSplitedRow(splited);\n        return copy;\n    }\n    transformTo(version, obj) {\n        if (version.match(/webgl2|es3/i)) {\n            return this.transformToGLSLES3(obj);\n        }\n        else if (version.match(/webgl1|es1/i)) {\n            return this.transformToGLSLES1(obj);\n        }\n        else {\n            console.error('Invalid Version');\n            return obj;\n        }\n    }\n    _splitShaderCode(source) {\n        return source.split(/\\r\\n|\\n/);\n    }\n    _joinSplitedRow(splitedRow) {\n        return splitedRow.join('\\n');\n    }\n    /**\n     * Fill arguments into template shader text in ShaderityObject.\n     * @param obj a shaderity object\n     * @returns a copied and processed shaderity object\n     */\n    fillTemplate(obj, arg) {\n        const copy = this.copyShaderityObject(obj);\n        const templateString = obj.code.replace(/\\/\\*[\\t ]*shaderity:[\\t ]*(@{[\\t ]*)(\\S+)([\\t ]*})[\\t ]*\\*\\//g, '${this.$2}');\n        const fillTemplate = function (templateString, arg) {\n            return new Function(\"return `\" + templateString + \"`;\").call(arg);\n        };\n        copy.code = fillTemplate(templateString, arg);\n        return copy;\n    }\n    insertDefinition(obj, definition) {\n        const copy = this.copyShaderityObject(obj);\n        let splited = this._splitShaderCode(obj.code);\n        const defStr = definition.replace(/#define[\\t ]+/, '');\n        splited.unshift(`#define ${defStr}`);\n        copy.code = this._joinSplitedRow(splited);\n        return copy;\n    }\n    reflect(obj) {\n        let splited = this._splitShaderCode(obj.code);\n        const reflection = new Reflection();\n        const varTypes = /[\\t ]+(float|int|vec2|vec3|vec4|mat2|mat3|mat4|ivec2|ivec3|ivec4)[\\t ]+(\\w+);/;\n        const varTypes2 = /[\\t ]+(float|int|vec2|vec3|vec4|mat2|mat3|mat4|ivec2|ivec3|ivec4|sampler2D|samplerCube|sampler3D)[\\t ]+(\\w+);/;\n        const semanticRegExp = /<.*semantic[\\t ]*=[\\t ]*(\\w+).*>/;\n        for (let row of splited) {\n            if (obj.shaderStage === 'vertex') {\n                const attributeMatch = row.match(/^(?![\\/])[\\t ]*(attribute|in)[\\t ]+.+;/);\n                if (attributeMatch) {\n                    const reflectionAttribute = {\n                        name: '',\n                        type: 'float',\n                        semantic: 'UNKNOWN'\n                    };\n                    const match = row.match(varTypes);\n                    if (match) {\n                        const type = match[1];\n                        reflectionAttribute.type = type;\n                        const name = match[2];\n                        reflectionAttribute.name = name;\n                        const match2 = row.match(semanticRegExp);\n                        if (match2) {\n                            reflectionAttribute.semantic = match2[1];\n                        }\n                        else {\n                            for (let [key, value] of this.__attributeSemanticsMap) {\n                                if (name.match(new RegExp(key, 'i'))) {\n                                    reflectionAttribute.semantic = value;\n                                }\n                            }\n                        }\n                    }\n                    reflection.attributes.push(reflectionAttribute);\n                    continue;\n                }\n            }\n            let varyingMatch;\n            if (obj.shaderStage === 'vertex') {\n                varyingMatch = row.match(/^(?![\\/])[\\t ]*(varying|out)[\\t ]+.+;/);\n            }\n            else {\n                varyingMatch = row.match(/^(?![\\/])[\\t ]*(varying|in)[\\t ]+.+;/);\n            }\n            if (varyingMatch) {\n                const reflectionVarying = {\n                    name: '',\n                    type: 'float',\n                    inout: 'in'\n                };\n                const match = row.match(varTypes);\n                if (match) {\n                    const type = match[1];\n                    reflectionVarying.type = type;\n                    const name = match[2];\n                    reflectionVarying.name = name;\n                    reflectionVarying.inout = (obj.shaderStage === 'vertex') ? 'out' : 'in';\n                }\n                reflection.varyings.push(reflectionVarying);\n                continue;\n            }\n            const uniformMatch = row.match(/^(?![\\/])[\\t ]*uniform[\\t ]+/);\n            if (uniformMatch) {\n                const reflectionUniform = {\n                    name: '',\n                    type: 'float',\n                    semantic: 'UNKNOWN'\n                };\n                const match = row.match(varTypes2);\n                if (match) {\n                    const type = match[1];\n                    reflectionUniform.type = type;\n                    const name = match[2];\n                    reflectionUniform.name = name;\n                    const match2 = row.match(semanticRegExp);\n                    if (match2) {\n                        reflectionUniform.semantic = match2[1];\n                    }\n                    else {\n                        for (let [key, value] of this.__uniformSemanticsMap) {\n                            if (name.match(new RegExp(key, 'i'))) {\n                                reflectionUniform.semantic = value;\n                            }\n                        }\n                    }\n                }\n                reflection.uniforms.push(reflectionUniform);\n                continue;\n            }\n        }\n        return reflection;\n    }\n    _defineGLSLES3() {\n    }\n}\nexports.default = Shaderity;\n\n\n//# sourceURL=webpack:///./node_modules/shaderity/dist/index.js?");

/***/ }),

/***/ "./src/effekseer/EffekseerComponent.ts":
/*!*********************************************!*\
  !*** ./src/effekseer/EffekseerComponent.ts ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EffekseerComponent; });\n/* harmony import */ var _foundation_core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../foundation/math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass EffekseerComponent extends _foundation_core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.__speed = 1;\r\n        this.playJustAfterLoaded = false;\r\n        this.isLoop = false;\r\n        _foundation_core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].noWebGLTex2DStateCache = true;\r\n    }\r\n    static get componentTID() {\r\n        return _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_6__[\"WellKnownComponentTIDs\"].EffekseerComponentTID;\r\n    }\r\n    cancelLoop() {\r\n        clearInterval(this.__timer);\r\n    }\r\n    play() {\r\n        const __play = () => {\r\n            // Play the loaded effect\r\n            this.__handle = effekseer.play(this.__effect);\r\n        };\r\n        if (this.isLoop) {\r\n            this.__timer = setInterval(__play, 200);\r\n        }\r\n        else {\r\n            __play();\r\n        }\r\n    }\r\n    set playSpeed(val) {\r\n        if (this.__handle) {\r\n            this.__handle.setSpeed(val);\r\n        }\r\n        this.__speed = val;\r\n    }\r\n    get playSpeed() {\r\n        return this.__speed;\r\n    }\r\n    set translate(vec) {\r\n        if (this.__handle) {\r\n            this.__handle.setLocation(vec.x, vec.y, vec.z);\r\n        }\r\n        this.__transformComponent.translate = vec;\r\n    }\r\n    get translate() {\r\n        return this.__transformComponent.translate;\r\n    }\r\n    set rotate(vec) {\r\n        if (this.__handle) {\r\n            this.__handle.setRotation(vec.x, vec.y, vec.z);\r\n        }\r\n        this.__transformComponent.rotate = vec;\r\n    }\r\n    get rotate() {\r\n        return this.__transformComponent.rotate;\r\n    }\r\n    set scale(vec) {\r\n        if (this.__handle) {\r\n            this.__handle.setScale(vec.x, vec.y, vec.z);\r\n        }\r\n        this.__transformComponent.scale = vec;\r\n    }\r\n    get scale() {\r\n        return this.__transformComponent.scale;\r\n    }\r\n    $create() {\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\r\n        this.__transformComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"]);\r\n        this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Load);\r\n    }\r\n    static common_$load() {\r\n        if (EffekseerComponent.__isInitialized) {\r\n            return;\r\n        }\r\n        const webGLResourceRepository = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getWebGLResourceRepository();\r\n        const glw = webGLResourceRepository.currentWebGLContextWrapper;\r\n        if (glw) {\r\n            effekseer.init(glw.getRawContext());\r\n            EffekseerComponent.__isInitialized = true;\r\n        }\r\n    }\r\n    $load() {\r\n        if (this.__effect == null) {\r\n            this.__effect = effekseer.loadEffect(this.uri, () => {\r\n                if (this.playJustAfterLoaded) {\r\n                    if (this.isLoop) {\r\n                        this.__timer = setInterval(() => { this.play(); }, 500);\r\n                    }\r\n                    else {\r\n                        this.play();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Logic);\r\n    }\r\n    static common_$logic() {\r\n        effekseer.update();\r\n    }\r\n    $logic() {\r\n        if (this.__handle != null) {\r\n            const worldMatrix = EffekseerComponent.__tmp_identityMatrix_0.copyComponents(this.__sceneGraphComponent.worldMatrixInner);\r\n            this.__handle.setMatrix(worldMatrix.v);\r\n            this.__handle.setSpeed(this.__speed);\r\n        }\r\n    }\r\n    static common_$render() {\r\n        const cameraComponent = _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance().getComponent(_foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"], _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"].main);\r\n        const viewMatrix = EffekseerComponent.__tmp_identityMatrix_0;\r\n        const projectionMatrix = EffekseerComponent.__tmp_identityMatrix_1;\r\n        if (cameraComponent) {\r\n            viewMatrix.copyComponents(cameraComponent.viewMatrix);\r\n            projectionMatrix.copyComponents(cameraComponent.projectionMatrix);\r\n        }\r\n        else {\r\n            viewMatrix.identity();\r\n            projectionMatrix.identity();\r\n        }\r\n        effekseer.setProjectionMatrix(projectionMatrix.v);\r\n        effekseer.setCameraMatrix(viewMatrix.v);\r\n        effekseer.draw();\r\n    }\r\n}\r\nEffekseerComponent.__isInitialized = false;\r\nEffekseerComponent.__tmp_identityMatrix_0 = _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"].identity();\r\nEffekseerComponent.__tmp_identityMatrix_1 = _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"].identity();\r\n_foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].registerComponentClass(EffekseerComponent);\r\n\n\n//# sourceURL=webpack:///./src/effekseer/EffekseerComponent.ts?");

/***/ }),

/***/ "./src/effekseer/main.ts":
/*!*******************************!*\
  !*** ./src/effekseer/main.ts ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _EffekseerComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EffekseerComponent */ \"./src/effekseer/EffekseerComponent.ts\");\n/* harmony import */ var _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n\r\n\r\n\r\n\r\nconst createEffekseerEntity = function () {\r\n    const entityRepository = _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n    const entity = entityRepository.createEntity([_foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _EffekseerComponent__WEBPACK_IMPORTED_MODULE_0__[\"default\"]]);\r\n    return entity;\r\n};\r\nconst Effekseer = Object.freeze({\r\n    EffekseerComponent: _EffekseerComponent__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n    createEffekseerEntity\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Effekseer);\r\n\n\n//# sourceURL=webpack:///./src/effekseer/main.ts?");

/***/ }),

/***/ "./src/foundation/cameras/OrbitCameraController.ts":
/*!*********************************************************!*\
  !*** ./src/foundation/cameras/OrbitCameraController.ts ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return OrbitCameraController; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass OrbitCameraController {\r\n    constructor() {\r\n        this.__isKeyUp = true;\r\n        this.__originalY = -1;\r\n        this.__originalX = -1;\r\n        this.__buttonNumber = 0;\r\n        this.__mouse_translate_y = 0;\r\n        this.__mouse_translate_x = 0;\r\n        this.__efficiency = 1;\r\n        this.__lengthOfCenterToEye = 1;\r\n        this.__fovyBias = 1.0;\r\n        this.__scaleOfTranslation = 2.8;\r\n        this.__mouseTranslateVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__newEyeVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__newCenterVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__newUpVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__newTangentVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        // private __verticalAngleThreshold = 0;\r\n        // private __verticalAngleOfVectors = 0;\r\n        this.__isForceGrab = false;\r\n        this.__isSymmetryMode = true;\r\n        // private __doResetWhenCameraSettingChanged = false;\r\n        this.__rot_bgn_x = 0;\r\n        this.__rot_bgn_y = 0;\r\n        this.__rot_x = 0;\r\n        this.__rot_y = 0;\r\n        this.__dolly = 0.5;\r\n        this.dollyScale = 2.0;\r\n        this.__eyeVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__centerVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__upVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__shiftCameraTo = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.scaleOfLengthCenterToCamera = 1.0;\r\n        this.__zFarAdjustingFactorBasedOnAABB = 150;\r\n        this.__scaleOfZNearAndZFar = 5000;\r\n        this.__doPreventDefault = true;\r\n        this.moveSpeed = 1;\r\n        this.__isPressingShift = false;\r\n        this.__isPressingCtrl = false;\r\n        this.__pinchInOutControl = false;\r\n        this.__pinchInOutOriginalDistance = null;\r\n        this.__resetDollyTouchTime = 0;\r\n        // private __controllerTranslate = MutableVector3.zero();\r\n        this.__mouseDownFunc = this.__mouseDown.bind(this);\r\n        this.__mouseUpFunc = this.__mouseUp.bind(this);\r\n        this.__mouseMoveFunc = this.__mouseMove.bind(this);\r\n        this.__touchDownFunc = this.__touchDown.bind(this);\r\n        this.__touchUpFunc = this.__touchUp.bind(this);\r\n        this.__touchMoveFunc = this.__touchMove.bind(this);\r\n        this.__pinchInOutFunc = this.__pinchInOut.bind(this);\r\n        this.__pinchInOutEndFunc = this.__pinchInOutEnd.bind(this);\r\n        this.__mouseWheelFunc = this.__mouseWheel.bind(this);\r\n        this.__mouseDblClickFunc = this.__mouseDblClick.bind(this);\r\n        this.__contextMenuFunc = this.__contextMenu.bind(this);\r\n        this.__pressShiftFunc = this.__pressShift.bind(this);\r\n        this.__releaseShiftFunc = this.__releaseShift.bind(this);\r\n        this.__pressCtrlFunc = this.__pressCtrl.bind(this);\r\n        this.__releaseCtrlFunc = this.__releaseCtrl.bind(this);\r\n        this.__resetDollyAndPositionFunc = this.__resetDollyAndPosition.bind(this);\r\n        this.registerEventListeners();\r\n    }\r\n    set zFarAdjustingFactorBasedOnAABB(value) {\r\n        this.__zFarAdjustingFactorBasedOnAABB = value;\r\n    }\r\n    get zFarAdjustingFactorBasedOnAABB() {\r\n        return this.__zFarAdjustingFactorBasedOnAABB;\r\n    }\r\n    setTarget(targetEntity) {\r\n        this.__targetEntity = targetEntity;\r\n    }\r\n    getTarget() {\r\n        return this.__targetEntity;\r\n    }\r\n    set doPreventDefault(flag) {\r\n        this.__doPreventDefault = flag;\r\n    }\r\n    get doPreventDefault() {\r\n        return this.__doPreventDefault;\r\n    }\r\n    __mouseDown(e) {\r\n        this.__tryToPreventDefault(e);\r\n        if (!this.__isKeyUp)\r\n            return;\r\n        if (this.__isPressingCtrl)\r\n            return;\r\n        this.__originalX = e.clientX;\r\n        this.__originalY = e.clientY;\r\n        this.__rot_bgn_x = this.__rot_x;\r\n        this.__rot_bgn_y = this.__rot_y;\r\n        this.__isKeyUp = false;\r\n        // if (typeof e.buttons !== \"undefined\") {\r\n        //        this.updateCamera();\r\n        // }\r\n    }\r\n    __mouseMove(e) {\r\n        this.__tryToPreventDefault(e);\r\n        if (this.__isKeyUp)\r\n            return;\r\n        if (this.__isPressingCtrl)\r\n            return;\r\n        if (this.__buttonNumber === 0) {\r\n            this.__buttonNumber = e.buttons;\r\n        }\r\n        const currentMouseX = e.clientX;\r\n        const currentMouseY = e.clientY;\r\n        switch (this.__buttonNumber) {\r\n            case 1: // left\r\n                if (this.__isPressingShift) {\r\n                    this.__parallelTranslateControl(this.__originalX, this.__originalY, currentMouseX, currentMouseY);\r\n                }\r\n                else {\r\n                    this.__rotateControl(this.__originalX, this.__originalY, currentMouseX, currentMouseY);\r\n                    this.__rot_bgn_x = this.__rot_x;\r\n                    this.__rot_bgn_y = this.__rot_y;\r\n                }\r\n                break;\r\n            case 2: // right\r\n                this.__zoomControl(this.__originalX, currentMouseX);\r\n                break;\r\n            case 4: // center\r\n                this.__parallelTranslateControl(this.__originalX, this.__originalY, currentMouseX, currentMouseY);\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n        this.__originalX = currentMouseX;\r\n        this.__originalY = currentMouseY;\r\n    }\r\n    ;\r\n    __mouseUp(e) {\r\n        this.__buttonNumber = 0;\r\n        this.__originalX = -1;\r\n        this.__originalY = -1;\r\n        this.__isKeyUp = true;\r\n    }\r\n    __touchDown(e) {\r\n        this.__tryToPreventDefault(e);\r\n        if (e.touches.length === 1) {\r\n            this.__originalX = e.touches[0].clientX;\r\n            this.__originalY = e.touches[0].clientY;\r\n            this.__rot_bgn_x = this.__rot_x;\r\n            this.__rot_bgn_y = this.__rot_y;\r\n        }\r\n        else {\r\n            this.__originalX = (e.touches[0].clientX + e.touches[1].clientX) * 0.5;\r\n            this.__originalY = (e.touches[0].clientY + e.touches[1].clientY) * 0.5;\r\n        }\r\n        this.__isKeyUp = false;\r\n    }\r\n    __touchMove(e) {\r\n        this.__tryToPreventDefault(e);\r\n        if (this.__isKeyUp)\r\n            return;\r\n        let currentTouchX = e.touches[0].clientX;\r\n        let currentTouchY = e.touches[0].clientY;\r\n        if (e.touches.length === 1) {\r\n            currentTouchX = e.touches[0].clientX;\r\n            currentTouchY = e.touches[0].clientY;\r\n            this.__rotateControl(this.__originalX, this.__originalY, currentTouchX, currentTouchY);\r\n            this.__rot_bgn_x = this.__rot_x;\r\n            this.__rot_bgn_y = this.__rot_y;\r\n        }\r\n        else {\r\n            currentTouchX = (e.touches[0].clientX + e.touches[1].clientX) * 0.5;\r\n            currentTouchY = (e.touches[0].clientY + e.touches[1].clientY) * 0.5;\r\n            this.__parallelTranslateControl(this.__originalX, this.__originalY, currentTouchX, currentTouchY);\r\n        }\r\n        this.__originalX = currentTouchX;\r\n        this.__originalY = currentTouchY;\r\n    }\r\n    __touchUp(e) {\r\n        const touchNumber = e.touches.length;\r\n        if (touchNumber === 0) {\r\n            this.__originalX = -1;\r\n            this.__originalY = -1;\r\n            this.__isKeyUp = true;\r\n        }\r\n        else if (touchNumber === 1) {\r\n            this.__originalX = e.touches[0].clientX;\r\n            this.__originalY = e.touches[0].clientY;\r\n            this.__rot_bgn_x = this.__rot_x;\r\n            this.__rot_bgn_y = this.__rot_y;\r\n        }\r\n        else {\r\n            this.__originalX = (e.touches[0].clientX + e.touches[1].clientX) * 0.5;\r\n            this.__originalY = (e.touches[0].clientY + e.touches[1].clientY) * 0.5;\r\n        }\r\n    }\r\n    set rotX(value) {\r\n        this.__rot_x = value;\r\n    }\r\n    set rotY(value) {\r\n        this.__rot_y = value;\r\n    }\r\n    get rotX() {\r\n        return this.__rot_x;\r\n    }\r\n    get rotY() {\r\n        return this.__rot_y;\r\n    }\r\n    set maximumY(maximum_y) {\r\n        this.__maximum_y = maximum_y;\r\n    }\r\n    set minimumY(minimum_y) {\r\n        this.__minimum_y = minimum_y;\r\n    }\r\n    __rotateControl(originalX, originalY, currentX, currentY) {\r\n        // calc rotation angle\r\n        let delta_x = (currentX - originalX) * this.__efficiency * 0.3;\r\n        let delta_y = (currentY - originalY) * this.__efficiency * 0.3;\r\n        this.__rot_x = this.__rot_bgn_x - delta_x;\r\n        this.__rot_y = this.__rot_bgn_y - delta_y;\r\n        // check if rotation angle is within range\r\n        // if (\r\n        //   this.__verticalAngleThreshold - this.__verticalAngleOfVectors < this.__rot_y\r\n        // ) {\r\n        //          this._rot_y -= this._rot_y - (this._verticalAngleThreshold - this._verticalAngleOfVectors);\r\n        // }\r\n        // if (\r\n        //   this.__rot_y < -this.__verticalAngleThreshold + this.__verticalAngleOfVectors\r\n        // ) {\r\n        //         this._rot_y += this._rot_y - (this._verticalAngleThreshold - this._verticalAngleOfVectors);\r\n        // }\r\n        if (this.__maximum_y != null && this.__rot_y > this.__maximum_y) {\r\n            this.__rot_y = this.__maximum_y;\r\n        }\r\n        if (this.__minimum_y != null && this.__rot_y < this.__minimum_y) {\r\n            this.__rot_y = this.__minimum_y;\r\n        }\r\n    }\r\n    __zoomControl(originalValue, currentValue) {\r\n        this.dolly -= ((currentValue - originalValue) / 1000) * this.__efficiency;\r\n    }\r\n    __parallelTranslateControl(originalX, originalY, currentX, currentY) {\r\n        this.__mouse_translate_y = ((currentY - originalY) / 1000) * this.__efficiency;\r\n        this.__mouse_translate_x = ((currentX - originalX) / 1000) * this.__efficiency;\r\n        const scale = this.__lengthOfCenterToEye * this.__fovyBias * this.__scaleOfTranslation;\r\n        const upDirTranslateVec = OrbitCameraController.__tmpVec3_0;\r\n        upDirTranslateVec.copyComponents(this.__newUpVec).normalize().multiply(this.__mouse_translate_y).multiply(scale);\r\n        const tangentDirTranslateVec = OrbitCameraController.__tmpVec3_1;\r\n        tangentDirTranslateVec.copyComponents(this.__newTangentVec).normalize().multiply(this.__mouse_translate_x).multiply(scale);\r\n        this.__mouseTranslateVec.add(upDirTranslateVec).add(tangentDirTranslateVec);\r\n    }\r\n    __getTouchesDistance(e) {\r\n        const touches = e.touches;\r\n        const diffX = touches[1].clientX - touches[0].clientX;\r\n        const diffY = touches[1].clientY - touches[0].clientY;\r\n        return Math.hypot(diffX, diffY);\r\n    }\r\n    __pinchInOut(e) {\r\n        if (e.touches.length < 2)\r\n            return;\r\n        if (this.__pinchInOutOriginalDistance == null) {\r\n            this.__pinchInOutOriginalDistance = this.__getTouchesDistance(e);\r\n            return;\r\n        }\r\n        const currentDistance = this.__getTouchesDistance(e);\r\n        const originalDistance = this.__pinchInOutOriginalDistance;\r\n        if (!this.__pinchInOutControl) {\r\n            if (Math.abs(currentDistance - originalDistance) > 35.0) {\r\n                this.__pinchInOutOriginalDistance = currentDistance;\r\n                this.__pinchInOutControl = true;\r\n            }\r\n            return;\r\n        }\r\n        const ratio = originalDistance / currentDistance;\r\n        this.dolly *= Math.pow(ratio * this.__efficiency, 2.2 / 15.0);\r\n        this.__pinchInOutOriginalDistance = currentDistance;\r\n    }\r\n    __pinchInOutEnd(e) {\r\n        if (e.touches.length < 2) {\r\n            this.__pinchInOutControl = false;\r\n            this.__pinchInOutOriginalDistance = null;\r\n        }\r\n    }\r\n    __tryToPreventDefault(evt) {\r\n        if (this.__doPreventDefault) {\r\n            evt.preventDefault();\r\n        }\r\n    }\r\n    __mouseWheel(evt) {\r\n        this.__tryToPreventDefault(evt);\r\n        this.dolly += Math.sign(evt.deltaY) / 200;\r\n    }\r\n    ;\r\n    __contextMenu(evt) {\r\n        this.__tryToPreventDefault(evt);\r\n    }\r\n    ;\r\n    set dolly(value) {\r\n        value = Math.min(value, 1);\r\n        value = Math.max(value, 0.0001);\r\n        let gamma = Math.pow(value, 5);\r\n        gamma = Math.max(gamma, 0.0001);\r\n        this.__dolly = gamma;\r\n    }\r\n    get dolly() {\r\n        return Math.pow(this.__dolly, 1 / 5);\r\n    }\r\n    __mouseDblClick(evt) {\r\n        if (evt.shiftKey) {\r\n            this.__mouseTranslateVec.zero();\r\n        }\r\n        else if (evt.ctrlKey) {\r\n            this.__rot_y = 0;\r\n            this.__rot_x = 0;\r\n            this.__rot_bgn_y = 0;\r\n            this.__rot_bgn_x = 0;\r\n        }\r\n    }\r\n    ;\r\n    __resetDollyAndPosition(e) {\r\n        if (e.touches.length > 1)\r\n            return;\r\n        const currentTime = new Date().getTime();\r\n        if (currentTime - this.__resetDollyTouchTime < 300) {\r\n            this.dolly = Math.pow(0.5, 1.0 / 2.2);\r\n            this.__mouseTranslateVec.zero();\r\n            this.__rot_x = 0;\r\n            this.__rot_y = 0;\r\n        }\r\n        else {\r\n            this.__resetDollyTouchTime = currentTime;\r\n        }\r\n    }\r\n    __pressShift(e) {\r\n        if (e.keyCode === 16) {\r\n            this.__isPressingShift = true;\r\n        }\r\n    }\r\n    __releaseShift(e) {\r\n        if (e.keyCode === 16) {\r\n            this.__isPressingShift = false;\r\n        }\r\n    }\r\n    __pressCtrl(e) {\r\n        if (e.keyCode === 17) {\r\n            this.__isPressingCtrl = true;\r\n        }\r\n    }\r\n    __releaseCtrl(e) {\r\n        if (e.keyCode === 17) {\r\n            this.__isPressingCtrl = false;\r\n        }\r\n    }\r\n    registerEventListeners(eventTargetDom = document) {\r\n        this._eventTargetDom = eventTargetDom;\r\n        if (eventTargetDom) {\r\n            if (\"ontouchend\" in document) {\r\n                eventTargetDom.addEventListener(\"touchstart\", this.__touchDownFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"touchmove\", this.__touchMoveFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"touchend\", this.__touchUpFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"touchmove\", this.__pinchInOutFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"touchend\", this.__pinchInOutEndFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"touchstart\", this.__resetDollyAndPositionFunc, { passive: !this.__doPreventDefault });\r\n            }\r\n            else {\r\n                eventTargetDom.addEventListener(\"mousedown\", this.__mouseDownFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"mouseup\", this.__mouseUpFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"mouseleave\", this.__mouseUpFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"mousemove\", this.__mouseMoveFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"keydown\", this.__pressShiftFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"keyup\", this.__releaseShiftFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"keydown\", this.__pressCtrlFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"keyup\", this.__releaseCtrlFunc, { passive: !this.__doPreventDefault });\r\n                eventTargetDom.addEventListener(\"contextmenu\", (e) => { e.preventDefault(); });\r\n            }\r\n            if (window.WheelEvent) {\r\n                eventTargetDom.addEventListener(\"wheel\", this.__mouseWheelFunc, { passive: !this.__doPreventDefault });\r\n            }\r\n            eventTargetDom.addEventListener(\"contextmenu\", this.__contextMenuFunc, { passive: !this.__doPreventDefault });\r\n            eventTargetDom.addEventListener(\"dblclick\", this.__mouseDblClickFunc, { passive: !this.__doPreventDefault });\r\n        }\r\n    }\r\n    unregisterEventListeners() {\r\n        const eventTargetDom = this._eventTargetDom;\r\n        if (eventTargetDom) {\r\n            if (\"ontouchend\" in document) {\r\n                eventTargetDom.removeEventListener(\"touchstart\", this.__touchDownFunc);\r\n                eventTargetDom.removeEventListener(\"touchmove\", this.__touchMoveFunc);\r\n                eventTargetDom.removeEventListener(\"touchend\", this.__touchUpFunc);\r\n                eventTargetDom.removeEventListener(\"touchmove\", this.__pinchInOutFunc);\r\n                eventTargetDom.removeEventListener(\"touchend\", this.__pinchInOutEndFunc);\r\n                eventTargetDom.removeEventListener(\"touchstart\", this.__resetDollyAndPositionFunc);\r\n            }\r\n            else {\r\n                eventTargetDom.removeEventListener(\"mousedown\", this.__mouseDownFunc);\r\n                eventTargetDom.removeEventListener(\"mouseup\", this.__mouseUpFunc);\r\n                eventTargetDom.removeEventListener(\"mouseleave\", this.__mouseUpFunc);\r\n                eventTargetDom.removeEventListener(\"mousemove\", this.__mouseMoveFunc);\r\n                eventTargetDom.removeEventListener(\"keydown\", this.__pressShiftFunc);\r\n                eventTargetDom.removeEventListener(\"keyup\", this.__releaseShiftFunc);\r\n                eventTargetDom.removeEventListener(\"contextmenu\", (e) => { e.preventDefault(); });\r\n            }\r\n            if (window.WheelEvent) {\r\n                eventTargetDom.removeEventListener(\"wheel\", this.__mouseWheelFunc);\r\n            }\r\n            eventTargetDom.removeEventListener(\"contextmenu\", this.__contextMenuFunc);\r\n            eventTargetDom.removeEventListener(\"dblclick\", this.__mouseDblClickFunc);\r\n        }\r\n    }\r\n    __getFovyFromCamera(camera) {\r\n        if (camera.fovy) {\r\n            return camera.fovy;\r\n        }\r\n        else {\r\n            return _math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].radianToDegree(2 * Math.atan(Math.abs(camera.top - camera.bottom) / (2 * camera.zNear)));\r\n        }\r\n    }\r\n    logic(cameraComponent) {\r\n        const data0 = this.__updateTargeting(cameraComponent);\r\n        const eye = data0.newEyeVec;\r\n        const center = data0.newCenterVec;\r\n        const up = data0.newUpVec;\r\n        const data = this.__convert(cameraComponent, eye, center, up);\r\n        const cc = cameraComponent;\r\n        cc.eyeInner = data.newEyeVec;\r\n        cc.directionInner = data.newCenterVec;\r\n        cc.upInner = data.newUpVec;\r\n        cc.zNearInner = data.newZNear;\r\n        cc.zFarInner = data.newZFar;\r\n        cc.leftInner = data.newLeft;\r\n        cc.rightInner = data.newRight;\r\n        cc.topInner = data.newTop;\r\n        cc.bottomInner = data.newBottom;\r\n        cc.fovyInner = data.fovy;\r\n    }\r\n    __convert(camera, eye, center, up) {\r\n        if (this.__isKeyUp || !this.__isForceGrab) {\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addTo(eye, this.__shiftCameraTo, this.__eyeVec);\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addTo(center, this.__shiftCameraTo, this.__centerVec);\r\n            this.__upVec.copyComponents(up);\r\n        }\r\n        const centerToEyeVec = this.__eyeVec.subtract(this.__centerVec);\r\n        centerToEyeVec.multiply(this.__dolly * this.dollyScale);\r\n        this.__lengthOfCenterToEye = centerToEyeVec.length();\r\n        const newUpVec = this.__newUpVec;\r\n        const newEyeVec = this.__newEyeVec;\r\n        const newCenterVec = this.__newCenterVec;\r\n        const newTangentVec = this.__newTangentVec;\r\n        if (this.__isSymmetryMode) {\r\n            const projectedCenterToEyeVec = OrbitCameraController.__tmpVec3_0;\r\n            projectedCenterToEyeVec.setComponents(centerToEyeVec.x, 0, centerToEyeVec.z);\r\n            let horizontalAngleOfVectors = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].angleOfVectors(projectedCenterToEyeVec, OrbitCameraController.__tmp_up);\r\n            const horizontalSign = Math.sign(projectedCenterToEyeVec.cross(OrbitCameraController.__tmp_up).y);\r\n            horizontalAngleOfVectors *= horizontalSign;\r\n            const rotateM_X = OrbitCameraController.__tmp_rotateM_X;\r\n            const rotateM_Y = OrbitCameraController.__tmp_rotateM_Y;\r\n            const rotateM_Reset = OrbitCameraController.__tmp_rotateM_Reset;\r\n            const rotateM_Revert = OrbitCameraController.__tmp_rotateM_Revert;\r\n            rotateM_X.rotateX(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(this.__rot_y));\r\n            rotateM_Y.rotateY(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(this.__rot_x));\r\n            rotateM_Reset.rotateY(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(horizontalAngleOfVectors));\r\n            rotateM_Revert.rotateY(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(-horizontalAngleOfVectors));\r\n            const rotateM = OrbitCameraController.__tmp_rotateM;\r\n            _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].multiplyTo(rotateM_X, rotateM_Reset, rotateM);\r\n            rotateM.multiplyByLeft(rotateM_Y);\r\n            rotateM.multiplyByLeft(rotateM_Revert);\r\n            rotateM.multiplyVectorTo(this.__upVec, newUpVec);\r\n            rotateM.multiplyVectorTo(centerToEyeVec, newEyeVec).add(this.__centerVec);\r\n            this.__newCenterVec.copyComponents(this.__centerVec);\r\n            const newEyeToCenterVec = OrbitCameraController.__tmpVec3_1;\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].subtractTo(newCenterVec, newEyeVec, newEyeToCenterVec);\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].crossTo(newUpVec, newEyeToCenterVec, newTangentVec);\r\n            this.__newEyeVec.add(this.__mouseTranslateVec);\r\n            this.__newCenterVec.add(this.__mouseTranslateVec);\r\n            // const horizonResetVec = OrbitCameraController.__tmpVec3_2;\r\n            // rotateM_Reset.multiplyVectorTo(centerToEyeVec, horizonResetVec);\r\n            // this.__verticalAngleOfVectors = Vector3.angleOfVectors(horizonResetVec, OrbitCameraController.__tmp_up);\r\n            // const verticalSign = Math.sign(Vector3.crossTo(horizonResetVec, OrbitCameraController.__tmp_up, OrbitCameraController.__tmp_verticalSign).x);\r\n            //this._verticalAngleOfVectors *= verticalSign;\r\n        }\r\n        else {\r\n            const rotateM_X = OrbitCameraController.__tmp_rotateM_X;\r\n            const rotateM_Y = OrbitCameraController.__tmp_rotateM_Y;\r\n            rotateM_X.rotateX(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(this.__rot_y));\r\n            rotateM_Y.rotateY(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(this.__rot_x));\r\n            const rotateM = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].multiplyTo(rotateM_Y, rotateM_X, OrbitCameraController.__tmp_rotateM);\r\n            rotateM.multiplyVectorTo(this.__upVec, newUpVec);\r\n            rotateM.multiplyVectorTo(centerToEyeVec, newEyeVec).add(this.__centerVec);\r\n            this.__newCenterVec.copyComponents(this.__centerVec);\r\n            const newEyeToCenterVec = OrbitCameraController.__tmpVec3_1;\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].subtractTo(newCenterVec, newEyeVec, newEyeToCenterVec);\r\n            _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].crossTo(newUpVec, newEyeToCenterVec, newTangentVec);\r\n            this.__newEyeVec.add(this.__mouseTranslateVec);\r\n            this.__newCenterVec.add(this.__mouseTranslateVec);\r\n        }\r\n        let newLeft = camera.left;\r\n        let newRight = camera.right;\r\n        let newTop = camera.top;\r\n        let newBottom = camera.bottom;\r\n        let newZNear = camera.zNear;\r\n        let newZFar = camera.zFar;\r\n        let ratio = 1;\r\n        const targetAABB = this.__getTargetAABB();\r\n        if (this.__targetEntity) {\r\n            newZFar = newZNear + _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].lengthBtw(newCenterVec, newEyeVec);\r\n            newZFar += targetAABB.lengthCenterToCorner * this.__zFarAdjustingFactorBasedOnAABB;\r\n        }\r\n        if (typeof newLeft !== \"undefined\") {\r\n            if (typeof targetAABB.lengthCenterToCorner !== \"undefined\") {\r\n                //let aabb = this.__getTargetAABB();\r\n                ratio = newZFar / camera.zNear;\r\n                const minRatio = this.__scaleOfZNearAndZFar;\r\n                ratio /= minRatio;\r\n                let scale = ratio;\r\n                newLeft *= scale;\r\n                newRight *= scale;\r\n                newTop *= scale;\r\n                newBottom *= scale;\r\n                //        newZFar *= scale;\r\n                newZNear *= scale;\r\n            }\r\n        }\r\n        const fovy = this.__getFovyFromCamera(camera);\r\n        this.__fovyBias = Math.tan(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(fovy / 2.0));\r\n        return {\r\n            newEyeVec,\r\n            newCenterVec,\r\n            newUpVec,\r\n            newZNear,\r\n            newZFar,\r\n            newLeft,\r\n            newRight,\r\n            newTop,\r\n            newBottom,\r\n            fovy\r\n        };\r\n    }\r\n    __getTargetAABB() {\r\n        if (this.__firstTargetAABB == null) {\r\n            this.__firstTargetAABB = this.__targetEntity.getSceneGraph().worldAABB.clone();\r\n        }\r\n        return this.__firstTargetAABB;\r\n    }\r\n    __updateTargeting(camera) {\r\n        const eyeVec = camera.eye;\r\n        const centerVec = camera._direction;\r\n        const upVec = camera._up;\r\n        if (this.__targetEntity == null) {\r\n            return { newEyeVec: eyeVec, newCenterVec: centerVec, newUpVec: upVec };\r\n        }\r\n        const targetAABB = this.__getTargetAABB();\r\n        let newCenterVec = targetAABB.centerPoint;\r\n        const centerToCameraVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].subtractTo(eyeVec, centerVec, OrbitCameraController.returnVector3Eye);\r\n        const centerToCameraVecNormalized = centerToCameraVec.normalize();\r\n        const lengthCenterToCamera = targetAABB.lengthCenterToCorner * (1.0 + 1.0 / Math.tan(_math_MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].degreeToRadian(camera.fovy / 2.0))) * this.scaleOfLengthCenterToCamera;\r\n        let newEyeVec = centerToCameraVecNormalized.multiply(lengthCenterToCamera).add(newCenterVec);\r\n        let newUpVec = upVec;\r\n        const sg = camera.entity.getSceneGraph();\r\n        if (sg != null) {\r\n            const invMat = _math_Matrix44__WEBPACK_IMPORTED_MODULE_4__[\"default\"].invertTo(sg.worldMatrixInner, OrbitCameraController.__tmpMat44_0);\r\n            newEyeVec = invMat.multiplyVector3To(newEyeVec, OrbitCameraController.returnVector3Eye);\r\n            newCenterVec = invMat.multiplyVector3To(newCenterVec, OrbitCameraController.returnVector3Center);\r\n            newUpVec = invMat.multiplyVector3To(upVec, OrbitCameraController.returnVector3Up);\r\n        }\r\n        return { newEyeVec, newCenterVec, newUpVec };\r\n    }\r\n    set scaleOfZNearAndZFar(value) {\r\n        this.__scaleOfZNearAndZFar = value;\r\n    }\r\n    get scaleOfZNearAndZFar() {\r\n        return this.__scaleOfZNearAndZFar;\r\n    }\r\n}\r\nOrbitCameraController.returnVector3Eye = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nOrbitCameraController.returnVector3Center = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nOrbitCameraController.returnVector3Up = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nOrbitCameraController.__tmp_up = new _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0, 1);\r\nOrbitCameraController.__tmpVec3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nOrbitCameraController.__tmpVec3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nOrbitCameraController.__tmp_rotateM_X = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nOrbitCameraController.__tmp_rotateM_Y = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nOrbitCameraController.__tmp_rotateM = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nOrbitCameraController.__tmp_rotateM_Reset = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nOrbitCameraController.__tmp_rotateM_Revert = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nOrbitCameraController.__tmpMat44_0 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"].identity();\r\n\n\n//# sourceURL=webpack:///./src/foundation/cameras/OrbitCameraController.ts?");

/***/ }),

/***/ "./src/foundation/cameras/WalkThroughCameraController.ts":
/*!***************************************************************!*\
  !*** ./src/foundation/cameras/WalkThroughCameraController.ts ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WalkThroughCameraController; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/MathClassUtil */ \"./src/foundation/math/MathClassUtil.ts\");\n/* harmony import */ var _misc_MiscUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass WalkThroughCameraController {\r\n    constructor(options = {\r\n        eventTargetDom: document,\r\n        verticalSpeed: 1,\r\n        horizontalSpeed: 1,\r\n        turnSpeed: 0.25,\r\n        mouseWheelSpeedScale: 1,\r\n        inverseVerticalRotating: false,\r\n        inverseHorizontalRotating: false\r\n    }) {\r\n        this._isKeyDown = false;\r\n        this._isMouseDrag = false;\r\n        this._lastKeyCode = -1;\r\n        this._currentDir = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, -1);\r\n        this._currentPos = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, 0);\r\n        this._currentCenter = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, -1);\r\n        this._currentHorizontalDir = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, -1);\r\n        this._newDir = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, -1);\r\n        this._isMouseDown = false;\r\n        this._clickedMouseXOnCanvas = -1;\r\n        this._clickedMouseYOnCanvas = -1;\r\n        this._draggedMouseXOnCanvas = -1;\r\n        this._draggedMouseYOnCanvas = -1;\r\n        this._deltaMouseXOnCanvas = -1;\r\n        this._deltaMouseYOnCanvas = -1;\r\n        this._mouseXAdjustScale = 1;\r\n        this._mouseYAdjustScale = 1;\r\n        this._deltaY = -1;\r\n        this._deltaX = -1;\r\n        this._mouseUpBind = this._mouseUp.bind(this);\r\n        this._mouseDownBind = this._mouseDown.bind(this);\r\n        this._mouseMoveBind = this._mouseMove.bind(this);\r\n        this._mouseWheelBind = this._mouseWheel.bind(this);\r\n        this._needInitialize = true;\r\n        this._zFarAdjustingFactorBasedOnAABB = 150.0;\r\n        this.__scaleOfZNearAndZFar = 5000;\r\n        this._horizontalSpeed = options.horizontalSpeed;\r\n        this._verticalSpeed = options.verticalSpeed;\r\n        this._turnSpeed = options.turnSpeed;\r\n        this._mouseXAdjustScale = this._turnSpeed;\r\n        this._mouseYAdjustScale = this._turnSpeed;\r\n        this._mouseWheelSpeedScale = options.mouseWheelSpeedScale;\r\n        this._inverseVerticalRotating = options.inverseVerticalRotating;\r\n        this._inverseHorizontalRotating = options.inverseHorizontalRotating;\r\n        this.reset();\r\n        this._onKeydown = e => {\r\n            this._isKeyDown = true;\r\n            this._lastKeyCode = e.keyCode;\r\n        };\r\n        this._onKeyup = e => {\r\n            this._isKeyDown = false;\r\n            this._lastKeyCode = -1;\r\n        };\r\n        const eventTargetDom = options.eventTargetDom;\r\n        this.registerEventListeners(eventTargetDom);\r\n    }\r\n    registerEventListeners(eventTargetDom = document) {\r\n        this._eventTargetDom = eventTargetDom;\r\n        if (eventTargetDom) {\r\n            eventTargetDom.addEventListener(\"keydown\", this._onKeydown);\r\n            eventTargetDom.addEventListener(\"keyup\", this._onKeyup);\r\n            if (\"ontouchend\" in document) {\r\n                document.addEventListener(\"touchstart\", this._mouseDownBind);\r\n                document.addEventListener(\"touchend\", this._mouseUpBind);\r\n                document.addEventListener(\"touchmove\", this._mouseMoveBind);\r\n            }\r\n            if (\"onmouseup\" in document) {\r\n                eventTargetDom.addEventListener(\"mousedown\", this._mouseDownBind);\r\n                eventTargetDom.addEventListener(\"mouseup\", this._mouseUpBind);\r\n                eventTargetDom.addEventListener(\"mouseleave\", this._mouseUpBind);\r\n                eventTargetDom.addEventListener(\"mousemove\", this._mouseMoveBind);\r\n            }\r\n            if (\"onwheel\" in document) {\r\n                eventTargetDom.addEventListener(\"wheel\", this._mouseWheelBind);\r\n            }\r\n        }\r\n    }\r\n    unregisterEventListeners() {\r\n        const eventTargetDom = this._eventTargetDom;\r\n        if (eventTargetDom) {\r\n            eventTargetDom.removeEventListener(\"keydown\", this._onKeydown);\r\n            eventTargetDom.removeEventListener(\"keyup\", this._onKeyup);\r\n            if (\"ontouchend\" in document) {\r\n                document.removeEventListener(\"touchstart\", this._mouseDownBind);\r\n                document.removeEventListener(\"touchend\", this._mouseUpBind);\r\n                document.removeEventListener(\"touchmove\", this._mouseMoveBind);\r\n            }\r\n            if (\"onmouseup\" in document) {\r\n                eventTargetDom.removeEventListener(\"mousedown\", this._mouseDownBind);\r\n                eventTargetDom.removeEventListener(\"mouseup\", this._mouseUpBind);\r\n                eventTargetDom.removeEventListener(\"mouseleave\", this._mouseUpBind);\r\n                eventTargetDom.removeEventListener(\"mousemove\", this._mouseMoveBind);\r\n            }\r\n            if (\"onwheel\" in document) {\r\n                eventTargetDom.removeEventListener(\"wheel\", this._mouseWheelBind);\r\n            }\r\n        }\r\n    }\r\n    _mouseWheel(e) {\r\n        if (this._currentDir === null) {\r\n            return;\r\n        }\r\n        const delta = -1 * Math.sign(e.deltaY) * this._mouseWheelSpeedScale * this._horizontalSpeed;\r\n        const horizontalDir = WalkThroughCameraController.__tmp_Vec3_0;\r\n        horizontalDir.setComponents(this._currentDir.x, 0, this._currentDir.z).normalize();\r\n        const deltaVec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].multiplyTo(horizontalDir, delta, WalkThroughCameraController.__tmp_Vec3_1);\r\n        this._currentPos.add(deltaVec);\r\n        this._currentCenter.add(deltaVec);\r\n    }\r\n    _mouseDown(evt) {\r\n        _misc_MiscUtil__WEBPACK_IMPORTED_MODULE_3__[\"MiscUtil\"].preventDefaultForDesktopOnly(evt);\r\n        evt.stopPropagation();\r\n        this._isMouseDown = true;\r\n        let rect = evt.target.getBoundingClientRect();\r\n        this._clickedMouseXOnCanvas = evt.clientX - rect.left;\r\n        this._clickedMouseYOnCanvas = evt.clientY - rect.top;\r\n        return false;\r\n    }\r\n    _mouseMove(evt) {\r\n        _misc_MiscUtil__WEBPACK_IMPORTED_MODULE_3__[\"MiscUtil\"].preventDefaultForDesktopOnly(evt);\r\n        if (!this._isMouseDown) {\r\n            return;\r\n        }\r\n        evt.stopPropagation();\r\n        let rect = evt.target.getBoundingClientRect();\r\n        this._draggedMouseXOnCanvas = evt.clientX - rect.left;\r\n        this._draggedMouseYOnCanvas = evt.clientY - rect.top;\r\n        this._deltaMouseXOnCanvas =\r\n            this._draggedMouseXOnCanvas - this._clickedMouseXOnCanvas;\r\n        this._deltaMouseYOnCanvas =\r\n            this._draggedMouseYOnCanvas - this._clickedMouseYOnCanvas;\r\n        this._isMouseDrag = true;\r\n    }\r\n    _mouseUp(evt) {\r\n        this._isMouseDown = false;\r\n        this._isMouseDrag = false;\r\n        const target = evt.target;\r\n        if ((target === null || target === void 0 ? void 0 : target.getBoundingClientRect) == null) {\r\n            return;\r\n        }\r\n        const rect = target.getBoundingClientRect();\r\n        this._clickedMouseXOnCanvas = evt.clientX - rect.left;\r\n        this._clickedMouseYOnCanvas = evt.clientY - rect.top;\r\n    }\r\n    tryReset() { }\r\n    reset() {\r\n        this._isKeyDown = false;\r\n        this._lastKeyCode = -1;\r\n        this._currentPos.zero();\r\n        this._currentCenter.setComponents(0, 0, -1);\r\n        this._currentDir.setComponents(0, 0, -1);\r\n        this._currentHorizontalDir.setComponents(0, 0, -1);\r\n        this._isMouseDown = false;\r\n        this._isMouseDrag = false;\r\n        this._draggedMouseXOnCanvas = -1;\r\n        this._draggedMouseYOnCanvas = -1;\r\n        this._deltaMouseXOnCanvas = -1;\r\n        this._deltaMouseYOnCanvas = -1;\r\n        this._mouseXAdjustScale = this._turnSpeed;\r\n        this._mouseYAdjustScale = this._turnSpeed;\r\n        this._deltaY = 0;\r\n        this._deltaX = 0;\r\n        this._newDir.setComponents(0, 0, -1);\r\n    }\r\n    logic(cameraComponent) {\r\n        const data = this.__convert(cameraComponent);\r\n        const cc = cameraComponent;\r\n        cc.eyeInner = data.newEyeVec;\r\n        cc.directionInner = data.newCenterVec;\r\n        cc.upInner = data.newUpVec;\r\n        cc.zNearInner = data.newZNear;\r\n        cc.zFarInner = data.newZFar;\r\n        cc.leftInner = data.newLeft;\r\n        cc.rightInner = data.newRight;\r\n        cc.topInner = data.newTop;\r\n        cc.bottomInner = data.newBottom;\r\n        cc.fovyInner = data.fovy;\r\n    }\r\n    __convert(camera) {\r\n        let newZNear = camera.zNearInner;\r\n        let newZFar = camera.zFarInner;\r\n        if (this._needInitialize && this._targetEntity) {\r\n            const targetAABB = this._targetEntity.getSceneGraph().worldAABB;\r\n            newZFar = camera.zNear + _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].lengthBtw(this._currentCenter, this._currentPos);\r\n            newZFar += targetAABB.lengthCenterToCorner * this._zFarAdjustingFactorBasedOnAABB;\r\n            let scale = newZFar / camera.zNear;\r\n            scale /= this.__scaleOfZNearAndZFar;\r\n            newZNear = camera.zNear * scale;\r\n            const lengthCenterToCamera = targetAABB.lengthCenterToCorner * (1.0 + 1.0 / Math.tan(_math_MathUtil__WEBPACK_IMPORTED_MODULE_5__[\"MathUtil\"].degreeToRadian(camera.fovy / 2.0)));\r\n            this._currentPos.copyComponents(targetAABB.centerPoint);\r\n            this._currentPos.z += lengthCenterToCamera;\r\n            this._currentCenter.copyComponents(targetAABB.centerPoint);\r\n            this._currentDir.setComponents(0, 0, -1);\r\n            if (camera.entity.getSceneGraph()) {\r\n                const sg = camera.entity.getSceneGraph();\r\n                const invMat = _math_Matrix44__WEBPACK_IMPORTED_MODULE_1__[\"default\"].invertTo(sg.worldMatrixInner, WalkThroughCameraController.__tmpInvMat);\r\n                invMat.multiplyVector3To(this._currentPos, this._currentPos);\r\n                invMat.multiplyVector3To(this._currentCenter, this._currentCenter);\r\n            }\r\n            this._needInitialize = false;\r\n        }\r\n        const t = this._deltaY / 90;\r\n        this._newDir.x = this._currentDir.x * (1 - t);\r\n        this._newDir.y = t;\r\n        this._newDir.z = this._currentDir.z * (1 - t);\r\n        this._newDir.normalize();\r\n        this._currentHorizontalDir.x = this._currentDir.x;\r\n        this._currentHorizontalDir.y = 0;\r\n        this._currentHorizontalDir.z = this._currentDir.z;\r\n        this._currentHorizontalDir.normalize();\r\n        const moveVector = WalkThroughCameraController.__tmp_Vec3_0.zero();\r\n        switch (this._lastKeyCode) {\r\n            case 87: // w key\r\n            case 38: // arrow upper key\r\n                moveVector.x = this._currentHorizontalDir.x * this._horizontalSpeed;\r\n                moveVector.z = this._currentHorizontalDir.z * this._horizontalSpeed;\r\n                break;\r\n            case 65: // a key\r\n            case 37: // arrow left key\r\n                moveVector.x = this._currentHorizontalDir.z * this._horizontalSpeed;\r\n                moveVector.z = -this._currentHorizontalDir.x * this._horizontalSpeed;\r\n                break;\r\n            case 83: // s key\r\n            case 40: // arrow down key\r\n                moveVector.x = -this._currentHorizontalDir.x * this._horizontalSpeed;\r\n                moveVector.z = -this._currentHorizontalDir.z * this._horizontalSpeed;\r\n                break;\r\n            case 68: // d key\r\n            case 39: // arrow right key\r\n                moveVector.x = -this._currentHorizontalDir.z * this._horizontalSpeed;\r\n                moveVector.z = this._currentHorizontalDir.x * this._horizontalSpeed;\r\n                break;\r\n            case 81: // q key\r\n                moveVector.x = -this._newDir.x * this._horizontalSpeed;\r\n                moveVector.y = -this._newDir.y * this._horizontalSpeed;\r\n                moveVector.z = -this._newDir.z * this._horizontalSpeed;\r\n                break;\r\n            case 69: // e key\r\n                moveVector.x = this._newDir.x * this._horizontalSpeed;\r\n                moveVector.y = this._newDir.y * this._horizontalSpeed;\r\n                moveVector.z = this._newDir.z * this._horizontalSpeed;\r\n                break;\r\n            case 82: // r key\r\n                moveVector.y = this._verticalSpeed;\r\n                break;\r\n            case 70: // f key\r\n                moveVector.y = -this._verticalSpeed;\r\n                break;\r\n        }\r\n        this._currentPos.add(moveVector);\r\n        this._currentCenter.add(moveVector);\r\n        if (this._isMouseDrag) {\r\n            if (this._inverseHorizontalRotating) {\r\n                this._deltaX = this._deltaMouseXOnCanvas * this._mouseXAdjustScale;\r\n            }\r\n            else {\r\n                this._deltaX = -this._deltaMouseXOnCanvas * this._mouseXAdjustScale;\r\n            }\r\n            if (this._inverseVerticalRotating) {\r\n                this._deltaY += this._deltaMouseYOnCanvas * this._mouseYAdjustScale;\r\n            }\r\n            else {\r\n                this._deltaY += -this._deltaMouseYOnCanvas * this._mouseYAdjustScale;\r\n            }\r\n            this._deltaY = Math.max(-120, Math.min(50, this._deltaY));\r\n            const rotateMatrix = WalkThroughCameraController.__tmpRotateMat.rotateY(_math_MathUtil__WEBPACK_IMPORTED_MODULE_5__[\"MathUtil\"].degreeToRadian(this._deltaX));\r\n            rotateMatrix.multiplyVectorTo(this._currentDir, this._currentDir);\r\n            const newEyeToCenter = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].subtractTo(this._currentCenter, this._currentPos, WalkThroughCameraController.__tmp_Vec3_1);\r\n            rotateMatrix.multiplyVectorTo(newEyeToCenter, newEyeToCenter);\r\n            newEyeToCenter.x = newEyeToCenter.x * (1 - t);\r\n            newEyeToCenter.y = t;\r\n            newEyeToCenter.z = newEyeToCenter.z * (1 - t);\r\n            newEyeToCenter.normalize();\r\n            this._currentCenter.copyComponents(this._currentPos);\r\n            this._currentCenter.add(newEyeToCenter);\r\n            this._clickedMouseXOnCanvas = this._draggedMouseXOnCanvas;\r\n            this._clickedMouseYOnCanvas = this._draggedMouseYOnCanvas;\r\n            this._deltaMouseXOnCanvas = 0;\r\n            this._deltaMouseYOnCanvas = 0;\r\n        }\r\n        const newLeft = camera.left;\r\n        const newRight = camera.right;\r\n        const newTop = camera.top;\r\n        const newBottom = camera.bottom;\r\n        return {\r\n            newEyeVec: this._currentPos,\r\n            newCenterVec: this._currentCenter,\r\n            newUpVec: camera.up.clone(),\r\n            newZNear: newZNear,\r\n            newZFar: newZFar,\r\n            newLeft,\r\n            newRight,\r\n            newTop,\r\n            newBottom,\r\n            fovy: camera.fovy\r\n        };\r\n    }\r\n    getDirection() {\r\n        return this._currentCenter !== null ? this._newDir.clone() : null;\r\n    }\r\n    set horizontalSpeed(value) {\r\n        this._horizontalSpeed = value;\r\n    }\r\n    get horizontalSpeed() {\r\n        return this._horizontalSpeed;\r\n    }\r\n    set verticalSpeed(value) {\r\n        this._verticalSpeed = value;\r\n    }\r\n    get verticalSpeed() {\r\n        return this._verticalSpeed;\r\n    }\r\n    set mouseWheelSpeed(value) {\r\n        this._mouseWheelSpeedScale = value;\r\n    }\r\n    get mouseWheelSpeed() {\r\n        return this._mouseWheelSpeedScale;\r\n    }\r\n    setTarget(targetEntity) {\r\n        const speed = targetEntity.getSceneGraph().worldAABB.lengthCenterToCorner / 10;\r\n        this.verticalSpeed = speed;\r\n        this.horizontalSpeed = speed;\r\n        this._targetEntity = targetEntity;\r\n        this._needInitialize = true;\r\n    }\r\n    getTarget() {\r\n        return this._targetEntity;\r\n    }\r\n    set zFarAdjustingFactorBasedOnAABB(value) {\r\n        this._zFarAdjustingFactorBasedOnAABB = value;\r\n    }\r\n    get zFarAdjustingFactorBasedOnAABB() {\r\n        return this._zFarAdjustingFactorBasedOnAABB;\r\n    }\r\n    set scaleOfZNearAndZFar(value) {\r\n        this.__scaleOfZNearAndZFar = value;\r\n    }\r\n    get scaleOfZNearAndZFar() {\r\n        return this.__scaleOfZNearAndZFar;\r\n    }\r\n    get allInfo() {\r\n        const info = {};\r\n        info.verticalSpeed = this.verticalSpeed;\r\n        info.horizontalSpeed = this.horizontalSpeed;\r\n        info._turnSpeed = this._turnSpeed;\r\n        if (this._currentPos) {\r\n            info._currentPos = this._currentPos.clone();\r\n        }\r\n        if (this._currentCenter) {\r\n            info._currentCenter = this._currentCenter.clone();\r\n        }\r\n        if (this._currentDir) {\r\n            info._currentDir = this._currentDir.clone();\r\n        }\r\n        info._deltaY = this._deltaY;\r\n        info._newDir = this._newDir.clone();\r\n        return info;\r\n    }\r\n    set allInfo(arg) {\r\n        let json = arg;\r\n        if (typeof arg === \"string\") {\r\n            json = JSON.parse(arg);\r\n        }\r\n        for (let key in json) {\r\n            if (json.hasOwnProperty(key) && key in this) {\r\n                if (key === \"quaternion\") {\r\n                    this[key] = _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_2__[\"default\"].cloneOfMathObjects(_math_MathClassUtil__WEBPACK_IMPORTED_MODULE_2__[\"default\"].arrayToQuaternion(json[key]));\r\n                }\r\n                else {\r\n                    this[key] = _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_2__[\"default\"].cloneOfMathObjects(_math_MathClassUtil__WEBPACK_IMPORTED_MODULE_2__[\"default\"].arrayToVectorOrMatrix(json[key]));\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nWalkThroughCameraController.__tmpInvMat = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"].identity();\r\nWalkThroughCameraController.__tmpRotateMat = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_6__[\"default\"].identity();\r\nWalkThroughCameraController.__tmp_Vec3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].zero();\r\nWalkThroughCameraController.__tmp_Vec3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].zero();\r\n\n\n//# sourceURL=webpack:///./src/foundation/cameras/WalkThroughCameraController.ts?");

/***/ }),

/***/ "./src/foundation/components/AnimationComponent.ts":
/*!*********************************************************!*\
  !*** ./src/foundation/components/AnimationComponent.ts ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AnimationComponent; });\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/AnimationInterpolation */ \"./src/foundation/definitions/AnimationInterpolation.ts\");\n/* harmony import */ var _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/AnimationAttribute */ \"./src/foundation/definitions/AnimationAttribute.ts\");\n/* harmony import */ var _TransformComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/MutableQuaternion */ \"./src/foundation/math/MutableQuaternion.ts\");\n/* harmony import */ var _MeshComponent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass AnimationComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.__animationLine = new Map();\r\n        this.__backupDefaultValues = new Map();\r\n        this.__isAnimating = true;\r\n        this.__currentProcessStage = _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__[\"ProcessStage\"].Create;\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].AnimationComponentTID;\r\n    }\r\n    setAnimation(attributeName, animationInputArray, animationOutputArray, interpolation) {\r\n        const line = {\r\n            input: animationInputArray,\r\n            output: animationOutputArray,\r\n            outputAttributeName: attributeName,\r\n            interpolationMethod: interpolation\r\n        };\r\n        this.__animationLine.set(_definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].fromString(attributeName).index, line);\r\n        this.__transformComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _TransformComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n        this.__meshComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _MeshComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\r\n        this.backupDefaultValues(_definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].fromString(attributeName).index);\r\n        AnimationComponent.__startInputValueDirty = true;\r\n        AnimationComponent.__endInputValueDirty = true;\r\n    }\r\n    static lerp(start, end, ratio, animationAttributeIndex) {\r\n        if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n            return _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].qlerpTo(start, end, ratio, AnimationComponent.__returnQuaternion);\r\n        }\r\n        else if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n            const returnArray = Array(start.length);\r\n            for (let i = 0; i < start.length; i++) {\r\n                returnArray[i] = start[i] * (1 - ratio) + end[i] * ratio;\r\n            }\r\n            return returnArray;\r\n        }\r\n        else {\r\n            const l_vec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(start, (1 - ratio), this.__tmpVector3_0);\r\n            const r_vec = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(end, ratio, this.__tmpVector3_1);\r\n            return this.__returnVector3.copyComponents(l_vec).add(r_vec);\r\n        }\r\n    }\r\n    /**\r\n     * Compute cubic spline interpolation.\r\n     * @param p_0 starting point\r\n     * @param p_1 ending point\r\n     * @param m_0 inTangent\r\n     * @param m_1 outTangent\r\n     * @param t ratio\r\n     * @param animationAttributeIndex index of attribution\r\n     */\r\n    static cubicSpline(p_0, p_1, m_0, m_1, t, animationAttributeIndex) {\r\n        const ratio2 = t * t;\r\n        const ratio3 = ratio2 * t;\r\n        // coefficients\r\n        const c_0 = 2 * ratio3 - 3 * ratio2 + 1;\r\n        const c_1 = ratio3 - 2 * ratio2 + t;\r\n        const c_2 = -2 * ratio3 + 3 * ratio2;\r\n        const c_3 = ratio3 - ratio2;\r\n        if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n            const cp_0 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyNumberTo(p_0, c_0, this.__tmpQuaternion_0);\r\n            const cm_0 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyNumberTo(m_0, c_1, this.__tmpQuaternion_1);\r\n            const cp_1 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyNumberTo(p_1, c_2, this.__tmpQuaternion_2);\r\n            const cm_1 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyNumberTo(m_1, c_3, this.__tmpQuaternion_3);\r\n            return this.__returnQuaternion.copyComponents(cp_0).add(cm_0).add(cp_1).add(cm_1);\r\n        }\r\n        else if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n            return [c_0 * p_0 + c_1 * m_0 + c_2 * p_1 + c_3 * m_1];\r\n        }\r\n        else {\r\n            const cp_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(p_0, c_0, this.__tmpVector3_0);\r\n            const cm_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(m_0, c_1, this.__tmpVector3_1);\r\n            const cp_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(p_1, c_2, this.__tmpVector3_2);\r\n            const cm_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(m_1, c_3, this.__tmpVector3_3);\r\n            return this.__returnVector3.copyComponents(cp_0).add(cm_0).add(cp_1).add(cm_1);\r\n        }\r\n    }\r\n    static __isClamped(idx, inputArray) {\r\n        if (idx < 0) {\r\n            return true;\r\n        }\r\n        if (idx >= inputArray.length) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    static binarySearch(inputArray, currentTime) {\r\n        let low = 0;\r\n        let high = inputArray.length - 1;\r\n        let mid = 0;\r\n        let retVal = 0;\r\n        while (low <= high) {\r\n            mid = low + ((high - low) >> 1);\r\n            if (inputArray[mid] < currentTime) {\r\n                low = mid + 1;\r\n                retVal = mid;\r\n            }\r\n            else if (currentTime < inputArray[mid]) {\r\n                high = mid - 1;\r\n                retVal = high;\r\n            }\r\n            else { // if (inputArray[mid] === input) {\r\n                return mid;\r\n            }\r\n        }\r\n        return retVal;\r\n    }\r\n    static interpolationSearch(inputArray, currentTime) {\r\n        let mid = 0;\r\n        let lower = 0;\r\n        let upper = inputArray.length - 1;\r\n        let retVal = 0;\r\n        while (lower <= upper && currentTime >= inputArray[lower] && currentTime <= inputArray[upper]) {\r\n            mid = Math.floor(lower + (currentTime - inputArray[lower]) * ((upper - lower)) / (inputArray[upper] - inputArray[lower]));\r\n            if (inputArray[mid] < currentTime) {\r\n                lower = mid + 1;\r\n                retVal = mid;\r\n            }\r\n            else if (currentTime < inputArray[mid]) {\r\n                upper = mid - 1;\r\n                retVal = upper;\r\n            }\r\n            else { // if (inputArray[mid] === input) {\r\n                return mid;\r\n            }\r\n        }\r\n        return retVal;\r\n    }\r\n    static bruteForceSearch(inputArray, currentTime) {\r\n        for (let i = 0; i < inputArray.length; i++) {\r\n            if (inputArray[i] <= currentTime && currentTime < inputArray[i + 1]) {\r\n                return i;\r\n            }\r\n        }\r\n        return inputArray.length - 1;\r\n    }\r\n    static interpolate(line, currentTime, animationAttributeIndex) {\r\n        var _a;\r\n        const inputArray = line.input;\r\n        const outputArray = line.output;\r\n        const method = (_a = line.interpolationMethod) !== null && _a !== void 0 ? _a : _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].Linear;\r\n        // out of range\r\n        if (currentTime <= inputArray[0]) {\r\n            return outputArray[0];\r\n        }\r\n        else if (inputArray[inputArray.length - 1] <= currentTime) {\r\n            return outputArray[inputArray.length - 1];\r\n        }\r\n        if (method === _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].CubicSpline) {\r\n            // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#appendix-c-spline-interpolation\r\n            const k = this.interpolationSearch(inputArray, currentTime);\r\n            const t_diff = (inputArray[k + 1] - inputArray[k]); // t_(k+1) - t_k\r\n            const t = (currentTime - inputArray[k]) / t_diff;\r\n            const [p_0, p_1, m_0, m_1] = this.__prepareVariablesForCubicSpline(outputArray, k, t_diff, animationAttributeIndex);\r\n            return this.cubicSpline(p_0, p_1, m_0, m_1, t, animationAttributeIndex);\r\n        }\r\n        else if (method === _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].Linear) {\r\n            const i = this.interpolationSearch(inputArray, currentTime);\r\n            const ratio = (currentTime - inputArray[i]) / (inputArray[i + 1] - inputArray[i]);\r\n            return this.lerp(outputArray[i], outputArray[i + 1], ratio, animationAttributeIndex);\r\n        }\r\n        else if (method === _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].Step) {\r\n            for (let i = 0; i < inputArray.length - 1; i++) {\r\n                if (inputArray[i] <= currentTime && currentTime < inputArray[i + 1]) {\r\n                    return outputArray[i];\r\n                }\r\n            }\r\n            return outputArray[inputArray.length - 1];\r\n        }\r\n        // non supported type\r\n        return outputArray[0];\r\n    }\r\n    static __prepareVariablesForCubicSpline(outputArray, k, t_diff, animationAttributeIndex) {\r\n        let p_0, p_1, m_0, m_1;\r\n        if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n            p_0 = outputArray[3 * k + 1]; //v_k\r\n            p_1 = outputArray[3 * k + 4]; //v_(k+1)\r\n            // the num of__tmpQuaternion is specified by this.cubicSpline\r\n            const b_k = this.__tmpQuaternion_2.copyComponents(outputArray[3 * k + 2]);\r\n            m_0 = b_k.multiplyNumber(t_diff);\r\n            const a_k_plus_one = this.__tmpQuaternion_3.copyComponents(outputArray[3 * k + 3]); // a_(k+1)\r\n            m_1 = a_k_plus_one.multiplyNumber(t_diff);\r\n        }\r\n        else if (animationAttributeIndex === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n            p_0 = outputArray[k][1]; //v_k\r\n            p_1 = outputArray[k + 1][1]; //v_(k+1)\r\n            const b_k = outputArray[k][2];\r\n            m_0 = t_diff * b_k;\r\n            const a_k_plus_one = outputArray[k + 1][0];\r\n            m_1 = t_diff * a_k_plus_one;\r\n        }\r\n        else {\r\n            p_0 = outputArray[3 * k + 1];\r\n            p_1 = outputArray[3 * k + 4];\r\n            const b_k = this.__tmpVector3_2.copyComponents(outputArray[3 * k + 2]);\r\n            m_0 = b_k.multiply(t_diff);\r\n            const a_k_plus_one = this.__tmpVector3_3.copyComponents(outputArray[3 * k + 3]);\r\n            m_1 = a_k_plus_one.multiply(t_diff);\r\n        }\r\n        return [p_0, p_1, m_0, m_1];\r\n    }\r\n    getStartInputValueOfAnimation() {\r\n        let latestInputValue = Number.MAX_VALUE;\r\n        for (let line of this.__animationLine.values()) {\r\n            let inputValueArray = line.input;\r\n            let inputLatestValueAtThisAttribute = inputValueArray[0];\r\n            if (inputLatestValueAtThisAttribute < latestInputValue) {\r\n                latestInputValue = inputLatestValueAtThisAttribute;\r\n                if (latestInputValue < AnimationComponent.__startInputValueOfAllComponent) {\r\n                    AnimationComponent.__startInputValueOfAllComponent = latestInputValue;\r\n                }\r\n            }\r\n        }\r\n        return latestInputValue;\r\n    }\r\n    getEndInputValueOfAnimation() {\r\n        let latestInputValue = -Number.MAX_VALUE;\r\n        for (let line of this.__animationLine.values()) {\r\n            let inputValueArray = line.input;\r\n            let inputLatestValueAtThisAttribute = inputValueArray[inputValueArray.length - 1];\r\n            if (inputLatestValueAtThisAttribute > latestInputValue) {\r\n                latestInputValue = inputLatestValueAtThisAttribute;\r\n                if (latestInputValue > AnimationComponent.__endInputValueOfAllComponent) {\r\n                    AnimationComponent.__endInputValueOfAllComponent = latestInputValue;\r\n                }\r\n            }\r\n        }\r\n        return latestInputValue;\r\n    }\r\n    static get startInputValue() {\r\n        if (this.__startInputValueDirty) {\r\n            const components = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance().getComponentsWithType(AnimationComponent);\r\n            components.forEach(component => {\r\n                component.getStartInputValueOfAnimation();\r\n            });\r\n            this.__startInputValueDirty = false;\r\n        }\r\n        return AnimationComponent.__startInputValueOfAllComponent;\r\n    }\r\n    static get endInputValue() {\r\n        if (this.__endInputValueDirty) {\r\n            const components = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance().getComponentsWithType(AnimationComponent);\r\n            components.forEach(component => {\r\n                component.getEndInputValueOfAnimation();\r\n            });\r\n            this.__endInputValueDirty = false;\r\n        }\r\n        return AnimationComponent.__endInputValueOfAllComponent;\r\n    }\r\n    static get isAnimating() {\r\n        return this.__isAnimating;\r\n    }\r\n    static set isAnimating(flg) {\r\n        const animationComponents = this.__componentRepository._getComponents(AnimationComponent);\r\n        for (let animationComponent of animationComponents) {\r\n            animationComponent.isAnimating = flg;\r\n        }\r\n    }\r\n    get isAnimating() {\r\n        return this.__isAnimating;\r\n    }\r\n    set isAnimating(flg) {\r\n        if (flg) {\r\n            for (var [i, line] of this.__animationLine) {\r\n                this.backupDefaultValues(i);\r\n            }\r\n        }\r\n        else {\r\n            for (var [i, line] of this.__animationLine) {\r\n                this.restoreDefaultValues(i);\r\n            }\r\n        }\r\n        this.__isAnimating = flg;\r\n    }\r\n    restoreDefaultValues(i) {\r\n        if (this.__backupDefaultValues.get(i) == null) {\r\n            if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n                this.__transformComponent.quaternion = this.__backupDefaultValues.get(i);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Translate.index) {\r\n                this.__transformComponent.translate = this.__backupDefaultValues.get(i);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Scale.index) {\r\n                this.__transformComponent.scale = this.__backupDefaultValues.get(i);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n                this.__meshComponent.weights = this.__backupDefaultValues.get(i);\r\n            }\r\n        }\r\n    }\r\n    backupDefaultValues(i) {\r\n        if (this.__backupDefaultValues.get(i) == null) {\r\n            if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n                this.__backupDefaultValues.set(i, this.__transformComponent.quaternion);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Translate.index) {\r\n                this.__backupDefaultValues.set(i, this.__transformComponent.translate);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Scale.index) {\r\n                this.__backupDefaultValues.set(i, this.__transformComponent.scale);\r\n            }\r\n            else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n                this.__backupDefaultValues.set(i, this.__meshComponent.weights);\r\n            }\r\n        }\r\n    }\r\n    $create() {\r\n        this.__transformComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _TransformComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n        this.__meshComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _MeshComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic() {\r\n        if (AnimationComponent.isAnimating) {\r\n            for (var [i, line] of this.__animationLine) {\r\n                let value = AnimationComponent.interpolate(line, AnimationComponent.globalTime, i);\r\n                if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Quaternion.index) {\r\n                    this.__transformComponent.quaternion = value;\r\n                }\r\n                else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Translate.index) {\r\n                    this.__transformComponent.translate = value;\r\n                }\r\n                else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Scale.index) {\r\n                    this.__transformComponent.scale = value;\r\n                }\r\n                else if (i === _definitions_AnimationAttribute__WEBPACK_IMPORTED_MODULE_4__[\"AnimationAttribute\"].Weights.index) {\r\n                    this.__meshComponent.weights = value;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nAnimationComponent.globalTime = 0;\r\nAnimationComponent.__isAnimating = true;\r\nAnimationComponent.__startInputValueOfAllComponent = Number.MAX_VALUE;\r\nAnimationComponent.__endInputValueOfAllComponent = -Number.MAX_VALUE;\r\nAnimationComponent.__startInputValueDirty = false;\r\nAnimationComponent.__endInputValueDirty = false;\r\nAnimationComponent.__componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\nAnimationComponent.__returnVector3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAnimationComponent.__tmpVector3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAnimationComponent.__tmpVector3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAnimationComponent.__tmpVector3_2 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAnimationComponent.__tmpVector3_3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAnimationComponent.__returnQuaternion = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nAnimationComponent.__tmpQuaternion_0 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nAnimationComponent.__tmpQuaternion_1 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nAnimationComponent.__tmpQuaternion_2 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nAnimationComponent.__tmpQuaternion_3 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].registerComponentClass(AnimationComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/AnimationComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/BlendShapeComponent.ts":
/*!**********************************************************!*\
  !*** ./src/foundation/components/BlendShapeComponent.ts ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BlendShapeComponent; });\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n\r\n\r\n\r\n\r\nclass BlendShapeComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityComponent) {\r\n        super(entityUid, componentSid, entityComponent);\r\n        this.__weights = [];\r\n        this.__targetNames = [];\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Logic);\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].BlendShapeComponentTID;\r\n    }\r\n    set weights(weights) {\r\n        this.__weights = weights;\r\n    }\r\n    get weights() {\r\n        return this.__weights;\r\n    }\r\n    set targetNames(names) {\r\n        this.__targetNames = names;\r\n    }\r\n    get targetNames() {\r\n        return this.__targetNames;\r\n    }\r\n    $logic() {\r\n    }\r\n}\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].registerComponentClass(BlendShapeComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/BlendShapeComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/CameraComponent.ts":
/*!******************************************************!*\
  !*** ./src/foundation/components/CameraComponent.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CameraComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_CameraType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/CameraType */ \"./src/foundation/definitions/CameraType.ts\");\n/* harmony import */ var _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _geometry_Frustum__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../geometry/Frustum */ \"./src/foundation/geometry/Frustum.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _CameraControllerComponent__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./CameraControllerComponent */ \"./src/foundation/components/CameraControllerComponent.ts\");\n/* harmony import */ var _system_ModuleManager__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CameraComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this._eyeInner = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this._direction = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this._directionInner = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this._up = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this._upInner = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this._filmWidth = 36; // mili meter\r\n        this._filmHeight = 24; // mili meter\r\n        this._focalLength = 20;\r\n        // x: left, y:right, z:top, w: bottom\r\n        this._corner = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].dummy();\r\n        this._cornerInner = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].dummy();\r\n        // x: zNear, y: zFar,\r\n        // if perspective, z: fovy, w: aspect\r\n        // if ortho, z: xmag, w: ymag\r\n        this._parameters = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].dummy();\r\n        this._parametersInner = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].dummy();\r\n        this.__type = _definitions_CameraType__WEBPACK_IMPORTED_MODULE_4__[\"CameraType\"].Perspective;\r\n        this._projectionMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].dummy();\r\n        this.__isProjectionMatrixUpToDate = false;\r\n        this._viewMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].dummy();\r\n        this.__isViewMatrixUpToDate = false;\r\n        this.__frustum = new _geometry_Frustum__WEBPACK_IMPORTED_MODULE_12__[\"default\"]();\r\n        this.maxNumberOfComponent = Math.max(10, Math.floor(_core_Config__WEBPACK_IMPORTED_MODULE_13__[\"default\"].maxEntityNumber / 100));\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'eyeInner', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0, 0, 0]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'direction', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0, 0, -1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'up', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0, 1, 0]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'directionInner', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0, 0, -1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'upInner', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0, 1, 0]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'corner', _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [-1, 1, 1, -1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'cornerInner', _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [-1, 1, 1, -1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'parameters', _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0.1, 10000, 90, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'parametersInner', _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [0.1, 10000, 90, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'projectionMatrix', _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_6__[\"BufferUse\"].CPUGeneric, 'viewMatrix', _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_7__[\"ComponentType\"].Float, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\r\n        this.submitToAllocation(_core_Config__WEBPACK_IMPORTED_MODULE_13__[\"default\"].maxCameraNumber);\r\n        const globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_14__[\"default\"].getInstance();\r\n        globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ViewMatrix);\r\n        globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ProjectionMatrix);\r\n        globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ViewPosition);\r\n        this.setFovyAndChangeFocalLength(90);\r\n        if (CameraComponent.main === -1) {\r\n            CameraComponent.main = componentSid;\r\n        }\r\n    }\r\n    static set main(componentSID) {\r\n        this.__main = componentSID;\r\n    }\r\n    static get main() {\r\n        return this.__main;\r\n    }\r\n    set type(type) {\r\n        this.__type = type;\r\n        if (type === _definitions_CameraType__WEBPACK_IMPORTED_MODULE_4__[\"CameraType\"].Orthographic) {\r\n            this._parameters.z = 1;\r\n            this._parameters.w = 1;\r\n            this._parametersInner.z = 1;\r\n            this._parametersInner.w = 1;\r\n        }\r\n        else {\r\n            this.setFovyAndChangeFocalLength(90);\r\n            this._parameters.w = 1;\r\n            this._parametersInner.z = 90;\r\n            this._parametersInner.w = 1;\r\n        }\r\n    }\r\n    get type() {\r\n        return this.__type;\r\n    }\r\n    get eye() {\r\n        return CameraComponent._eye;\r\n    }\r\n    get eyeInner() {\r\n        return this._eyeInner;\r\n    }\r\n    set eyeInner(vec) {\r\n        this._eyeInner.copyComponents(vec);\r\n    }\r\n    set upInner(vec) {\r\n        this._upInner.copyComponents(vec);\r\n    }\r\n    set up(vec) {\r\n        this._up.copyComponents(vec);\r\n    }\r\n    get up() {\r\n        return this._up.clone();\r\n    }\r\n    get upInner() {\r\n        return this._upInner;\r\n    }\r\n    set direction(vec) {\r\n        const oldDirection = this._direction;\r\n        const newDirection = vec;\r\n        const oldUp = this._up;\r\n        const orthogonalVectorNewDirectionAndOldUp = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].crossTo(newDirection, oldUp, CameraComponent.__tmpVector3_0);\r\n        const isOrthogonalNewDirectionAndOldUp = orthogonalVectorNewDirectionAndOldUp.length() === 0.0;\r\n        let newUpNonNormalize;\r\n        if (isOrthogonalNewDirectionAndOldUp) {\r\n            const relativeXaxis = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].crossTo(oldDirection, oldUp, CameraComponent.__tmpVector3_1);\r\n            newUpNonNormalize = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].crossTo(relativeXaxis, newDirection, CameraComponent.__tmpVector3_2);\r\n        }\r\n        else {\r\n            const newDirectionComponentInOldUp = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].multiplyTo(newDirection, newDirection.dot(oldUp), CameraComponent.__tmpVector3_1);\r\n            newUpNonNormalize = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].subtractTo(oldUp, newDirectionComponentInOldUp, CameraComponent.__tmpVector3_2);\r\n        }\r\n        this._up.copyComponents(newUpNonNormalize).normalize();\r\n        this._direction.copyComponents(newDirection);\r\n    }\r\n    set directionInner(vec) {\r\n        this._directionInner.copyComponents(vec);\r\n    }\r\n    get direction() {\r\n        return this._direction.clone();\r\n    }\r\n    get directionInner() {\r\n        return this._directionInner;\r\n    }\r\n    set corner(vec) {\r\n        this._corner.copyComponents(vec);\r\n    }\r\n    get corner() {\r\n        return this._corner.clone();\r\n    }\r\n    set left(value) {\r\n        this._corner.x = value;\r\n    }\r\n    set leftInner(value) {\r\n        this._cornerInner.x = value;\r\n    }\r\n    get left() {\r\n        return this._corner.x;\r\n    }\r\n    set right(value) {\r\n        this._corner.y = value;\r\n    }\r\n    set rightInner(value) {\r\n        this._cornerInner.y = value;\r\n    }\r\n    get right() {\r\n        return this._corner.y;\r\n    }\r\n    set top(value) {\r\n        this._corner.z = value;\r\n    }\r\n    set topInner(value) {\r\n        this._cornerInner.z = value;\r\n    }\r\n    get top() {\r\n        return this._corner.z;\r\n    }\r\n    set bottom(value) {\r\n        this._corner.w = value;\r\n    }\r\n    set bottomInner(value) {\r\n        this._cornerInner.w = value;\r\n    }\r\n    get bottom() {\r\n        return this._corner.w;\r\n    }\r\n    set cornerInner(vec) {\r\n        this._corner.copyComponents(vec);\r\n    }\r\n    get cornerInner() {\r\n        return this._corner;\r\n    }\r\n    // set parameters(vec: Vector4) {\r\n    //   this._parameters.copyComponents(vec);\r\n    // }\r\n    set parametersInner(vec) {\r\n        this._parametersInner.copyComponents(vec);\r\n    }\r\n    get parametersInner() {\r\n        return this._parametersInner;\r\n    }\r\n    get parameters() {\r\n        return this._parameters.clone();\r\n    }\r\n    set zNear(val) {\r\n        this._parameters.x = val;\r\n    }\r\n    set zNearInner(val) {\r\n        this._parametersInner.x = val;\r\n    }\r\n    get zNearInner() {\r\n        return this._parametersInner.x;\r\n    }\r\n    get zNear() {\r\n        return this._parameters.x;\r\n    }\r\n    set focalLength(val) {\r\n        this._focalLength = val;\r\n        this._parameters.z = 2 * _math_MathUtil__WEBPACK_IMPORTED_MODULE_16__[\"MathUtil\"].radianToDegree(Math.atan(this._filmHeight / (val * 2)));\r\n    }\r\n    get focalLength() {\r\n        return this._focalLength;\r\n    }\r\n    set zFar(val) {\r\n        this._parameters.y = val;\r\n    }\r\n    set zFarInner(val) {\r\n        this._parametersInner.y = val;\r\n    }\r\n    get zFarInner() {\r\n        return this._parametersInner.y;\r\n    }\r\n    get zFar() {\r\n        return this._parameters.y;\r\n    }\r\n    setFovyAndChangeFilmSize(degree) {\r\n        this._parameters.z = degree;\r\n        this._filmHeight = 2 * this.focalLength * Math.tan(_math_MathUtil__WEBPACK_IMPORTED_MODULE_16__[\"MathUtil\"].degreeToRadian(degree) / 2);\r\n        this._filmWidth = this._filmHeight * this.aspect;\r\n    }\r\n    setFovyAndChangeFocalLength(degree) {\r\n        this._parameters.z = degree;\r\n        this._focalLength = this._filmHeight / 2 / Math.tan(_math_MathUtil__WEBPACK_IMPORTED_MODULE_16__[\"MathUtil\"].degreeToRadian(degree) / 2);\r\n    }\r\n    get fovy() {\r\n        return this._parameters.z;\r\n    }\r\n    set fovyInner(val) {\r\n        this._parametersInner.z = val;\r\n    }\r\n    set aspect(val) {\r\n        this._parameters.w = val;\r\n        this._filmWidth = this._filmHeight * val;\r\n    }\r\n    get aspect() {\r\n        return this._parameters.w;\r\n    }\r\n    set xMag(val) {\r\n        this._parameters.z = val;\r\n    }\r\n    get xMag() {\r\n        return this._parameters.z;\r\n    }\r\n    set yMag(val) {\r\n        this._parameters.w = val;\r\n    }\r\n    get yMag() {\r\n        return this._parameters.w;\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].CameraComponentTID;\r\n    }\r\n    calcProjectionMatrix() {\r\n        const zNear = this._parametersInner.x;\r\n        const zFar = this._parametersInner.y;\r\n        if (this.type === _definitions_CameraType__WEBPACK_IMPORTED_MODULE_4__[\"CameraType\"].Perspective) {\r\n            const fovy = this._parametersInner.z;\r\n            const aspect = this._parametersInner.w;\r\n            var yscale = 1.0 / Math.tan((0.5 * fovy * Math.PI) / 180);\r\n            var xscale = yscale / aspect;\r\n            this._projectionMatrix.setComponents(xscale, 0, 0, 0, 0, yscale, 0, 0, 0, 0, -(zFar + zNear) / (zFar - zNear), -(2.0 * zFar * zNear) / (zFar - zNear), 0, 0, -1, 0);\r\n        }\r\n        else if (this.type === _definitions_CameraType__WEBPACK_IMPORTED_MODULE_4__[\"CameraType\"].Orthographic) {\r\n            const xmag = this._parametersInner.z;\r\n            const ymag = this._parametersInner.w;\r\n            this._projectionMatrix.setComponents(1 / xmag, 0.0, 0.0, 0, 0.0, 1 / ymag, 0.0, 0, 0.0, 0.0, -2 / (zFar - zNear), -(zFar + zNear) / (zFar - zNear), 0.0, 0.0, 0.0, 1.0);\r\n        }\r\n        else {\r\n            const left = this._cornerInner.x;\r\n            const right = this._cornerInner.y;\r\n            const top = this._cornerInner.z;\r\n            const bottom = this._cornerInner.w;\r\n            this._projectionMatrix.setComponents(2 * zNear / (right - left), 0.0, (right + left) / (right - left), 0.0, 0.0, 2 * zNear / (top - bottom), (top + bottom) / (top - bottom), 0.0, 0.0, 0.0, -(zFar + zNear) / (zFar - zNear), -1 * 2 * zFar * zNear / (zFar - zNear), 0.0, 0.0, -1.0, 0.0);\r\n        }\r\n        return this._projectionMatrix;\r\n    }\r\n    get projectionMatrix() {\r\n        return this._projectionMatrix;\r\n    }\r\n    calcViewMatrix() {\r\n        const eye = this.eyeInner;\r\n        const f = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].subtractTo(this._directionInner, eye, CameraComponent.__tmpVector3_0).normalize();\r\n        const s = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].crossTo(f, this._upInner, CameraComponent.__tmpVector3_1).normalize();\r\n        const u = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].crossTo(s, f, CameraComponent.__tmpVector3_2);\r\n        this._viewMatrix.setComponents(s.x, s.y, s.z, -_math_Vector3__WEBPACK_IMPORTED_MODULE_3__[\"default\"].dot(s, eye), u.x, u.y, u.z, -_math_Vector3__WEBPACK_IMPORTED_MODULE_3__[\"default\"].dot(u, eye), -f.x, -f.y, -f.z, _math_Vector3__WEBPACK_IMPORTED_MODULE_3__[\"default\"].dot(f, eye), 0, 0, 0, 1);\r\n        const invertWorldMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].invertTo(this.__sceneGraphComponent.worldMatrixInner, CameraComponent.__tmpMatrix44_0);\r\n        this._viewMatrix.multiply(invertWorldMatrix);\r\n        return this._viewMatrix;\r\n    }\r\n    get viewMatrix() {\r\n        return this._viewMatrix;\r\n    }\r\n    set viewMatrix(viewMatrix) {\r\n        this._viewMatrix.copyComponents(viewMatrix);\r\n    }\r\n    set projectionMatrix(projectionMatrix) {\r\n        this._projectionMatrix.copyComponents(projectionMatrix);\r\n    }\r\n    get viewProjectionMatrix() {\r\n        return _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyTo(this._projectionMatrix, this._viewMatrix, CameraComponent.__tmpMatrix44_0);\r\n    }\r\n    setValuesToGlobalDataRepository() {\r\n        CameraComponent.__globalDataRepository.setValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ViewMatrix, this.componentSID, this.viewMatrix);\r\n        CameraComponent.__globalDataRepository.setValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ProjectionMatrix, this.componentSID, this.projectionMatrix);\r\n        CameraComponent.__globalDataRepository.setValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_15__[\"ShaderSemantics\"].ViewPosition, this.componentSID, this.worldPosition);\r\n    }\r\n    get worldPosition() {\r\n        this.__sceneGraphComponent.worldMatrixInner.multiplyVector3To(this.eyeInner, CameraComponent.returnVector3);\r\n        return CameraComponent.returnVector3;\r\n    }\r\n    updateFrustum() {\r\n        this.__frustum.update(this.viewMatrix, this.projectionMatrix);\r\n    }\r\n    get frustum() {\r\n        return this.__frustum;\r\n    }\r\n    $create() {\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_9__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic({ renderPass }) {\r\n        const cameraControllerComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _CameraControllerComponent__WEBPACK_IMPORTED_MODULE_17__[\"default\"]);\r\n        if (cameraControllerComponent == null) {\r\n            this._eyeInner.copyComponents(CameraComponent._eye);\r\n            this._directionInner.copyComponents(this._direction);\r\n            this._upInner.copyComponents(this._up);\r\n            this._cornerInner.copyComponents(this._corner);\r\n            this._parametersInner.copyComponents(this._parameters);\r\n        }\r\n        else {\r\n            this._parametersInner.w = this._parameters.w;\r\n        }\r\n        this.calcViewMatrix();\r\n        this.calcProjectionMatrix();\r\n        const rnXRModule = _system_ModuleManager__WEBPACK_IMPORTED_MODULE_18__[\"default\"].getInstance().getModule('xr');\r\n        if ((rnXRModule === null || rnXRModule === void 0 ? void 0 : rnXRModule.WebVRSystem.getInstance().isWebVRMode) && renderPass.isMainPass) {\r\n            const webvrSystem = rnXRModule.WebVRSystem.getInstance();\r\n            webvrSystem.setValuesToGlobalDataRepository();\r\n        }\r\n        else {\r\n            this.setValuesToGlobalDataRepository();\r\n        }\r\n    }\r\n}\r\nCameraComponent._eye = _math_Vector3__WEBPACK_IMPORTED_MODULE_3__[\"default\"].zero();\r\nCameraComponent.__main = -1;\r\nCameraComponent.returnVector3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero();\r\nCameraComponent.__globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_14__[\"default\"].getInstance();\r\nCameraComponent.__tmpVector3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero();\r\nCameraComponent.__tmpVector3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero();\r\nCameraComponent.__tmpVector3_2 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero();\r\nCameraComponent.__tmpMatrix44_0 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].zero();\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(CameraComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/CameraComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/CameraControllerComponent.ts":
/*!****************************************************************!*\
  !*** ./src/foundation/components/CameraControllerComponent.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CameraControllerComponent; });\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _CameraComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../cameras/OrbitCameraController */ \"./src/foundation/cameras/OrbitCameraController.ts\");\n/* harmony import */ var _cameras_WalkThroughCameraController__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../cameras/WalkThroughCameraController */ \"./src/foundation/cameras/WalkThroughCameraController.ts\");\n/* harmony import */ var _definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../definitions/CameraControllerType */ \"./src/foundation/definitions/CameraControllerType.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CameraControllerComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.__cameraController = new _cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_5__[\"default\"]();\r\n    }\r\n    set type(type) {\r\n        this.__cameraController.unregisterEventListeners();\r\n        if (type === _definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_7__[\"CameraControllerType\"].Orbit) {\r\n            this.__cameraController = new _cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_5__[\"default\"]();\r\n        }\r\n        else if (type === _definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_7__[\"CameraControllerType\"].WalkThrough) {\r\n            this.__cameraController = new _cameras_WalkThroughCameraController__WEBPACK_IMPORTED_MODULE_6__[\"default\"]();\r\n        }\r\n        else {\r\n            console.warn('Not support type!');\r\n        }\r\n    }\r\n    get type() {\r\n        if (this.__cameraController instanceof _cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\r\n            return _definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_7__[\"CameraControllerType\"].Orbit;\r\n        }\r\n        else {\r\n            return _definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_7__[\"CameraControllerType\"].WalkThrough;\r\n        }\r\n    }\r\n    get controller() {\r\n        return this.__cameraController;\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].CameraControllerComponentTID;\r\n    }\r\n    $create() {\r\n        this.__cameraComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _CameraComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic() {\r\n        if (this.__cameraController) {\r\n            this.__cameraController.logic(this.__cameraComponent);\r\n        }\r\n    }\r\n}\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_3__[\"default\"].registerComponentClass(CameraControllerComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/CameraControllerComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/LightComponent.ts":
/*!*****************************************************!*\
  !*** ./src/foundation/components/LightComponent.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return LightComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_LightType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/LightType */ \"./src/foundation/definitions/LightType.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_VectorN__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/VectorN */ \"./src/foundation/math/VectorN.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass LightComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.type = _definitions_LightType__WEBPACK_IMPORTED_MODULE_3__[\"LightType\"].Point;\r\n        this.__intensity = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 1, 1);\r\n        this.__initialdirection = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 1, 0);\r\n        this.__direction = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 1, 0);\r\n        this.spotExponent = 1.0;\r\n        this.spotCutoff = 30; // in degree\r\n        this.range = -1;\r\n        this.maxNumberOfComponent = Math.max(10, Math.floor(_core_Config__WEBPACK_IMPORTED_MODULE_7__[\"default\"].maxEntityNumber / 100));\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].LightComponentTID;\r\n    }\r\n    get direction() {\r\n        return this.__direction;\r\n    }\r\n    set intensity(value) {\r\n        this.__intensity = value;\r\n    }\r\n    get intensity() {\r\n        return this.__intensity;\r\n    }\r\n    $create() {\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__[\"ProcessStage\"].Load);\r\n    }\r\n    $load() {\r\n        const lightComponents = LightComponent.__componentRepository.getComponentsWithType(LightComponent);\r\n        const currentComponentSIDs = LightComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].CurrentComponentSIDs, 0);\r\n        currentComponentSIDs.v[_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].LightComponentTID] = lightComponents.length;\r\n        LightComponent.__lightPositions = LightComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].LightPosition, 0);\r\n        LightComponent.__lightDirections = LightComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].LightDirection, 0);\r\n        LightComponent.__lightIntensities = LightComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].LightIntensity, 0);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic() {\r\n        this.__direction = this.__sceneGraphComponent.normalMatrixInner.multiplyVector(this.__initialdirection);\r\n        LightComponent.__lightDirections.v[4 * this.componentSID + 0] = this.__direction.x;\r\n        LightComponent.__lightDirections.v[4 * this.componentSID + 1] = this.__direction.y;\r\n        LightComponent.__lightDirections.v[4 * this.componentSID + 2] = this.__direction.z;\r\n        LightComponent.__lightDirections.v[4 * this.componentSID + 3] = 0;\r\n        const lightPosition = this.__sceneGraphComponent.worldPosition;\r\n        LightComponent.__lightPositions.v[4 * this.componentSID + 0] = lightPosition.x;\r\n        LightComponent.__lightPositions.v[4 * this.componentSID + 1] = lightPosition.y;\r\n        LightComponent.__lightPositions.v[4 * this.componentSID + 2] = lightPosition.z;\r\n        LightComponent.__lightPositions.v[4 * this.componentSID + 3] = this.type.index;\r\n        LightComponent.__lightIntensities.v[4 * this.componentSID + 0] = this.__intensity.x;\r\n        LightComponent.__lightIntensities.v[4 * this.componentSID + 1] = this.__intensity.y;\r\n        LightComponent.__lightIntensities.v[4 * this.componentSID + 2] = this.__intensity.z;\r\n        LightComponent.__lightIntensities.v[4 * this.componentSID + 3] = 0;\r\n    }\r\n}\r\nLightComponent.__componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\nLightComponent.__globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getInstance();\r\nLightComponent.__tmp_vec4 = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].zero();\r\nLightComponent.__lightPositions = new _math_VectorN__WEBPACK_IMPORTED_MODULE_11__[\"default\"](new Float32Array(0));\r\nLightComponent.__lightDirections = new _math_VectorN__WEBPACK_IMPORTED_MODULE_11__[\"default\"](new Float32Array(0));\r\nLightComponent.__lightIntensities = new _math_VectorN__WEBPACK_IMPORTED_MODULE_11__[\"default\"](new Float32Array(0));\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(LightComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/LightComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/MeshComponent.ts":
/*!****************************************************!*\
  !*** ./src/foundation/components/MeshComponent.ts ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MeshComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _core_Entity__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../core/Entity */ \"./src/foundation/core/Entity.ts\");\n/* harmony import */ var _BlendShapeComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/MathClassUtil */ \"./src/foundation/math/MathClassUtil.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MeshComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.__viewDepth = -Number.MAX_VALUE;\r\n        this.isPickable = true;\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Create);\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].MeshComponentTID;\r\n    }\r\n    setMesh(mesh) {\r\n        this.__mesh = mesh;\r\n        mesh._attachedEntityUID = this.entityUID;\r\n    }\r\n    unsetMesh() {\r\n        if (this.__mesh == null) {\r\n            return false;\r\n        }\r\n        this.__mesh._attachedEntityUID = _core_Entity__WEBPACK_IMPORTED_MODULE_6__[\"default\"].invalidEntityUID;\r\n        this.__mesh = void 0;\r\n        return true;\r\n    }\r\n    get mesh() {\r\n        return this.__mesh;\r\n    }\r\n    set weights(value) {\r\n        if (this.__mesh == null) {\r\n            return;\r\n        }\r\n        //    this.__mesh!.makeVerticesSeparated();\r\n        this.__mesh.weights = value;\r\n    }\r\n    calcViewDepth(cameraComponent) {\r\n        let centerPosition_inLocal = this.__mesh.AABB.centerPoint;\r\n        const skeletal = this.entity.getSkeletal();\r\n        if (skeletal === null || skeletal === void 0 ? void 0 : skeletal._bindShapeMatrix) {\r\n            skeletal._bindShapeMatrix.multiplyVector3To(this.__mesh.AABB.centerPoint, centerPosition_inLocal);\r\n        }\r\n        const worldMatrixInner = this.entity.getSceneGraph().worldMatrixInner;\r\n        const centerPosition_inWorld = worldMatrixInner.multiplyVector3To(centerPosition_inLocal, MeshComponent.__tmpVector3_0);\r\n        const viewMatrix = cameraComponent.viewMatrix;\r\n        const centerPosition_inView = viewMatrix.multiplyVector3To(centerPosition_inWorld, MeshComponent.__tmpVector3_1);\r\n        this.__viewDepth = centerPosition_inView.z;\r\n        return this.__viewDepth;\r\n    }\r\n    get viewDepth() {\r\n        return this.__viewDepth;\r\n    }\r\n    static alertNoMeshSet(meshComponent) {\r\n        console.debug('No mesh is set on this MeshComponent:' + meshComponent.componentSID);\r\n    }\r\n    castRay(srcPointInWorld, directionInWorld, dotThreshold = 0) {\r\n        if (this.__mesh) {\r\n            let srcPointInLocal = srcPointInWorld;\r\n            let directionInLocal = directionInWorld;\r\n            if (this.__sceneGraphComponent) {\r\n                const invWorldMatrix = _math_Matrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"].invert(this.__sceneGraphComponent.worldMatrixInner);\r\n                srcPointInLocal = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](invWorldMatrix.multiplyVector(new _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](srcPointInWorld)));\r\n                const distVecInWorld = _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].add(srcPointInWorld, directionInWorld);\r\n                const distVecInLocal = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](invWorldMatrix.multiplyVector(new _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](distVecInWorld)));\r\n                directionInLocal = _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].normalize(_math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].subtract(distVecInLocal, srcPointInLocal));\r\n                const { t, intersectedPosition } = this.__mesh.castRay(srcPointInLocal, directionInLocal, dotThreshold);\r\n                let intersectPositionInWorld = null;\r\n                if (t >= 0) {\r\n                    intersectPositionInWorld = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this.__sceneGraphComponent.worldMatrixInner.multiplyVector(new _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](intersectedPosition)));\r\n                }\r\n                return { t, intersectedPositionInWorld: intersectPositionInWorld };\r\n            }\r\n        }\r\n        return { t: -1, intersectedPositionInWorld: undefined };\r\n    }\r\n    castRayFromScreen(x, y, camera, viewport, dotThreshold = 0) {\r\n        if (this.__mesh) {\r\n            if (this.__sceneGraphComponent) {\r\n                const invPVW = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_10__[\"default\"].multiplyTo(camera.projectionMatrix, camera.viewMatrix, MeshComponent.__tmpMatrix44_0).multiply(this.__sceneGraphComponent.worldMatrixInner).invert();\r\n                const srcPointInLocal = _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_11__[\"default\"].unProjectTo(x, y, 0, invPVW, viewport, MeshComponent.__tmpVector3_0);\r\n                const distVecInLocal = _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_11__[\"default\"].unProjectTo(x, y, 1, invPVW, viewport, MeshComponent.__tmpVector3_1);\r\n                const directionInLocal = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].subtractTo(distVecInLocal, srcPointInLocal, MeshComponent.__tmpVector3_2).normalize();\r\n                const { t, intersectedPosition } = this.__mesh.castRay(srcPointInLocal, directionInLocal, dotThreshold);\r\n                let intersectedPositionInWorld = null;\r\n                if (intersectedPosition != null && t >= 0) {\r\n                    intersectedPositionInWorld = this.__sceneGraphComponent.worldMatrixInner.multiplyVector3To(intersectedPosition, MeshComponent.__returnVector3);\r\n                }\r\n                return { t, intersectedPositionInWorld };\r\n            }\r\n        }\r\n        return { t: -1, intersectedPositionInWorld: undefined };\r\n    }\r\n    $create() {\r\n        this.__blendShapeComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _BlendShapeComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"]);\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Load);\r\n    }\r\n    $load() {\r\n        if (this.__mesh == null) {\r\n            return;\r\n        }\r\n        //    this.__mesh!.makeVerticesSeparated();\r\n        this.__mesh.__calcTangents();\r\n        this.__mesh._calcArenbergInverseMatrices();\r\n        // this.__mesh.__initMorphPrimitives();\r\n        this.__mesh.__calcFaceNormalsIfNonNormal();\r\n        if (this.__blendShapeComponent && this.__blendShapeComponent.weights.length > 0) {\r\n            this.__mesh.__calcBaryCentricCoord();\r\n        }\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic() {\r\n        if (this.__mesh == null) {\r\n            return;\r\n        }\r\n        // this.__mesh.__calcMorphPrimitives();\r\n    }\r\n}\r\nMeshComponent.__tmpVector3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nMeshComponent.__tmpVector3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nMeshComponent.__tmpVector3_2 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nMeshComponent.__returnVector3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nMeshComponent.__tmpMatrix44_0 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_10__[\"default\"].zero();\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(MeshComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/MeshComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/MeshRendererComponent.ts":
/*!************************************************************!*\
  !*** ./src/foundation/components/MeshRendererComponent.ts ***!
  \************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MeshRendererComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _MeshComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _CameraComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _system_ModuleManager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n/* harmony import */ var _definitions_visibility__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../definitions/visibility */ \"./src/foundation/definitions/visibility.ts\");\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _materials_core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../materials/core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MeshRendererComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.diffuseCubeMapContribution = 1.0;\r\n        this.specularCubeMapContribution = 1.0;\r\n        this.rotationOfCubeMap = 0;\r\n        this._readyForRendering = false;\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\r\n        const componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        const cameraComponents = componentRepository.getComponentsWithType(_CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\r\n        if (cameraComponents) {\r\n            MeshRendererComponent.__cameraComponent = cameraComponents[0];\r\n        }\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__[\"WellKnownComponentTIDs\"].MeshRendererComponentTID;\r\n    }\r\n    static get firstTransparentIndex() {\r\n        return MeshRendererComponent.__firstTransparentIndex;\r\n    }\r\n    static get lastTransparentIndex() {\r\n        return MeshRendererComponent.__lastTransparentIndex;\r\n    }\r\n    static __isReady() {\r\n        if (MeshRendererComponent.__instanceIDBufferUid !== _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].InvalidCGAPIResourceUid) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    static __setupInstanceIDBuffer() {\r\n        if (MeshRendererComponent.__instanceIdAccessor == null) {\r\n            const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_11__[\"BufferUse\"].CPUGeneric);\r\n            const count = _core_Config__WEBPACK_IMPORTED_MODULE_10__[\"default\"].maxEntityNumber;\r\n            const bufferView = buffer.takeBufferView({ byteLengthToNeed: 4 /*byte*/ * count, byteStride: 0, isAoS: false });\r\n            MeshRendererComponent.__instanceIdAccessor = bufferView.takeAccessor({ compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_12__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_13__[\"ComponentType\"].Float, count: count });\r\n        }\r\n        const meshComponents = MeshRendererComponent.__componentRepository.getComponentsWithType(_MeshComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\r\n        if (meshComponents == null) {\r\n            return _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].InvalidCGAPIResourceUid;\r\n        }\r\n        for (var i = 0; i < meshComponents.length; i++) {\r\n            MeshRendererComponent.__instanceIdAccessor.setScalar(i, meshComponents[i].entityUID, {});\r\n        }\r\n        return MeshRendererComponent.__webglResourceRepository.createVertexBuffer(MeshRendererComponent.__instanceIdAccessor);\r\n    }\r\n    static set manualTransparentSids(sids) {\r\n        MeshRendererComponent.__manualTransparentSids = sids;\r\n    }\r\n    static set manualTransparentEntityNames(names) {\r\n        MeshRendererComponent.__manualTransparentSids = [];\r\n        for (let name of names) {\r\n            const entity = _core_RnObject__WEBPACK_IMPORTED_MODULE_16__[\"default\"].getRnObjectByName(name);\r\n            if (entity) {\r\n                const meshComponent = entity.getMesh();\r\n                if (meshComponent) {\r\n                    const mesh = meshComponent.mesh;\r\n                    if (mesh) {\r\n                        if (!mesh.isOpaque()) {\r\n                            MeshRendererComponent.__manualTransparentSids.push(meshComponent.componentSID);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    $create() {\r\n        this.__meshComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _MeshComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Load);\r\n    }\r\n    static common_$load({ processApproach }) {\r\n        const moduleManager = _system_ModuleManager__WEBPACK_IMPORTED_MODULE_14__[\"default\"].getInstance();\r\n        const moduleName = 'webgl';\r\n        const webglModule = moduleManager.getModule(moduleName);\r\n        // Strategy\r\n        MeshRendererComponent.__webglRenderingStrategy = webglModule.getRenderingStrategy(processApproach);\r\n        // ResourceRepository\r\n        MeshRendererComponent.__webglResourceRepository = webglModule.WebGLResourceRepository.getInstance();\r\n        _materials_core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_17__[\"default\"].initDefaultTextures();\r\n    }\r\n    $load() {\r\n        MeshRendererComponent.__webglRenderingStrategy.$load(this.__meshComponent);\r\n        if (this.diffuseCubeMap && !this.diffuseCubeMap.startedToLoad) {\r\n            this.diffuseCubeMap.loadTextureImagesAsync();\r\n        }\r\n        if (this.specularCubeMap && !this.specularCubeMap.startedToLoad) {\r\n            this.specularCubeMap.loadTextureImagesAsync();\r\n        }\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].PreRender);\r\n    }\r\n    static common_$prerender() {\r\n        const gl = MeshRendererComponent.__webglResourceRepository.currentWebGLContextWrapper;\r\n        if (gl == null) {\r\n            throw new Error('No WebGLRenderingContext!');\r\n        }\r\n        MeshRendererComponent.__webglRenderingStrategy.common_$prerender();\r\n        if (MeshRendererComponent.__isReady()) {\r\n            return 0;\r\n        }\r\n        MeshRendererComponent.__instanceIDBufferUid = MeshRendererComponent.__setupInstanceIDBuffer();\r\n        return MeshRendererComponent.__instanceIDBufferUid;\r\n    }\r\n    $prerender() {\r\n        MeshRendererComponent.__webglRenderingStrategy.$prerender(this.__meshComponent, this, MeshRendererComponent.__instanceIDBufferUid);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Render);\r\n    }\r\n    static sort_$render(renderPass) {\r\n        if (MeshRendererComponent.__manualTransparentSids == null) {\r\n            const sortedMeshComponentSids = MeshRendererComponent.sort_$render_inner(void 0, renderPass);\r\n            // const sortedMeshComponentSids = MeshRendererComponent.sort_$render_inner();\r\n            return sortedMeshComponentSids;\r\n        }\r\n        else {\r\n            const sortedMeshComponentSids = MeshRendererComponent.sort_$render_inner(MeshRendererComponent.__manualTransparentSids, renderPass);\r\n            // const sortedMeshComponentSids = MeshRendererComponent.sort_$render_inner(MeshRendererComponent.__manualTransparentSids);\r\n            return sortedMeshComponentSids;\r\n        }\r\n    }\r\n    static sort_$render_inner(transparentMeshComponentSids_ = [], renderPass) {\r\n        const sceneGraphComponents = renderPass.sceneTopLevelGraphComponents;\r\n        let meshComponents = [];\r\n        const componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        let cameraComponent = renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = componentRepository.getComponent(_CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"], _CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].main);\r\n        }\r\n        if (cameraComponent && MeshRendererComponent.isViewFrustumCullingEnabled) {\r\n            cameraComponent.updateFrustum();\r\n            const whetherContainsSkeletal = (sg) => {\r\n                const skeletalComponent = sg.entity.getSkeletal();\r\n                if (skeletalComponent != null) {\r\n                    return true;\r\n                }\r\n                else {\r\n                    const children = sg.children;\r\n                    for (let child of children) {\r\n                        return whetherContainsSkeletal(child);\r\n                    }\r\n                    return false;\r\n                }\r\n            };\r\n            const frustum = cameraComponent.frustum;\r\n            const doAsVisible = (sg, meshComponents) => {\r\n                const sgs = _SceneGraphComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"].flattenHierarchy(sg, false);\r\n                for (let sg of sgs) {\r\n                    const mesh = sg.entity.getMesh();\r\n                    if (mesh) {\r\n                        meshComponents.push(mesh);\r\n                    }\r\n                }\r\n            };\r\n            const frustumCullingRecursively = (sg, meshComponents) => {\r\n                const result = frustum.culling(sg);\r\n                if (result === _definitions_visibility__WEBPACK_IMPORTED_MODULE_15__[\"Visibility\"].Visible) {\r\n                    doAsVisible(sg, meshComponents);\r\n                }\r\n                else if (result === _definitions_visibility__WEBPACK_IMPORTED_MODULE_15__[\"Visibility\"].Neutral ||\r\n                    whetherContainsSkeletal(sg)) {\r\n                    const children = sg.children;\r\n                    const mesh = sg.entity.getMesh();\r\n                    if (mesh) {\r\n                        meshComponents.push(mesh);\r\n                    }\r\n                    for (let child of children) {\r\n                        frustumCullingRecursively(child, meshComponents);\r\n                    }\r\n                }\r\n            };\r\n            for (let tlsg of sceneGraphComponents) {\r\n                frustumCullingRecursively(tlsg, meshComponents);\r\n            }\r\n        }\r\n        else {\r\n            meshComponents = renderPass.meshComponents;\r\n        }\r\n        meshComponents = Array.from(new Set(meshComponents));\r\n        const opaqueAndTransparentPartiallyMeshComponentSids = [];\r\n        const transparentPartiallyMeshComponents = [];\r\n        const transparentCompletelyMeshComponents = [];\r\n        for (let i = 0; i < meshComponents.length; i++) {\r\n            if (!meshComponents[i].entity.getSceneGraph().isVisible) {\r\n                continue;\r\n            }\r\n            const meshRendererComponent = meshComponents[i].entity.getMeshRenderer();\r\n            if (meshRendererComponent.currentProcessStage === _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Render) {\r\n                const meshComponent = meshComponents[i];\r\n                if (meshComponent.mesh) {\r\n                    if (transparentMeshComponentSids_.length === 0 && meshComponent.mesh.isBlendPartially()) {\r\n                        transparentPartiallyMeshComponents.push(meshComponent);\r\n                        opaqueAndTransparentPartiallyMeshComponentSids.push(meshComponent.componentSID);\r\n                    }\r\n                    else if (transparentMeshComponentSids_.length === 0 && meshComponent.mesh.isAllBlend()) {\r\n                        transparentCompletelyMeshComponents.push(meshComponent);\r\n                    }\r\n                    if (meshComponent.mesh.isOpaque()) {\r\n                        opaqueAndTransparentPartiallyMeshComponentSids.push(meshComponent.componentSID);\r\n                    }\r\n                    else {\r\n                        if (cameraComponent) {\r\n                            meshComponent.calcViewDepth(cameraComponent);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    _MeshComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"].alertNoMeshSet(meshComponent);\r\n                }\r\n            }\r\n        }\r\n        // Sort transparent meshes\r\n        const transparentPartiallyOrAllMeshComponents = transparentPartiallyMeshComponents.concat(transparentCompletelyMeshComponents);\r\n        transparentPartiallyOrAllMeshComponents.sort(function (a, b) {\r\n            return a.viewDepth - b.viewDepth;\r\n        });\r\n        let transparentMeshComponentSids;\r\n        if (transparentMeshComponentSids_.length === 0) {\r\n            transparentMeshComponentSids = transparentPartiallyOrAllMeshComponents.map((meshComponent) => {\r\n                return meshComponent.componentSID;\r\n            });\r\n        }\r\n        else {\r\n            transparentMeshComponentSids = transparentMeshComponentSids_;\r\n        }\r\n        MeshRendererComponent.__firstTransparentIndex = opaqueAndTransparentPartiallyMeshComponentSids.length;\r\n        // Concat opaque and transparent meshes\r\n        const sortedMeshComponentSids = opaqueAndTransparentPartiallyMeshComponentSids.concat(transparentMeshComponentSids);\r\n        MeshRendererComponent.__lastTransparentIndex = sortedMeshComponentSids.length - 1;\r\n        // Add terminator\r\n        sortedMeshComponentSids.push(_core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"].invalidComponentSID);\r\n        return sortedMeshComponentSids;\r\n    }\r\n    static common_$render({ renderPass, processStage, renderPassTickCount }) {\r\n        MeshRendererComponent.__cameraComponent = renderPass.cameraComponent;\r\n        if (MeshRendererComponent.__cameraComponent == null) {\r\n            MeshRendererComponent.__cameraComponent = MeshRendererComponent.__componentRepository.getComponent(_CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"], _CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].main);\r\n        }\r\n        let viewMatrix = MeshRendererComponent.__tmp_identityMatrix;\r\n        let projectionMatrix = MeshRendererComponent.__tmp_identityMatrix;\r\n        if (MeshRendererComponent.__cameraComponent) {\r\n            viewMatrix = MeshRendererComponent.__cameraComponent.viewMatrix;\r\n            projectionMatrix = MeshRendererComponent.__cameraComponent.projectionMatrix;\r\n        }\r\n        const meshComponentSids = _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__componentsOfProcessStages.get(processStage);\r\n        const meshComponents = MeshRendererComponent.__componentRepository._getComponents(_MeshComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\r\n        MeshRendererComponent.__webglRenderingStrategy.common_$render(meshComponentSids, meshComponents, viewMatrix, projectionMatrix, renderPass, renderPassTickCount);\r\n    }\r\n    $render({ i, renderPass, renderPassTickCount }) {\r\n        if (MeshRendererComponent.__webglRenderingStrategy.$render == null) {\r\n            return;\r\n        }\r\n        const entity = this.__entityRepository.getEntity(this.__entityUid);\r\n        MeshRendererComponent.__webglRenderingStrategy.$render(i, this.__meshComponent, this.__sceneGraphComponent.worldMatrixInner, this.__sceneGraphComponent.normalMatrixInner, entity, renderPass, renderPassTickCount, this.diffuseCubeMap, this.specularCubeMap);\r\n        if (this.__meshComponent.mesh) {\r\n            if (this.__meshComponent.mesh.weights.length > 0) {\r\n                this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].PreRender);\r\n            }\r\n        }\r\n        else {\r\n            _MeshComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"].alertNoMeshSet(this.__meshComponent);\r\n        }\r\n    }\r\n}\r\nMeshRendererComponent.__shaderProgramHandleOfPrimitiveObjectUids = new Map();\r\nMeshRendererComponent.__componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\nMeshRendererComponent.__instanceIDBufferUid = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].InvalidCGAPIResourceUid;\r\nMeshRendererComponent.__tmp_identityMatrix = _math_Matrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"].identity();\r\nMeshRendererComponent.__firstTransparentIndex = -1;\r\nMeshRendererComponent.__lastTransparentIndex = -1;\r\nMeshRendererComponent.isViewFrustumCullingEnabled = true;\r\nMeshRendererComponent.isDepthMaskTrueForTransparencies = false;\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(MeshRendererComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/MeshRendererComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/PhysicsComponent.ts":
/*!*******************************************************!*\
  !*** ./src/foundation/components/PhysicsComponent.ts ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return PhysicsComponent; });\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../physics/VRMSpringBonePhysicsStrategy */ \"./src/foundation/physics/VRMSpringBonePhysicsStrategy.ts\");\n\r\n\r\n\r\n\r\n\r\nclass PhysicsComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityComponent) {\r\n        super(entityUid, componentSid, entityComponent);\r\n        this.__strategy = new _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Logic);\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].PhysicsComponentTID;\r\n    }\r\n    get strategy() {\r\n        return this.__strategy;\r\n    }\r\n    static common_$logic() {\r\n        _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_4__[\"default\"].update();\r\n    }\r\n    $logic() {\r\n    }\r\n}\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].registerComponentClass(PhysicsComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/PhysicsComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/SceneGraphComponent.ts":
/*!**********************************************************!*\
  !*** ./src/foundation/components/SceneGraphComponent.ts ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SceneGraphComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_AABB__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../math/AABB */ \"./src/foundation/math/AABB.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _AnimationComponent__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./AnimationComponent */ \"./src/foundation/components/AnimationComponent.ts\");\n/* harmony import */ var _gizmos_AABBGizmo__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../gizmos/AABBGizmo */ \"./src/foundation/gizmos/AABBGizmo.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass SceneGraphComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this.__children = [];\r\n        this._worldMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"].dummy();\r\n        this._normalMatrix = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"].dummy();\r\n        this.__isWorldMatrixUpToDate = false;\r\n        this.__isNormalMatrixUpToDate = false;\r\n        this.__tmpMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"].identity();\r\n        this.__worldAABB = new _math_AABB__WEBPACK_IMPORTED_MODULE_10__[\"default\"]();\r\n        this.__isWorldAABBDirty = true;\r\n        this.isVisible = true;\r\n        this.__AABBGizmo = new _gizmos_AABBGizmo__WEBPACK_IMPORTED_MODULE_13__[\"default\"](this);\r\n        // Skeletal\r\n        this.isRootJoint = false;\r\n        this.jointIndex = -1;\r\n        const thisClass = SceneGraphComponent;\r\n        SceneGraphComponent.__sceneGraphs.push(this);\r\n        this.isAbleToBeParent = false;\r\n        this.beAbleToBeParent(true);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__[\"BufferUse\"].GPUInstanceData, 'worldMatrix', _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__[\"BufferUse\"].GPUInstanceData, 'normalMatrix', _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, [1, 0, 0, 0, 1, 0, 0, 0, 1]);\r\n        this.submitToAllocation(this.maxNumberOfComponent);\r\n    }\r\n    set isGizmoVisible(flg) {\r\n        if (flg) {\r\n            this.__AABBGizmo.setup();\r\n        }\r\n        this.__AABBGizmo.isVisible = flg;\r\n    }\r\n    get isGizmoVisible() {\r\n        return this.__AABBGizmo.isVisible;\r\n    }\r\n    static getTopLevelComponents() {\r\n        return SceneGraphComponent.__sceneGraphs.filter((sg) => {\r\n            return sg.isTopLevel;\r\n        });\r\n    }\r\n    isJoint() {\r\n        if (this.jointIndex >= 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].SceneGraphComponentTID;\r\n    }\r\n    beAbleToBeParent(flag) {\r\n        this.isAbleToBeParent = flag;\r\n    }\r\n    setWorldMatrixDirty() {\r\n        var _a;\r\n        this.setWorldMatrixDirtyRecursively();\r\n        (_a = this.parent) === null || _a === void 0 ? void 0 : _a.setWorldAABBDirtyParentRecursively();\r\n    }\r\n    setWorldMatrixDirtyRecursively() {\r\n        this.__isWorldMatrixUpToDate = false;\r\n        this.__isNormalMatrixUpToDate = false;\r\n        this.__isWorldAABBDirty = true;\r\n        this.children.forEach((child) => {\r\n            child.setWorldMatrixDirtyRecursively();\r\n        });\r\n    }\r\n    setWorldAABBDirtyParentRecursively() {\r\n        var _a;\r\n        this.__isWorldAABBDirty = true;\r\n        (_a = this.parent) === null || _a === void 0 ? void 0 : _a.setWorldAABBDirtyParentRecursively();\r\n    }\r\n    addChild(sg) {\r\n        if (this.__children != null) {\r\n            sg.__parent = this;\r\n            this.__children.push(sg);\r\n        }\r\n        else {\r\n            console.error('This is not allowed to have children.');\r\n        }\r\n    }\r\n    get isTopLevel() {\r\n        return this.__parent == null;\r\n    }\r\n    get children() {\r\n        return this.__children;\r\n    }\r\n    get parent() {\r\n        return this.__parent;\r\n    }\r\n    get worldMatrixInner() {\r\n        if (!this.__isWorldMatrixUpToDate) {\r\n            this._worldMatrix.copyComponents(this.calcWorldMatrixRecursively(false)); //this.isJoint()));\r\n            this.__isWorldMatrixUpToDate = true;\r\n        }\r\n        return this._worldMatrix;\r\n    }\r\n    get worldMatrix() {\r\n        return this.worldMatrixInner.clone();\r\n    }\r\n    get normalMatrixInner() {\r\n        if (!this.__isNormalMatrixUpToDate) {\r\n            _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].invertTo(this.worldMatrixInner, SceneGraphComponent.invertedMatrix44);\r\n            this._normalMatrix.copyComponents(SceneGraphComponent.invertedMatrix44.transpose());\r\n            this.__isNormalMatrixUpToDate = true;\r\n        }\r\n        return this._normalMatrix;\r\n    }\r\n    get normalMatrix() {\r\n        return this.normalMatrixInner.clone();\r\n    }\r\n    isWorldMatrixUpToDateRecursively() {\r\n        if (this.__isWorldMatrixUpToDate) {\r\n            if (this.__parent) {\r\n                let result = this.__parent.isWorldMatrixUpToDateRecursively();\r\n                return result;\r\n            }\r\n            else {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    calcWorldMatrixRecursively(isJointMode) {\r\n        if (this.__isWorldMatrixUpToDate) {\r\n            return this._worldMatrix;\r\n        }\r\n        const entity = this.__entityRepository.getEntity(this.__entityUid);\r\n        const transform = entity.getTransform();\r\n        if (this.__parent == null || (isJointMode && this.__parent != null && !this.__parent.isJoint())) {\r\n            return transform.matrixInner;\r\n        }\r\n        const matrixFromAncestorToParent = this.__parent.calcWorldMatrixRecursively(isJointMode);\r\n        return _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"].multiplyTo(matrixFromAncestorToParent, transform.matrixInner, this.__tmpMatrix);\r\n    }\r\n    /**\r\n     * Collects children and itself from specified sceneGraphComponent.\r\n     * @param sceneGraphComponent collects children and itself from the sceneGraphComponent\r\n     * @param isJointMode collects joints only\r\n     */\r\n    static flattenHierarchy(sceneGraphComponent, isJointMode) {\r\n        const results = [];\r\n        if (!isJointMode || sceneGraphComponent.isJoint()) {\r\n            results.push(sceneGraphComponent);\r\n        }\r\n        if (sceneGraphComponent.isAbleToBeParent) {\r\n            const children = sceneGraphComponent.children;\r\n            for (let i = 0; i < children.length; i++) {\r\n                const hitChildren = this.flattenHierarchy(children[i], isJointMode);\r\n                Array.prototype.push.apply(results, hitChildren);\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    get worldPosition() {\r\n        const zeroVector = SceneGraphComponent.__originVector3;\r\n        this.worldMatrixInner.multiplyVector3To(zeroVector, SceneGraphComponent.returnVector3);\r\n        return SceneGraphComponent.returnVector3;\r\n    }\r\n    getWorldPositionOf(localPosition) {\r\n        return this.worldMatrixInner.multiplyVector3(localPosition);\r\n    }\r\n    getLocalPositionOf(worldPosition) {\r\n        return _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].invert(this.worldMatrixInner).multiplyVector3(worldPosition);\r\n    }\r\n    calcWorldAABB() {\r\n        const that = this;\r\n        // this.__worldAABB.initialize();\r\n        var aabb = (function mergeAABBRecursively(elem, flg) {\r\n            const meshComponent = elem.entity.getMesh();\r\n            elem.__worldAABB.initialize();\r\n            if (meshComponent != null && meshComponent.mesh != null) {\r\n                const skeletalComponent = elem.entity.getSkeletal();\r\n                if (false) {}\r\n                else {\r\n                    _math_AABB__WEBPACK_IMPORTED_MODULE_10__[\"default\"].multiplyMatrixTo(elem.worldMatrixInner, meshComponent.mesh.AABB, elem.__worldAABB);\r\n                }\r\n            }\r\n            var children = elem.children;\r\n            for (let i = 0; i < children.length; i++) {\r\n                var aabb = mergeAABBRecursively(children[i], true);\r\n                if (flg && elem.__animationComponent == null) {\r\n                    elem.__worldAABB.mergeAABB(aabb);\r\n                }\r\n                else {\r\n                    elem.__worldAABB.mergeAABB(aabb);\r\n                }\r\n            }\r\n            return elem.__worldAABB;\r\n        })(this, false);\r\n        this.__worldAABB.mergeAABB(aabb);\r\n        return this.__worldAABB;\r\n    }\r\n    get worldAABB() {\r\n        if (!SceneGraphComponent.isJointAABBShouldBeCalculated && this.isJoint()) {\r\n            return this.__worldAABB;\r\n        }\r\n        if (this.__isWorldAABBDirty) {\r\n            this.calcWorldAABB();\r\n            this.__isWorldAABBDirty = false;\r\n        }\r\n        else {\r\n            // console.count('skipped')\r\n        }\r\n        return this.__worldAABB;\r\n    }\r\n    setVisibilityRecursively(flag) {\r\n        this.isVisible = flag;\r\n        for (let child of this.__children) {\r\n            child.setVisibilityRecursively(flag);\r\n        }\r\n    }\r\n    castRay(srcPointInWorld, directionInWorld, dotThreshold = 0, ignoreMeshComponents = []) {\r\n        const collectedSgComponents = SceneGraphComponent.flattenHierarchy(this, false);\r\n        const meshComponents = [];\r\n        for (let sg of collectedSgComponents) {\r\n            const mesh = sg.entity.getMesh();\r\n            if (mesh) {\r\n                meshComponents.push(mesh);\r\n            }\r\n        }\r\n        let rayDistance = Number.MAX_VALUE;\r\n        let intersectedPosition = null;\r\n        let selectedMeshComponent = null;\r\n        for (let meshComponent of meshComponents) {\r\n            if (!meshComponent.entity.getSceneGraph().isVisible) {\r\n                continue;\r\n            }\r\n            if (!meshComponent.isPickable) {\r\n                continue;\r\n            }\r\n            if (ignoreMeshComponents.indexOf(meshComponent) !== -1) {\r\n                continue;\r\n            }\r\n            let { t, intersectedPositionInWorld } = meshComponent.castRay(srcPointInWorld, directionInWorld, dotThreshold);\r\n            if (t < rayDistance) {\r\n                rayDistance = t;\r\n                intersectedPositionInWorld = intersectedPositionInWorld;\r\n                selectedMeshComponent = meshComponent;\r\n            }\r\n        }\r\n        if (rayDistance === Number.MAX_VALUE) {\r\n            rayDistance = -1;\r\n        }\r\n        return { intersectedPosition, rayDistance, selectedMeshComponent };\r\n    }\r\n    castRayFromScreen(x, y, camera, viewport, dotThreshold = 0, ignoreMeshComponents = []) {\r\n        const collectedSgComponents = SceneGraphComponent.flattenHierarchy(this, false);\r\n        const meshComponents = [];\r\n        for (let sg of collectedSgComponents) {\r\n            const mesh = sg.entity.getMesh();\r\n            if (mesh) {\r\n                meshComponents.push(mesh);\r\n            }\r\n        }\r\n        let rayDistance = Number.MAX_VALUE;\r\n        let intersectedPosition = null;\r\n        let selectedMeshComponent = null;\r\n        for (let meshComponent of meshComponents) {\r\n            if (!meshComponent.entity.getSceneGraph().isVisible) {\r\n                continue;\r\n            }\r\n            if (!meshComponent.isPickable) {\r\n                continue;\r\n            }\r\n            if (ignoreMeshComponents.indexOf(meshComponent) !== -1) {\r\n                continue;\r\n            }\r\n            let { t, intersectedPositionInWorld } = meshComponent.castRayFromScreen(x, y, camera, viewport, dotThreshold);\r\n            if (t < rayDistance) {\r\n                rayDistance = t;\r\n                intersectedPosition = intersectedPositionInWorld;\r\n                selectedMeshComponent = meshComponent;\r\n            }\r\n        }\r\n        if (rayDistance === Number.MAX_VALUE) {\r\n            rayDistance = -1;\r\n        }\r\n        return { intersectedPosition, rayDistance, selectedMeshComponent };\r\n    }\r\n    $create() {\r\n        this.__animationComponent = this.entity.getComponent(_AnimationComponent__WEBPACK_IMPORTED_MODULE_12__[\"default\"]);\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_6__[\"ProcessStage\"].Logic);\r\n    }\r\n    $logic() {\r\n        this._worldMatrix.copyComponents(this.calcWorldMatrixRecursively(false));\r\n        if (this.__AABBGizmo.isSetup && this.__AABBGizmo.isVisible) {\r\n            this.__AABBGizmo.update();\r\n        }\r\n        // if (this.parent == null) {\r\n        // this.calcWorldAABB();\r\n        // }\r\n    }\r\n}\r\nSceneGraphComponent.__sceneGraphs = [];\r\nSceneGraphComponent._isAllUpdate = false;\r\nSceneGraphComponent.__originVector3 = _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].zero();\r\nSceneGraphComponent.returnVector3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero();\r\nSceneGraphComponent.isJointAABBShouldBeCalculated = false;\r\nSceneGraphComponent.invertedMatrix44 = new _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"]([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(SceneGraphComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/SceneGraphComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/SkeletalComponent.ts":
/*!********************************************************!*\
  !*** ./src/foundation/components/SkeletalComponent.ts ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SkeletalComponent; });\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/MutableQuaternion */ \"./src/foundation/math/MutableQuaternion.ts\");\n/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass SkeletalComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n        this._jointIndices = [];\r\n        this.__joints = [];\r\n        this._inverseBindMatrices = [];\r\n        this.isSkinning = true;\r\n        this.isOptimizingMode = true;\r\n        this.__qArray = new Float32Array(0);\r\n        this.__tArray = new Float32Array(0);\r\n        this.__qtArray = new Float32Array(0);\r\n        this.__qtInfo = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_7__[\"default\"].dummy();\r\n        this.__matArray = new Float32Array(0);\r\n        if (SkeletalComponent.__tookGlobalDataNum < _core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber) {\r\n            if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Mat4x4) {\r\n                SkeletalComponent.__globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneMatrix);\r\n            }\r\n            else if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x2) {\r\n                SkeletalComponent.__globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneQuaternion);\r\n                SkeletalComponent.__globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneTranslateScale);\r\n            }\r\n            else if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x1) {\r\n                SkeletalComponent.__globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneMatrix);\r\n                SkeletalComponent.__globalDataRepository.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneCompressedChunk);\r\n            }\r\n            SkeletalComponent.__tookGlobalDataNum++;\r\n        }\r\n        else {\r\n            console.warn('The actual number of Skeleton generated exceeds Config.maxSkeletonNumber.');\r\n        }\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Logic);\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_2__[\"WellKnownComponentTIDs\"].SkeletalComponentTID;\r\n    }\r\n    set joints(joints) {\r\n        this.__joints = joints;\r\n        let index = 0;\r\n        if (this.componentSID < _core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber) {\r\n            index = this.componentSID;\r\n        }\r\n        if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Mat4x4) {\r\n            this.__matArray = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneMatrix, index).v;\r\n        }\r\n        else if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x2) {\r\n            this.__qArray = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneQuaternion, index).v;\r\n            this.__tArray = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneTranslateScale, index).v;\r\n        }\r\n        else if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x1) {\r\n            this.__matArray = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneMatrix, index).v;\r\n            this.__qtArray = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneCompressedChunk, index).v;\r\n            this.__qtInfo = SkeletalComponent.__globalDataRepository.getValue(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_9__[\"ShaderSemantics\"].BoneCompressedInfo, 0);\r\n        }\r\n    }\r\n    get rootJointWorldMatrixInner() {\r\n        var _a;\r\n        return (_a = this.jointsHierarchy) === null || _a === void 0 ? void 0 : _a.worldMatrixInner;\r\n    }\r\n    get jointMatrices() {\r\n        return this.__jointMatrices;\r\n    }\r\n    get jointQuaternionArray() {\r\n        return this.__qArray;\r\n    }\r\n    get jointTranslateScaleArray() {\r\n        return this.__tArray;\r\n    }\r\n    get jointMatricesArray() {\r\n        return this.__matArray;\r\n    }\r\n    get jointCompressedChunk() {\r\n        return this.__qtArray;\r\n    }\r\n    get jointCompressedInfo() {\r\n        return this.__qtInfo;\r\n    }\r\n    $logic() {\r\n        if (!this.isSkinning) {\r\n            return;\r\n        }\r\n        const scales = [];\r\n        const tXArray = [];\r\n        const tYArray = [];\r\n        const tZArray = [];\r\n        for (let i = 0; i < this.__joints.length; i++) {\r\n            const joint = this.__joints[i];\r\n            let m;\r\n            if (joint.isVisible) {\r\n                const globalJointTransform = joint.worldMatrixInner;\r\n                const inverseBindMatrix = this._inverseBindMatrices[i];\r\n                _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].multiplyTo(globalJointTransform, inverseBindMatrix, SkeletalComponent.__tmp_mat4);\r\n                if (this._bindShapeMatrix) {\r\n                    SkeletalComponent.__tmp_mat4.multiply(this._bindShapeMatrix); // only for glTF1\r\n                }\r\n                m = SkeletalComponent.__tmp_mat4;\r\n            }\r\n            else {\r\n                m = SkeletalComponent.__identityMat;\r\n            }\r\n            if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Mat4x4 || _core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x1) {\r\n                this.__matArray[i * 16 + 0] = m.v[0];\r\n                this.__matArray[i * 16 + 1] = m.v[1];\r\n                this.__matArray[i * 16 + 2] = m.v[2];\r\n                this.__matArray[i * 16 + 3] = m.v[3];\r\n                this.__matArray[i * 16 + 4] = m.v[4];\r\n                this.__matArray[i * 16 + 5] = m.v[5];\r\n                this.__matArray[i * 16 + 6] = m.v[6];\r\n                this.__matArray[i * 16 + 7] = m.v[7];\r\n                this.__matArray[i * 16 + 8] = m.v[8];\r\n                this.__matArray[i * 16 + 9] = m.v[9];\r\n                this.__matArray[i * 16 + 10] = m.v[10];\r\n                this.__matArray[i * 16 + 11] = m.v[11];\r\n                this.__matArray[i * 16 + 12] = m.v[12];\r\n                this.__matArray[i * 16 + 13] = m.v[13];\r\n                this.__matArray[i * 16 + 14] = m.v[14];\r\n                this.__matArray[i * 16 + 15] = m.v[15];\r\n            }\r\n            if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType !== _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Mat4x4) {\r\n                const scaleVec = SkeletalComponent.__tmpVec3_0.setComponents(Math.hypot(m.m00, m.m01, m.m02), Math.hypot(m.m10, m.m11, m.m12), Math.hypot(m.m20, m.m21, m.m22));\r\n                if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x2) {\r\n                    m.m00 /= scaleVec.x;\r\n                    m.m01 /= scaleVec.x;\r\n                    m.m02 /= scaleVec.x;\r\n                    m.m10 /= scaleVec.y;\r\n                    m.m11 /= scaleVec.y;\r\n                    m.m12 /= scaleVec.y;\r\n                    m.m20 /= scaleVec.z;\r\n                    m.m21 /= scaleVec.z;\r\n                    m.m22 /= scaleVec.z;\r\n                    const q = SkeletalComponent.__tmp_q.fromMatrix(m);\r\n                    this.__qArray[i * 4 + 0] = q.x;\r\n                    this.__qArray[i * 4 + 1] = q.y;\r\n                    this.__qArray[i * 4 + 2] = q.z;\r\n                    this.__qArray[i * 4 + 3] = q.w;\r\n                    this.__tArray[i * 4 + 0] = m.m03; // m.getTranslate().x\r\n                    this.__tArray[i * 4 + 1] = m.m13; // m.getTranslate().y\r\n                    this.__tArray[i * 4 + 2] = m.m23; // m.getTranslate().z\r\n                    this.__tArray[i * 4 + 3] = Math.max(scaleVec.x, scaleVec.y, scaleVec.z);\r\n                }\r\n                else if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x1) {\r\n                    scales.push(Math.max(scaleVec.x, scaleVec.y, scaleVec.z));\r\n                    const t = m.getTranslateTo(SkeletalComponent.__tmpVec3_1);\r\n                    tXArray.push(Math.abs(t.x));\r\n                    tYArray.push(Math.abs(t.y));\r\n                    tZArray.push(Math.abs(t.z));\r\n                }\r\n            }\r\n        }\r\n        if (_core_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_12__[\"BoneDataType\"].Vec4x1) {\r\n            const maxScale = Math.max(...scales);\r\n            const maxX = Math.max(...tXArray);\r\n            const maxY = Math.max(...tYArray);\r\n            const maxZ = Math.max(...tZArray);\r\n            this.__qtInfo.x = maxX * 1.1;\r\n            this.__qtInfo.y = maxY * 1.1;\r\n            this.__qtInfo.z = maxZ * 1.1;\r\n            this.__qtInfo.w = maxScale;\r\n            for (let i = 0; i < this.__joints.length; i++) {\r\n                const m = SkeletalComponent.__tmp_mat4;\r\n                m.v[0] = this.__matArray[i * 16 + 0];\r\n                m.v[1] = this.__matArray[i * 16 + 1];\r\n                m.v[2] = this.__matArray[i * 16 + 2];\r\n                m.v[3] = this.__matArray[i * 16 + 3];\r\n                m.v[4] = this.__matArray[i * 16 + 4];\r\n                m.v[5] = this.__matArray[i * 16 + 5];\r\n                m.v[6] = this.__matArray[i * 16 + 6];\r\n                m.v[7] = this.__matArray[i * 16 + 7];\r\n                m.v[8] = this.__matArray[i * 16 + 8];\r\n                m.v[9] = this.__matArray[i * 16 + 9];\r\n                m.v[10] = this.__matArray[i * 16 + 10];\r\n                m.v[11] = this.__matArray[i * 16 + 11];\r\n                m.v[12] = this.__matArray[i * 16 + 12];\r\n                m.v[13] = this.__matArray[i * 16 + 13];\r\n                m.v[14] = this.__matArray[i * 16 + 14];\r\n                m.v[15] = this.__matArray[i * 16 + 15];\r\n                const q = SkeletalComponent.__tmp_q.fromMatrix(m);\r\n                q.normalize();\r\n                const vec2QPacked = _math_MathUtil__WEBPACK_IMPORTED_MODULE_6__[\"MathUtil\"].packNormalizedVec4ToVec2(q.x, q.y, q.z, q.w, 4096);\r\n                this.__qtArray[i * 4 + 0] = vec2QPacked[0];\r\n                this.__qtArray[i * 4 + 1] = vec2QPacked[1];\r\n                const t = m.getTranslateTo(SkeletalComponent.__tmpVec3_0);\r\n                const normalizedX = this.__qtInfo.x === 0.0 ? 0.0 : t.x / this.__qtInfo.x;\r\n                const normalizedY = this.__qtInfo.y === 0.0 ? 0.0 : t.y / this.__qtInfo.y;\r\n                const normalizedZ = this.__qtInfo.z === 0.0 ? 0.0 : t.z / this.__qtInfo.z;\r\n                const normalizedW = this.__qtInfo.w === 0.0 ? 0.0 : scales[i] / this.__qtInfo.w;\r\n                const vec2TPacked = _math_MathUtil__WEBPACK_IMPORTED_MODULE_6__[\"MathUtil\"].packNormalizedVec4ToVec2(normalizedX, normalizedY, normalizedZ, normalizedW, 4096);\r\n                this.__qtArray[i * 4 + 2] = vec2TPacked[0];\r\n                this.__qtArray[i * 4 + 3] = vec2TPacked[1];\r\n            }\r\n        }\r\n    }\r\n}\r\nSkeletalComponent.__tmpVec3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].zero();\r\nSkeletalComponent.__tmpVec3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].zero();\r\nSkeletalComponent.__tmp_mat4 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nSkeletalComponent.__tmp_q = new _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_5__[\"default\"](0, 0, 0, 1);\r\nSkeletalComponent.__identityMat = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].identity();\r\nSkeletalComponent.__globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_10__[\"default\"].getInstance();\r\nSkeletalComponent.__tookGlobalDataNum = 0;\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerComponentClass(SkeletalComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/SkeletalComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/TransformComponent.ts":
/*!*********************************************************!*\
  !*** ./src/foundation/components/TransformComponent.ts ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TransformComponent; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Quaternion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/MutableQuaternion */ \"./src/foundation/math/MutableQuaternion.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import AnimationComponent from './AnimationComponent';\r\nclass TransformComponent extends _core_Component__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityComponent) {\r\n        super(entityUid, componentSid, entityComponent);\r\n        this._translate = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].dummy();\r\n        this._rotate = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].dummy();\r\n        this._scale = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].dummy();\r\n        this._quaternion = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_9__[\"default\"].dummy();\r\n        this._matrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].dummy();\r\n        this._invMatrix = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].dummy();\r\n        this._normalMatrix = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_11__[\"default\"].dummy();\r\n        this.__toUpdateAllTransform = true;\r\n        this._updateCount = 0;\r\n        this.__updateCountAtLastLogic = 0;\r\n        // dependencies\r\n        this._dependentAnimationComponentId = 0;\r\n        const thisClass = TransformComponent;\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'translate', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [0, 0, 0]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'rotate', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [0, 0, 0]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'scale', _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [1, 1, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'quaternion', _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_9__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [0, 0, 0, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'matrix', _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'invMatrix', _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\r\n        this.registerMember(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_7__[\"BufferUse\"].CPUGeneric, 'normalMatrix', _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, [1, 0, 0, 0, 1, 0, 0, 0, 1]);\r\n        this.submitToAllocation(this.maxNumberOfComponent);\r\n        this._is_translate_updated = true;\r\n        this._is_euler_angles_updated = true;\r\n        this._is_scale_updated = true;\r\n        this._is_quaternion_updated = true;\r\n        this._is_trs_matrix_updated = true;\r\n        this._is_inverse_trs_matrix_updated = true;\r\n        this._is_normal_trs_matrix_updated = true;\r\n        this.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_10__[\"ProcessStage\"].Logic);\r\n    }\r\n    static get renderedPropertyCount() {\r\n        return null;\r\n    }\r\n    static get componentTID() {\r\n        return _WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_6__[\"WellKnownComponentTIDs\"].TransformComponentTID;\r\n    }\r\n    set toUpdateAllTransform(flag) {\r\n        this.__toUpdateAllTransform = flag;\r\n    }\r\n    get toUpdateAllTransform() {\r\n        return this.__toUpdateAllTransform;\r\n    }\r\n    _needUpdate() {\r\n        this._updateCount++;\r\n    }\r\n    set translate(vec) {\r\n        this._translate.copyComponents(vec);\r\n        this._is_translate_updated = true;\r\n        this._is_trs_matrix_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        this.__updateTransform();\r\n    }\r\n    get translate() {\r\n        return this.translateInner.clone();\r\n    }\r\n    get translateInner() {\r\n        if (this._is_translate_updated) {\r\n            return this._translate;\r\n        }\r\n        else if (this._is_trs_matrix_updated) {\r\n            this._matrix.getTranslateTo(this._translate);\r\n            this._is_translate_updated = true;\r\n        }\r\n        return this._translate;\r\n    }\r\n    set rotate(vec) {\r\n        this._rotate.copyComponents(vec);\r\n        this._is_euler_angles_updated = true;\r\n        this._is_quaternion_updated = false;\r\n        this._is_trs_matrix_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        this.__updateTransform();\r\n    }\r\n    get rotate() {\r\n        return this.rotateInner.clone();\r\n    }\r\n    get rotateInner() {\r\n        if (this._is_euler_angles_updated) {\r\n            return this._rotate;\r\n        }\r\n        else if (this._is_trs_matrix_updated) {\r\n            this._matrix.toEulerAnglesTo(this._rotate);\r\n        }\r\n        else if (this._is_quaternion_updated) {\r\n            this._quaternion.toEulerAnglesTo(this._rotate);\r\n        }\r\n        this._is_euler_angles_updated = true;\r\n        return this._rotate;\r\n    }\r\n    set scale(vec) {\r\n        this._scale.copyComponents(vec);\r\n        this._is_scale_updated = true;\r\n        this._is_trs_matrix_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        this.__updateTransform();\r\n    }\r\n    get scale() {\r\n        return this.scaleInner.clone();\r\n    }\r\n    get scaleInner() {\r\n        if (this._is_scale_updated) {\r\n            return this._scale;\r\n        }\r\n        else if (this._is_trs_matrix_updated) {\r\n            this._matrix.getScaleTo(this._scale);\r\n            this._is_scale_updated = true;\r\n        }\r\n        return this._scale;\r\n    }\r\n    set quaternion(quat) {\r\n        this._quaternion.copyComponents(quat);\r\n        this._is_quaternion_updated = true;\r\n        this._is_euler_angles_updated = false;\r\n        this._is_trs_matrix_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        this.__updateTransform();\r\n    }\r\n    get quaternion() {\r\n        return this.quaternionInner.clone();\r\n    }\r\n    get quaternionInner() {\r\n        if (this._is_quaternion_updated) {\r\n            return this._quaternion;\r\n        }\r\n        else if (!this._is_quaternion_updated) {\r\n            if (this._is_trs_matrix_updated) {\r\n                this._is_quaternion_updated = true;\r\n                this._quaternion.fromMatrix(this._matrix);\r\n                return this._quaternion;\r\n            }\r\n            else if (this._is_euler_angles_updated) {\r\n                const rotationMat = TransformComponent.__tmpMatrix44_0.rotate(this._rotate);\r\n                this._quaternion.fromMatrix(rotationMat);\r\n                this._is_quaternion_updated = true;\r\n                return this._quaternion;\r\n            }\r\n        }\r\n        return this._quaternion;\r\n    }\r\n    set matrix(mat) {\r\n        this._matrix.copyComponents(mat);\r\n        this._is_trs_matrix_updated = true;\r\n        this._is_translate_updated = false;\r\n        this._is_euler_angles_updated = false;\r\n        this._is_quaternion_updated = false;\r\n        this._is_scale_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        this.__updateTransform();\r\n    }\r\n    get matrix() {\r\n        return this.matrixInner.clone();\r\n    }\r\n    get matrixInner() {\r\n        if (this._is_trs_matrix_updated) {\r\n            return this._matrix;\r\n        }\r\n        // Clear and set Scale\r\n        const scale = this.scaleInner;\r\n        const n00 = scale.v[0];\r\n        // const n01 = 0;\r\n        // const n02 = 0;\r\n        // const n03 = 0;\r\n        // const n10 = 0;\r\n        const n11 = scale.v[1];\r\n        // const n12 = 0;\r\n        // const n13 = 0;\r\n        // const n20 = 0;\r\n        // const n21 = 0;\r\n        const n22 = scale.v[2];\r\n        // const n23 = 0;\r\n        // const n30 = 0;\r\n        // const n31 = 0;\r\n        // const n32 = 0;\r\n        // const n33 = 1;\r\n        const q = this.quaternionInner;\r\n        const sx = q.v[0] * q.v[0];\r\n        const sy = q.v[1] * q.v[1];\r\n        const sz = q.v[2] * q.v[2];\r\n        const cx = q.v[1] * q.v[2];\r\n        const cy = q.v[0] * q.v[2];\r\n        const cz = q.v[0] * q.v[1];\r\n        const wx = q.v[3] * q.v[0];\r\n        const wy = q.v[3] * q.v[1];\r\n        const wz = q.v[3] * q.v[2];\r\n        const m00 = 1.0 - 2.0 * (sy + sz);\r\n        const m01 = 2.0 * (cz - wz);\r\n        const m02 = 2.0 * (cy + wy);\r\n        // const m03 = 0.0;\r\n        const m10 = 2.0 * (cz + wz);\r\n        const m11 = 1.0 - 2.0 * (sx + sz);\r\n        const m12 = 2.0 * (cx - wx);\r\n        // const m13 = 0.0;\r\n        const m20 = 2.0 * (cy - wy);\r\n        const m21 = 2.0 * (cx + wx);\r\n        const m22 = 1.0 - 2.0 * (sx + sy);\r\n        // const m23 = 0.0;\r\n        // const m30 = 0.0;\r\n        // const m31 = 0.0;\r\n        // const m32 = 0.0;\r\n        // const m33 = 1.0;\r\n        const translate = this.translateInner;\r\n        // TranslateMatrix * RotateMatrix * ScaleMatrix\r\n        this._matrix.m00 = m00 * n00;\r\n        this._matrix.m01 = m01 * n11;\r\n        this._matrix.m02 = m02 * n22;\r\n        this._matrix.m03 = translate.v[0];\r\n        this._matrix.m10 = m10 * n00;\r\n        this._matrix.m11 = m11 * n11;\r\n        this._matrix.m12 = m12 * n22;\r\n        this._matrix.m13 = translate.v[1];\r\n        this._matrix.m20 = m20 * n00;\r\n        this._matrix.m21 = m21 * n11;\r\n        this._matrix.m22 = m22 * n22;\r\n        this._matrix.m23 = translate.v[2];\r\n        this._matrix.m30 = 0;\r\n        this._matrix.m31 = 0;\r\n        this._matrix.m32 = 0;\r\n        this._matrix.m33 = 1;\r\n        // const rotateMatrix = new Matrix44(this.quaternion);\r\n        // const matrix = MutableMatrix44.multiply(rotateMatrix, Matrix44.scale(this.scale));\r\n        // matrix.m03 = this.translate.x;\r\n        // matrix.m13 = this.translate.y;\r\n        // matrix.m23 = this.translate.z;\r\n        //this._matrix.copyComponents(matrix);\r\n        this._is_trs_matrix_updated = true;\r\n        return this._matrix;\r\n    }\r\n    get inverseMatrix() {\r\n        return this.inverseMatrixInner.clone();\r\n    }\r\n    get inverseMatrixInner() {\r\n        if (!this._is_inverse_trs_matrix_updated) {\r\n            _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].invertTo(this.matrixInner, this._invMatrix);\r\n            this._is_inverse_trs_matrix_updated = true;\r\n        }\r\n        return this._invMatrix;\r\n    }\r\n    get normalMatrix() {\r\n        return this.normalMatrixInner.clone();\r\n    }\r\n    get normalMatrixInner() {\r\n        if (!this._is_normal_trs_matrix_updated) {\r\n            const invertedMatrix44 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].invertTo(this.matrixInner, TransformComponent.__tmpMatrix44_0);\r\n            const newNormalMatrix = invertedMatrix44.transpose();\r\n            this._normalMatrix.copyComponents(newNormalMatrix);\r\n            this._is_normal_trs_matrix_updated = true;\r\n        }\r\n        return this._normalMatrix;\r\n    }\r\n    /**\r\n     * Set multiple transform information at once. By using this method,\r\n     * we reduce the cost of automatically updating other transform components inside this class.\r\n     * This method may be useful for animation processing and so on.\r\n     *\r\n     * The transform components of these arguments must not be mutually discrepant.\r\n     * for example. The transform components of matrix argument (translate, rotate/quaternion, scale)\r\n     * must be equal to translate, rotate, scale, quaternion arguments.\r\n     * And both rotate and quaternion arguments must be same rotation.\r\n     * If there is an argument passed with null or undefined, it is interpreted as unchanged.\r\n     *\r\n     * @param {*} translate\r\n     * @param {*} rotate\r\n     * @param {*} scale\r\n     * @param {*} quaternion\r\n     * @param {*} matrix\r\n     */\r\n    setTransform(translate, rotate, scale, quaternion, matrix) {\r\n        this._is_trs_matrix_updated = false;\r\n        this._is_inverse_trs_matrix_updated = false;\r\n        this._is_normal_trs_matrix_updated = false;\r\n        // Matrix\r\n        if (matrix != null) {\r\n            this._matrix.copyComponents(matrix);\r\n            this._is_trs_matrix_updated = true;\r\n            this._is_translate_updated = false;\r\n            this._is_euler_angles_updated = false;\r\n            this._is_quaternion_updated = false;\r\n            this._is_scale_updated = false;\r\n        }\r\n        // Translate\r\n        if (translate != null) {\r\n            this._translate.copyComponents(translate);\r\n            this._is_translate_updated = true;\r\n        }\r\n        // Rotation\r\n        if (rotate != null && quaternion != null) {\r\n            this._rotate.copyComponents(rotate);\r\n            this._quaternion = new _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_9__[\"default\"](quaternion);\r\n            this._is_euler_angles_updated = true;\r\n            this._is_quaternion_updated = true;\r\n        }\r\n        else if (rotate != null) {\r\n            this._rotate.copyComponents(rotate);\r\n            this._is_euler_angles_updated = true;\r\n            this._is_quaternion_updated = false;\r\n        }\r\n        else if (quaternion != null) {\r\n            this._quaternion.copyComponents(quaternion);\r\n            this._is_euler_angles_updated = false;\r\n            this._is_quaternion_updated = true;\r\n        }\r\n        // Scale\r\n        if (scale != null) {\r\n            this._scale.copyComponents(scale);\r\n            this._is_scale_updated = true;\r\n        }\r\n        this.__updateTransform();\r\n    }\r\n    __updateTransform() {\r\n        if (this.__toUpdateAllTransform) {\r\n            this.__updateRotation();\r\n            this.__updateTranslate();\r\n            this.__updateScale();\r\n        }\r\n        //this.__updateMatrix();\r\n        this._needUpdate();\r\n    }\r\n    __updateRotation() {\r\n        if (this._is_euler_angles_updated && !this._is_quaternion_updated) {\r\n            const rotationMat = TransformComponent.__tmpMatrix44_0.rotate(this._rotate);\r\n            this._quaternion.fromMatrix(rotationMat);\r\n            this._is_quaternion_updated = true;\r\n        }\r\n        else if (!this._is_euler_angles_updated && this._is_quaternion_updated) {\r\n            this._quaternion.toEulerAnglesTo(this._rotate);\r\n            this._is_euler_angles_updated = true;\r\n        }\r\n        else if (!this._is_euler_angles_updated && !this._is_quaternion_updated && this._is_trs_matrix_updated) {\r\n            this._quaternion.fromMatrix(this._matrix);\r\n            this._is_quaternion_updated = true;\r\n            this._matrix.toEulerAnglesTo(this._rotate);\r\n            this._is_euler_angles_updated = true;\r\n        }\r\n    }\r\n    __updateTranslate() {\r\n        if (!this._is_translate_updated && this._is_trs_matrix_updated) {\r\n            this._matrix.getTranslateTo(this._translate);\r\n            this._is_translate_updated = true;\r\n        }\r\n    }\r\n    __updateScale() {\r\n        if (!this._is_scale_updated && this._is_trs_matrix_updated) {\r\n            this._matrix.getScaleTo(this._scale);\r\n            this._is_scale_updated = true;\r\n        }\r\n    }\r\n    __updateMatrix() {\r\n        if (!this._is_trs_matrix_updated && this._is_translate_updated && this._is_quaternion_updated && this._is_scale_updated) {\r\n            const rotationMatrix = this._matrix.fromQuaternion(this._quaternion);\r\n            const scaleMat = TransformComponent.__tmpMatrix44_0.scale(this._scale);\r\n            const rsMatrix = rotationMatrix.multiply(scaleMat); // rsMatrix references to this._matrix\r\n            rsMatrix.putTranslate(this._translate);\r\n            this._is_trs_matrix_updated = true;\r\n        }\r\n    }\r\n    setPropertiesFromJson(arg) {\r\n        let json = arg;\r\n        if (typeof arg === \"string\") {\r\n            json = JSON.parse(arg);\r\n        }\r\n        for (let key in json) {\r\n            if (json.hasOwnProperty(key) && key in this) {\r\n                if (key === \"quaternion\") {\r\n                    this[key] = new _math_Quaternion__WEBPACK_IMPORTED_MODULE_1__[\"default\"](json[key]);\r\n                }\r\n                else if (key === 'matrix') {\r\n                    this[key] = new _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"](json[key]);\r\n                }\r\n                else {\r\n                    this[key] = new _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](json[key]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    setRotationFromNewUpAndFront(UpVec, FrontVec) {\r\n        const yDir = UpVec;\r\n        const xDir = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].crossTo(yDir, FrontVec, TransformComponent.__tmpVector3_0);\r\n        const zDir = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].crossTo(xDir, yDir, TransformComponent.__tmpVector3_1);\r\n        const rotateMatrix = TransformComponent.__tmpMatrix44_0.setComponents(xDir.x, yDir.x, zDir.x, 0, xDir.y, yDir.y, zDir.y, 0, xDir.z, yDir.z, zDir.z, 0, 0, 0, 0, 1);\r\n        this.rotateMatrix44 = rotateMatrix;\r\n    }\r\n    headToDirection(fromVec, toVec) {\r\n        const fromDir = TransformComponent.__tmpVector3_0.copyComponents(fromVec).normalize();\r\n        const toDir = TransformComponent.__tmpVector3_1.copyComponents(toVec).normalize();\r\n        const rotationDir = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].crossTo(fromDir, toDir, TransformComponent.__tmpVector3_2);\r\n        const cosTheta = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dot(fromDir, toDir);\r\n        const theta = Math.acos(cosTheta);\r\n        this.quaternion = TransformComponent.__tmpQuaternion_0.axisAngle(rotationDir, theta);\r\n    }\r\n    set rotateMatrix44(rotateMatrix) {\r\n        this.quaternion = TransformComponent.__tmpQuaternion_0.fromMatrix(rotateMatrix);\r\n    }\r\n    get rotateMatrix44() {\r\n        return new _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.quaternion);\r\n    }\r\n    $logic() {\r\n        const sceneGraphComponent = this.entity.getSceneGraph();\r\n        if (this.__updateCountAtLastLogic !== this._updateCount) {\r\n            sceneGraphComponent.setWorldMatrixDirty();\r\n            this.__updateCountAtLastLogic = this._updateCount;\r\n        }\r\n        else {\r\n            const skeletalComponent = this.entity.getSkeletal();\r\n            if (skeletalComponent != null) {\r\n                sceneGraphComponent.setWorldMatrixDirty();\r\n            }\r\n        }\r\n    }\r\n}\r\nTransformComponent.__tmpMatrix44_0 = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_8__[\"default\"].zero();\r\nTransformComponent.__tmpVector3_0 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nTransformComponent.__tmpVector3_1 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nTransformComponent.__tmpVector3_2 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero();\r\nTransformComponent.__tmpQuaternion_0 = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_9__[\"default\"].identity();\r\n_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].registerComponentClass(TransformComponent);\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/TransformComponent.ts?");

/***/ }),

/***/ "./src/foundation/components/WellKnownComponentTIDs.ts":
/*!*************************************************************!*\
  !*** ./src/foundation/components/WellKnownComponentTIDs.ts ***!
  \*************************************************************/
/*! exports provided: WellKnownComponentTIDs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WellKnownComponentTIDs\", function() { return WellKnownComponentTIDs; });\n// const MaterialSID = 0\r\nconst AnimationComponentTID = 1;\r\nconst TransformComponentTID = 2;\r\nconst SceneGraphComponentTID = 3;\r\nconst MeshComponentTID = 4;\r\nconst MeshRendererComponentTID = 5;\r\nconst CameraControllerComponentTID = 6;\r\nconst CameraComponentTID = 7;\r\nconst LightComponentTID = 8;\r\nconst SkeletalComponentTID = 9;\r\nconst BlendShapeComponentTID = 10;\r\nconst PhysicsComponentTID = 11;\r\nconst SparkGearComponentTID = 12;\r\nconst EffekseerComponentTID = 13;\r\nconst maxWellKnownTidNumber = 13;\r\nconst WellKnownComponentTIDs = Object.freeze({\r\n    AnimationComponentTID,\r\n    TransformComponentTID,\r\n    SceneGraphComponentTID,\r\n    MeshComponentTID,\r\n    MeshRendererComponentTID,\r\n    CameraControllerComponentTID,\r\n    CameraComponentTID,\r\n    LightComponentTID,\r\n    SkeletalComponentTID,\r\n    BlendShapeComponentTID,\r\n    PhysicsComponentTID,\r\n    SparkGearComponentTID,\r\n    EffekseerComponentTID,\r\n    maxWellKnownTidNumber\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/components/WellKnownComponentTIDs.ts?");

/***/ }),

/***/ "./src/foundation/core/Component.ts":
/*!******************************************!*\
  !*** ./src/foundation/core/Component.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Component; });\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _EntityRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _ComponentRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _Config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _RnObject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./RnObject */ \"./src/foundation/core/RnObject.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Component is a functional unit that can be added to an Entity instance.\r\n */\r\nclass Component extends _RnObject__WEBPACK_IMPORTED_MODULE_7__[\"default\"] {\r\n    /**\r\n     * The constructor of the Component class.\r\n     * When creating an Component, use the createComponent method of the ComponentRepository class\r\n     * instead of directly calling this constructor.\r\n     * @param entityUid Unique ID of the corresponding entity\r\n     * @param componentSid Scoped ID of the Component\r\n     * @param entityRepository The instance of the EntityRepository class (Dependency Injection)\r\n     */\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super();\r\n        this.__currentProcessStage = _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Create;\r\n        this.__byteOffsetOfThisComponent = -1;\r\n        this.__maxComponentNumber = _Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxEntityNumber;\r\n        this.__entityUid = entityUid;\r\n        this._component_sid = componentSid;\r\n        this.__isAlive = true;\r\n        const stages = Component._processStages;\r\n        stages.forEach(stage => {\r\n            if (this.isExistProcessStageMethod(stage)) {\r\n                if (Component.__componentsOfProcessStages.get(stage) == null) {\r\n                    Component.__componentsOfProcessStages.set(stage, new Int32Array(_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxEntityNumber));\r\n                    // Component.__dirtyOfArrayOfProcessStages.set(stage, false);\r\n                    Component.__lengthOfArrayOfProcessStages.set(stage, 0);\r\n                }\r\n            }\r\n        });\r\n        this.__memoryManager = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        this.__entityRepository = entityRepository;\r\n    }\r\n    set maxNumberOfComponent(value) {\r\n        this.__maxComponentNumber = value;\r\n    }\r\n    get maxNumberOfComponent() {\r\n        return this.__maxComponentNumber;\r\n    }\r\n    /**\r\n     * Move to the other stages of process\r\n     * @param processStage stage of component's process\r\n     */\r\n    moveStageTo(processStage) {\r\n        // Component.__dirtyOfArrayOfProcessStages.set(this.__currentProcessStage, false);\r\n        // Component.__dirtyOfArrayOfProcessStages.set(processStage, true);\r\n        this.__currentProcessStage = processStage;\r\n    }\r\n    /**\r\n     * Get the Type ID of the Component\r\n     */\r\n    static get componentTID() {\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get the Scoped ID of the Component\r\n     */\r\n    get componentSID() {\r\n        return this._component_sid;\r\n    }\r\n    /**\r\n     * Get the unique ID of the entity corresponding to the component.\r\n     */\r\n    get entityUID() {\r\n        return this.__entityUid;\r\n    }\r\n    /**\r\n     * Get the current process stage of the component.\r\n     */\r\n    get currentProcessStage() {\r\n        return this.__currentProcessStage;\r\n    }\r\n    /**\r\n     * Get true or false whether the specified ProcessStage exists in Component.\r\n     */\r\n    static isExistProcessStageMethod(componentType, processStage, componentRepository) {\r\n        if (componentType.prototype[processStage.methodName] == null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Get true or false whether the specified ProcessStage exists in Component.\r\n     */\r\n    isExistProcessStageMethod(processStage) {\r\n        if (this[processStage.methodName] == null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Process the components\r\n     * @param param0 params\r\n     */\r\n    static process({ componentType, processStage, processApproach, componentRepository, strategy, renderPass, renderPassTickCount }) {\r\n        if (!Component.isExistProcessStageMethod(componentType, processStage, componentRepository)) {\r\n            return;\r\n        }\r\n        const methodName = processStage.methodName;\r\n        const array = this.__componentsOfProcessStages.get(processStage);\r\n        const components = componentRepository._getComponents(componentType);\r\n        for (let i = 0; i < array.length; ++i) {\r\n            const componentSid = array[i];\r\n            if (componentSid === Component.invalidComponentSID) {\r\n                return;\r\n            }\r\n            const component = components[componentSid];\r\n            component[methodName]({\r\n                i,\r\n                processStage,\r\n                processApproach,\r\n                strategy,\r\n                renderPass,\r\n                renderPassTickCount\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Update all components at each process stage.\r\n     */\r\n    static updateComponentsOfEachProcessStage(componentClass, processStage, componentRepository, renderPass) {\r\n        if (!Component.isExistProcessStageMethod(componentClass, processStage, componentRepository)) {\r\n            return;\r\n        }\r\n        const array = Component.__componentsOfProcessStages.get(processStage);\r\n        if (array) {\r\n            const method = componentClass['sort_' + processStage.methodName];\r\n            if (method != null) {\r\n                let sids = [];\r\n                sids = method(renderPass);\r\n                for (let i = 0; i < sids.length; i++) {\r\n                    array[i] = sids[i];\r\n                }\r\n            }\r\n            else {\r\n                let count = 0;\r\n                const components = componentRepository.getComponentsWithType(componentClass);\r\n                for (let i = 0; i < components.length; ++i) {\r\n                    const component = components[i];\r\n                    if (processStage === component.__currentProcessStage) {\r\n                        array[count++] = i;\r\n                    }\r\n                }\r\n                array[count] = Component.invalidComponentSID;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * get byte length of sum of member fields in the component class\r\n     */\r\n    static getByteLengthSumOfMembers(bufferUse, componentClass) {\r\n        const byteLengthSumOfMembers = this.__byteLengthSumOfMembers.get(componentClass);\r\n        return byteLengthSumOfMembers.get(bufferUse);\r\n    }\r\n    static setupBufferView() {\r\n    }\r\n    /**\r\n     * register a dependency for the other components.\r\n     */\r\n    registerDependency(component, isMust) {\r\n    }\r\n    /**\r\n     * take a buffer view from the buffer.\r\n     */\r\n    static takeBufferView(bufferUse, componentClass, byteLengthSumOfMembers, count) {\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance().createOrGetBuffer(bufferUse);\r\n        if (!this.__bufferViews.has(componentClass)) {\r\n            this.__bufferViews.set(componentClass, new Map());\r\n        }\r\n        const bufferViews = this.__bufferViews.get(componentClass);\r\n        if (!bufferViews.has(bufferUse)) {\r\n            const bufferView = buffer.takeBufferView({ byteLengthToNeed: byteLengthSumOfMembers * count, byteStride: 0, isAoS: false, byteAlign: 16 });\r\n            bufferViews.set(bufferUse, bufferView);\r\n            return bufferView;\r\n        }\r\n        return void 0;\r\n    }\r\n    /**\r\n     * take one memory area for the specified member for all same type of the component instances.\r\n     */\r\n    takeOne(memberName, dataClassType, initValues) {\r\n        if (!this['_' + memberName].isDummy()) {\r\n            return;\r\n        }\r\n        let taken = Component.__accessors.get(this.constructor).get(memberName).takeOne();\r\n        if (dataClassType === _math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || dataClassType === _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_6__[\"default\"]) {\r\n            this['_' + memberName] = new dataClassType(taken, false, true);\r\n        }\r\n        else {\r\n            this['_' + memberName] = new dataClassType(taken, false, true);\r\n        }\r\n        for (let i = 0; i < this['_' + memberName].v.length; ++i) {\r\n            this['_' + memberName].v[i] = initValues[i];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * get the taken accessor for the member field.\r\n     */\r\n    static getAccessor(memberName, componentClass) {\r\n        return this.__accessors.get(componentClass).get(memberName);\r\n    }\r\n    /**\r\n     * take one accessor for the member field.\r\n     */\r\n    static takeAccessor(bufferUse, memberName, componentClass, compositionType, componentType, count) {\r\n        if (!this.__accessors.has(componentClass)) {\r\n            this.__accessors.set(componentClass, new Map());\r\n        }\r\n        const accessors = this.__accessors.get(componentClass);\r\n        if (!accessors.has(memberName)) {\r\n            const bufferViews = this.__bufferViews.get(componentClass);\r\n            const bytes = compositionType.getNumberOfComponents() * componentType.getSizeInBytes();\r\n            let alignedBytes = bytes;\r\n            if (bytes % 16 !== 0) {\r\n                alignedBytes += (bytes % 16 === 0) ? 0 : 16 - bytes % 16;\r\n            }\r\n            const accessor = bufferViews.get(bufferUse).takeFlexibleAccessor({ compositionType: compositionType, componentType, count: count, byteStride: alignedBytes, byteAlign: 16 });\r\n            accessors.set(memberName, accessor);\r\n            return accessor;\r\n        }\r\n        else {\r\n            return void 0;\r\n        }\r\n    }\r\n    static getByteOffsetOfThisComponentTypeInBuffer(bufferUse, componentClass) {\r\n        return this.__bufferViews.get(componentClass).get(bufferUse).byteOffsetInBuffer;\r\n    }\r\n    static getByteOffsetOfFirstOfThisMemberInBuffer(memberName, componentClass) {\r\n        return this.__accessors.get(componentClass).get(memberName).byteOffsetInBuffer;\r\n    }\r\n    static getByteOffsetOfFirstOfThisMemberInBufferView(memberName, componentClass) {\r\n        return this.__accessors.get(componentClass).get(memberName).byteOffsetInBufferView;\r\n    }\r\n    static getCompositionTypeOfMember(memberName, componentClass) {\r\n        const memberInfoArray = this.__memberInfo.get(componentClass);\r\n        const info = memberInfoArray.find(info => {\r\n            return info.memberName === memberName;\r\n        });\r\n        if (info != null) {\r\n            return info.compositionType;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    static getComponentTypeOfMember(memberName, componentClass) {\r\n        const memberInfoArray = this.__memberInfo.get(componentClass);\r\n        const info = memberInfoArray.find(info => {\r\n            return info.memberName === memberName;\r\n        });\r\n        if (info != null) {\r\n            return info.componentType;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Register a member field of component class for memory allocation.\r\n     * @param bufferUse purpose type of buffer use\r\n     * @param memberName the name of member field\r\n     * @param dataClassType a class of data\r\n     * @param componentType a type of number\r\n     * @param initValues a initial value\r\n     */\r\n    registerMember(bufferUse, memberName, dataClassType, componentType, initValues) {\r\n        if (!Component.__memberInfo.has(this.constructor)) {\r\n            Component.__memberInfo.set(this.constructor, []);\r\n        }\r\n        const memberInfoArray = Component.__memberInfo.get(this.constructor);\r\n        memberInfoArray.push({\r\n            bufferUse: bufferUse, memberName: memberName, dataClassType: dataClassType,\r\n            compositionType: dataClassType.compositionType,\r\n            componentType: componentType, initValues: initValues\r\n        });\r\n    }\r\n    /**\r\n     * Allocate memory of self member fields\r\n     * @param count a number of entities to need allocate\r\n     */\r\n    submitToAllocation(count) {\r\n        const componentClass = this.constructor;\r\n        const memberInfoArray = Component.__memberInfo.get(componentClass);\r\n        if (this._component_sid === 0) {\r\n            if (!Component.__members.has(componentClass)) {\r\n                Component.__members.set(componentClass, new Map());\r\n            }\r\n            const member = Component.__members.get(componentClass);\r\n            memberInfoArray.forEach(info => {\r\n                member.set(info.bufferUse, []);\r\n            });\r\n            memberInfoArray.forEach(info => {\r\n                member.get(info.bufferUse).push(info);\r\n            });\r\n            // take a BufferView for all entities for each member fields.\r\n            for (let bufferUse of member.keys()) {\r\n                const infoArray = member.get(bufferUse);\r\n                if (!Component.__byteLengthSumOfMembers.has(componentClass)) {\r\n                    Component.__byteLengthSumOfMembers.set(componentClass, new Map());\r\n                }\r\n                let byteLengthSumOfMembers = Component.__byteLengthSumOfMembers.get(componentClass);\r\n                if (!byteLengthSumOfMembers.has(bufferUse)) {\r\n                    byteLengthSumOfMembers.set(bufferUse, 0);\r\n                }\r\n                infoArray.forEach(info => {\r\n                    byteLengthSumOfMembers.set(bufferUse, byteLengthSumOfMembers.get(bufferUse) +\r\n                        info.compositionType.getNumberOfComponents() * info.componentType.getSizeInBytes());\r\n                });\r\n                if (infoArray.length > 0) {\r\n                    const bufferView = Component.takeBufferView(bufferUse, componentClass, byteLengthSumOfMembers.get(bufferUse), count);\r\n                    this.__byteOffsetOfThisComponent = bufferView.byteOffsetInBuffer;\r\n                }\r\n            }\r\n            // take a Accessor for all entities for each member fields (same as BufferView)\r\n            for (let bufferUse of member.keys()) {\r\n                const infoArray = member.get(bufferUse);\r\n                infoArray.forEach(info => {\r\n                    const accessor = Component.takeAccessor(info.bufferUse, info.memberName, componentClass, info.compositionType, info.componentType, count);\r\n                    this['_byteOffsetOfAccessorInBuffer_' + info.memberName] = accessor.byteOffsetInBuffer;\r\n                    this['_byteOffsetOfAccessorInComponent_' + info.memberName] = accessor.byteOffsetInBufferView;\r\n                });\r\n            }\r\n        }\r\n        const member = Component.__members.get(componentClass);\r\n        // take a field value allocation for each entity for each member field\r\n        for (let bufferUse of member.keys()) {\r\n            const infoArray = member.get(bufferUse);\r\n            infoArray.forEach(info => {\r\n                this.takeOne(info.memberName, info.dataClassType, info.initValues);\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * get the entity which has this component.\r\n     * @returns the entity which has this component\r\n     */\r\n    get entity() {\r\n        return this.__entityRepository.getEntity(this.__entityUid);\r\n    }\r\n    /**\r\n     * get the bytes Information of the member\r\n     * @param component a instance of the component\r\n     * @param memberName the member of component in string\r\n     * @returns bytes information\r\n     */\r\n    static getDataByteInfoInner(component, memberName) {\r\n        const data = component['_' + memberName];\r\n        const typedArray = data.v;\r\n        const byteOffsetInBuffer = typedArray.byteOffset;\r\n        const byteLength = typedArray.byteLength;\r\n        const componentNumber = typedArray.length;\r\n        const locationOffsetInBuffer = byteOffsetInBuffer / 4 / 4; // 4byte is the size of Float32Array, and texel fetch is 4 components unit.\r\n        const byteOffsetInThisComponent = this['_byteOffsetOfAccessorInComponent_' + memberName] + component.componentSID * componentNumber * 4;\r\n        const locationOffsetInThisComponent = this['_byteOffsetOfAccessorInComponent_' + memberName] + component.componentSID * componentNumber;\r\n        const thisComponentByteOffsetInBuffer = component.__byteOffsetOfThisComponent;\r\n        const thisComponentLocationOffsetInBuffer = component.__byteOffsetOfThisComponent / 4 / 4;\r\n        return {\r\n            byteLength,\r\n            byteOffsetInBuffer,\r\n            byteOffsetInThisComponent,\r\n            locationOffsetInBuffer,\r\n            locationOffsetInThisComponent,\r\n            thisComponentByteOffsetInBuffer,\r\n            thisComponentLocationOffsetInBuffer,\r\n            componentNumber\r\n        };\r\n    }\r\n    /**\r\n     * get the bytes Information of the member\r\n     * @param memberName the member of component in string\r\n     * @returns bytes information\r\n     */\r\n    getDataByteInfo(memberName) {\r\n        return Component.getDataByteInfoInner(this, memberName);\r\n    }\r\n    /**\r\n     * get the bytes Information of the member (static version) by ComponentSID\r\n     * @param componentType the Component type\r\n     * @param componentSID the ComponentSID of the component\r\n     * @param memberName the member of component in string\r\n     * @returns bytes information\r\n     */\r\n    static getDataByteInfoByComponentSID(componentType, componentSID, memberName) {\r\n        const component = _ComponentRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().getComponent(componentType, componentSID);\r\n        if (component) {\r\n            return Component.getDataByteInfoInner(component, memberName);\r\n        }\r\n        return void 0;\r\n    }\r\n    /**\r\n     * get the bytes Information of the member (static version) by EntityUID\r\n     * @param componentType the component type\r\n     * @param entityUID the EntityUID\r\n     * @param memberName the member of component in string\r\n     * @returns bytes information\r\n     */\r\n    static getDataByteInfoByEntityUID(componentType, entityUID, memberName) {\r\n        const component = _EntityRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance().getComponentOfEntity(entityUID, componentType);\r\n        if (component) {\r\n            return Component.getDataByteInfoInner(component, memberName);\r\n        }\r\n        return void 0;\r\n    }\r\n    /**\r\n     * get the Pixel Location Offset in the Buffer of the Member\r\n     * @param componentType the component type (e.g. TransformComponent )\r\n     * @param memberName the member name in string\r\n     * @returns the pixel offsets\r\n     */\r\n    static getLocationOffsetOfMemberOfComponent(componentType, memberName) {\r\n        const component = _ComponentRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().getComponent(componentType, 0);\r\n        return component['_byteOffsetOfAccessorInBuffer_' + memberName] / 4 / 4;\r\n    }\r\n}\r\nComponent.invalidComponentSID = -1;\r\nComponent.__componentsOfProcessStages = new Map();\r\nComponent.__lengthOfArrayOfProcessStages = new Map();\r\n// protected static __dirtyOfArrayOfProcessStages: Map<ProcessStageEnum, boolean> = new Map();\r\nComponent.__bufferViews = new Map();\r\nComponent.__accessors = new Map();\r\nComponent.__byteLengthSumOfMembers = new Map();\r\nComponent.__memberInfo = new Map();\r\nComponent.__members = new Map();\r\nComponent._processStages = [\r\n    _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Create,\r\n    _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Load,\r\n    // ProcessStage.Mount,\r\n    _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Logic,\r\n    _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].PreRender,\r\n    _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_3__[\"ProcessStage\"].Render,\r\n];\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/Component.ts?");

/***/ }),

/***/ "./src/foundation/core/ComponentRepository.ts":
/*!****************************************************!*\
  !*** ./src/foundation/core/ComponentRepository.ts ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ComponentRepository; });\n/* harmony import */ var _Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _misc_IsUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../misc/IsUtil */ \"./src/foundation/misc/IsUtil.ts\");\n/* harmony import */ var _Config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Config */ \"./src/foundation/core/Config.ts\");\n\r\n\r\n\r\n/**\r\n * The class that generates and manages all kinds of components.\r\n */\r\nclass ComponentRepository {\r\n    constructor() {\r\n        this.__component_sid_count_map = new Map();\r\n        this.__components = new Map();\r\n    }\r\n    static registerComponentClass(componentClass) {\r\n        const thisClass = ComponentRepository;\r\n        thisClass.__componentClasses.set(componentClass.componentTID, componentClass);\r\n    }\r\n    static unregisterComponentClass(componentTID) {\r\n        const thisClass = ComponentRepository;\r\n        thisClass.__componentClasses.delete(componentTID);\r\n    }\r\n    /**\r\n     * Gets the singleton instance of the ComponentRepository.\r\n     */\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new ComponentRepository();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    /**\r\n     * Gets the class object of the component corresponding to specified ComponentTID.\r\n     * @param componentTid The componentTID to get the class object.\r\n     */\r\n    static getComponentClass(componentTid) {\r\n        return this.__componentClasses.get(componentTid);\r\n    }\r\n    /**\r\n     * Creates an instance of the component for the entity.\r\n     * @param componentTid The componentTID to create the instance.\r\n     * @param entityUid The entityUID of the entity.\r\n     * @param entityRepository the reference of the entityRepository.\r\n     */\r\n    createComponent(componentTid, entityUid, entityRepository) {\r\n        const thisClass = ComponentRepository;\r\n        const componentClass = thisClass.__componentClasses.get(componentTid);\r\n        if (componentClass != null) {\r\n            let component_sid_count = this.__component_sid_count_map.get(componentTid);\r\n            if (!_misc_IsUtil__WEBPACK_IMPORTED_MODULE_1__[\"default\"].exist(component_sid_count)) {\r\n                this.__component_sid_count_map.set(componentTid, 0);\r\n                component_sid_count = _Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"].invalidComponentSID;\r\n            }\r\n            this.__component_sid_count_map.set(componentTid, ++component_sid_count);\r\n            const component = new componentClass(entityUid, component_sid_count, entityRepository);\r\n            if (!this.__components.has(componentTid)) {\r\n                this.__components.set(componentTid, []);\r\n            }\r\n            const array = this.__components.get(componentTid);\r\n            if (array != null) {\r\n                array[component.componentSID] = component;\r\n                return component;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Get the instance of the component corresponding to the component class and componentSID.\r\n     * @param componentClass The class object to get the component.\r\n     * @param componentSid The componentSID to get the component.\r\n     */\r\n    getComponent(componentClass, componentSid) {\r\n        return this.getComponentFromComponentTID(componentClass.componentTID, componentSid);\r\n    }\r\n    /**\r\n     * Get the instance of the component corresponding to the componentTID and componentSID.\r\n     * @param componentTid The componentTID to get the component.\r\n     * @param componentSid The componentSID to get the component.\r\n     */\r\n    getComponentFromComponentTID(componentTid, componentSid) {\r\n        const map = this.__components.get(componentTid);\r\n        if (map != null) {\r\n            const component = map[componentSid];\r\n            if (component != null) {\r\n                return map[componentSid];\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * @private\r\n     * Gets an array of components corresponding to the class object of the component.\r\n     * @param componentClass The class object of the component.\r\n     */\r\n    _getComponents(componentClass) {\r\n        return this.__components.get(componentClass.componentTID);\r\n    }\r\n    static getMemoryBeginIndex(componentTid) {\r\n        let memoryBeginIndex = 0;\r\n        for (let i = 0; i < componentTid; i++) {\r\n            const componentClass = ComponentRepository.__componentClasses.get(i);\r\n            if (componentClass != null) {\r\n                const sizeOfComponent = componentClass.sizeOfThisComponent;\r\n                const maxEntityNumber = _Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxEntityNumber;\r\n                memoryBeginIndex += sizeOfComponent * maxEntityNumber;\r\n            }\r\n        }\r\n        return memoryBeginIndex;\r\n    }\r\n    /**\r\n     * Gets an array of components corresponding to the class object of the component.\r\n     * @param componentType The class object of the component.\r\n     */\r\n    getComponentsWithType(componentType) {\r\n        const components = this.__components.get(componentType.componentTID);\r\n        if (components == null) {\r\n            return [];\r\n        }\r\n        return components;\r\n    }\r\n    /**\r\n     * Gets all componentTIDs.\r\n     */\r\n    getComponentTIDs() {\r\n        const indices = [];\r\n        for (let type of this.__components.keys()) {\r\n            indices.push(type);\r\n        }\r\n        indices.sort(function (a, b) {\r\n            if (a < b)\r\n                return -1;\r\n            if (a > b)\r\n                return 1;\r\n            return 0;\r\n        });\r\n        return indices;\r\n    }\r\n}\r\nComponentRepository.__componentClasses = new Map();\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/ComponentRepository.ts?");

/***/ }),

/***/ "./src/foundation/core/Config.ts":
/*!***************************************!*\
  !*** ./src/foundation/core/Config.ts ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n\r\nlet maxEntityNumber = 5000;\r\nlet maxLightNumberInShader = 4;\r\nlet maxVertexMorphNumberInShader = 41;\r\nlet maxMaterialInstanceForEachType = 500;\r\nlet maxSkeletonNumber = 33;\r\nlet maxCameraNumber = 15;\r\nlet maxSizeLimitOfNonCompressedTexture = 512;\r\nlet maxSkeletalBoneNumber = 250;\r\nlet dataTextureWidth = Math.pow(2, 12);\r\nlet dataTextureHeight = Math.pow(2, 12);\r\nlet boneDataType = _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_0__[\"BoneDataType\"].Vec4x2;\r\nlet noWebGLTex2DStateCache = false;\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    maxEntityNumber, maxLightNumberInShader, maxVertexMorphNumberInShader, maxMaterialInstanceForEachType, boneDataType,\r\n    maxSkeletonNumber, maxCameraNumber, maxSizeLimitOfNonCompressedTexture, maxSkeletalBoneNumber, dataTextureWidth, dataTextureHeight,\r\n    noWebGLTex2DStateCache\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/Config.ts?");

/***/ }),

/***/ "./src/foundation/core/Entity.ts":
/*!***************************************!*\
  !*** ./src/foundation/core/Entity.ts ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Entity; });\n/* harmony import */ var _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _RnObject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RnObject */ \"./src/foundation/core/RnObject.ts\");\n\r\n\r\n/**\r\n * The Rhodonite Entity Class which are an entities that exists in space.\r\n * Entities can acquire various functions by having components on themselves.\r\n */\r\nclass Entity extends _RnObject__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    /**\r\n     * The constructor of the Entity class.\r\n     * When creating an Entity, use the createEntity method of the EntityRepository class\r\n     * instead of directly calling this constructor.\r\n     * @param entityUID The unique ID of the entity\r\n     * @param isAlive Whether this entity alive or not\r\n     * @param entityComponent The instance of EntityComponent (Dependency Injection)\r\n     */\r\n    constructor(entityUID, isAlive) {\r\n        super();\r\n        this.__components = []; // index is ComponentTID\r\n        this.__entity_uid = entityUID;\r\n        this.__isAlive = isAlive;\r\n    }\r\n    /**\r\n     * Get Unique ID of the entity.\r\n     */\r\n    get entityUID() {\r\n        return this.__entity_uid;\r\n    }\r\n    /**\r\n     * @private\r\n     * Sets a component to this entity.\r\n     * @param component The component to set.\r\n     */\r\n    _setComponent(component) {\r\n        this.__components[component.constructor.componentTID] = component;\r\n    }\r\n    /**\r\n     * Get the component of the specified type that the entity has\r\n     * @param componentType\r\n     */\r\n    getComponent(componentType) {\r\n        return this.__components[componentType.componentTID];\r\n    }\r\n    /**\r\n     * Gets the component corresponding to the ComponentTID.\r\n     * @param componentTID The ComponentTID to get the component.\r\n     */\r\n    getComponentByComponentTID(componentTID) {\r\n        return this.__components[componentTID];\r\n    }\r\n    /**\r\n     * Get the TransformComponent of the entity.\r\n     * It's a shortcut method of getComponent(TransformComponent).\r\n     */\r\n    getTransform() {\r\n        if (this.__transformComponent == null) {\r\n            this.__transformComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].TransformComponentTID);\r\n        }\r\n        return this.__transformComponent;\r\n    }\r\n    /**\r\n     * Get the SceneGraphComponent of the entity.\r\n     * It's a shortcut method of getComponent(SceneGraphComponent).\r\n     */\r\n    getSceneGraph() {\r\n        if (this.__sceneGraphComponent == null) {\r\n            this.__sceneGraphComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].SceneGraphComponentTID);\r\n        }\r\n        return this.__sceneGraphComponent;\r\n    }\r\n    getSkeletal() {\r\n        if (this.__skeletalComponent == null) {\r\n            this.__skeletalComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].SkeletalComponentTID);\r\n        }\r\n        return this.__skeletalComponent;\r\n    }\r\n    getMesh() {\r\n        if (this.__meshComponent == null) {\r\n            this.__meshComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].MeshComponentTID);\r\n        }\r\n        return this.__meshComponent;\r\n    }\r\n    getMeshRenderer() {\r\n        if (this.__meshRendererComponent == null) {\r\n            this.__meshRendererComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].MeshRendererComponentTID);\r\n        }\r\n        return this.__meshRendererComponent;\r\n    }\r\n    getCamera() {\r\n        if (this.__cameraComponent == null) {\r\n            this.__cameraComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].CameraComponentTID);\r\n        }\r\n        return this.__cameraComponent;\r\n    }\r\n    getCameraController() {\r\n        if (this.__cameraControllerComponent == null) {\r\n            this.__cameraControllerComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].CameraControllerComponentTID);\r\n        }\r\n        return this.__cameraControllerComponent;\r\n    }\r\n    getBlendShape() {\r\n        if (this.__blendShapeComponent == null) {\r\n            this.__blendShapeComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].BlendShapeComponentTID);\r\n        }\r\n        return this.__blendShapeComponent;\r\n    }\r\n    getPhysics() {\r\n        if (this.__physicsComponent == null) {\r\n            this.__physicsComponent = this.getComponentByComponentTID(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_0__[\"WellKnownComponentTIDs\"].PhysicsComponentTID);\r\n        }\r\n        return this.__physicsComponent;\r\n    }\r\n}\r\nEntity.invalidEntityUID = -1;\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/Entity.ts?");

/***/ }),

/***/ "./src/foundation/core/EntityRepository.ts":
/*!*************************************************!*\
  !*** ./src/foundation/core/EntityRepository.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EntityRepository; });\n/* harmony import */ var _Entity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Entity */ \"./src/foundation/core/Entity.ts\");\n/* harmony import */ var _ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n\r\n\r\n/**\r\n * The class that generates and manages entities.\r\n */\r\nclass EntityRepository {\r\n    constructor() {\r\n        this.__entity_uid_count = _Entity__WEBPACK_IMPORTED_MODULE_0__[\"default\"].invalidEntityUID;\r\n        this.__entities = [];\r\n        this._components = [];\r\n        this.__componentRepository = _ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new EntityRepository();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    /**\r\n     * Creates an entity which has the given types of the components\r\n     * @param componentClasses The class objects of the components.\r\n     */\r\n    createEntity(componentClasses) {\r\n        const entity = new _Entity__WEBPACK_IMPORTED_MODULE_0__[\"default\"](++this.__entity_uid_count, true);\r\n        this.__entities[this.__entity_uid_count] = entity;\r\n        return this.addComponentsToEntity(componentClasses, entity.entityUID);\r\n    }\r\n    /**\r\n     * Add components to the entity.\r\n     * @param componentClasses The class objects to set to the entity.\r\n     * @param entityUid The entityUID of the entity.\r\n     */\r\n    addComponentsToEntity(componentClasses, entityUid) {\r\n        const entity = this.getEntity(entityUid);\r\n        for (let componentClass of componentClasses) {\r\n            const component = this.__componentRepository.createComponent(componentClass.componentTID, entityUid, this);\r\n            let map = this._components[entity.entityUID];\r\n            if (map == null) {\r\n                map = new Map();\r\n                this._components[entity.entityUID] = map;\r\n            }\r\n            if (component != null) {\r\n                map.set(componentClass.componentTID, component);\r\n                entity._setComponent(component);\r\n            }\r\n        }\r\n        return entity;\r\n    }\r\n    /**\r\n     * Remove components from the entity.\r\n     * @param componentClasses The class object of the components to remove.\r\n     * @param entityUid The entityUID of the entity.\r\n     */\r\n    removeComponentsFromEntity(componentClasses, entityUid) {\r\n        const entity = this.getEntity(entityUid);\r\n        for (let componentClass of componentClasses) {\r\n            let map = this._components[entity.entityUID];\r\n            if (map == null) {\r\n                map = new Map();\r\n                this._components[entity.entityUID] = map;\r\n            }\r\n            map.delete(componentClass.componentTID);\r\n        }\r\n        return entity;\r\n    }\r\n    /**\r\n     * Gets the entity corresponding to the entityUID.\r\n     * @param entityUid The entityUID of the entity.\r\n     */\r\n    getEntity(entityUid) {\r\n        return this.__entities[entityUid];\r\n    }\r\n    /**\r\n     * Gets the specified component from the entity.\r\n     * @param entityUid The entity to get the component from.\r\n     * @param componentType The class object of the component to get.\r\n     */\r\n    getComponentOfEntity(entityUid, componentType) {\r\n        const entity = this._components[entityUid];\r\n        let component = null;\r\n        if (entity != null) {\r\n            component = entity.get(componentType.componentTID);\r\n            if (component != null) {\r\n                return component;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        return component;\r\n    }\r\n    /**\r\n     * Search entities by the given tags.\r\n     * @param tags The tags to search\r\n     */\r\n    searchByTags(tags) {\r\n        const matchEntities = [];\r\n        for (let entity of this.__entities) {\r\n            if (entity.matchTags(tags)) {\r\n                matchEntities.push(entity);\r\n            }\r\n        }\r\n        return matchEntities;\r\n    }\r\n    /**\r\n     * Gets entity by the unique name.\r\n     * @param uniqueName The unique name of the entity.\r\n     */\r\n    getEntityByUniqueName(uniqueName) {\r\n        for (let entity of this.__entities) {\r\n            if (entity.uniqueName === uniqueName) {\r\n                return entity;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    /**\r\n     * @private\r\n     * Gets all entities.\r\n     */\r\n    _getEntities() {\r\n        return this.__entities.concat();\r\n    }\r\n    /**\r\n     * Gets the number of all entities.\r\n     */\r\n    getEntitiesNumber() {\r\n        return this.__entities.length;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/EntityRepository.ts?");

/***/ }),

/***/ "./src/foundation/core/GlobalDataRepository.ts":
/*!*****************************************************!*\
  !*** ./src/foundation/core/GlobalDataRepository.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GlobalDataRepository; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _MemoryManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../materials/core/Material */ \"./src/foundation/materials/core/Material.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/MathClassUtil */ \"./src/foundation/math/MathClassUtil.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _math_VectorN__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/VectorN */ \"./src/foundation/math/VectorN.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _Config__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The class which manages global data.\r\n */\r\nclass GlobalDataRepository {\r\n    constructor() {\r\n        this.__fields = new Map();\r\n    }\r\n    initialize() {\r\n        // CurrentComponentSIDs\r\n        const currentComponentSIDsInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].CurrentComponentSIDs, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].ScalarArray, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, maxIndex: _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_16__[\"WellKnownComponentTIDs\"].maxWellKnownTidNumber,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, needUniformInFastest: true, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_16__[\"WellKnownComponentTIDs\"].maxWellKnownTidNumber))\r\n        };\r\n        this.registerProperty(currentComponentSIDsInfo, 1);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].CurrentComponentSIDs);\r\n        // Camera\r\n        const viewMatrixInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ViewMatrix, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Mat4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, initialValue: _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_15__[\"default\"].identity()\r\n        };\r\n        const projectionMatrixInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ProjectionMatrix, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Mat4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, initialValue: _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_15__[\"default\"].identity()\r\n        };\r\n        const viewPositionInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ViewPosition, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_14__[\"default\"](0, 0, 1)\r\n        };\r\n        this.registerProperty(viewMatrixInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxCameraNumber);\r\n        this.registerProperty(projectionMatrixInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxCameraNumber);\r\n        this.registerProperty(viewPositionInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxCameraNumber);\r\n        // Skinning\r\n        const boneMatrixInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneMatrix, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Mat4Array, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletalBoneNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(0))\r\n        };\r\n        const boneQuaternionInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneQuaternion, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletalBoneNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(0))\r\n        };\r\n        const boneTranslateScaleInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneTranslateScale, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletalBoneNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, soloDatum: true,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(0))\r\n        };\r\n        const boneCompressedChunkInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneCompressedChunk, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletalBoneNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, soloDatum: true,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(0))\r\n        };\r\n        const boneCompressedInfoInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneCompressedInfo, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, soloDatum: true,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: _math_Vector4__WEBPACK_IMPORTED_MODULE_13__[\"default\"].zero()\r\n        };\r\n        const skeletalComponentSIDInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SkinningMode, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Int,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader, min: 0, max: 1, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"](-1)\r\n        };\r\n        if (_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_17__[\"BoneDataType\"].Mat4x4) {\r\n            this.registerProperty(boneMatrixInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber);\r\n        }\r\n        else if (_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_17__[\"BoneDataType\"].Vec4x2) {\r\n            this.registerProperty(boneQuaternionInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber);\r\n            this.registerProperty(boneTranslateScaleInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber);\r\n        }\r\n        else if (_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_17__[\"BoneDataType\"].Vec4x1) {\r\n            this.registerProperty(boneMatrixInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber);\r\n            this.registerProperty(boneCompressedChunkInfo, _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxSkeletonNumber);\r\n            this.registerProperty(boneCompressedInfoInfo, 1);\r\n            this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BoneCompressedInfo);\r\n        }\r\n        this.registerProperty(skeletalComponentSIDInfo, 1);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SkinningMode);\r\n        // Lighting\r\n        const lightPositionInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightPosition, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader,\r\n            min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader))\r\n        };\r\n        const lightDirectionInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightDirection, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader,\r\n            min: -1, max: 1, isSystem: true, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader)), updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n        };\r\n        const lightIntensityInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightIntensity, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4Array, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, maxIndex: _Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader,\r\n            min: 0, max: 10, isSystem: true, initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_9__[\"default\"](new Float32Array(_Config__WEBPACK_IMPORTED_MODULE_11__[\"default\"].maxLightNumberInShader)), updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n        };\r\n        this.registerProperty(lightPositionInfo, 1);\r\n        this.registerProperty(lightDirectionInfo, 1);\r\n        this.registerProperty(lightIntensityInfo, 1);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightDirection);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightIntensity);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightPosition);\r\n        const lightNumberInfo = {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightNumber,\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Int,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader,\r\n            min: 0,\r\n            max: Number.MAX_SAFE_INTEGER,\r\n            isSystem: true,\r\n            updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"](0),\r\n        };\r\n        this.registerProperty(lightNumberInfo, 1);\r\n        this.takeOne(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightNumber);\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new GlobalDataRepository();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    registerProperty(semanticInfo, maxCount) {\r\n        const propertyIndex = _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._getPropertyIndex(semanticInfo);\r\n        const buffer = _MemoryManager__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].GPUInstanceData);\r\n        const alignedByteLength = _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._calcAlignedByteLength(semanticInfo);\r\n        const bufferView = buffer.takeBufferView({\r\n            byteLengthToNeed: alignedByteLength * maxCount,\r\n            byteStride: 0,\r\n            byteAlign: 16,\r\n            isAoS: false\r\n        });\r\n        let maxArrayLength = semanticInfo.maxIndex;\r\n        if (_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].isArray(semanticInfo.compositionType) && maxArrayLength == null) {\r\n            maxArrayLength = 100;\r\n        }\r\n        const accessor = bufferView.takeFlexibleAccessor({\r\n            compositionType: semanticInfo.compositionType,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n            count: maxCount,\r\n            byteStride: alignedByteLength,\r\n            arrayLength: maxArrayLength,\r\n            byteAlign: 16\r\n        });\r\n        const globalPropertyStruct = {\r\n            shaderSemanticsInfo: semanticInfo,\r\n            values: [],\r\n            maxCount: maxCount,\r\n            accessor: accessor\r\n        };\r\n        this.__fields.set(propertyIndex, globalPropertyStruct);\r\n    }\r\n    takeOne(shaderSemantic, arrayIndex) {\r\n        const propertyIndex = _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._getPropertyIndex2(shaderSemantic, arrayIndex);\r\n        const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n        if (globalPropertyStruct) {\r\n            const semanticInfo = globalPropertyStruct.shaderSemanticsInfo;\r\n            const typedArray = globalPropertyStruct.accessor.takeOne();\r\n            const countIndex = globalPropertyStruct.values.length;\r\n            const valueObj = _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_6__[\"default\"].initWithFloat32Array(semanticInfo.initialValue, semanticInfo.initialValue, typedArray, semanticInfo.compositionType);\r\n            globalPropertyStruct.values[countIndex] = valueObj;\r\n            return valueObj;\r\n        }\r\n        return void 0;\r\n    }\r\n    setValue(shaderSemantic, countIndex, value, arrayIndex) {\r\n        const propertyIndex = _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._getPropertyIndex2(shaderSemantic, arrayIndex);\r\n        const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n        if (globalPropertyStruct) {\r\n            const valueObj = globalPropertyStruct.values[countIndex];\r\n            _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_6__[\"default\"]._setForce(valueObj, value);\r\n        }\r\n    }\r\n    getValue(shaderSemantic, countIndex, arrayIndex) {\r\n        const propertyIndex = _materials_core_Material__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._getPropertyIndex2(shaderSemantic, arrayIndex);\r\n        const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n        if (globalPropertyStruct) {\r\n            const valueObj = globalPropertyStruct.values[countIndex];\r\n            return valueObj;\r\n        }\r\n        return void 0;\r\n    }\r\n    getGlobalPropertyStruct(propertyIndex) {\r\n        return this.__fields.get(propertyIndex);\r\n    }\r\n    setUniformLocations(shaderProgramUid) {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getWebGLResourceRepository();\r\n        const semanticsInfoArray = [];\r\n        this.__fields.forEach((globalPropertyStruct, key) => {\r\n            const semanticInfo = globalPropertyStruct.shaderSemanticsInfo;\r\n            semanticsInfoArray.push(semanticInfo);\r\n        });\r\n        webglResourceRepository.setupUniformLocations(shaderProgramUid, semanticsInfoArray);\r\n    }\r\n    setUniformValues(shaderProgram) {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getWebGLResourceRepository();\r\n        this.__fields.forEach((globalPropertyStruct, key) => {\r\n            const info = globalPropertyStruct.shaderSemanticsInfo;\r\n            const values = globalPropertyStruct.values;\r\n            for (let i = 0; i < values.length; i++) {\r\n                webglResourceRepository.setUniformValue(shaderProgram, info.semantic.str, true, values[i], info.index);\r\n            }\r\n        });\r\n    }\r\n    // getLocationOffsetOfProperty(propertyIndex: Index, countIndex: Index) {\r\n    //   const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n    //   if (globalPropertyStruct) {\r\n    //     const value = globalPropertyStruct.values[countIndex];\r\n    //     return (value.v as Float32Array).byteOffset / 4 / 4;\r\n    //   }\r\n    //   return void 0;\r\n    // }\r\n    getLocationOffsetOfProperty(propertyIndex) {\r\n        const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n        if (globalPropertyStruct) {\r\n            return globalPropertyStruct.accessor.byteOffsetInBuffer / 4 / 4;\r\n        }\r\n        return void 0;\r\n    }\r\n    getCurrentDataNumberOfTheProperty(propertyIndex) {\r\n        const globalPropertyStruct = this.__fields.get(propertyIndex);\r\n        if (globalPropertyStruct) {\r\n            return globalPropertyStruct.values.length;\r\n        }\r\n        return 0;\r\n    }\r\n    addPropertiesStr(vertexPropertiesStr, pixelPropertiesStr, propertySetter) {\r\n        this.__fields.forEach((globalPropertyStruct, propertyIndex) => {\r\n            const info = globalPropertyStruct.shaderSemanticsInfo;\r\n            if (info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader || info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader) {\r\n                vertexPropertiesStr += propertySetter('', info, propertyIndex, true);\r\n            }\r\n            if (info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader || info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexAndPixelShader) {\r\n                pixelPropertiesStr += propertySetter('', info, propertyIndex, true);\r\n            }\r\n        });\r\n        return [vertexPropertiesStr, pixelPropertiesStr];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/GlobalDataRepository.ts?");

/***/ }),

/***/ "./src/foundation/core/MemoryManager.ts":
/*!**********************************************!*\
  !*** ./src/foundation/core/MemoryManager.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MemoryManager; });\n/* harmony import */ var _memory_Buffer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../memory/Buffer */ \"./src/foundation/memory/Buffer.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _Config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Config */ \"./src/foundation/core/Config.ts\");\n\r\n\r\n\r\n/**\r\n * Usage\r\n * const mm = MemoryManager.getInstance();\r\n * this.translate = new Vector3(\r\n *   mm.assignMem(componentUID, propertyId, entityUID, isRendered)\r\n * );\r\n */\r\nclass MemoryManager {\r\n    constructor(cpuGeneric, gpuInstanceData, gpuVertexData) {\r\n        //__entityMaxCount: number;\r\n        this.__buffers = {};\r\n        this.__buffersOnDemand = new Map();\r\n        this.__memorySizeRatios = {};\r\n        this.__memorySizeRatios[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].CPUGeneric.str] = cpuGeneric;\r\n        this.__memorySizeRatios[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].GPUInstanceData.str] = gpuInstanceData;\r\n        this.__memorySizeRatios[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].GPUVertexData.str] = gpuVertexData;\r\n    }\r\n    static createInstanceIfNotCreated(cpuGeneric, gpuInstanceData, gpuVertexData) {\r\n        if (!this.__instance) {\r\n            this.__instance = new MemoryManager(cpuGeneric, gpuInstanceData, gpuVertexData);\r\n            return this.__instance;\r\n        }\r\n        return this.__instance;\r\n    }\r\n    __makeMultipleOf4byteSize(memorySize) {\r\n        return memorySize + ((memorySize % 4 === 0) ? 0 : 4 - memorySize % 4);\r\n    }\r\n    static getInstance() {\r\n        return this.__instance;\r\n    }\r\n    __createBuffer(bufferUse) {\r\n        let memorySize = MemoryManager.bufferWidthLength * MemoryManager.bufferHeightLength /*width*height*/ * 4 /*rgba*/ * 4 /*byte*/ * this.__memorySizeRatios[bufferUse.str];\r\n        const arrayBuffer = new ArrayBuffer(this.__makeMultipleOf4byteSize(memorySize));\r\n        const buffer = new _memory_Buffer__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n            byteLength: arrayBuffer.byteLength,\r\n            buffer: arrayBuffer,\r\n            name: bufferUse.str\r\n        });\r\n        this.__buffers[buffer.name] = buffer;\r\n        return buffer;\r\n    }\r\n    getBuffer(bufferUse) {\r\n        let buffer = this.__buffers[bufferUse.toString()];\r\n        return buffer;\r\n    }\r\n    createOrGetBuffer(bufferUse) {\r\n        let buffer = this.__buffers[bufferUse.toString()];\r\n        if (buffer == null) {\r\n            buffer = this.__createBuffer(bufferUse);\r\n        }\r\n        return buffer;\r\n    }\r\n    createBufferOnDemand(size, object) {\r\n        const arrayBuffer = new ArrayBuffer(size);\r\n        const buffer = new _memory_Buffer__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n            byteLength: arrayBuffer.byteLength,\r\n            buffer: arrayBuffer,\r\n            name: _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].UBOGeneric.toString()\r\n        });\r\n        this.__buffersOnDemand.set(object.objectUID, buffer);\r\n        return buffer;\r\n    }\r\n    getBufferOnDemand(object) {\r\n        return this.__buffersOnDemand.get(object.objectUID);\r\n    }\r\n    static get bufferWidthLength() {\r\n        return _Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].dataTextureWidth;\r\n    }\r\n    static get bufferHeightLength() {\r\n        return _Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].dataTextureHeight;\r\n    }\r\n    printMemoryUsage() {\r\n        const cpuGeneric = this.__buffers[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].CPUGeneric.toString()];\r\n        const gpuInstanceData = this.__buffers[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].GPUInstanceData.toString()];\r\n        const gpuVertexData = this.__buffers[_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_1__[\"BufferUse\"].GPUVertexData.toString()];\r\n        // const uboGeneric = this.__buffers[BufferUse.UBOGeneric.toString()];\r\n        console.log(`Memory Usage in Memory Manager:`);\r\n        console.log(`CPUGeneric: ${cpuGeneric.takenSizeInByte} byte of ${cpuGeneric.byteLength} bytes. (${cpuGeneric.takenSizeInByte / cpuGeneric.byteLength * 100} %) `);\r\n        console.log(`GPUInstanceData: ${gpuInstanceData.takenSizeInByte} byte of ${gpuInstanceData.byteLength} bytes. (${gpuInstanceData.takenSizeInByte / gpuInstanceData.byteLength * 100} %) `);\r\n        if (gpuVertexData != null) {\r\n            console.log(`GPUVertexData: ${gpuVertexData.takenSizeInByte} byte of ${gpuVertexData.byteLength} bytes. (${gpuVertexData.takenSizeInByte / gpuVertexData.byteLength * 100} %) `);\r\n        }\r\n        // console.log(`UBOGeneric: ${uboGeneric.takenSizeInByte} byte of ${uboGeneric.byteLength} bytes. (${uboGeneric.takenSizeInByte / uboGeneric.byteLength * 100} %) `);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/MemoryManager.ts?");

/***/ }),

/***/ "./src/foundation/core/RnObject.ts":
/*!*****************************************!*\
  !*** ./src/foundation/core/RnObject.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return RnObject; });\n/**\r\n * The root class of the objects in Rhodonite\r\n */\r\nclass RnObject {\r\n    constructor() {\r\n        this.__objectUid = RnObject.InvalidObjectUID;\r\n        this.__tags = {}; // Tag string allows alphabet, digit and underscore (_) only\r\n        this.__combinedTagString = ''; // Tag string allows alphabet, digit and underscore (_) only\r\n        this.__objectUid = RnObject.currentMaxObjectCount++;\r\n        RnObject.__objects[this.__objectUid] = this;\r\n        this.__uniqueName = 'entity_of_uid_' + this.__objectUid;\r\n        RnObject.__uniqueNames[this.__objectUid] = this.__uniqueName;\r\n        RnObject.__objectsByNameMap.set(this.__uniqueName, this);\r\n    }\r\n    searchByTag(tag, value) {\r\n        for (let obj of RnObject.__objects) {\r\n            if (obj.getTagValue(tag) === value) {\r\n                return obj;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    /**\r\n     * Gets the objectUID of the object.\r\n     */\r\n    get objectUID() {\r\n        return this.__objectUid;\r\n    }\r\n    /**\r\n     * Gets the object by corresponding to the objectUID.\r\n     * @param objectUid The objectUID of the object.\r\n     */\r\n    static getRnObject(objectUid) {\r\n        return RnObject.__objects[objectUid];\r\n    }\r\n    /**\r\n     * Gets the object by the unique name.\r\n     * @param uniqueName The unique name of the object.\r\n     */\r\n    static getRnObjectByName(uniqueName) {\r\n        return RnObject.__objectsByNameMap.get(uniqueName);\r\n    }\r\n    /**\r\n     * Try to set a unique name of the entity.\r\n     * @param name\r\n     * @param toAddNameIfConflict If true, force to add name string to the current unique name string. If false, give up to change name.\r\n     */\r\n    tryToSetUniqueName(name, toAddNameIfConflict) {\r\n        if (RnObject.__uniqueNames.indexOf(name) !== -1) {\r\n            // Conflict\r\n            if (toAddNameIfConflict) {\r\n                const newName = name + '_(' + this.__uniqueName + ')';\r\n                if (RnObject.__uniqueNames.indexOf(newName) === -1) {\r\n                    this.__uniqueName = newName;\r\n                    RnObject.__uniqueNames[this.__objectUid] = this.__uniqueName;\r\n                    RnObject.__objectsByNameMap.set(this.__uniqueName, this);\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        else {\r\n            this.__uniqueName = name;\r\n            RnObject.__uniqueNames[this.__objectUid] = this.__uniqueName;\r\n            RnObject.__objectsByNameMap.set(this.__uniqueName, this);\r\n            return true;\r\n        }\r\n    }\r\n    /**\r\n     * Validate the string of tags.\r\n     * @param val The string to be validated\r\n     */\r\n    validateTagString(val) {\r\n        var reg = new RegExp(/[!\"#$%&'()\\*\\+\\-\\s\\.,\\/:;<=>?@\\[\\\\\\]^`{|}~]/g);\r\n        if (reg.test(val)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Tries to set tag (name and value).\r\n     * @param tagName The tag name.\r\n     * @param tagValue Tha value of the tag.\r\n     */\r\n    tryToSetTag(tag) {\r\n        if (this.validateTagString(tag.tag)) {\r\n            if (this.hasTag(tag.tag)) {\r\n                this.removeTag(tag.tag);\r\n            }\r\n            this.__tags[tag.tag] = tag.value;\r\n            this.__combinedTagString += `${tag.tag}:${tag.value}` + ' ';\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Gets the value of the tag.\r\n     * @param tagName The tag name.\r\n     */\r\n    getTagValue(tagName) {\r\n        return this.__tags[tagName];\r\n    }\r\n    /**\r\n     * Gets the tag object.\r\n     * @param tagName The tag name.\r\n     */\r\n    getTag(tagName) {\r\n        const tag = {\r\n            tag: tagName,\r\n            value: this.__tags[tagName]\r\n        };\r\n        return tag;\r\n    }\r\n    /**\r\n     * Gets the boolean value whether this object has the tag or not.\r\n     * @param tagName The tag name.\r\n     */\r\n    hasTag(tagName) {\r\n        if (this.__tags[tagName] != null) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * Remove the tag.\r\n     * @param tagName The tag name.\r\n     */\r\n    removeTag(tagName) {\r\n        const strToDelete = `${tagName}:${this.__tags[tagName]}` + ' ';\r\n        this.__combinedTagString.replace(this.__combinedTagString, \"\");\r\n        delete this.__tags[tagName];\r\n    }\r\n    /**\r\n     * Confirms the matching of the tag name and tag value.\r\n     * @param tagName The tag name.\r\n     * @param tagValue The tag value.\r\n     */\r\n    matchTag(tagName, tagValue) {\r\n        if (this.__tags[tagName] === tagValue) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * Confirm that this object's tags includes given an array of string.\r\n     * @param stringArray an array of string.\r\n     */\r\n    matchTagsAsFreeStrings(stringArray) {\r\n        let regExpStr = '^';\r\n        for (let i = 0; i < stringArray.length; i++) {\r\n            regExpStr += `(?=.*${stringArray[i]})`;\r\n        }\r\n        var reg = new RegExp(regExpStr);\r\n        if (reg.test(this.__combinedTagString)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * Confirm that this object's tags includes given set of tags.\r\n     * @param tags The set of tags.\r\n     */\r\n    matchTags(tags) {\r\n        let regExpStr = '^';\r\n        for (let tagName in tags) {\r\n            regExpStr += `(?=.*${[tagName]}:${tags[tagName]})`;\r\n        }\r\n        var reg = new RegExp(regExpStr);\r\n        if (reg.test(this.__combinedTagString)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * Get the unique name of the entity.\r\n     */\r\n    get uniqueName() {\r\n        return this.__uniqueName;\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n    static _reset() {\r\n        this.currentMaxObjectCount = 0;\r\n        this.__uniqueNames = [];\r\n        this.__objectsByNameMap = new Map();\r\n        this.__objects = [];\r\n    }\r\n}\r\nRnObject.InvalidObjectUID = -1;\r\nRnObject.currentMaxObjectCount = 0;\r\nRnObject.__uniqueNames = [];\r\nRnObject.__objectsByNameMap = new Map();\r\nRnObject.__objects = [];\r\n\n\n//# sourceURL=webpack:///./src/foundation/core/RnObject.ts?");

/***/ }),

/***/ "./src/foundation/definitions/AlphaMode.ts":
/*!*************************************************!*\
  !*** ./src/foundation/definitions/AlphaMode.ts ***!
  \*************************************************/
/*! exports provided: AlphaMode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AlphaMode\", function() { return AlphaMode; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass AlphaModeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Opaque = new AlphaModeClass({ index: 0, str: 'OPAQUE' });\r\nconst Mask = new AlphaModeClass({ index: 1, str: 'MASK' });\r\nconst Translucent = new AlphaModeClass({ index: 2, str: 'TRANSLUCENT' });\r\nconst Additive = new AlphaModeClass({ index: 3, str: 'ADDITIVE' });\r\nconst typeList = [Opaque, Mask, Translucent, Additive];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nfunction fromGlTFString(str) {\r\n    if (str === 'BLEND') {\r\n        return Translucent;\r\n    }\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst AlphaMode = Object.freeze({ Opaque, Mask, Translucent, Additive, from, fromString, fromGlTFString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/AlphaMode.ts?");

/***/ }),

/***/ "./src/foundation/definitions/AnimationAttribute.ts":
/*!**********************************************************!*\
  !*** ./src/foundation/definitions/AnimationAttribute.ts ***!
  \**********************************************************/
/*! exports provided: AnimationAttribute */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AnimationAttribute\", function() { return AnimationAttribute; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass AnimationAttributeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Quaternion = new AnimationAttributeClass({ index: 0, str: 'Quaternion' });\r\nconst Translate = new AnimationAttributeClass({ index: 1, str: 'Translate' });\r\nconst Scale = new AnimationAttributeClass({ index: 2, str: 'Scale' });\r\nconst Weights = new AnimationAttributeClass({ index: 3, str: 'Weights' });\r\nconst typeList = [Quaternion, Translate, Scale, Weights];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst AnimationAttribute = Object.freeze({ Quaternion, Translate, Scale, Weights, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/AnimationAttribute.ts?");

/***/ }),

/***/ "./src/foundation/definitions/AnimationInterpolation.ts":
/*!**************************************************************!*\
  !*** ./src/foundation/definitions/AnimationInterpolation.ts ***!
  \**************************************************************/
/*! exports provided: AnimationInterpolation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AnimationInterpolation\", function() { return AnimationInterpolation; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass AnimationInterpolationClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Linear = new AnimationInterpolationClass({ index: 0, str: 'Linear' });\r\nconst Step = new AnimationInterpolationClass({ index: 1, str: 'Step' });\r\nconst CubicSpline = new AnimationInterpolationClass({ index: 2, str: 'CubicSpline' });\r\nconst typeList = [Linear, Step, CubicSpline];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst AnimationInterpolation = Object.freeze({ Linear, Step, CubicSpline, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/AnimationInterpolation.ts?");

/***/ }),

/***/ "./src/foundation/definitions/BasisCompressionType.ts":
/*!************************************************************!*\
  !*** ./src/foundation/definitions/BasisCompressionType.ts ***!
  \************************************************************/
/*! exports provided: BasisCompressionType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BasisCompressionType\", function() { return BasisCompressionType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass BasisCompressionTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst ETC1 = new BasisCompressionTypeClass({ index: 0, str: 'ETC1' });\r\nconst ETC2 = new BasisCompressionTypeClass({ index: 1, str: 'ETC2' });\r\nconst BC1 = new BasisCompressionTypeClass({ index: 2, str: 'BC1' });\r\nconst BC3 = new BasisCompressionTypeClass({ index: 3, str: 'BC3' });\r\nconst BC4 = new BasisCompressionTypeClass({ index: 4, str: 'BC4' });\r\nconst BC5 = new BasisCompressionTypeClass({ index: 5, str: 'BC5' });\r\nconst BC7_M6_OPAQUE = new BasisCompressionTypeClass({ index: 6, str: 'BC7_M6_OPAQUE' });\r\nconst BC7_M5 = new BasisCompressionTypeClass({ index: 7, str: 'BC7_M5' });\r\nconst PVRTC1_RGB = new BasisCompressionTypeClass({ index: 8, str: 'PVRTC1_RGB' });\r\nconst PVRTC1_RGBA = new BasisCompressionTypeClass({ index: 9, str: 'PVRTC1_RGBA' });\r\nconst ASTC = new BasisCompressionTypeClass({ index: 10, str: 'ASTC' });\r\nconst ATC_RGB = new BasisCompressionTypeClass({ index: 11, str: 'ATC_RGB' });\r\nconst ATC_RGBA = new BasisCompressionTypeClass({ index: 12, str: 'ATC_RGBA' });\r\nconst RGBA32 = new BasisCompressionTypeClass({ index: 13, str: 'RGBA32' });\r\nconst RGB565 = new BasisCompressionTypeClass({ index: 14, str: 'RGB565' });\r\nconst BGR565 = new BasisCompressionTypeClass({ index: 15, str: 'BGR565' });\r\nconst RGBA4444 = new BasisCompressionTypeClass({ index: 16, str: 'RGBA4444' });\r\nconst typeList = [ETC1, ETC2, BC1, BC3, BC4, BC5, BC7_M5, BC7_M6_OPAQUE, PVRTC1_RGB, PVRTC1_RGBA, ASTC, ATC_RGB, ATC_RGBA, RGBA32, RGB565, BGR565, RGBA4444];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst BasisCompressionType = Object.freeze({ ETC1, ETC2, BC1, BC3, BC4, BC5, BC7_M5, BC7_M6_OPAQUE, PVRTC1_RGB, PVRTC1_RGBA, ASTC, ATC_RGB, ATC_RGBA, RGBA32, RGB565, BGR565, RGBA4444, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/BasisCompressionType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/BoneDataType.ts":
/*!****************************************************!*\
  !*** ./src/foundation/definitions/BoneDataType.ts ***!
  \****************************************************/
/*! exports provided: BoneDataType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BoneDataType\", function() { return BoneDataType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass BoneDataTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Mat4x4 = new BoneDataTypeClass({ index: 0, str: 'Mat4x4' });\r\nconst Vec4x2 = new BoneDataTypeClass({ index: 1, str: 'Vec4x2' });\r\nconst Vec4x1 = new BoneDataTypeClass({ index: 2, str: 'Vec4x1' });\r\nconst typeList = [Mat4x4, Vec4x2, Vec4x1];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst BoneDataType = Object.freeze({ Mat4x4, Vec4x2, Vec4x1, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/BoneDataType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/BufferUse.ts":
/*!*************************************************!*\
  !*** ./src/foundation/definitions/BufferUse.ts ***!
  \*************************************************/
/*! exports provided: BufferUse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BufferUse\", function() { return BufferUse; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass BufferUseClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst GPUInstanceData = new BufferUseClass({ index: 0, str: 'GPUInstanceData' });\r\nconst GPUVertexData = new BufferUseClass({ index: 1, str: 'GPUVertexData' });\r\nconst UBOGeneric = new BufferUseClass({ index: 2, str: 'UBOGeneric' });\r\nconst CPUGeneric = new BufferUseClass({ index: 3, str: 'CPUGeneric' });\r\nconst typeList = [GPUInstanceData, GPUVertexData, UBOGeneric, CPUGeneric];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst BufferUse = Object.freeze({ GPUInstanceData, GPUVertexData, UBOGeneric, CPUGeneric, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/BufferUse.ts?");

/***/ }),

/***/ "./src/foundation/definitions/CameraControllerType.ts":
/*!************************************************************!*\
  !*** ./src/foundation/definitions/CameraControllerType.ts ***!
  \************************************************************/
/*! exports provided: CameraControllerType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CameraControllerType\", function() { return CameraControllerType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass CameraControllerTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Orbit = new CameraControllerTypeClass({ index: 0, str: 'Orbit' });\r\nconst WalkThrough = new CameraControllerTypeClass({ index: 1, str: 'WalkThrough' });\r\nconst typeList = [Orbit, WalkThrough];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst CameraControllerType = Object.freeze({ Orbit, WalkThrough, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/CameraControllerType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/CameraType.ts":
/*!**************************************************!*\
  !*** ./src/foundation/definitions/CameraType.ts ***!
  \**************************************************/
/*! exports provided: CameraType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CameraType\", function() { return CameraType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass CameraTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Perspective = new CameraTypeClass({ index: 0, str: 'Perspective' });\r\nconst Orthographic = new CameraTypeClass({ index: 1, str: 'Orthographic' });\r\nconst Frustom = new CameraTypeClass({ index: 2, str: 'Frustom' });\r\nconst typeList = [Perspective, Orthographic, Frustom];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst CameraType = Object.freeze({ Perspective, Orthographic, Frustom, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/CameraType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ComponentType.ts":
/*!*****************************************************!*\
  !*** ./src/foundation/definitions/ComponentType.ts ***!
  \*****************************************************/
/*! exports provided: ComponentType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ComponentType\", function() { return ComponentType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ComponentTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str, sizeInBytes }) {\r\n        super({ index, str });\r\n        this.__sizeInBytes = sizeInBytes;\r\n    }\r\n    getSizeInBytes() {\r\n        return this.__sizeInBytes;\r\n    }\r\n    isFloatingPoint() {\r\n        if (this.index === 5126 // Float\r\n            || this.index === 5127 // Double\r\n            || this.index === 0x8D61 // HalfFloat\r\n        ) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    isInteger() {\r\n        if (this.index === 5120 // Byte\r\n            || this.index === 5121 // UnsignedByte\r\n            || this.index === 5122 // Short\r\n            || this.index === 5123 // UnsignedShort\r\n            || this.index === 5124 // Int\r\n            || this.index === 5125 // UnsignedInt\r\n        ) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nconst Unknown = new ComponentTypeClass({ index: 5119, str: 'UNKNOWN', sizeInBytes: 0 });\r\nconst Byte = new ComponentTypeClass({ index: 5120, str: 'BYTE', sizeInBytes: 1 });\r\nconst UnsignedByte = new ComponentTypeClass({ index: 5121, str: 'UNSIGNED_BYTE', sizeInBytes: 1 });\r\nconst Short = new ComponentTypeClass({ index: 5122, str: 'SHORT', sizeInBytes: 2 });\r\nconst UnsignedShort = new ComponentTypeClass({ index: 5123, str: 'UNSIGNED_SHORT', sizeInBytes: 2 });\r\nconst Int = new ComponentTypeClass({ index: 5124, str: 'INT', sizeInBytes: 4 });\r\nconst UnsignedInt = new ComponentTypeClass({ index: 5125, str: 'UNSIGNED_INT', sizeInBytes: 4 });\r\nconst Float = new ComponentTypeClass({ index: 5126, str: 'FLOAT', sizeInBytes: 4 });\r\nconst Double = new ComponentTypeClass({ index: 5127, str: 'DOUBLE', sizeInBytes: 8 });\r\nconst Bool = new ComponentTypeClass({ index: 35670, str: 'BOOL', sizeInBytes: 1 });\r\nconst HalfFloat = new ComponentTypeClass({ index: 0x8D61, str: 'HALF_FLOAT_OES', sizeInBytes: 2 });\r\nconst typeList = [Unknown, Byte, UnsignedByte, Short, UnsignedShort, Int, UnsignedInt, Float, Double, HalfFloat];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nfunction fromTypedArray(typedArray) {\r\n    if (typedArray instanceof Int8Array) {\r\n        return Byte;\r\n    }\r\n    else if (typedArray instanceof Uint8Array || typedArray instanceof Uint8ClampedArray) {\r\n        return UnsignedByte;\r\n    }\r\n    else if (typedArray instanceof Int16Array) {\r\n        return Short;\r\n    }\r\n    else if (typedArray instanceof Uint16Array) {\r\n        return UnsignedShort;\r\n    }\r\n    else if (typedArray instanceof Int32Array) {\r\n        return Int;\r\n    }\r\n    else if (typedArray instanceof Uint32Array) {\r\n        return UnsignedInt;\r\n    }\r\n    else if (typedArray instanceof Float32Array) {\r\n        return Float;\r\n    }\r\n    else if (typedArray instanceof Float64Array) {\r\n        return Double;\r\n    }\r\n    return Unknown;\r\n}\r\nfunction fromGlslString(str_) {\r\n    let str = str_;\r\n    switch (str_) {\r\n        case 'int':\r\n            str = 'INT';\r\n            break;\r\n        case 'float':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'vec2':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'vec3':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'vec4':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'mat2':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'mat3':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'mat4':\r\n            str = 'FLOAT';\r\n            break;\r\n        case 'ivec2':\r\n            str = 'INT';\r\n            break;\r\n        case 'ivec3':\r\n            str = 'INT';\r\n            break;\r\n        case 'ivec4':\r\n            str = 'INT';\r\n            break;\r\n        case 'sampler2D':\r\n            str = 'INT';\r\n            break;\r\n        case 'sampler3D':\r\n            str = 'INT';\r\n            break;\r\n        case 'samplerCube':\r\n            str = 'INT';\r\n            break;\r\n    }\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst ComponentType = Object.freeze({ Unknown, Byte, UnsignedByte, Short, UnsignedShort, Int, UnsignedInt: UnsignedInt, Float, Double, Bool, HalfFloat, from, fromTypedArray, fromString, fromGlslString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ComponentType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/CompositionType.ts":
/*!*******************************************************!*\
  !*** ./src/foundation/definitions/CompositionType.ts ***!
  \*******************************************************/
/*! exports provided: CompositionType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CompositionType\", function() { return CompositionType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n/* harmony import */ var _ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n\r\n\r\nclass CompositionTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str, glslStr, hlslStr, numberOfComponents }) {\r\n        super({ index, str });\r\n        this.__numberOfComponents = 0;\r\n        this.__numberOfComponents = numberOfComponents;\r\n        this.__glslStr = glslStr;\r\n        this.__hlslStr = hlslStr;\r\n    }\r\n    getNumberOfComponents() {\r\n        return this.__numberOfComponents;\r\n    }\r\n    getGlslStr(componentType) {\r\n        if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Double || this === CompositionType.Texture2D || this === CompositionType.TextureCube) {\r\n            return this.__glslStr;\r\n        }\r\n        else if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Byte || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Short || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Int) {\r\n            if (this === CompositionType.Scalar) {\r\n                return 'int';\r\n            }\r\n            else {\r\n                return 'i' + this.__glslStr;\r\n            }\r\n        }\r\n        else if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Bool) {\r\n            return 'bool';\r\n        }\r\n        return 'unknown';\r\n    }\r\n    getGlslInitialValue(componentType) {\r\n        if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Double) {\r\n            if (this === CompositionType.Scalar) {\r\n                return '0.0';\r\n            }\r\n            else {\r\n                if (this.__numberOfComponents === 2) {\r\n                    return this.__glslStr + '(0.0, 0.0)';\r\n                }\r\n                else if (this.__numberOfComponents === 3) {\r\n                    return this.__glslStr + '(0.0, 0.0, 0.0)';\r\n                }\r\n                else if (this.__numberOfComponents === 4) {\r\n                    return this.__glslStr + '(0.0, 0.0, 0.0, 0.0)';\r\n                }\r\n                else if (this.__numberOfComponents === 9) {\r\n                    return this.__glslStr + '(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)';\r\n                }\r\n                else if (this.__numberOfComponents === 16) {\r\n                    return this.__glslStr + '(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)';\r\n                }\r\n            }\r\n        }\r\n        else if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Byte || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Short || componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Int) {\r\n            if (this === CompositionType.Scalar) {\r\n                return '0';\r\n            }\r\n            else {\r\n                if (this.__numberOfComponents === 2) {\r\n                    return this.__glslStr + '(0, 0)';\r\n                }\r\n                else if (this.__numberOfComponents === 3) {\r\n                    return this.__glslStr + '(0, 0, 0)';\r\n                }\r\n                else if (this.__numberOfComponents === 4) {\r\n                    return this.__glslStr + '(0, 0, 0, 0)';\r\n                }\r\n                else if (this.__numberOfComponents === 9) {\r\n                    return this.__glslStr + '(0, 0, 0, 0, 0, 0, 0, 0, 0)';\r\n                }\r\n                else if (this.__numberOfComponents === 16) {\r\n                    return this.__glslStr + '(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)';\r\n                }\r\n            }\r\n        }\r\n        else if (componentType === _ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Bool) {\r\n            if (this === CompositionType.Scalar) {\r\n                return 'false';\r\n            }\r\n            else {\r\n                if (this.__numberOfComponents === 2) {\r\n                    return this.__glslStr + '(false, false)';\r\n                }\r\n                else if (this.__numberOfComponents === 3) {\r\n                    return this.__glslStr + '(false, false, false)';\r\n                }\r\n                else if (this.__numberOfComponents === 4) {\r\n                    return this.__glslStr + '(false, false, false, false)';\r\n                }\r\n            }\r\n        }\r\n        return 'unknown';\r\n    }\r\n}\r\nconst Unknown = new CompositionTypeClass({ index: -1, str: 'UNKNOWN', glslStr: 'unknown', hlslStr: 'unknown', numberOfComponents: 0 });\r\nconst Scalar = new CompositionTypeClass({ index: 0, str: 'SCALAR', glslStr: 'float', hlslStr: 'float', numberOfComponents: 1 });\r\nconst Vec2 = new CompositionTypeClass({ index: 1, str: 'VEC2', glslStr: 'vec2', hlslStr: 'float2', numberOfComponents: 2 });\r\nconst Vec3 = new CompositionTypeClass({ index: 2, str: 'VEC3', glslStr: 'vec3', hlslStr: 'float3', numberOfComponents: 3 });\r\nconst Vec4 = new CompositionTypeClass({ index: 3, str: 'VEC4', glslStr: 'vec4', hlslStr: 'float4', numberOfComponents: 4 });\r\nconst Mat2 = new CompositionTypeClass({ index: 4, str: 'MAT2', glslStr: 'mat2', hlslStr: 'float2x2', numberOfComponents: 4 });\r\nconst Mat3 = new CompositionTypeClass({ index: 5, str: 'MAT3', glslStr: 'mat3', hlslStr: 'float3x3', numberOfComponents: 9 });\r\nconst Mat4 = new CompositionTypeClass({ index: 6, str: 'MAT4', glslStr: 'mat4', hlslStr: 'float4x4', numberOfComponents: 16 });\r\nconst Texture2D = new CompositionTypeClass({ index: 7, str: 'TEXTURE_2D', glslStr: 'sampler2D', hlslStr: 'Texture2D', numberOfComponents: 1 });\r\nconst TextureCube = new CompositionTypeClass({ index: 8, str: 'TEXTURE_CUBE_MAP', glslStr: 'samplerCube', hlslStr: 'TextureCube', numberOfComponents: 1 });\r\nconst ScalarArray = new CompositionTypeClass({ index: 9, str: 'SCALAR_ARRAY', glslStr: 'float', hlslStr: 'float', numberOfComponents: 1 });\r\nconst Vec2Array = new CompositionTypeClass({ index: 10, str: 'VEC2_ARRAY', glslStr: 'vec2', hlslStr: 'float2', numberOfComponents: 2 });\r\nconst Vec3Array = new CompositionTypeClass({ index: 11, str: 'VEC3_ARRAY', glslStr: 'vec3', hlslStr: 'float3', numberOfComponents: 3 });\r\nconst Vec4Array = new CompositionTypeClass({ index: 12, str: 'VEC4_ARRAY', glslStr: 'vec4', hlslStr: 'float4', numberOfComponents: 4 });\r\nconst Mat4Array = new CompositionTypeClass({ index: 13, str: 'MAT4_ARRAY', glslStr: 'mat4', hlslStr: 'float4x4', numberOfComponents: 16 });\r\nconst typeList = [Unknown, Scalar, Vec2, Vec3, Vec4, Mat2, Mat3, Mat4, Texture2D, TextureCube, ScalarArray, Vec2Array, Vec3Array, Vec4Array];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nfunction fromGlslString(str_) {\r\n    let str = str_;\r\n    switch (str_) {\r\n        case 'int':\r\n            str = 'scalar';\r\n            break;\r\n        case 'float':\r\n            str = 'scalar';\r\n            break;\r\n        case 'ivec2':\r\n            str = 'vec2';\r\n            break;\r\n        case 'ivec3':\r\n            str = 'vec3';\r\n            break;\r\n        case 'ivec4':\r\n            str = 'vec4';\r\n            break;\r\n        case 'sampler2D':\r\n            str = 'TEXTURE_2D';\r\n            break;\r\n        case 'samplerCube':\r\n            str = 'TEXTURE_CUBE_MAP';\r\n            break;\r\n    }\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nfunction isArray(compositionType) {\r\n    if (compositionType === ScalarArray || compositionType === Vec2Array || compositionType === Vec3Array || compositionType === Vec4Array || compositionType === Mat4Array) {\r\n        return true;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nconst CompositionType = Object.freeze({ Unknown, Scalar, Vec2, Vec3, Vec4, Mat2, Mat3, Mat4, Texture2D, TextureCube, ScalarArray, Vec2Array, Vec3Array, Vec4Array, Mat4Array, from, fromString, fromGlslString, isArray });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/CompositionType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/HdriFormat.ts":
/*!**************************************************!*\
  !*** ./src/foundation/definitions/HdriFormat.ts ***!
  \**************************************************/
/*! exports provided: HdriFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HdriFormat\", function() { return HdriFormat; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass HdriFormatClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst LDR_SRGB = new HdriFormatClass({ index: 0, str: '.ldr_srgb' });\r\nconst LDR_LINEAR = new HdriFormatClass({ index: 1, str: '.ldr_linear' });\r\nconst HDR = new HdriFormatClass({ index: 2, str: '.hdr' });\r\nconst RGBE_PNG = new HdriFormatClass({ index: 3, str: '.rgbe.png' });\r\nconst RGB9_E5_PNG = new HdriFormatClass({ index: 4, str: '.rgb9_e5.png' });\r\nconst OpenEXR = new HdriFormatClass({ index: 5, str: '.exr' });\r\nconst typeList = [LDR_SRGB, LDR_LINEAR, HDR, RGBE_PNG, RGB9_E5_PNG, OpenEXR];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst HdriFormat = Object.freeze({ LDR_SRGB, LDR_LINEAR, HDR, RGBE_PNG, RGB9_E5_PNG, OpenEXR });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/HdriFormat.ts?");

/***/ }),

/***/ "./src/foundation/definitions/LightType.ts":
/*!*************************************************!*\
  !*** ./src/foundation/definitions/LightType.ts ***!
  \*************************************************/
/*! exports provided: LightType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LightType\", function() { return LightType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass LightTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Directional = new LightTypeClass({ index: 0, str: 'Directional' });\r\nconst Point = new LightTypeClass({ index: 1, str: 'Point' });\r\nconst Spot = new LightTypeClass({ index: 2, str: 'Spot' });\r\nconst Ambient = new LightTypeClass({ index: 3, str: 'Ambient' });\r\nconst typeList = [Point, Directional, Spot, Ambient];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst LightType = Object.freeze({ Point, Directional, Spot, Ambient, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/LightType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/PixelFormat.ts":
/*!***************************************************!*\
  !*** ./src/foundation/definitions/PixelFormat.ts ***!
  \***************************************************/
/*! exports provided: PixelFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PixelFormat\", function() { return PixelFormat; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass PixelFormatClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst DepthComponent = new PixelFormatClass({ index: 0x1902, str: 'DEPTH_COMPONENT' });\r\nconst Alpha = new PixelFormatClass({ index: 0x1906, str: 'ALPHA' });\r\nconst RGB = new PixelFormatClass({ index: 0x1907, str: 'RGB' });\r\nconst RGBA = new PixelFormatClass({ index: 0x1908, str: 'RGBA' });\r\nconst Luminance = new PixelFormatClass({ index: 0x1909, str: 'LUMINANCE' });\r\nconst LuminanceAlpha = new PixelFormatClass({ index: 0x190A, str: 'LUMINANCE_ALPHA' });\r\nconst typeList = [DepthComponent, Alpha, RGB, RGBA, Luminance, LuminanceAlpha];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst PixelFormat = Object.freeze({ DepthComponent, Alpha, RGB, RGBA, Luminance, LuminanceAlpha });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/PixelFormat.ts?");

/***/ }),

/***/ "./src/foundation/definitions/PrimitiveMode.ts":
/*!*****************************************************!*\
  !*** ./src/foundation/definitions/PrimitiveMode.ts ***!
  \*****************************************************/
/*! exports provided: PrimitiveMode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PrimitiveMode\", function() { return PrimitiveMode; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass PrimitiveModeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Unknown = new PrimitiveModeClass({ index: -1, str: 'UNKNOWN' });\r\nconst Points = new PrimitiveModeClass({ index: 0, str: 'POINTS' });\r\nconst Lines = new PrimitiveModeClass({ index: 1, str: 'LINES' });\r\nconst LineLoop = new PrimitiveModeClass({ index: 2, str: 'LINE_LOOP' });\r\nconst LineStrip = new PrimitiveModeClass({ index: 3, str: 'LINE_STRIP' });\r\nconst Triangles = new PrimitiveModeClass({ index: 4, str: 'TRIANGLES' });\r\nconst TriangleStrip = new PrimitiveModeClass({ index: 5, str: 'TRIANGLE_STRIP' });\r\nconst TriangleFan = new PrimitiveModeClass({ index: 6, str: 'TRIANGLE_FAN' });\r\nconst typeList = [Unknown, Points, Lines, LineLoop, LineStrip, Triangles, TriangleStrip, TriangleFan];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst PrimitiveMode = Object.freeze({ Unknown, Points, Lines, LineLoop, LineStrip, Triangles, TriangleStrip, TriangleFan, from });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/PrimitiveMode.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ProcessApproach.ts":
/*!*******************************************************!*\
  !*** ./src/foundation/definitions/ProcessApproach.ts ***!
  \*******************************************************/
/*! exports provided: ProcessApproach */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ProcessApproach\", function() { return ProcessApproach; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ProcessApproachClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst None = new ProcessApproachClass({ index: 0, str: 'NONE' });\r\nconst UniformWebGL1 = new ProcessApproachClass({ index: 1, str: 'UNIFORM_WEBGL1' });\r\nconst UniformWebGL2 = new ProcessApproachClass({ index: 2, str: 'UNIFORM_WEBGL2' });\r\nconst DataTextureWebGL1 = new ProcessApproachClass({ index: 3, str: 'DATA_TEXTURE_WEBGL1' });\r\nconst DataTextureWebGL2 = new ProcessApproachClass({ index: 4, str: 'DATA_TEXTURE_WEBGL2' });\r\nconst UBOWebGL2 = new ProcessApproachClass({ index: 5, str: 'UBO_WEBGL2' });\r\nconst TransformFeedbackWebGL2 = new ProcessApproachClass({ index: 6, str: 'TRANSFORM_FEEDBACK_WEBGL2' });\r\nconst FastestWebGL1 = new ProcessApproachClass({ index: 7, str: 'FASTEST_WEBGL1' });\r\nconst typeList = [None, UniformWebGL1, UniformWebGL2, DataTextureWebGL1, DataTextureWebGL2, UBOWebGL2, TransformFeedbackWebGL2, FastestWebGL1];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst ProcessApproach = Object.freeze({ None, UniformWebGL1, UniformWebGL2, DataTextureWebGL1, DataTextureWebGL2, UBOWebGL2, TransformFeedbackWebGL2, FastestWebGL1 });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ProcessApproach.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ProcessStage.ts":
/*!****************************************************!*\
  !*** ./src/foundation/definitions/ProcessStage.ts ***!
  \****************************************************/
/*! exports provided: ProcessStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ProcessStage\", function() { return ProcessStage; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ProcessStageClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str, methodName }) {\r\n        super({ index, str });\r\n        this.methodName = methodName;\r\n    }\r\n}\r\nconst Unknown = new ProcessStageClass({ index: -1, str: 'UNKNOWN', methodName: '$unknown' });\r\nconst Create = new ProcessStageClass({ index: 0, str: 'CREATE', methodName: '$create' });\r\nconst Load = new ProcessStageClass({ index: 1, str: 'LOAD', methodName: '$load' });\r\nconst Mount = new ProcessStageClass({ index: 2, str: 'MOUNT', methodName: '$mount' });\r\nconst Logic = new ProcessStageClass({ index: 3, str: 'LOGIC', methodName: '$logic' });\r\nconst PreRender = new ProcessStageClass({ index: 4, str: 'PRE_RENDER', methodName: '$prerender' });\r\nconst Render = new ProcessStageClass({ index: 5, str: 'RENDER', methodName: '$render' });\r\nconst Unmount = new ProcessStageClass({ index: 6, str: 'UNMOUNT', methodName: '$unmount' });\r\nconst Discard = new ProcessStageClass({ index: 7, str: 'DISCARD', methodName: '$discard' });\r\nconst typeList = [Unknown, Create, Load, Mount, Logic, PreRender, Render, Unmount, Discard];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst ProcessStage = Object.freeze({ Unknown, Create, Load, Mount, Logic, PreRender, Render, Unmount, Discard, from });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ProcessStage.ts?");

/***/ }),

/***/ "./src/foundation/definitions/RenderBufferTarget.ts":
/*!**********************************************************!*\
  !*** ./src/foundation/definitions/RenderBufferTarget.ts ***!
  \**********************************************************/
/*! exports provided: RenderBufferTarget */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RenderBufferTarget\", function() { return RenderBufferTarget; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass RenderBufferTargetClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst None = new RenderBufferTargetClass({ index: -2, str: 'NONE' });\r\nconst Back = new RenderBufferTargetClass({ index: -1, str: 'BACK' });\r\nconst ColorAttachment0 = new RenderBufferTargetClass({ index: 0, str: 'COLOR_ATTACHMENT0' });\r\nconst ColorAttachment1 = new RenderBufferTargetClass({ index: 1, str: 'COLOR_ATTACHMENT1' });\r\nconst ColorAttachment2 = new RenderBufferTargetClass({ index: 2, str: 'COLOR_ATTACHMENT2' });\r\nconst ColorAttachment3 = new RenderBufferTargetClass({ index: 3, str: 'COLOR_ATTACHMENT3' });\r\nconst ColorAttachment4 = new RenderBufferTargetClass({ index: 4, str: 'COLOR_ATTACHMENT4' });\r\nconst ColorAttachment5 = new RenderBufferTargetClass({ index: 5, str: 'COLOR_ATTACHMENT5' });\r\nconst ColorAttachment6 = new RenderBufferTargetClass({ index: 6, str: 'COLOR_ATTACHMENT6' });\r\nconst ColorAttachment7 = new RenderBufferTargetClass({ index: 7, str: 'COLOR_ATTACHMENT7' });\r\nconst ColorAttachment8 = new RenderBufferTargetClass({ index: 8, str: 'COLOR_ATTACHMENT8' });\r\nconst ColorAttachment9 = new RenderBufferTargetClass({ index: 9, str: 'COLOR_ATTACHMENT9' });\r\nconst ColorAttachment10 = new RenderBufferTargetClass({ index: 10, str: 'COLOR_ATTACHMENT10' });\r\nconst ColorAttachment11 = new RenderBufferTargetClass({ index: 11, str: 'COLOR_ATTACHMENT11' });\r\nconst ColorAttachment12 = new RenderBufferTargetClass({ index: 12, str: 'COLOR_ATTACHMENT12' });\r\nconst ColorAttachment13 = new RenderBufferTargetClass({ index: 13, str: 'COLOR_ATTACHMENT13' });\r\nconst ColorAttachment14 = new RenderBufferTargetClass({ index: 14, str: 'COLOR_ATTACHMENT14' });\r\nconst ColorAttachment15 = new RenderBufferTargetClass({ index: 15, str: 'COLOR_ATTACHMENT15' });\r\nconst typeList = [None, Back, ColorAttachment0, ColorAttachment1, ColorAttachment2, ColorAttachment3, ColorAttachment4,\r\n    ColorAttachment5, ColorAttachment6, ColorAttachment7, ColorAttachment8, ColorAttachment9, ColorAttachment10,\r\n    ColorAttachment11, ColorAttachment12, ColorAttachment13, ColorAttachment14, ColorAttachment15];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst RenderBufferTarget = Object.freeze({ None, Back, ColorAttachment0, ColorAttachment1, ColorAttachment2, ColorAttachment3, ColorAttachment4,\r\n    ColorAttachment5, ColorAttachment6, ColorAttachment7, ColorAttachment8, ColorAttachment9, ColorAttachment10,\r\n    ColorAttachment11, ColorAttachment12, ColorAttachment13, ColorAttachment14, ColorAttachment15, from });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/RenderBufferTarget.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ShaderNode.ts":
/*!**************************************************!*\
  !*** ./src/foundation/definitions/ShaderNode.ts ***!
  \**************************************************/
/*! exports provided: ShaderNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderNode\", function() { return ShaderNode; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ShaderNodeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst ClassicShading = new ShaderNodeClass({ index: 0, str: 'ClassicShading' });\r\nconst PBRShading = new ShaderNodeClass({ index: 1, str: 'PBRShading' });\r\nconst Lerp = new ShaderNodeClass({ index: 2, str: 'Lerp' });\r\nconst Add = new ShaderNodeClass({ index: 3, str: 'Add' });\r\nconst typeList = [ClassicShading, PBRShading];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst ShaderNode = Object.freeze({ ClassicShading, PBRShading, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ShaderSemantics.ts":
/*!*******************************************************!*\
  !*** ./src/foundation/definitions/ShaderSemantics.ts ***!
  \*******************************************************/
/*! exports provided: ShaderSemanticsClass, ShaderSemantics */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderSemanticsClass\", function() { return ShaderSemanticsClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderSemantics\", function() { return ShaderSemantics; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n/* harmony import */ var _CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n\r\n\r\nclass ShaderSemanticsClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ str }) {\r\n        super({ index: ++ShaderSemanticsClass.__indexCount * ShaderSemanticsClass._scale, str, noCheckStrUnique: true });\r\n        ShaderSemanticsClass.__classes[this.index] = this;\r\n    }\r\n    static getShaderSemanticByIndex(index) {\r\n        return this.__classes[Math.abs(index) - Math.abs(index) % this._scale];\r\n    }\r\n    static isNonArrayShaderSemanticIndex(index) {\r\n        if (index >= this._scale) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    static isArrayAndZeroIndexShaderSemanticIndex(index) {\r\n        if (index < 0 && Math.abs(index) % ShaderSemanticsClass._scale === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    static isArrayAndNonZeroIndexShaderSemanticIndex(index) {\r\n        if (index < 0 && Math.abs(index) % ShaderSemanticsClass._scale !== 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\nShaderSemanticsClass.__indexCount = -1;\r\nShaderSemanticsClass._scale = 10000;\r\nShaderSemanticsClass.__classes = [];\r\nconst WorldMatrix = new ShaderSemanticsClass({ str: 'worldMatrix' });\r\nconst ViewMatrix = new ShaderSemanticsClass({ str: 'viewMatrix' });\r\nconst ProjectionMatrix = new ShaderSemanticsClass({ str: 'projectionMatrix' });\r\nconst NormalMatrix = new ShaderSemanticsClass({ str: 'normalMatrix' });\r\nconst BoneMatrix = new ShaderSemanticsClass({ str: 'boneMatrix' });\r\nconst BaseColorFactor = new ShaderSemanticsClass({ str: 'baseColorFactor' });\r\nconst BaseColorTexture = new ShaderSemanticsClass({ str: 'baseColorTexture' });\r\nconst NormalTexture = new ShaderSemanticsClass({ str: 'normalTexture' });\r\nconst MetallicRoughnessTexture = new ShaderSemanticsClass({ str: 'metallicRoughnessTexture' });\r\nconst OcclusionTexture = new ShaderSemanticsClass({ str: 'occlusionTexture' });\r\nconst EmissiveTexture = new ShaderSemanticsClass({ str: 'emissiveTexture' });\r\nconst LightNumber = new ShaderSemanticsClass({ str: 'lightNumber' });\r\nconst LightPosition = new ShaderSemanticsClass({ str: 'lightPosition' });\r\nconst LightDirection = new ShaderSemanticsClass({ str: 'lightDirection' });\r\nconst LightIntensity = new ShaderSemanticsClass({ str: 'lightIntensity' });\r\nconst MetallicRoughnessFactor = new ShaderSemanticsClass({ str: 'metallicRoughnessFactor' });\r\nconst BrdfLutTexture = new ShaderSemanticsClass({ str: 'brdfLutTexture' });\r\nconst DiffuseEnvTexture = new ShaderSemanticsClass({ str: 'diffuseEnvTexture' });\r\nconst SpecularEnvTexture = new ShaderSemanticsClass({ str: 'specularEnvTexture' });\r\nconst IBLParameter = new ShaderSemanticsClass({ str: 'iblParameter' });\r\nconst ViewPosition = new ShaderSemanticsClass({ str: 'viewPosition' });\r\nconst Wireframe = new ShaderSemanticsClass({ str: 'wireframe' });\r\nconst DiffuseColorFactor = new ShaderSemanticsClass({ str: 'diffuseColorFactor' });\r\nconst DiffuseColorTexture = new ShaderSemanticsClass({ str: 'diffuseColorTexture' });\r\nconst SpecularColorFactor = new ShaderSemanticsClass({ str: 'specularColorFactor' });\r\nconst SpecularColorTexture = new ShaderSemanticsClass({ str: 'specularColorTexture' });\r\nconst Shininess = new ShaderSemanticsClass({ str: 'shininess' });\r\nconst ShadingModel = new ShaderSemanticsClass({ str: 'shadingModel' });\r\nconst SkinningMode = new ShaderSemanticsClass({ str: 'skinningMode' });\r\nconst GeneralTexture = new ShaderSemanticsClass({ str: 'generalTexture' });\r\nconst VertexAttributesExistenceArray = new ShaderSemanticsClass({ str: 'vertexAttributesExistenceArray' });\r\nconst BoneQuaternion = new ShaderSemanticsClass({ str: 'boneQuaternion' });\r\nconst BoneTranslateScale = new ShaderSemanticsClass({ str: 'boneTranslateScale' });\r\nconst BoneCompressedChunk = new ShaderSemanticsClass({ str: 'boneCompressedChunk' });\r\nconst BoneCompressedInfo = new ShaderSemanticsClass({ str: 'boneCompressedInfo' });\r\nconst PointSize = new ShaderSemanticsClass({ str: 'pointSize' });\r\nconst ColorEnvTexture = new ShaderSemanticsClass({ str: 'colorEnvTexture' });\r\nconst PointDistanceAttenuation = new ShaderSemanticsClass({ str: 'pointDistanceAttenuation' });\r\nconst HDRIFormat = new ShaderSemanticsClass({ str: 'hdriFormat' });\r\nconst ScreenInfo = new ShaderSemanticsClass({ str: 'screenInfo' });\r\nconst DepthTexture = new ShaderSemanticsClass({ str: 'depthTexture' });\r\nconst LightViewProjectionMatrix = new ShaderSemanticsClass({ str: 'lightViewProjectionMatrix' });\r\nconst Anisotropy = new ShaderSemanticsClass({ str: 'anisotropy' });\r\nconst ClearCoatParameter = new ShaderSemanticsClass({ str: 'clearcoatParameter' });\r\nconst SheenParameter = new ShaderSemanticsClass({ str: 'sheenParameter' });\r\nconst SpecularGlossinessFactor = new ShaderSemanticsClass({ str: 'specularGlossinessFactor' });\r\nconst SpecularGlossinessTexture = new ShaderSemanticsClass({ str: 'specularGlossinessTexture' });\r\nconst EntityUID = new ShaderSemanticsClass({ str: 'entityUID' });\r\nconst MorphTargetNumber = new ShaderSemanticsClass({ str: 'morphTargetNumber' });\r\nconst DataTextureMorphOffsetPosition = new ShaderSemanticsClass({ str: 'dataTextureMorphOffsetPosition' });\r\nconst MorphWeights = new ShaderSemanticsClass({ str: 'morphWeights' });\r\nconst CurrentComponentSIDs = new ShaderSemanticsClass({ str: 'currentComponentSIDs' });\r\nconst AlphaCutoff = new ShaderSemanticsClass({ str: 'alphaCutoff' });\r\nconst typeList = [WorldMatrix, ViewMatrix, ProjectionMatrix, NormalMatrix, BoneMatrix, BaseColorFactor, BaseColorTexture,\r\n    NormalTexture, MetallicRoughnessTexture, OcclusionTexture, EmissiveTexture, LightNumber, LightPosition, LightDirection, LightIntensity,\r\n    MetallicRoughnessFactor, BrdfLutTexture, DiffuseEnvTexture, SpecularEnvTexture, IBLParameter, ViewPosition, Wireframe,\r\n    DiffuseColorFactor, DiffuseColorTexture, SpecularColorFactor, SpecularColorTexture, Shininess, ShadingModel, SkinningMode, GeneralTexture,\r\n    VertexAttributesExistenceArray, BoneQuaternion, BoneTranslateScale, BoneCompressedChunk, BoneCompressedInfo, PointSize, ColorEnvTexture, PointDistanceAttenuation, HDRIFormat,\r\n    ScreenInfo, DepthTexture, LightViewProjectionMatrix, Anisotropy, ClearCoatParameter, SheenParameter, SpecularGlossinessFactor, SpecularGlossinessTexture,\r\n    EntityUID, MorphTargetNumber, DataTextureMorphOffsetPosition, MorphWeights, CurrentComponentSIDs, AlphaCutoff];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nfunction fromStringCaseSensitively(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromStringCaseSensitively\"])({ typeList, str });\r\n}\r\nfunction fullSemanticStr(info) {\r\n    let prefix = '';\r\n    if (info.prefix != null) {\r\n        prefix = info.prefix;\r\n    }\r\n    return prefix + info.semantic.str;\r\n}\r\nconst getShaderProperty = (materialTypeName, info, propertyIndex, isGlobalData) => {\r\n    if (info.isComponentData) {\r\n        return '';\r\n    }\r\n    const returnType = info.compositionType.getGlslStr(info.componentType);\r\n    let variableName = ShaderSemantics.fullSemanticStr(info);\r\n    // definition of uniform variable\r\n    const varType = info.compositionType.getGlslStr(info.componentType);\r\n    let varIndexStr = '';\r\n    if (info.maxIndex) {\r\n        varIndexStr = `[${info.maxIndex}]`;\r\n    }\r\n    let varDef = `  uniform ${varType} u_${variableName}${varIndexStr};\\n`;\r\n    // inner contents of 'get_' shader function\r\n    let str = '';\r\n    if (propertyIndex < 0 || _CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].isArray(info.compositionType)) {\r\n        if (Math.abs(propertyIndex) % ShaderSemanticsClass._scale !== 0 && !_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].isArray(info.compositionType)) {\r\n            return '';\r\n        }\r\n        if (variableName.match(/\\[.+?\\]/)) {\r\n            variableName = variableName.replace(/\\[.+?\\]/g, `[i]`);\r\n        }\r\n        else {\r\n            variableName += '[i]';\r\n        }\r\n        str += `\n    ${returnType} val;\n    for (int i=0; i<${info.maxIndex}; i++) {\n      if (i == index) {\n        val = u_${variableName};\n        break;\n      }\n    }\n    return val;\n    `;\r\n    }\r\n    else {\r\n        str += `return u_${variableName};`;\r\n    }\r\n    let funcDef = '';\r\n    const isTexture = info.compositionType === _CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Texture2D || info.compositionType === _CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].TextureCube;\r\n    if (!isTexture) {\r\n        funcDef = `\n  ${returnType} get_${info.semantic.str}(float instanceId, int index) {\n    ${str}\n  }\n`;\r\n    }\r\n    return `${varDef}${funcDef}`;\r\n};\r\nconst ShaderSemantics = Object.freeze({\r\n    from, fromString, fromStringCaseSensitively,\r\n    WorldMatrix, ViewMatrix, ProjectionMatrix, NormalMatrix, BoneMatrix, BaseColorFactor, BaseColorTexture,\r\n    NormalTexture, MetallicRoughnessTexture, OcclusionTexture, EmissiveTexture, LightNumber, LightPosition, LightDirection, LightIntensity,\r\n    MetallicRoughnessFactor, BrdfLutTexture, DiffuseEnvTexture, SpecularEnvTexture, IBLParameter, ViewPosition, Wireframe,\r\n    DiffuseColorFactor, DiffuseColorTexture, SpecularColorFactor, SpecularColorTexture, Shininess, ShadingModel, SkinningMode, GeneralTexture,\r\n    VertexAttributesExistenceArray, BoneQuaternion, BoneTranslateScale, BoneCompressedChunk, BoneCompressedInfo, PointSize, ColorEnvTexture, PointDistanceAttenuation,\r\n    HDRIFormat, ScreenInfo, DepthTexture, LightViewProjectionMatrix, Anisotropy, ClearCoatParameter, SheenParameter, SpecularGlossinessFactor, SpecularGlossinessTexture,\r\n    fullSemanticStr, getShaderProperty, EntityUID, MorphTargetNumber, DataTextureMorphOffsetPosition, MorphWeights, CurrentComponentSIDs, AlphaCutoff\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ShaderSemantics.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ShaderType.ts":
/*!**************************************************!*\
  !*** ./src/foundation/definitions/ShaderType.ts ***!
  \**************************************************/
/*! exports provided: ShaderType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderType\", function() { return ShaderType; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ShaderTypeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst VertexShader = new ShaderTypeClass({ index: 1, str: 'VertexShader' });\r\nconst PixelShader = new ShaderTypeClass({ index: 2, str: 'PixelShader' });\r\nconst VertexAndPixelShader = new ShaderTypeClass({ index: 3, str: 'VertexAndPixelShader' });\r\nconst ComputeShader = new ShaderTypeClass({ index: 4, str: 'ComputeShader' });\r\nconst typeList = [VertexShader, PixelShader, VertexAndPixelShader, ComputeShader];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst ShaderType = Object.freeze({ VertexShader, PixelShader, VertexAndPixelShader, ComputeShader, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ShaderType.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ShaderVariableUpdateInterval.ts":
/*!********************************************************************!*\
  !*** ./src/foundation/definitions/ShaderVariableUpdateInterval.ts ***!
  \********************************************************************/
/*! exports provided: ShaderVariableUpdateInterval */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderVariableUpdateInterval\", function() { return ShaderVariableUpdateInterval; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ShaderVariableUpdateIntervalClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst FirstTimeOnly = new ShaderVariableUpdateIntervalClass({ index: 0, str: 'FirstTimeOnly' });\r\nconst EveryTime = new ShaderVariableUpdateIntervalClass({ index: 1, str: 'EveryTime' });\r\nconst RenderPass = new ShaderVariableUpdateIntervalClass({ index: 2, str: 'RenderPass' });\r\nconst typeList = [FirstTimeOnly, EveryTime, RenderPass];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst ShaderVariableUpdateInterval = Object.freeze({ FirstTimeOnly, EveryTime, RenderPass, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ShaderVariableUpdateInterval.ts?");

/***/ }),

/***/ "./src/foundation/definitions/ShadingModel.ts":
/*!****************************************************!*\
  !*** ./src/foundation/definitions/ShadingModel.ts ***!
  \****************************************************/
/*! exports provided: ShadingModel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShadingModel\", function() { return ShadingModel; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass ShadingModelClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Unknown = new ShadingModelClass({ index: -1, str: 'UNKNOWN' });\r\nconst Constant = new ShadingModelClass({ index: 0, str: 'CONSTANT' });\r\nconst Lambert = new ShadingModelClass({ index: 1, str: 'LAMBERT' });\r\nconst BlinnPhong = new ShadingModelClass({ index: 2, str: 'BLINN' });\r\nconst Phong = new ShadingModelClass({ index: 3, str: 'PHONG' });\r\nconst typeList = [Unknown, Constant, Lambert, BlinnPhong, Phong];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst ShadingModel = Object.freeze({ Unknown, Constant, Lambert, BlinnPhong, Phong, from });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/ShadingModel.ts?");

/***/ }),

/***/ "./src/foundation/definitions/TextureParameter.ts":
/*!********************************************************!*\
  !*** ./src/foundation/definitions/TextureParameter.ts ***!
  \********************************************************/
/*! exports provided: TextureParameter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TextureParameter\", function() { return TextureParameter; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass TextureParameterClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Nearest = new TextureParameterClass({ index: 0x2600, str: 'NEAREST' });\r\nconst Linear = new TextureParameterClass({ index: 0x2601, str: 'LINEAR' });\r\nconst NearestMipmapNearest = new TextureParameterClass({ index: 0x2700, str: 'NEAREST_MIPMAP_NEAREST' });\r\nconst LinearMipmapNearest = new TextureParameterClass({ index: 0x2701, str: 'LINEAR_MIPMAP_NEAREST' });\r\nconst NearestMipmapLinear = new TextureParameterClass({ index: 0x2702, str: 'NEAREST_MIPMAP_LINEAR' });\r\nconst LinearMipmapLinear = new TextureParameterClass({ index: 0x2703, str: 'LINEAR_MIPMAP_LINEAR' });\r\nconst TextureMagFilter = new TextureParameterClass({ index: 0x2800, str: 'TEXTURE_MAG_FILTER' });\r\nconst TextureMinFilter = new TextureParameterClass({ index: 0x2801, str: 'TEXTURE_MIN_FILTER' });\r\nconst TextureWrapS = new TextureParameterClass({ index: 0x2802, str: 'TEXTURE_WRAP_S' });\r\nconst TextureWrapT = new TextureParameterClass({ index: 0x2803, str: 'TEXTURE_WRAP_T' });\r\nconst Texture2D = new TextureParameterClass({ index: 0x0DE1, str: 'TEXTURE_2D' });\r\nconst Texture = new TextureParameterClass({ index: 0x1702, str: 'TEXTURE' });\r\nconst Texture0 = new TextureParameterClass({ index: 0x84C0, str: 'TEXTURE0' });\r\nconst Texture1 = new TextureParameterClass({ index: 0x84C1, str: 'TEXTURE1' });\r\nconst ActiveTexture = new TextureParameterClass({ index: 0x84E0, str: 'ACTIVE_TEXTURE' });\r\nconst Repeat = new TextureParameterClass({ index: 0x2901, str: 'REPEAT' });\r\nconst ClampToEdge = new TextureParameterClass({ index: 0x812F, str: 'CLAMP_TO_EDGE' });\r\nconst MirroredRepeat = new TextureParameterClass({ index: 0x8370, str: 'MIRRORED_REPEAT' });\r\nconst RGB8 = new TextureParameterClass({ index: 0x8051, str: 'RGB8' });\r\nconst RGBA8 = new TextureParameterClass({ index: 0x8058, str: 'RGBA8' });\r\nconst RGB10_A2 = new TextureParameterClass({ index: 0x8059, str: 'RGB10_A2' });\r\nconst RGB16F = new TextureParameterClass({ index: 0x881B, str: 'RGB16F' });\r\nconst RGB32F = new TextureParameterClass({ index: 0x8815, str: 'RGB32F' });\r\nconst RGBA16F = new TextureParameterClass({ index: 0x881A, str: 'RGBA16F' });\r\nconst RGBA32F = new TextureParameterClass({ index: 0x8814, str: 'RGBA32F' });\r\nconst Depth16 = new TextureParameterClass({ index: 0x81A5, str: 'DEPTH_COMPONENT16' });\r\nconst Depth24 = new TextureParameterClass({ index: 0x81A6, str: 'DEPTH_COMPONENT24' });\r\nconst Depth32F = new TextureParameterClass({ index: 0x8CAC, str: 'DEPTH_COMPONENT32F' });\r\nconst Depth24Stencil8 = new TextureParameterClass({ index: 0x88F0, str: 'DEPTH24_STENCIL8' });\r\nconst Depth32FStencil8 = new TextureParameterClass({ index: 0x8CAD, str: 'DEPTH32F_STENCIL8' });\r\nconst typeList = [\r\n    Nearest, Linear, NearestMipmapNearest, LinearMipmapNearest, NearestMipmapLinear, LinearMipmapLinear,\r\n    TextureMagFilter, TextureMinFilter, TextureWrapS, TextureWrapT, Texture2D, Texture, Texture0, Texture1, ActiveTexture, Repeat, ClampToEdge, MirroredRepeat,\r\n    RGB8, RGBA8, RGB10_A2, RGB16F, RGB32F, RGBA16F, RGBA32F, Depth16, Depth24, Depth32F, Depth24Stencil8, Depth32FStencil8\r\n];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst TextureParameter = Object.freeze({\r\n    Nearest, Linear, NearestMipmapNearest, LinearMipmapNearest, NearestMipmapLinear, LinearMipmapLinear,\r\n    TextureMagFilter, TextureMinFilter, TextureWrapS, TextureWrapT, Texture2D, Texture, Texture0, Texture1, ActiveTexture, Repeat, ClampToEdge, MirroredRepeat,\r\n    RGB8, RGBA8, RGB10_A2, RGB16F, RGB32F, RGBA16F, RGBA32F, Depth16, Depth24, Depth32F, Depth24Stencil8, Depth32FStencil8,\r\n    from\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/TextureParameter.ts?");

/***/ }),

/***/ "./src/foundation/definitions/VertexAttribute.ts":
/*!*******************************************************!*\
  !*** ./src/foundation/definitions/VertexAttribute.ts ***!
  \*******************************************************/
/*! exports provided: VertexAttributeClass, VertexAttribute */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VertexAttributeClass\", function() { return VertexAttributeClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VertexAttribute\", function() { return VertexAttribute; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass VertexAttributeClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str, shaderStr, attributeSlot }) {\r\n        super({ index, str });\r\n        this.__attributeSlot = attributeSlot;\r\n        this.__shaderStr = shaderStr;\r\n    }\r\n    getAttributeSlot() {\r\n        return this.__attributeSlot;\r\n    }\r\n    get shaderStr() {\r\n        return this.__shaderStr;\r\n    }\r\n}\r\nconst Unknown = new VertexAttributeClass({ index: -1, str: 'UNKNOWN', shaderStr: 'a_unknown', attributeSlot: -1 });\r\nconst Position = new VertexAttributeClass({ index: 0, str: 'POSITION', shaderStr: 'a_position', attributeSlot: 0 });\r\nconst Normal = new VertexAttributeClass({ index: 1, str: 'NORMAL', shaderStr: 'a_normal', attributeSlot: 1 });\r\nconst Tangent = new VertexAttributeClass({ index: 2, str: 'TANGENT', shaderStr: 'a_tangent', attributeSlot: 2 });\r\nconst Texcoord0 = new VertexAttributeClass({ index: 3, str: 'TEXCOORD_0', shaderStr: 'a_texcoord_0', attributeSlot: 3 });\r\nconst Texcoord1 = new VertexAttributeClass({ index: 4, str: 'TEXCOORD_1', shaderStr: 'a_texcoord_1', attributeSlot: 4 });\r\nconst Color0 = new VertexAttributeClass({ index: 5, str: 'COLOR_0', shaderStr: 'a_color_0', attributeSlot: 5 });\r\nconst Joints0 = new VertexAttributeClass({ index: 6, str: 'JOINTS_0', shaderStr: 'a_joints_0', attributeSlot: 6 });\r\nconst Weights0 = new VertexAttributeClass({ index: 7, str: 'WEIGHTS_0', shaderStr: 'a_weights_0', attributeSlot: 7 });\r\nconst Instance = new VertexAttributeClass({ index: 8, str: 'INSTANCE', shaderStr: 'a_instance', attributeSlot: 8 });\r\nconst FaceNormal = new VertexAttributeClass({ index: 9, str: 'FACE_NORMAL', shaderStr: 'a_faceNormal', attributeSlot: 9 });\r\nconst BaryCentricCoord = new VertexAttributeClass({ index: 10, str: 'BARY_CENTRIC_COORD', shaderStr: 'a_baryCentricCoord', attributeSlot: 10 });\r\nconst typeList = [Unknown, Position, Normal, Tangent, Texcoord0, Texcoord1, Color0, Joints0, Weights0, Instance, FaceNormal, BaryCentricCoord];\r\nconst AttributeTypeNumber = 11;\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    let newStr = str;\r\n    if (str === 'COLOR') {\r\n        newStr = 'COLOR_0';\r\n    }\r\n    else if (str === 'TEXCOORD') {\r\n        newStr = 'TEXCOORD_0';\r\n    }\r\n    else if (str === 'JOINTS') {\r\n        newStr = 'JOINTS_0';\r\n    }\r\n    else if (str === 'WEIGHTS') {\r\n        newStr = 'WEIGHTS_0';\r\n    }\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str: newStr });\r\n}\r\nconst VertexAttribute = Object.freeze({\r\n    Unknown, Position, Normal, Tangent, Texcoord0, Texcoord1, Color0, Joints0, Weights0, Instance, FaceNormal, BaryCentricCoord, AttributeTypeNumber: AttributeTypeNumber, from, fromString\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/VertexAttribute.ts?");

/***/ }),

/***/ "./src/foundation/definitions/visibility.ts":
/*!**************************************************!*\
  !*** ./src/foundation/definitions/visibility.ts ***!
  \**************************************************/
/*! exports provided: Visibility */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Visibility\", function() { return Visibility; });\n/* harmony import */ var _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass VisibilityClass extends _misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst Neutral = new VisibilityClass({ index: 0, str: 'Neutral' });\r\nconst Visible = new VisibilityClass({ index: 1, str: 'Visible' });\r\nconst Invisible = new VisibilityClass({ index: -1, str: 'Invisible' });\r\nconst typeList = [Visible, Invisible, Neutral];\r\nfunction from(index) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nfunction fromString(str) {\r\n    return Object(_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_fromString\"])({ typeList, str });\r\n}\r\nconst Visibility = Object.freeze({ Visible, Invisible, Neutral, from, fromString });\r\n\n\n//# sourceURL=webpack:///./src/foundation/definitions/visibility.ts?");

/***/ }),

/***/ "./src/foundation/exporter/Gltf2Exporter.ts":
/*!**************************************************!*\
  !*** ./src/foundation/exporter/Gltf2Exporter.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Gltf2Exporter; });\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n\r\n\r\n/**\r\n * The glTF2 format Exporter class.\r\n */\r\nclass Gltf2Exporter {\r\n    constructor() {\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new Gltf2Exporter();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    /**\r\n     * Exports All scene data in the rhodonite system as glTF2 format.\r\n     * @param filename\r\n     */\r\n    export(filename) {\r\n        const entities = Gltf2Exporter.__entityRepository._getEntities();\r\n        const json = {\r\n            \"asset\": {\r\n                \"version\": \"2.0\",\r\n                \"generator\": `Rhodonite (${window['Rn'].VERSION})`\r\n            }\r\n        };\r\n        const fileName = filename ? filename : 'Rhodonite_' + (new Date()).getTime();\r\n        json.buffers = [{\r\n                'uri': fileName + '.bin'\r\n            }];\r\n        json.bufferViews = [];\r\n        json.accessors = [];\r\n        json.materials = [{\r\n                \"pbrMetallicRoughness\": {\r\n                    \"baseColorFactor\": [\r\n                        1.0,\r\n                        1.0,\r\n                        1.0,\r\n                        1.0\r\n                    ]\r\n                }\r\n            }];\r\n        this.countMeshes(json, entities);\r\n        this.createNodes(json, entities);\r\n        this.createMeshBinaryMetaData(json, entities);\r\n        this.createMeshes(json, entities);\r\n        this.createMaterials(json, entities);\r\n        const arraybuffer = this.createWriteBinary(json, entities);\r\n        this.download(json, fileName, arraybuffer);\r\n    }\r\n    createWriteBinary(json, entities) {\r\n        const buffer = new ArrayBuffer(json.buffers[0].byteLength);\r\n        const dataView = new DataView(buffer);\r\n        for (let i = 0; i < json.accessors.length; i++) {\r\n            const accessor = json.accessors[i];\r\n            const rnAccessor = accessor.accessor;\r\n            const compositionType = rnAccessor.compositionType;\r\n            const componentType = rnAccessor.componentType;\r\n            const dataViewSetter = rnAccessor.getDataViewSetter(componentType);\r\n            const attributeCount = accessor.count;\r\n            const bufferview = json.bufferViews[accessor.bufferView];\r\n            const bufferViewByteOffset = bufferview.byteOffset;\r\n            for (let k = 0; k < attributeCount; k++) {\r\n                if (compositionType.getNumberOfComponents() === 1) {\r\n                    const byteIndex = componentType.getSizeInBytes() * k;\r\n                    const value = rnAccessor.getScalar(k, {});\r\n                    dataView[dataViewSetter](bufferViewByteOffset + byteIndex, value, true);\r\n                }\r\n                else if (compositionType.getNumberOfComponents() === 2) {\r\n                    const array = rnAccessor.getVec2AsArray(k, {});\r\n                    for (let l = 0; l < 2; l++) {\r\n                        dataView[dataViewSetter](bufferViewByteOffset + componentType.getSizeInBytes() * (k * 2 + l), array[l], true);\r\n                    }\r\n                }\r\n                else if (compositionType.getNumberOfComponents() === 3) {\r\n                    const array = rnAccessor.getVec3AsArray(k, {});\r\n                    for (let l = 0; l < 3; l++) {\r\n                        dataView[dataViewSetter](bufferViewByteOffset + componentType.getSizeInBytes() * (k * 3 + l), array[l], true);\r\n                    }\r\n                }\r\n                else if (compositionType.getNumberOfComponents() === 4) {\r\n                    const array = rnAccessor.getVec4AsArray(k, {});\r\n                    for (let l = 0; l < 4; l++) {\r\n                        dataView[dataViewSetter](bufferViewByteOffset + componentType.getSizeInBytes() * (k * 4 + l), array[l], true);\r\n                    }\r\n                }\r\n            }\r\n            accessor.accessor = void 0;\r\n        }\r\n        return buffer;\r\n    }\r\n    countMeshes(json, entities) {\r\n        let count = 0;\r\n        json.meshes = [];\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            const meshComponent = entity.getMesh();\r\n            if (meshComponent) {\r\n                entity.gltfMeshIndex = count++;\r\n            }\r\n        }\r\n    }\r\n    createMeshes(json, entities) {\r\n        let count = 0;\r\n        json.meshes = [];\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            const meshComponent = entity.getMesh();\r\n            if (meshComponent && meshComponent.mesh) {\r\n                json.meshes[count] = {};\r\n                const mesh = json.meshes[count];\r\n                mesh.primitives = [];\r\n                const primitiveCount = meshComponent.mesh.getPrimitiveNumber();\r\n                for (let j = 0; j < primitiveCount; j++) {\r\n                    mesh.primitives[j] = {};\r\n                    const primitive = mesh.primitives[j];\r\n                    const rnPrimitive = meshComponent.mesh.getPrimitiveAt(j);\r\n                    const indicesAccessor = rnPrimitive.indicesAccessor;\r\n                    if (indicesAccessor) {\r\n                        primitive.indices = indicesAccessor.gltfAccessorIndex;\r\n                        primitive.mode = rnPrimitive.primitiveMode.index;\r\n                    }\r\n                    const attributeAccessors = rnPrimitive.attributeAccessors;\r\n                    primitive.attributes = {};\r\n                    const attributes = primitive.attributes;\r\n                    for (let k = 0; k < attributeAccessors.length; k++) {\r\n                        const attributeAccessor = attributeAccessors[k];\r\n                        attributes[rnPrimitive.attributeSemantics[k].str] = attributeAccessor.gltfAccessorIndex;\r\n                    }\r\n                    primitive.material = 0;\r\n                }\r\n                entity.gltfMeshIndex = count++;\r\n            }\r\n        }\r\n    }\r\n    createMaterials(json, entities) {\r\n        let countMesh = 0;\r\n        let countMaterial = 0;\r\n        let countTexture = 0;\r\n        let countImage = 0;\r\n        json.materials = [];\r\n        json.textures = [];\r\n        json.samplers = [];\r\n        json.images = [];\r\n        json.samplers[0] = {\r\n            \"magFilter\": 9729,\r\n            \"minFilter\": 9987,\r\n            \"wrapS\": 10497,\r\n            \"wrapT\": 10497\r\n        };\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            const meshComponent = entity.getMesh();\r\n            if (meshComponent && meshComponent.mesh) {\r\n                const mesh = json.meshes[countMesh++];\r\n                const primitiveCount = meshComponent.mesh.getPrimitiveNumber();\r\n                for (let j = 0; j < primitiveCount; j++) {\r\n                    const rnPrimitive = meshComponent.mesh.getPrimitiveAt(j);\r\n                    const primitive = mesh.primitives[j];\r\n                    const rnMaterial = rnPrimitive.material;\r\n                    const material = {\r\n                        \"pbrMetallicRoughness\": {}\r\n                    };\r\n                    let colorParam;\r\n                    let metallic = 1.0;\r\n                    let roughness = 1.0;\r\n                    if (rnMaterial != null) {\r\n                        colorParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].BaseColorFactor);\r\n                        if (colorParam == null) {\r\n                            colorParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].DiffuseColorFactor);\r\n                        }\r\n                        else {\r\n                            metallic = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].MetallicRoughnessFactor).x;\r\n                            roughness = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].MetallicRoughnessFactor).y;\r\n                        }\r\n                    }\r\n                    if (colorParam) {\r\n                        material.pbrMetallicRoughness.baseColorFactor = Array.prototype.slice.call(colorParam.v);\r\n                    }\r\n                    material.pbrMetallicRoughness.metallicFactor = metallic;\r\n                    material.pbrMetallicRoughness.roughnessFactor = roughness;\r\n                    if (rnMaterial) {\r\n                        material.alphaMode = rnMaterial.alphaMode.str;\r\n                        const processTexture = (rnTexture) => {\r\n                            if (rnTexture && rnTexture.width > 1 && rnTexture.height > 1) {\r\n                                let imageIndex = countImage;\r\n                                let match = false;\r\n                                for (let k = 0; k < json.images.length; k++) {\r\n                                    const image = json.images[k];\r\n                                    if (image.uri === rnTexture.name) {\r\n                                        imageIndex = k;\r\n                                        match = true;\r\n                                    }\r\n                                }\r\n                                if (!match) {\r\n                                    json.images[countImage++] = {\r\n                                        uri: (rnTexture.name) ? rnTexture.name : rnTexture.uniqueName\r\n                                    };\r\n                                    const htmlCanvasElement = rnTexture.htmlCanvasElement;\r\n                                    if (htmlCanvasElement) {\r\n                                        const blob = htmlCanvasElement.toBlob((blob) => {\r\n                                            setTimeout(function () {\r\n                                                var a = document.createElement('a');\r\n                                                const e = document.createEvent('MouseEvent');\r\n                                                e.initEvent(\"click\", true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n                                                a.href = URL.createObjectURL(blob);\r\n                                                a.download = rnTexture.name;\r\n                                                a.dispatchEvent(e);\r\n                                            }, Math.random() * 10000);\r\n                                        });\r\n                                    }\r\n                                }\r\n                                json.textures[countTexture] = {\r\n                                    sampler: 0,\r\n                                    source: imageIndex\r\n                                };\r\n                                return countTexture++;\r\n                            }\r\n                            return void 0;\r\n                        };\r\n                        let textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].BaseColorTexture);\r\n                        let rnTexture;\r\n                        let textureIndex;\r\n                        if (textureParam != null) {\r\n                            rnTexture = (textureParam[1]);\r\n                            textureIndex = processTexture(rnTexture);\r\n                            if (textureIndex != null) {\r\n                                material.pbrMetallicRoughness.baseColorTexture = { index: textureIndex };\r\n                            }\r\n                        }\r\n                        else {\r\n                            textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].DiffuseColorTexture);\r\n                            if (textureParam != null) {\r\n                                let rnTexture = (textureParam[1]);\r\n                                let textureIndex = processTexture(rnTexture);\r\n                                if (textureIndex != null) {\r\n                                    material.pbrMetallicRoughness.diffuseColorTexture = { index: textureIndex };\r\n                                }\r\n                            }\r\n                        }\r\n                        textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].MetallicRoughnessTexture);\r\n                        if (textureParam) {\r\n                            rnTexture = (textureParam[1]);\r\n                            textureIndex = processTexture(rnTexture);\r\n                            if (textureIndex != null) {\r\n                                material.pbrMetallicRoughness.metallicRoughnessTexture = { index: textureIndex };\r\n                            }\r\n                        }\r\n                        textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].NormalTexture);\r\n                        if (textureParam) {\r\n                            rnTexture = (textureParam[1]);\r\n                            textureIndex = processTexture(rnTexture);\r\n                            if (textureIndex != null) {\r\n                                material.normalTexture = { index: textureIndex };\r\n                            }\r\n                        }\r\n                        textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].OcclusionTexture);\r\n                        if (textureParam) {\r\n                            rnTexture = (textureParam[1]);\r\n                            textureIndex = processTexture(rnTexture);\r\n                            if (textureIndex != null) {\r\n                                material.occlusionTexture = { index: textureIndex };\r\n                            }\r\n                        }\r\n                        textureParam = rnMaterial.getParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].EmissiveTexture);\r\n                        if (textureParam) {\r\n                            rnTexture = (textureParam[1]);\r\n                            textureIndex = processTexture(rnTexture);\r\n                            if (textureIndex != null) {\r\n                                material.emissiveTexture = { index: textureIndex };\r\n                            }\r\n                        }\r\n                    }\r\n                    json.materials.push(material);\r\n                    primitive.material = countMaterial++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    createNodes(json, entities) {\r\n        json.nodes = [];\r\n        json.scenes = [{ 'nodes': [] }];\r\n        const scene = json.scenes[0];\r\n        const nodes = json.nodes;\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            entity.gltfNodeIndex = i;\r\n        }\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            nodes[i] = {};\r\n            const node = nodes[i];\r\n            // node.name\r\n            node.name = entity.uniqueName;\r\n            // node.children\r\n            node.children = [];\r\n            const sceneGraphComponent = entity.getSceneGraph();\r\n            const children = sceneGraphComponent.children;\r\n            for (let j = 0; j < children.length; j++) {\r\n                const child = children[j];\r\n                node.children.push(child.entity.gltfNodeIndex);\r\n            }\r\n            // matrix\r\n            node.matrix = Array.prototype.slice.call(entity.getTransform().matrix.v);\r\n            // mesh\r\n            node.mesh = entity.gltfMeshIndex;\r\n            if (sceneGraphComponent.parent == null) {\r\n                scene.nodes.push(i);\r\n            }\r\n        }\r\n    }\r\n    createMeshBinaryMetaData(json, entities) {\r\n        let count = 0;\r\n        let bufferByteLength = 0;\r\n        for (let i = 0; i < entities.length; i++) {\r\n            const entity = entities[i];\r\n            const meshComponent = entity.getMesh();\r\n            if (meshComponent && meshComponent.mesh) {\r\n                const primitiveCount = meshComponent.mesh.getPrimitiveNumber();\r\n                for (let j = 0; j < primitiveCount; j++) {\r\n                    const primitive = meshComponent.mesh.getPrimitiveAt(j);\r\n                    const indicesAccessor = primitive.indicesAccessor;\r\n                    if (indicesAccessor) {\r\n                        // BufferView\r\n                        let match = false;\r\n                        for (let k = 0; k < json.bufferViews.length; k++) {\r\n                            const bufferview = json.bufferViews[k];\r\n                            if (bufferview.rnAccessor === indicesAccessor) {\r\n                                match = true;\r\n                                indicesAccessor.gltfAccessorIndex = k;\r\n                            }\r\n                        }\r\n                        if (!match) {\r\n                            json.bufferViews[count] = {};\r\n                            const bufferview = json.bufferViews[count];\r\n                            bufferview.rnAccessor = indicesAccessor;\r\n                            bufferview.buffer = 0;\r\n                            bufferview.byteLength = indicesAccessor.byteLength;\r\n                            bufferview.byteOffset = bufferByteLength;\r\n                            bufferview.target = 34963;\r\n                            // Accessor\r\n                            json.accessors[count] = {};\r\n                            const accessor = json.accessors[count];\r\n                            accessor.bufferView = count;\r\n                            accessor.byteOffset = 0; //indicesAccessor.byteOffsetInBufferView;\r\n                            accessor.componentType = 5123;\r\n                            accessor.count = indicesAccessor.elementCount;\r\n                            indicesAccessor.calcMinMax();\r\n                            accessor.max = [indicesAccessor.max];\r\n                            accessor.min = [indicesAccessor.min];\r\n                            accessor.type = 'SCALAR';\r\n                            bufferByteLength += indicesAccessor.byteLength;\r\n                            indicesAccessor.gltfAccessorIndex = count;\r\n                            count++;\r\n                            accessor.accessor = indicesAccessor;\r\n                        }\r\n                    }\r\n                    const attributeAccessors = primitive.attributeAccessors;\r\n                    for (let j = 0; j < attributeAccessors.length; j++) {\r\n                        const attributeAccessor = attributeAccessors[j];\r\n                        let match = false;\r\n                        for (let k = 0; k < json.bufferViews.length; k++) {\r\n                            const bufferview = json.bufferViews[k];\r\n                            if (bufferview.rnAccessor === attributeAccessor) {\r\n                                match = true;\r\n                                attributeAccessor.gltfAccessorIndex = k;\r\n                            }\r\n                        }\r\n                        if (!match) {\r\n                            // BufferView\r\n                            json.bufferViews[count] = {};\r\n                            const bufferview = json.bufferViews[count];\r\n                            bufferview.rnAccessor = attributeAccessor;\r\n                            bufferview.buffer = 0;\r\n                            bufferview.byteLength = attributeAccessors[j].byteLength;\r\n                            bufferview.byteOffset = bufferByteLength;\r\n                            bufferview.target = 34962;\r\n                            // Accessor\r\n                            json.accessors[count] = {};\r\n                            const accessor = json.accessors[count];\r\n                            accessor.bufferView = count;\r\n                            accessor.byteOffset = 0; //attributeAccessor.byteOffsetInBufferView;\r\n                            accessor.componentType = 5126;\r\n                            accessor.count = attributeAccessor.elementCount;\r\n                            attributeAccessor.calcMinMax();\r\n                            accessor.max = Array.prototype.slice.call(attributeAccessor.max);\r\n                            accessor.min = Array.prototype.slice.call(attributeAccessor.min);\r\n                            accessor.type = 'VEC' + accessor.max.length;\r\n                            bufferByteLength += attributeAccessor.byteLength;\r\n                            attributeAccessor.gltfAccessorIndex = count;\r\n                            count++;\r\n                            accessor.accessor = attributeAccessor;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        json.bufferViews.forEach((bufferView) => {\r\n            bufferView.rnAccessor = void 0;\r\n        });\r\n        const buffer = json.buffers[0];\r\n        buffer.byteLength = bufferByteLength;\r\n    }\r\n    download(json, filename, arraybuffer) {\r\n        let a = document.createElement('a');\r\n        let e = document.createEvent('MouseEvent');\r\n        a.download = filename + '.gltf';\r\n        a.href = \"data:application/octet-stream,\" + encodeURIComponent(JSON.stringify(json));\r\n        e.initEvent(\"click\", true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n        a.dispatchEvent(e);\r\n        a = document.createElement('a');\r\n        e = document.createEvent('MouseEvent');\r\n        e.initEvent(\"click\", true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n        var blob = new Blob([arraybuffer], { type: \"octet/stream\" }), url = window.URL.createObjectURL(blob);\r\n        a.download = filename + '.bin';\r\n        a.href = url;\r\n        a.dispatchEvent(e);\r\n    }\r\n}\r\nGltf2Exporter.__entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n\n\n//# sourceURL=webpack:///./src/foundation/exporter/Gltf2Exporter.ts?");

/***/ }),

/***/ "./src/foundation/geometry/Frustum.ts":
/*!********************************************!*\
  !*** ./src/foundation/geometry/Frustum.ts ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Frustum; });\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/visibility */ \"./src/foundation/definitions/visibility.ts\");\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The view frustum class.\r\n */\r\nclass Frustum {\r\n    constructor() {\r\n        this.top = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.bottom = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.right = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.left = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.zNear = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.zFar = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].zero();\r\n        this.__updated = false;\r\n        this.__vp = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n    }\r\n    /**\r\n     * Updates this view frustum data from the view and projection matrices.\r\n     * @param viewMatrix The view matrix.\r\n     * @param projectionMatrix The projection matrix.\r\n     */\r\n    update(viewMatrix, projectionMatrix) {\r\n        _math_Matrix44__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiplyTo(projectionMatrix, viewMatrix, this.__vp);\r\n        this.zNear.x = this.__vp.m20 + this.__vp.m30;\r\n        this.zNear.y = this.__vp.m21 + this.__vp.m31;\r\n        this.zNear.z = this.__vp.m22 + this.__vp.m32;\r\n        this.zNear.w = this.__vp.m23 + this.__vp.m33;\r\n        this.zNear.normalize3();\r\n        this.zFar.x = -this.__vp.m20 + this.__vp.m30;\r\n        this.zFar.y = -this.__vp.m21 + this.__vp.m31;\r\n        this.zFar.z = -this.__vp.m22 + this.__vp.m32;\r\n        this.zFar.w = -this.__vp.m23 + this.__vp.m33;\r\n        this.zFar.normalize3();\r\n        this.bottom.x = this.__vp.m10 + this.__vp.m30;\r\n        this.bottom.y = this.__vp.m11 + this.__vp.m31;\r\n        this.bottom.z = this.__vp.m12 + this.__vp.m32;\r\n        this.bottom.w = this.__vp.m13 + this.__vp.m33;\r\n        this.bottom.normalize3();\r\n        this.top.x = -this.__vp.m10 + this.__vp.m30;\r\n        this.top.y = -this.__vp.m11 + this.__vp.m31;\r\n        this.top.z = -this.__vp.m12 + this.__vp.m32;\r\n        this.top.w = -this.__vp.m13 + this.__vp.m33;\r\n        this.top.normalize3();\r\n        this.left.x = this.__vp.m00 + this.__vp.m30;\r\n        this.left.y = this.__vp.m01 + this.__vp.m31;\r\n        this.left.z = this.__vp.m02 + this.__vp.m32;\r\n        this.left.w = this.__vp.m03 + this.__vp.m33;\r\n        this.left.normalize3();\r\n        this.right.x = -this.__vp.m00 + this.__vp.m30;\r\n        this.right.y = -this.__vp.m01 + this.__vp.m31;\r\n        this.right.z = -this.__vp.m02 + this.__vp.m32;\r\n        this.right.w = -this.__vp.m03 + this.__vp.m33;\r\n        this.right.normalize3();\r\n    }\r\n    /**\r\n     * Do clipping test (Inside / outside / neutral) of the plane of the view frustum.\r\n     * @param plane The plane of the view frustum.\r\n     * @param point The point to test.\r\n     * @param bias The bias value.\r\n     */\r\n    clipping(plane, point, bias) {\r\n        const dot = _math_Vector3__WEBPACK_IMPORTED_MODULE_3__[\"default\"].dot(plane, point);\r\n        const d = dot + plane.w;\r\n        if (d + bias < 0) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible; // outside completely\r\n        }\r\n        else if (d - bias > 0) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible; // inside completely\r\n        }\r\n        else {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Neutral; // neutral\r\n        }\r\n    }\r\n    /**\r\n     * Do culling test (Inside / outside / neutral) of the entity against to the view frustum.\r\n     * @param sg The SceneGraphComponent object of the entity.\r\n     */\r\n    culling(sg) {\r\n        const aabb = sg.worldAABB;\r\n        const center = aabb.centerPoint;\r\n        const centerToCorner = aabb.lengthCenterToCorner;\r\n        const right = this.clipping(this.right, center, centerToCorner);\r\n        const left = this.clipping(this.left, center, centerToCorner);\r\n        if (right === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible && left === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible || right === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible && left === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible;\r\n        }\r\n        const zNear = this.clipping(this.zNear, center, centerToCorner);\r\n        const zFar = this.clipping(this.zFar, center, centerToCorner);\r\n        if (zNear === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible && zFar === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible || zNear === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible && zFar === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible;\r\n        }\r\n        const top = this.clipping(this.top, center, centerToCorner);\r\n        const bottom = this.clipping(this.bottom, center, centerToCorner);\r\n        if (top === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible && bottom === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible || top === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible && bottom === _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Invisible;\r\n        }\r\n        const sum = top.index + bottom.index + right.index + left.index + zNear.index + zFar.index;\r\n        if (sum === 6) {\r\n            return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Visible;\r\n        }\r\n        return _definitions_visibility__WEBPACK_IMPORTED_MODULE_4__[\"Visibility\"].Neutral;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/geometry/Frustum.ts?");

/***/ }),

/***/ "./src/foundation/geometry/Mesh.ts":
/*!*****************************************!*\
  !*** ./src/foundation/geometry/Mesh.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Mesh; });\n/* harmony import */ var _Primitive__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_AABB__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../math/AABB */ \"./src/foundation/math/AABB.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_Entity__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../core/Entity */ \"./src/foundation/core/Entity.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The Mesh class.\r\n * This mesh object has primitives (geometries) or a reference of 'original mesh'.\r\n * If the latter, this mesh object is an 'instanced mesh', which has no primitives.\r\n * Instanced meshes refer original mesh's primitives when drawing.\r\n */\r\nclass Mesh {\r\n    constructor() {\r\n        this.__instanceIdx = 0;\r\n        this.__primitives = [];\r\n        this.__opaquePrimitives = [];\r\n        this.__transparentPrimitives = [];\r\n        this.weights = [];\r\n        this.__morphPrimitives = [];\r\n        this.__localAABB = new _math_AABB__WEBPACK_IMPORTED_MODULE_8__[\"default\"]();\r\n        this.__vaoUids = [];\r\n        this.__variationVBOUid = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__instances = [];\r\n        this._attachedEntityUID = _core_Entity__WEBPACK_IMPORTED_MODULE_10__[\"default\"].invalidEntityUID;\r\n        this.__instancesDirty = true;\r\n        this.tangentCalculationMode = 1; // 0: Off, 1: auto, 2: force calculation\r\n        this.isPreComputeForRayCastPickingEnable = false;\r\n        this.__hasFaceNormal = false;\r\n        this.__meshUID = ++Mesh.__mesh_uid_count;\r\n    }\r\n    /**\r\n     * Gets original (Non instanced) meshes.\r\n     */\r\n    static get originalMeshes() {\r\n        return this.__originalMeshes;\r\n    }\r\n    get variationVBOUid() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.variationVBOUid;\r\n        }\r\n        else {\r\n            return this.__variationVBOUid;\r\n        }\r\n    }\r\n    getVaoUids(index) {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.getVaoUids(index);\r\n        }\r\n        else {\r\n            return this.__vaoUids[index];\r\n        }\r\n    }\r\n    /**\r\n     * @private\r\n     * Adds the other mesh to this mesh as instanced meshes.\r\n     * @param mesh The other mesh.\r\n     */\r\n    _addMeshToInstanceArray(mesh) {\r\n        this.__instances.push(mesh);\r\n        this.__instancesDirty = true;\r\n    }\r\n    /**\r\n     * Adds primitive.\r\n     * @param primitive The primitive object.\r\n     */\r\n    addPrimitive(primitive) {\r\n        this.__instanceOf = void 0;\r\n        this.__instanceIdx = 0;\r\n        if (primitive.material == null || !primitive.material.isBlend()) {\r\n            this.__opaquePrimitives.push(primitive);\r\n        }\r\n        else {\r\n            this.__transparentPrimitives.push(primitive);\r\n        }\r\n        this.__primitives = this.__opaquePrimitives.concat(this.__transparentPrimitives);\r\n        Mesh.__originalMeshes.push(this);\r\n    }\r\n    /**\r\n     * Sets mesh.\r\n     * @param mesh The mesh.\r\n     */\r\n    setOriginalMesh(mesh) {\r\n        if (mesh.isInstanceMesh()) {\r\n            console.error(`Don't set InstanceMesh.`);\r\n            return false;\r\n        }\r\n        this.__primitives.length = 0;\r\n        this.__instanceOf = mesh;\r\n        mesh._addMeshToInstanceArray(this);\r\n        this.__instanceIdx = mesh.instanceIndex + 1;\r\n        // Remove this from original mesh list\r\n        Mesh.__originalMeshes = Mesh.__originalMeshes.filter(mesh => mesh !== this);\r\n        return true;\r\n    }\r\n    /**\r\n     * Gets true if these primitives are all 'Blend' type\r\n     */\r\n    isAllBlend() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.isAllBlend();\r\n        }\r\n        else {\r\n            if (this.__transparentPrimitives.length > 0 && this.__opaquePrimitives.length === 0) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets true if some primitives are 'Blend' type\r\n     */\r\n    isBlendPartially() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.isBlendPartially();\r\n        }\r\n        else {\r\n            if (this.__transparentPrimitives.length > 0 && this.__opaquePrimitives.length > 0) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets true if these primitives are all 'Opaque' type\r\n     */\r\n    isOpaque() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.isOpaque();\r\n        }\r\n        else {\r\n            if (this.__transparentPrimitives.length === 0 && this.__opaquePrimitives.length > 0) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    isFirstOpaquePrimitiveAt(index) {\r\n        if (this.isFirstOpaquePrimitiveAt(index)) {\r\n            return this.__instanceOf.isFirstOpaquePrimitiveAt(index);\r\n        }\r\n        else {\r\n            if (this.__opaquePrimitives.length > 0) {\r\n                if (index === 0) {\r\n                    return true;\r\n                }\r\n                else {\r\n                    return false;\r\n                }\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    isFirstTransparentPrimitiveAt(index) {\r\n        if (this.isFirstOpaquePrimitiveAt(index)) {\r\n            return this.__instanceOf.isFirstTransparentPrimitiveAt(index);\r\n        }\r\n        else {\r\n            if (this.__transparentPrimitives.length > 0) {\r\n                if (this.__opaquePrimitives.length === index) {\r\n                    return true;\r\n                }\r\n                else {\r\n                    return false;\r\n                }\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    __calcFaceNormalFor3Vertices(i, pos0, pos1, pos2, normalAccessor, indicesAccessor) {\r\n        // Calc normal\r\n        const ax = pos1.x - pos0.x;\r\n        const ay = pos1.y - pos0.y;\r\n        const az = pos1.z - pos0.z;\r\n        const bx = pos2.x - pos0.x;\r\n        const by = pos2.y - pos0.y;\r\n        const bz = pos2.z - pos0.z;\r\n        let nx = ay * bz - az * by; // cross product\r\n        let ny = az * bx - ax * bz;\r\n        let nz = ax * by - ay * bx;\r\n        let da = Math.hypot(nx, ny, nz); // normalize\r\n        if (da <= 1e-6) {\r\n            da = 0.0001;\r\n        }\r\n        da = 1.0 / da;\r\n        nx *= da;\r\n        ny *= da;\r\n        nz *= da;\r\n        normalAccessor.setVec3(i, nx, ny, nz, { indicesAccessor });\r\n        normalAccessor.setVec3(i + 1, nx, ny, nz, { indicesAccessor });\r\n        normalAccessor.setVec3(i + 2, nx, ny, nz, { indicesAccessor });\r\n    }\r\n    __calcTangents() {\r\n        if (this.tangentCalculationMode === 0) {\r\n            return;\r\n        }\r\n        for (let primitive of this.__primitives) {\r\n            const tangentIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Tangent);\r\n            if (tangentIdx !== -1 && this.tangentCalculationMode === 1) {\r\n                continue;\r\n            }\r\n            const texcoordIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Texcoord0);\r\n            const normalIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Normal);\r\n            if (texcoordIdx !== -1 && normalIdx !== -1) {\r\n                const positionIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n                const positionAccessor = primitive.attributeAccessors[positionIdx];\r\n                const texcoordAccessor = primitive.attributeAccessors[texcoordIdx];\r\n                const normalAccessor = primitive.attributeAccessors[normalIdx];\r\n                const indicesAccessor = primitive.indicesAccessor;\r\n                let incrementNum = 3; // PrimitiveMode.Triangles\r\n                if (primitive.primitiveMode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_2__[\"PrimitiveMode\"].TriangleStrip ||\r\n                    primitive.primitiveMode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_2__[\"PrimitiveMode\"].TriangleFan) {\r\n                    incrementNum = 1;\r\n                }\r\n                const vertexNum = primitive.getVertexCountAsIndicesBased();\r\n                const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__[\"BufferUse\"].CPUGeneric);\r\n                const tangentAttributeByteSize = positionAccessor.byteLength * 4 / 3;\r\n                const tangentBufferView = buffer.takeBufferView({ byteLengthToNeed: tangentAttributeByteSize, byteStride: 0, isAoS: false });\r\n                const tangentAccessor = tangentBufferView.takeAccessor({ compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, count: positionAccessor.elementCount });\r\n                for (let i = 0; i < vertexNum - 2; i += incrementNum) {\r\n                    const pos0 = positionAccessor.getVec3(i, { indicesAccessor });\r\n                    const pos1 = positionAccessor.getVec3(i + 1, { indicesAccessor });\r\n                    const pos2 = positionAccessor.getVec3(i + 2, { indicesAccessor });\r\n                    const uv0 = texcoordAccessor.getVec2(i, { indicesAccessor });\r\n                    const uv1 = texcoordAccessor.getVec2(i + 1, { indicesAccessor });\r\n                    const uv2 = texcoordAccessor.getVec2(i + 2, { indicesAccessor });\r\n                    const norm0 = normalAccessor.getVec3(i, { indicesAccessor });\r\n                    const norm1 = normalAccessor.getVec3(i + 1, { indicesAccessor });\r\n                    const norm2 = normalAccessor.getVec3(i + 2, { indicesAccessor });\r\n                    this.__calcTangentFor3Vertices(i, pos0, pos1, pos2, uv0, uv1, uv2, norm0, norm1, norm2, tangentAccessor, indicesAccessor);\r\n                }\r\n                primitive.setVertexAttribute(tangentAccessor, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Tangent);\r\n            }\r\n        }\r\n    }\r\n    __calcTangentFor3Vertices(i, pos0, pos1, pos2, uv0, uv1, uv2, norm0, norm1, norm2, tangentAccessor, indicesAccessor) {\r\n        const tan0Vec3 = this.__calcTangentPerVertex(pos0, pos1, pos2, uv0, uv1, uv2, norm0, norm1, norm2);\r\n        const tan1Vec3 = this.__calcTangentPerVertex(pos1, pos2, pos0, uv1, uv2, uv0, norm0, norm1, norm2);\r\n        const tan2Vec3 = this.__calcTangentPerVertex(pos2, pos0, pos1, uv2, uv0, uv1, norm0, norm1, norm2);\r\n        tangentAccessor.setVec4(i, tan0Vec3.x, tan0Vec3.y, tan0Vec3.z, 1, { indicesAccessor });\r\n        tangentAccessor.setVec4(i + 1, tan1Vec3.x, tan1Vec3.y, tan1Vec3.z, 1, { indicesAccessor });\r\n        tangentAccessor.setVec4(i + 2, tan2Vec3.x, tan2Vec3.y, tan2Vec3.z, 1, { indicesAccessor });\r\n    }\r\n    __calcTangentPerVertex(pos0Vec3, pos1Vec3, pos2Vec3, uv0Vec2, uv1Vec2, uv2Vec2, norm0Vec3, norm1Vec3, norm2Vec3) {\r\n        let cp0 = [\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos0Vec3.x, uv0Vec2.x, uv0Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos0Vec3.y, uv0Vec2.x, uv0Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos0Vec3.z, uv0Vec2.x, uv0Vec2.y)\r\n        ];\r\n        let cp1 = [\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos1Vec3.x, uv1Vec2.x, uv1Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos1Vec3.y, uv1Vec2.x, uv1Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos1Vec3.z, uv1Vec2.x, uv1Vec2.y)\r\n        ];\r\n        let cp2 = [\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos2Vec3.x, uv2Vec2.x, uv2Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos2Vec3.y, uv2Vec2.x, uv2Vec2.y),\r\n            new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos2Vec3.z, uv2Vec2.x, uv2Vec2.y)\r\n        ];\r\n        let u = [];\r\n        let v = [];\r\n        for (let i = 0; i < 3; i++) {\r\n            let v1 = _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].subtract(cp1[i], cp0[i]);\r\n            let v2 = _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].subtract(cp2[i], cp1[i]);\r\n            let abc = _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].cross(v1, v2);\r\n            let validate = Math.abs(abc.x) < Number.EPSILON;\r\n            if (validate) {\r\n                console.assert(validate, \"Polygons or polygons on UV are degenerate!\");\r\n                return new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0, 0, 0);\r\n            }\r\n            u[i] = -abc.y / abc.x;\r\n            v[i] = -abc.z / abc.x;\r\n        }\r\n        if (u[0] * u[0] + u[1] * u[1] + u[2] * u[2] < Number.EPSILON) {\r\n            const tangent = _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].cross(norm0Vec3, new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](pos1Vec3));\r\n            u[0] = tangent.x;\r\n            u[1] = tangent.y;\r\n            u[2] = tangent.z;\r\n        }\r\n        return _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"].normalize(new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](u[0], u[1], u[2]));\r\n    }\r\n    getPrimitiveAt(i) {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.getPrimitiveAt(i);\r\n        }\r\n        else {\r\n            // if (this.weights.length > 0) {\r\n            // return this.__morphPrimitives[i];\r\n            // } else {\r\n            return this.__primitives[i];\r\n            // }\r\n        }\r\n    }\r\n    getPrimitiveNumber() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.getPrimitiveNumber();\r\n        }\r\n        else {\r\n            return this.__primitives.length;\r\n        }\r\n    }\r\n    __calcFaceNormalsIfNonNormal() {\r\n        for (let primitive of this.__primitives) {\r\n            const normalIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Normal);\r\n            if (normalIdx !== -1) {\r\n                return;\r\n            }\r\n            this.__hasFaceNormal = true;\r\n            const positionIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n            const positionAccessor = primitive.attributeAccessors[positionIdx];\r\n            const indicesAccessor = primitive.indicesAccessor;\r\n            let incrementNum = 3; // PrimitiveMode.Triangles\r\n            if (primitive.primitiveMode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_2__[\"PrimitiveMode\"].TriangleStrip ||\r\n                primitive.primitiveMode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_2__[\"PrimitiveMode\"].TriangleFan) {\r\n                incrementNum = 1;\r\n            }\r\n            const vertexNum = primitive.getVertexCountAsIndicesBased();\r\n            const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__[\"BufferUse\"].CPUGeneric);\r\n            const normalAttributeByteSize = positionAccessor.byteLength;\r\n            const normalBufferView = buffer.takeBufferView({ byteLengthToNeed: normalAttributeByteSize, byteStride: 0, isAoS: false });\r\n            const normalAccessor = normalBufferView.takeAccessor({ compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec3, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, count: positionAccessor.elementCount });\r\n            for (let i = 0; i < vertexNum - 2; i += incrementNum) {\r\n                const pos0 = positionAccessor.getVec3(i, { indicesAccessor });\r\n                const pos1 = positionAccessor.getVec3(i + 1, { indicesAccessor });\r\n                const pos2 = positionAccessor.getVec3(i + 2, { indicesAccessor });\r\n                this.__calcFaceNormalFor3Vertices(i, pos0, pos1, pos2, normalAccessor, indicesAccessor);\r\n            }\r\n            primitive.setVertexAttribute(normalAccessor, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Normal);\r\n        }\r\n    }\r\n    makeVerticesSeparated() {\r\n        for (let primitive of this.__primitives) {\r\n            if (primitive.hasIndices()) {\r\n                const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__[\"BufferUse\"].CPUGeneric);\r\n                const vertexCount = primitive.getVertexCountAsIndicesBased();\r\n                const indexAccessor = primitive.indicesAccessor;\r\n                for (let i in primitive.attributeAccessors) {\r\n                    const attributeAccessor = primitive.attributeAccessors[i];\r\n                    const elementSizeInBytes = attributeAccessor.elementSizeInBytes;\r\n                    const bufferView = buffer.takeBufferView({ byteLengthToNeed: elementSizeInBytes * vertexCount, byteStride: 0, isAoS: false });\r\n                    const newAccessor = bufferView.takeAccessor({ compositionType: attributeAccessor.compositionType, componentType: attributeAccessor.componentType, count: vertexCount });\r\n                    for (let j = 0; j < vertexCount; j++) {\r\n                        const idx = indexAccessor.getScalar(j, {});\r\n                        newAccessor.setElementFromSameCompositionAccessor(j, attributeAccessor, idx);\r\n                    }\r\n                    primitive.setVertexAttribute(newAccessor, primitive.attributeSemantics[i]);\r\n                }\r\n                const indicesAccessor = primitive.indicesAccessor;\r\n                const elementSizeInBytes = indicesAccessor.elementSizeInBytes;\r\n                const bufferView = buffer.takeBufferView({ byteLengthToNeed: elementSizeInBytes * vertexCount, byteStride: 0, isAoS: false });\r\n                const newAccessor = bufferView.takeAccessor({ compositionType: indicesAccessor.compositionType, componentType: indicesAccessor.componentType, count: vertexCount });\r\n                for (let j = 0; j < vertexCount; j++) {\r\n                    //const idx = indexAccessor!.getScalar(j, {});\r\n                    newAccessor.setScalar(j, j, {});\r\n                }\r\n                primitive.setIndices(newAccessor);\r\n            }\r\n        }\r\n    }\r\n    __calcBaryCentricCoord() {\r\n        for (let primitive_i in this.__primitives) {\r\n            let primitive = this.__primitives[primitive_i];\r\n            const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__[\"BufferUse\"].CPUGeneric);\r\n            const positionIdx = primitive.attributeSemantics.indexOf(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n            const positionAccessor = primitive.attributeAccessors[positionIdx];\r\n            const indicesAccessor = primitive.indicesAccessor;\r\n            const vertexNum = positionAccessor.elementCount;\r\n            let num = vertexNum;\r\n            const baryCentricCoordAttributeByteSize = num * 4 /* vec4 */ * 4 /* bytes */;\r\n            const baryCentricCoordBufferView = buffer.takeBufferView({ byteLengthToNeed: baryCentricCoordAttributeByteSize, byteStride: 0, isAoS: false });\r\n            const baryCentricCoordAccessor = baryCentricCoordBufferView.takeAccessor({ compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float, count: num });\r\n            for (let ver_i = 0; ver_i < num; ver_i++) {\r\n                let idx = ver_i;\r\n                // if (indicesAccessor) {\r\n                //   idx = indicesAccessor!.getScalar(ver_i, {});\r\n                // }\r\n                baryCentricCoordAccessor.setVec4(ver_i, ver_i % 3 === 0 ? 1 : 0, // 1 0 0  1 0 0  1 0 0,\r\n                ver_i % 3 === 1 ? 1 : 0, // 0 1 0  0 1 0  0 1 0,\r\n                ver_i % 3 === 2 ? 1 : 0, // 0 0 1  0 0 1  0 0 1,\r\n                ver_i, {});\r\n            }\r\n            primitive.setVertexAttribute(baryCentricCoordAccessor, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].BaryCentricCoord);\r\n        }\r\n    }\r\n    __initMorphPrimitives() {\r\n        if (this.weights.length === 0) {\r\n            return;\r\n        }\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_4__[\"BufferUse\"].CPUGeneric);\r\n        for (let i = 0; i < this.__primitives.length; i++) {\r\n            const primitive = this.__primitives[i];\r\n            if (this.__morphPrimitives[i] == null) {\r\n                const target = primitive.targets[0];\r\n                const map = new Map();\r\n                target.forEach((accessor, semantic) => {\r\n                    const bufferView = buffer.takeBufferView({ byteLengthToNeed: accessor.byteLength, byteStride: 0, isAoS: false });\r\n                    const morphAccessor = bufferView.takeAccessor({ compositionType: accessor.compositionType, componentType: accessor.componentType, count: accessor.elementCount });\r\n                    map.set(semantic, morphAccessor);\r\n                });\r\n                const morphPrimitive = new _Primitive__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\n                morphPrimitive.setData(map, primitive.primitiveMode, primitive.material, primitive.indicesAccessor);\r\n                morphPrimitive.setTargets(primitive.targets);\r\n                this.__morphPrimitives[i] = morphPrimitive;\r\n            }\r\n        }\r\n    }\r\n    __calcMorphPrimitives() {\r\n        if (this.weights.length === 0) {\r\n            return;\r\n        }\r\n        for (let i = 0; i < this.__primitives.length; i++) {\r\n            const morphPrimitive = this.__morphPrimitives[i];\r\n            const primitive = this.__primitives[i];\r\n            const target0Attributes = primitive.targets[0];\r\n            target0Attributes.forEach((accessor, semantic) => {\r\n                const morphAccessor = morphPrimitive.getAttribute(semantic);\r\n                const elementCount = morphAccessor.elementCount;\r\n                for (let j = 0; j < elementCount; j++) {\r\n                    morphAccessor.setElementFromSameCompositionAccessor(j, primitive.getAttribute(semantic));\r\n                }\r\n            });\r\n            // primitive.targets.forEach((targetAttributes, k)=>{\r\n            //   targetAttributes.forEach((accessor, semantic) => {\r\n            //     const morphAccessor = morphPrimitive.getAttribute(semantic)!;\r\n            //     const elementCount = morphAccessor.elementCount;\r\n            //     for (let j = 0; j < elementCount; j++) {\r\n            //       morphAccessor.addElementFromSameCompositionAccessor(j, accessor, this.weights[k]);\r\n            //     }\r\n            //   });\r\n            // });\r\n        }\r\n    }\r\n    /**\r\n     * Gets AABB in local space.\r\n     */\r\n    get AABB() {\r\n        if (this.__localAABB.isVanilla()) {\r\n            for (let primitive of this.__primitives) {\r\n                this.__localAABB.mergeAABB(primitive.AABB);\r\n            }\r\n        }\r\n        return this.__localAABB;\r\n    }\r\n    get instanceIndex() {\r\n        return this.__instanceIdx;\r\n    }\r\n    isInstanceMesh() {\r\n        if (this.__instanceOf != null) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isOriginalMesh() {\r\n        return !this.isInstanceMesh();\r\n    }\r\n    get meshUID() {\r\n        return this.__meshUID;\r\n    }\r\n    updateVariationVBO() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.updateVariationVBO();\r\n        }\r\n        else {\r\n            if (!this.__instancesDirty) {\r\n                return false;\r\n            }\r\n            const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getWebGLResourceRepository();\r\n            this.__primitives.forEach((prim, i) => {\r\n                this.__vaoUids[i] = webglResourceRepository.createVertexArray();\r\n            });\r\n            if (this.__variationVBOUid != _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__[\"default\"].InvalidCGAPIResourceUid) {\r\n                webglResourceRepository.deleteVertexBuffer(this.__variationVBOUid);\r\n            }\r\n            const instanceNum = this.__instances.length;\r\n            const entityUIDs = new Float32Array(instanceNum + 1); // instances and original\r\n            entityUIDs[0] = this._attachedEntityUID;\r\n            for (var i = 0; i < instanceNum; i++) {\r\n                entityUIDs[i + 1] = this.__instances[i]._attachedEntityUID;\r\n            }\r\n            this.__variationVBOUid = webglResourceRepository.createVertexBufferFromTypedArray(entityUIDs);\r\n            this.__instancesDirty = false;\r\n            return true;\r\n        }\r\n    }\r\n    deleteVariationVBO() {\r\n        if (this.isInstanceMesh()) {\r\n            return this.__instanceOf.updateVariationVBO();\r\n        }\r\n        else {\r\n            const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getWebGLResourceRepository();\r\n            if (this.__variationVBOUid !== _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_9__[\"default\"].InvalidCGAPIResourceUid) {\r\n                webglResourceRepository.deleteVertexBuffer(this.__variationVBOUid);\r\n                this.__vaoUids.forEach((vaoUid) => {\r\n                    webglResourceRepository.deleteVertexArray(vaoUid);\r\n                });\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    get instanceCountIncludeOriginal() {\r\n        return this.__instances.length + 1;\r\n    }\r\n    castRay(srcPointInLocal, directionInLocal, dotThreshold = 0) {\r\n        let finalShortestIntersectedPosVec3;\r\n        let finalShortestT = Number.MAX_VALUE;\r\n        for (let primitive of this.__primitives) {\r\n            const { currentShortestIntersectedPosVec3, currentShortestT } = primitive.castRay(srcPointInLocal, directionInLocal, true, true, dotThreshold, this.__hasFaceNormal);\r\n            if (currentShortestT != null && currentShortestT < finalShortestT) {\r\n                finalShortestT = currentShortestT;\r\n                finalShortestIntersectedPosVec3 = currentShortestIntersectedPosVec3;\r\n            }\r\n        }\r\n        if (finalShortestT === Number.MAX_VALUE) {\r\n            finalShortestT === -1;\r\n        }\r\n        return { t: finalShortestT, intersectedPosition: finalShortestIntersectedPosVec3 };\r\n    }\r\n    _calcArenbergInverseMatrices() {\r\n        if (this.isPreComputeForRayCastPickingEnable) {\r\n            for (let primitive of this.__primitives) {\r\n                primitive._calcArenbergInverseMatrices();\r\n            }\r\n        }\r\n    }\r\n}\r\nMesh.invalidateMeshUID = -1;\r\nMesh.__mesh_uid_count = Mesh.invalidateMeshUID;\r\nMesh.__originalMeshes = [];\r\n\n\n//# sourceURL=webpack:///./src/foundation/geometry/Mesh.ts?");

/***/ }),

/***/ "./src/foundation/geometry/Plane.ts":
/*!******************************************!*\
  !*** ./src/foundation/geometry/Plane.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Plane; });\n/* harmony import */ var _Primitive__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass Plane extends _Primitive__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Generates a plane object\r\n     * @param width the length of U(X)-axis direction\r\n     * @param height the length of V(Y)-axis direction\r\n     * @param uSpan number of spans in U(X)-axis direction\r\n     * @param vSpan number of spans in V(Y)-axis direction\r\n     * @param isUVRepeat draw uSpan times vSpan number of textures\r\n     * @param flipTextureCoordinateY draw textures by flipping on the V(Y)-axis\r\n     * @param material attach a rhodonite material to this plane(the default material is the classicUberMaterial)\r\n     */\r\n    generate({ width, height, uSpan, vSpan, isUVRepeat = false, flipTextureCoordinateY = false, material }) {\r\n        var positions = [];\r\n        for (let i = 0; i <= vSpan; i++) {\r\n            for (let j = 0; j <= uSpan; j++) {\r\n                positions.push((j / uSpan - 1 / 2) * width);\r\n                positions.push(0);\r\n                positions.push((i / vSpan - 1 / 2) * height);\r\n            }\r\n        }\r\n        var indices = [];\r\n        for (let i = 0; i < vSpan; i++) {\r\n            let degenerate_left_index = 0;\r\n            let degenerate_right_index = 0;\r\n            for (let j = 0; j <= uSpan; j++) {\r\n                indices.push(i * (uSpan + 1) + j);\r\n                indices.push((i + 1) * (uSpan + 1) + j);\r\n                if (j === 0) {\r\n                    degenerate_left_index = (i + 1) * (uSpan + 1) + j;\r\n                }\r\n                else if (j === uSpan) {\r\n                    degenerate_right_index = (i + 1) * (uSpan + 1) + j;\r\n                }\r\n            }\r\n            indices.push(degenerate_right_index);\r\n            indices.push(degenerate_left_index);\r\n        }\r\n        var normals = [];\r\n        for (let i = 0; i <= vSpan; i++) {\r\n            for (let j = 0; j <= uSpan; j++) {\r\n                normals.push(0);\r\n                normals.push(1);\r\n                normals.push(0);\r\n            }\r\n        }\r\n        var texcoords = [];\r\n        for (let i = 0; i <= vSpan; i++) {\r\n            const i_ = flipTextureCoordinateY ? i : vSpan - i;\r\n            for (let j = 0; j <= uSpan; j++) {\r\n                if (isUVRepeat) {\r\n                    texcoords.push(j);\r\n                    texcoords.push(i_);\r\n                }\r\n                else {\r\n                    texcoords.push(j / uSpan);\r\n                    texcoords.push(i_ / vSpan);\r\n                }\r\n            }\r\n        }\r\n        // Check Size\r\n        const attributeCompositionTypes = [_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec3, _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec3, _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec2];\r\n        const attributeSemantics = [_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Position, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Normal, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Texcoord0];\r\n        const primitiveMode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_3__[\"PrimitiveMode\"].TriangleStrip;\r\n        const attributes = [new Float32Array(positions), new Float32Array(normals), new Float32Array(texcoords)];\r\n        let sumOfAttributesByteSize = 0;\r\n        attributes.forEach(attribute => {\r\n            sumOfAttributesByteSize += attribute.byteLength;\r\n        });\r\n        const indexSizeInByte = indices.length * 2;\r\n        // Create Buffer\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().createBufferOnDemand(indexSizeInByte + sumOfAttributesByteSize, this);\r\n        // Index Buffer\r\n        const indicesBufferView = buffer.takeBufferView({ byteLengthToNeed: indexSizeInByte /*byte*/, byteStride: 0, isAoS: false });\r\n        const indicesAccessor = indicesBufferView.takeAccessor({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedShort,\r\n            count: indices.length\r\n        });\r\n        for (let i = 0; i < indices.length; i++) {\r\n            indicesAccessor.setScalar(i, indices[i], {});\r\n        }\r\n        // VertexBuffer\r\n        const attributesBufferView = buffer.takeBufferView({ byteLengthToNeed: sumOfAttributesByteSize, byteStride: 0, isAoS: false });\r\n        const attributeAccessors = [];\r\n        const attributeComponentTypes = [];\r\n        attributes.forEach((attribute, i) => {\r\n            attributeComponentTypes[i] = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].fromTypedArray(attributes[i]);\r\n            const accessor = attributesBufferView.takeAccessor({\r\n                compositionType: attributeCompositionTypes[i],\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].fromTypedArray(attributes[i]),\r\n                count: attribute.byteLength / attributeCompositionTypes[i].getNumberOfComponents() / attributeComponentTypes[i].getSizeInBytes()\r\n            });\r\n            accessor.copyFromTypedArray(attribute);\r\n            attributeAccessors.push(accessor);\r\n        });\r\n        const attributeMap = new Map();\r\n        for (let i = 0; i < attributeSemantics.length; i++) {\r\n            attributeMap.set(attributeSemantics[i], attributeAccessors[i]);\r\n        }\r\n        this.setData(attributeMap, primitiveMode, material, indicesAccessor);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/geometry/Plane.ts?");

/***/ }),

/***/ "./src/foundation/geometry/Primitive.ts":
/*!**********************************************!*\
  !*** ./src/foundation/geometry/Primitive.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Primitive; });\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_AABB__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/AABB */ \"./src/foundation/math/AABB.ts\");\n/* harmony import */ var _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../helpers/MaterialHelper */ \"./src/foundation/helpers/MaterialHelper.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Primitive extends _core_RnObject__WEBPACK_IMPORTED_MODULE_2__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__mode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].Unknown;\r\n        this.__material = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_7__[\"default\"].createEmptyMaterial();\r\n        this._prevMaterial = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_7__[\"default\"].createEmptyMaterial();\r\n        this.__attributes = new Map();\r\n        this.__primitiveUid = -1; // start ID from zero\r\n        this.__aabb = new _math_AABB__WEBPACK_IMPORTED_MODULE_6__[\"default\"]();\r\n        this.__targets = [];\r\n        this.__inverseArenbergMatrix = [];\r\n        this.__arenberg3rdPosition = [];\r\n    }\r\n    set material(mat) {\r\n        this.__material = mat;\r\n    }\r\n    get material() {\r\n        return this.__material;\r\n    }\r\n    _backupMaterial() {\r\n        this._prevMaterial = this.__material;\r\n    }\r\n    _restoreMaterial() {\r\n        this.__material = this._prevMaterial;\r\n    }\r\n    setData(attributes, mode, material, indicesAccessor) {\r\n        this.__indices = indicesAccessor;\r\n        this.__attributes = attributes;\r\n        if (material != null) {\r\n            this.material = material;\r\n        }\r\n        else {\r\n            this.material = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_7__[\"default\"].createClassicUberMaterial({ isSkinning: true, isLighting: true });\r\n        }\r\n        this.__mode = mode;\r\n        this.__primitiveUid = Primitive.__primitiveCount++;\r\n        // if (Primitive.__headerAccessor == null) {\r\n        //   // primitive 0\r\n        //   // prim0.indices.byteOffset, prim0.indices.componentSizeInByte, prim0.indices.indicesLength, null\r\n        //   //   prim0.attrb0.byteOffset, prim0.attrib0.byteStride, prim0.attrib0.compositionN, prim0.attrib0.componentSizeInByte\r\n        //   //   prim0.attrb1.byteOffset, prim0.attrib1.byteStride, prim0.attrib1.compositionN, prim0.attrib1.componentSizeInByte\r\n        //   //   ...\r\n        //   //   prim0.attrb7.byteOffset, prim0.attrib7.byteStride, prim0.attrib7.compositionN, prim0.attrib7.componentSizeInByte\r\n        //   // primitive 1\r\n        //   // prim1.indices.byteOffset, prim1.indices.componentSizeInByte, prim0.indices.indicesLength, null\r\n        //   //   prim1.attrb0.byteOffset, prim1.attrib0.byteStride, prim1.attrib0.compositionN, prim1.attrib0.componentSizeInByte\r\n        //   //   prim1.attrb1.byteOffset, prim1.attrib1.byteStride, prim1.attrib1.compositionN, prim1.attrib1.componentSizeInByte\r\n        //   //   ...\r\n        //   //   prim1.attrb7.byteOffset, prim1.attrib7.byteStride, prim1.attrib7.compositionN, prim1.attrib7.componentSizeInByte\r\n        //   const buffer = MemoryManager.getInstance().createOrGetBuffer(BufferUse.UBOGeneric);\r\n        //   const bufferView = buffer.takeBufferView({byteLengthToNeed: ((1*4) + (8*4)) * 4/*byte*/ * Primitive.maxPrimitiveCount, byteStride: 64, isAoS:false });\r\n        //   Primitive.__headerAccessor = bufferView.takeAccessor(\r\n        //     {compositionType: CompositionType.Vec4, componentType: ComponentType.Float, count: 9 * Primitive.maxPrimitiveCount})\r\n        // }\r\n        // const attributeNumOfPrimitive = 1/*indices*/ + 8/*vertexAttributes*/;\r\n        // if (this.indicesAccessor != null) {\r\n        //   Primitive.__headerAccessor.setVec4(attributeNumOfPrimitive * this.__primitiveUid + 0 /* 0 means indices */,\r\n        //     this.indicesAccessor.byteOffsetInBuffer, this.indicesAccessor.componentSizeInBytes, this.indicesAccessor.byteLength / this.indicesAccessor.componentSizeInBytes, -1 );\r\n        // } else {\r\n        //   Primitive.__headerAccessor.setVec4(attributeNumOfPrimitive * this.__primitiveUid + 0 /* 0 means indices */, -1, -1, -1, -1 );\r\n        // }\r\n        // this.attributeAccessors.forEach((attributeAccessor, i)=>{\r\n        //   Primitive.__headerAccessor!.setVec4(attributeNumOfPrimitive * this.__primitiveUid + i,\r\n        //     attributeAccessor.byteOffsetInBuffer, attributeAccessor.byteStride, attributeAccessor.numberOfComponents, attributeAccessor.componentSizeInBytes);\r\n        // });\r\n    }\r\n    static get maxPrimitiveCount() {\r\n        return 500;\r\n    }\r\n    static get headerAccessor() {\r\n        return this.__headerAccessor;\r\n    }\r\n    static createPrimitive({ indices, attributeCompositionTypes, attributeSemantics, attributes, material, primitiveMode }) {\r\n        let sumOfAttributesByteSize = 0;\r\n        attributes.forEach(attribute => {\r\n            sumOfAttributesByteSize += attribute.byteLength;\r\n        });\r\n        let bufferSize = sumOfAttributesByteSize;\r\n        if (indices != null) {\r\n            bufferSize += indices.byteLength;\r\n        }\r\n        const primitive = new Primitive();\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().createBufferOnDemand(bufferSize, primitive);\r\n        let indicesComponentType;\r\n        let indicesBufferView;\r\n        let indicesAccessor;\r\n        if (indices != null) {\r\n            indicesComponentType = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].fromTypedArray(indices);\r\n            indicesBufferView = buffer.takeBufferView({ byteLengthToNeed: indices.byteLength, byteStride: 0, isAoS: false });\r\n            indicesAccessor = indicesBufferView.takeAccessor({\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_5__[\"CompositionType\"].Scalar,\r\n                componentType: indicesComponentType,\r\n                count: indices.byteLength / indicesComponentType.getSizeInBytes()\r\n            });\r\n            // copy indices\r\n            for (let i = 0; i < indices.byteLength / indicesAccessor.componentSizeInBytes; i++) {\r\n                indicesAccessor.setScalar(i, indices[i], {});\r\n            }\r\n        }\r\n        const attributesBufferView = buffer.takeBufferView({ byteLengthToNeed: sumOfAttributesByteSize, byteStride: 0, isAoS: false });\r\n        const attributeAccessors = [];\r\n        const attributeComponentTypes = [];\r\n        attributes.forEach((attribute, i) => {\r\n            attributeComponentTypes[i] = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].fromTypedArray(attributes[i]);\r\n            const accessor = attributesBufferView.takeAccessor({\r\n                compositionType: attributeCompositionTypes[i],\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].fromTypedArray(attributes[i]),\r\n                count: attribute.byteLength / attributeCompositionTypes[i].getNumberOfComponents() / attributeComponentTypes[i].getSizeInBytes()\r\n            });\r\n            accessor.copyFromTypedArray(attribute);\r\n            attributeAccessors.push(accessor);\r\n        });\r\n        const attributeMap = new Map();\r\n        for (let i = 0; i < attributeSemantics.length; i++) {\r\n            attributeMap.set(attributeSemantics[i], attributeAccessors[i]);\r\n        }\r\n        primitive.setData(attributeMap, primitiveMode, material, indicesAccessor);\r\n        return primitive;\r\n    }\r\n    get indicesAccessor() {\r\n        return this.__indices;\r\n    }\r\n    getVertexCountAsIndicesBased() {\r\n        if (this.indicesAccessor) {\r\n            return this.indicesAccessor.elementCount;\r\n        }\r\n        else {\r\n            return this.getVertexCountAsVerticesBased();\r\n        }\r\n    }\r\n    getVertexCountAsVerticesBased() {\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        return positionAccessor.elementCount;\r\n    }\r\n    getTriangleCountAsIndicesBased() {\r\n        if (this.indicesAccessor) {\r\n            switch (this.__mode) {\r\n                case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].Triangles:\r\n                    return this.indicesAccessor.elementCount / 3;\r\n                case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleStrip:\r\n                    return this.indicesAccessor.elementCount - 2;\r\n                case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleFan:\r\n                    return this.indicesAccessor.elementCount - 2;\r\n                default:\r\n                    return 0;\r\n            }\r\n        }\r\n        else {\r\n            return this.getTriangleCountAsVerticesBased();\r\n        }\r\n    }\r\n    getTriangleCountAsVerticesBased() {\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        switch (this.__mode) {\r\n            case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].Triangles:\r\n                return positionAccessor.elementCount / 3;\r\n            case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleStrip:\r\n                return positionAccessor.elementCount - 2;\r\n            case _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleFan:\r\n                return positionAccessor.elementCount - 2;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    hasIndices() {\r\n        return this.__indices != null;\r\n    }\r\n    get attributeAccessors() {\r\n        const accessors = [];\r\n        this.__attributes.forEach((accessor, semantic) => {\r\n            accessors.push(accessor);\r\n        });\r\n        return accessors;\r\n    }\r\n    getAttribute(semantic) {\r\n        return this.__attributes.get(semantic);\r\n    }\r\n    get attributeSemantics() {\r\n        const semantics = [];\r\n        this.__attributes.forEach((accessor, semantic) => {\r\n            semantics.push(semantic);\r\n        });\r\n        return semantics;\r\n    }\r\n    get attributeEntries() {\r\n        return this.__attributes.entries();\r\n    }\r\n    get attributeCompositionTypes() {\r\n        const types = [];\r\n        this.__attributes.forEach((accessor, semantic) => {\r\n            types.push(accessor.compositionType);\r\n        });\r\n        return types;\r\n    }\r\n    get attributeComponentTypes() {\r\n        const types = [];\r\n        this.__attributes.forEach((accessor, semantic) => {\r\n            types.push(accessor.componentType);\r\n        });\r\n        return types;\r\n    }\r\n    get primitiveMode() {\r\n        return this.__mode;\r\n    }\r\n    get primitiveUid() {\r\n        return this.__primitiveUid;\r\n    }\r\n    get AABB() {\r\n        if (this.__aabb.isVanilla()) {\r\n            const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n            if (positionAccessor.min == null || positionAccessor.max == null) {\r\n                positionAccessor.calcMinMax();\r\n            }\r\n            this.__aabb.minPoint = positionAccessor.min;\r\n            this.__aabb.maxPoint = positionAccessor.max;\r\n        }\r\n        return this.__aabb;\r\n    }\r\n    setVertexAttribute(accessor, vertexSemantics) {\r\n        this.__attributes.set(vertexSemantics, accessor);\r\n    }\r\n    removeIndices() {\r\n        this.__indices = undefined;\r\n    }\r\n    setIndices(accessor) {\r\n        this.__indices = accessor;\r\n    }\r\n    setTargets(targets) {\r\n        this.__targets = targets;\r\n    }\r\n    get targets() {\r\n        return this.__targets;\r\n    }\r\n    isBlend() {\r\n        if (this.material == null || !this.material.isBlend()) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n    isOpaque() {\r\n        return !this.isBlend();\r\n    }\r\n    create3DAPIVertexData() {\r\n        if (this.__vertexHandles != null) {\r\n            return false;\r\n        }\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getWebGLResourceRepository();\r\n        this.__vertexHandles = webglResourceRepository.createVertexBufferAndIndexBuffer(this);\r\n        return true;\r\n    }\r\n    delete3DAPIVertexData() {\r\n        if (this.__vertexHandles == null) {\r\n            return false;\r\n        }\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.deleteVertexDataResources(this.__vertexHandles);\r\n        return true;\r\n    }\r\n    get vertexHandles() {\r\n        return this.__vertexHandles;\r\n    }\r\n    castRay(origVec3, dirVec3, isFrontFacePickable, isBackFacePickable, dotThreshold, hasFaceNormal) {\r\n        let currentShortestT = Number.MAX_VALUE;\r\n        let currentShortestIntersectedPosVec3 = null;\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        // const positionElementNumPerVertex = this._vertices.components.position;\r\n        let incrementNum = 3; // gl.TRIANGLES\r\n        if (this.__mode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleStrip) {\r\n            // gl.TRIANGLE_STRIP\r\n            incrementNum = 1;\r\n        }\r\n        else if (this.__mode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].Points) {\r\n            return { currentShortestIntersectedPosVec3, currentShortestT };\r\n        }\r\n        if (this.hasIndices()) {\r\n            for (let i = 0; i < this.__indices.elementCount - 2; i++) {\r\n                const j = i * incrementNum;\r\n                if (j + 2 > this.__indices.elementCount - 1) {\r\n                    // gl.TRIANGLES\r\n                    break;\r\n                }\r\n                let pos0IndexBase = this.__indices.getScalar(j, {});\r\n                let pos1IndexBase = this.__indices.getScalar(j + 1, {});\r\n                let pos2IndexBase = this.__indices.getScalar(j + 2, {});\r\n                const result = this.__castRayInner(origVec3, dirVec3, i, pos0IndexBase, pos1IndexBase, pos2IndexBase, isFrontFacePickable, isBackFacePickable, dotThreshold, hasFaceNormal);\r\n                if (result === null) {\r\n                    continue;\r\n                }\r\n                const t = result[0];\r\n                if (result[0] < currentShortestT) {\r\n                    currentShortestT = t;\r\n                    currentShortestIntersectedPosVec3 = result[1];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < positionAccessor.elementCount; i += incrementNum) {\r\n                const pos0IndexBase = i;\r\n                const pos1IndexBase = i + 1;\r\n                const pos2IndexBase = i + 2;\r\n                const result = this.__castRayInner(origVec3, dirVec3, i, pos0IndexBase, pos1IndexBase, pos2IndexBase, isFrontFacePickable, isBackFacePickable, dotThreshold, hasFaceNormal);\r\n                if (result === null) {\r\n                    continue;\r\n                }\r\n                const t = result[0];\r\n                if (result[0] < currentShortestT) {\r\n                    currentShortestT = t;\r\n                    currentShortestIntersectedPosVec3 = result[1];\r\n                }\r\n            }\r\n        }\r\n        return { currentShortestIntersectedPosVec3, currentShortestT };\r\n    }\r\n    __castRayInner(origVec3, dirVec3, i, pos0IndexBase, pos1IndexBase, pos2IndexBase, isFrontFacePickable, isBackFacePickable, dotThreshold, hasFaceNormal) {\r\n        if (!this.__arenberg3rdPosition[i]) {\r\n            return null;\r\n        }\r\n        if (hasFaceNormal) {\r\n            const normalAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Normal);\r\n            if (normalAccessor) {\r\n                const normal = normalAccessor.getVec3(i, {});\r\n                if (normal.dot(dirVec3) < dotThreshold && !isFrontFacePickable) {\r\n                    return null;\r\n                }\r\n                if (normal.dot(dirVec3) > -dotThreshold && !isBackFacePickable) {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n        const vec3 = _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].subtract(origVec3, this.__arenberg3rdPosition[i]);\r\n        const convertedOrigVec3 = this.__inverseArenbergMatrix[i].multiplyVector(vec3);\r\n        const convertedDirVec3 = this.__inverseArenbergMatrix[i].multiplyVector(dirVec3);\r\n        if (convertedDirVec3.z >= -1e-6 && convertedDirVec3.z <= 1e-6) {\r\n            return null;\r\n        }\r\n        const t = -convertedOrigVec3.z / convertedDirVec3.z;\r\n        if (t <= 1e-5) {\r\n            return null;\r\n        }\r\n        const u = convertedOrigVec3.x + t * convertedDirVec3.x;\r\n        const v = convertedOrigVec3.y + t * convertedDirVec3.y;\r\n        if (u < 0.0 || v < 0.0 || u + v > 1.0) {\r\n            return null;\r\n        }\r\n        const fDat = 1.0 - u - v;\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        const pos0Vec3 = positionAccessor.getVec3(pos0IndexBase, {});\r\n        const pos1Vec3 = positionAccessor.getVec3(pos1IndexBase, {});\r\n        const pos2Vec3 = positionAccessor.getVec3(pos2IndexBase, {});\r\n        const pos0 = _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].multiply(pos0Vec3, u);\r\n        const pos1 = _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].multiply(pos1Vec3, v);\r\n        const pos2 = _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].multiply(pos2Vec3, fDat);\r\n        const intersectedPosVec3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero().add(pos0).add(pos1).add(pos2);\r\n        return [t, intersectedPosVec3];\r\n    }\r\n    _calcArenbergInverseMatrices() {\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        let incrementNum = 3; // gl.TRIANGLES\r\n        if (this.__mode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].TriangleStrip) {\r\n            // gl.TRIANGLE_STRIP\r\n            incrementNum = 1;\r\n        }\r\n        else if (this.__mode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_0__[\"PrimitiveMode\"].Points) {\r\n            return;\r\n        }\r\n        this.__inverseArenbergMatrix = [];\r\n        this.__arenberg3rdPosition = [];\r\n        if (this.hasIndices()) {\r\n            for (let i = 0; i < this.__indices.elementCount - 2; i++) {\r\n                const j = i * incrementNum;\r\n                if (j + 2 > this.__indices.elementCount - 1) {\r\n                    // gl.TRIANGLES\r\n                    break;\r\n                }\r\n                let pos0IndexBase = this.__indices.getScalar(j, {});\r\n                let pos1IndexBase = this.__indices.getScalar(j + 1, {});\r\n                let pos2IndexBase = this.__indices.getScalar(j + 2, {});\r\n                this._calcArenbergMatrixFor3Vertices(i, pos0IndexBase, pos1IndexBase, pos2IndexBase);\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < positionAccessor.elementCount - 2; i += incrementNum) {\r\n                const pos0IndexBase = i;\r\n                const pos1IndexBase = i + 1;\r\n                const pos2IndexBase = i + 2;\r\n                this._calcArenbergMatrixFor3Vertices(i, pos0IndexBase, pos1IndexBase, pos2IndexBase);\r\n            }\r\n        }\r\n    }\r\n    _calcArenbergMatrixFor3Vertices(i, pos0IndexBase, pos1IndexBase, pos2IndexBase) {\r\n        const positionAccessor = this.__attributes.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Position);\r\n        const pos0Vec3 = positionAccessor.getVec3(pos0IndexBase, {});\r\n        const pos1Vec3 = positionAccessor.getVec3(pos1IndexBase, {});\r\n        const pos2Vec3 = positionAccessor.getVec3(pos2IndexBase, {});\r\n        const ax = pos0Vec3.x - pos2Vec3.x;\r\n        const ay = pos0Vec3.y - pos2Vec3.y;\r\n        const az = pos0Vec3.z - pos2Vec3.z;\r\n        const bx = pos1Vec3.x - pos2Vec3.x;\r\n        const by = pos1Vec3.y - pos2Vec3.y;\r\n        const bz = pos1Vec3.z - pos2Vec3.z;\r\n        let nx = ay * bz - az * by;\r\n        let ny = az * bx - ax * bz;\r\n        let nz = ax * by - ay * bx;\r\n        let da = Math.sqrt(nx * nx + ny * ny + nz * nz);\r\n        if (da <= 1e-6) {\r\n            da = 0.0001;\r\n        }\r\n        da = 1.0 / da;\r\n        nx *= da;\r\n        ny *= da;\r\n        nz *= da;\r\n        const arenbergMatrix = new _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_10__[\"default\"](pos0Vec3.x - pos2Vec3.x, pos1Vec3.x - pos2Vec3.x, nx - pos2Vec3.x, pos0Vec3.y - pos2Vec3.y, pos1Vec3.y - pos2Vec3.y, ny - pos2Vec3.y, pos0Vec3.z - pos2Vec3.z, pos1Vec3.z - pos2Vec3.z, nz - pos2Vec3.z);\r\n        const inverseArenbergMatrix = arenbergMatrix.invert();\r\n        this.__inverseArenbergMatrix[i] = inverseArenbergMatrix;\r\n        this.__arenberg3rdPosition[i] = pos2Vec3;\r\n    }\r\n}\r\nPrimitive.__primitiveCount = 0;\r\n\n\n//# sourceURL=webpack:///./src/foundation/geometry/Primitive.ts?");

/***/ }),

/***/ "./src/foundation/geometry/Sphere.ts":
/*!*******************************************!*\
  !*** ./src/foundation/geometry/Sphere.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Sphere; });\n/* harmony import */ var _Primitive__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Sphere extends _Primitive__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n    }\r\n    generate({ radius, widthSegments, heightSegments, material }) {\r\n        var positions = [];\r\n        var texcoords = [];\r\n        var normals = [];\r\n        let shiftValue = 0.00001; // for avoid Singular point\r\n        for (var latNumber = 0; latNumber <= heightSegments; latNumber++) {\r\n            var theta = latNumber * Math.PI / heightSegments + shiftValue;\r\n            var sinTheta = Math.sin(theta);\r\n            var cosTheta = Math.cos(theta);\r\n            for (var longNumber = 0; longNumber <= widthSegments; longNumber++) {\r\n                var phi = longNumber * 2 * Math.PI / widthSegments;\r\n                var sinPhi = Math.sin(phi);\r\n                var cosPhi = Math.cos(phi);\r\n                var x = radius * cosPhi * sinTheta;\r\n                var y = radius * cosTheta;\r\n                var z = radius * sinPhi * sinTheta;\r\n                var position = new _math_Vector3__WEBPACK_IMPORTED_MODULE_6__[\"default\"](x, y, z);\r\n                positions.push(x);\r\n                positions.push(y);\r\n                positions.push(z);\r\n                var u = 1 - (longNumber / widthSegments);\r\n                var v = latNumber / heightSegments;\r\n                texcoords.push(u);\r\n                texcoords.push(v);\r\n                const normal = _math_Vector3__WEBPACK_IMPORTED_MODULE_6__[\"default\"].normalize(position);\r\n                normals.push(normal.x);\r\n                normals.push(normal.y);\r\n                normals.push(normal.z);\r\n            }\r\n        }\r\n        // first    first+1\r\n        //    +-------+\r\n        //    |     / |\r\n        //    |   /   |\r\n        //    | /     |\r\n        //    +-------+\r\n        // second   second+1\r\n        //\r\n        var indices = [];\r\n        for (var latNumber = 0; latNumber < heightSegments; latNumber++) {\r\n            for (var longNumber = 0; longNumber < widthSegments; longNumber++) {\r\n                var first = (latNumber * (widthSegments + 1)) + longNumber;\r\n                var second = first + widthSegments + 1;\r\n                indices.push(first + 1);\r\n                indices.push(second);\r\n                indices.push(first);\r\n                indices.push(first + 1);\r\n                indices.push(second + 1);\r\n                indices.push(second);\r\n            }\r\n        }\r\n        const attributeCompositionTypes = [_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec3, _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec3, _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec2];\r\n        const attributeSemantics = [_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Position, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Normal, _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].Texcoord0];\r\n        const primitiveMode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_3__[\"PrimitiveMode\"].Triangles;\r\n        const attributes = [new Float32Array(positions), new Float32Array(normals), new Float32Array(texcoords)];\r\n        let sumOfAttributesByteSize = 0;\r\n        attributes.forEach(attribute => {\r\n            sumOfAttributesByteSize += attribute.byteLength;\r\n        });\r\n        const indexSizeInByte = indices.length * 2;\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().createBufferOnDemand(indexSizeInByte + sumOfAttributesByteSize, this);\r\n        const indicesBufferView = buffer.takeBufferView({ byteLengthToNeed: indexSizeInByte /*byte*/, byteStride: 0, isAoS: false });\r\n        const indicesAccessor = indicesBufferView.takeAccessor({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedShort,\r\n            count: indices.length\r\n        });\r\n        for (let i = 0; i < indices.length; i++) {\r\n            indicesAccessor.setScalar(i, indices[i], {});\r\n        }\r\n        const attributesBufferView = buffer.takeBufferView({ byteLengthToNeed: sumOfAttributesByteSize, byteStride: 0, isAoS: false });\r\n        const attributeAccessors = [];\r\n        const attributeComponentTypes = [];\r\n        attributes.forEach((attribute, i) => {\r\n            attributeComponentTypes[i] = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].fromTypedArray(attributes[i]);\r\n            const accessor = attributesBufferView.takeAccessor({\r\n                compositionType: attributeCompositionTypes[i],\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].fromTypedArray(attributes[i]),\r\n                count: attribute.byteLength / attributeCompositionTypes[i].getNumberOfComponents() / attributeComponentTypes[i].getSizeInBytes()\r\n            });\r\n            accessor.copyFromTypedArray(attribute);\r\n            attributeAccessors.push(accessor);\r\n        });\r\n        const attributeMap = new Map();\r\n        for (let i = 0; i < attributeSemantics.length; i++) {\r\n            attributeMap.set(attributeSemantics[i], attributeAccessors[i]);\r\n        }\r\n        this.setData(attributeMap, primitiveMode, material, indicesAccessor);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/geometry/Sphere.ts?");

/***/ }),

/***/ "./src/foundation/gizmos/AABBGizmo.ts":
/*!********************************************!*\
  !*** ./src/foundation/gizmos/AABBGizmo.ts ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AABBGizmo; });\n/* harmony import */ var _Gizmo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Gizmo */ \"./src/foundation/gizmos/Gizmo.ts\");\n/* harmony import */ var _components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _geometry_Primitive__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../geometry/Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _geometry_Mesh__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../geometry/Mesh */ \"./src/foundation/geometry/Mesh.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass AABBGizmo extends _Gizmo__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(substance) {\r\n        super(substance);\r\n    }\r\n    get isSetup() {\r\n        if (this.__topEntity != null) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    setup() {\r\n        if (this.isSetup) {\r\n            return;\r\n        }\r\n        this.__topEntity = this.__entityRepository.createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"]]);\r\n        const meshComponent = this.__topEntity.getMesh();\r\n        // if (AABBGizmo.__aabbMesh == null) {\r\n        AABBGizmo.__aabbMesh = new _geometry_Mesh__WEBPACK_IMPORTED_MODULE_10__[\"default\"]();\r\n        AABBGizmo.__aabbMesh.addPrimitive(AABBGizmo.generatePrimitive());\r\n        meshComponent.setMesh(AABBGizmo.__aabbMesh);\r\n        // } else {\r\n        //   const mesh = new Mesh();\r\n        //   mesh.setOriginalMesh(AABBGizmo.__aabbMesh);\r\n        //   meshComponent.setMesh(mesh);\r\n        // }\r\n        this.setGizmoTag();\r\n    }\r\n    static generatePrimitive() {\r\n        const indices = new Uint32Array([\r\n            0, 1, 2, 3,\r\n            4, 5, 6, 7,\r\n            3, 0, 4, 7,\r\n            2, 1, 5, 6,\r\n            3, 2, 6, 7,\r\n            0, 1, 5, 4\r\n        ]);\r\n        const length = 1;\r\n        const positions = new Float32Array([\r\n            -length, -length, -length,\r\n            length, -length, -length,\r\n            length, length, -length,\r\n            -length, length, -length,\r\n            -length, -length, length,\r\n            length, -length, length,\r\n            length, length, length,\r\n            -length, length, length\r\n        ]);\r\n        const primitive = _geometry_Primitive__WEBPACK_IMPORTED_MODULE_8__[\"default\"].createPrimitive({\r\n            indices: indices,\r\n            attributeCompositionTypes: [_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3],\r\n            attributeSemantics: [_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_6__[\"VertexAttribute\"].Position],\r\n            attributes: [positions],\r\n            primitiveMode: _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_5__[\"PrimitiveMode\"].LineLoop\r\n        });\r\n        return primitive;\r\n    }\r\n    update() {\r\n        if (this.__topEntity == null) {\r\n            return;\r\n        }\r\n        const sg = this.__substance;\r\n        const aabb = sg.worldAABB;\r\n        this.__topEntity.getTransform().translate = aabb.centerPoint;\r\n        this.__topEntity.getTransform().scale = new _math_Vector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"](aabb.sizeX / 2, aabb.sizeY / 2, aabb.sizeZ / 2);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/gizmos/AABBGizmo.ts?");

/***/ }),

/***/ "./src/foundation/gizmos/Gizmo.ts":
/*!****************************************!*\
  !*** ./src/foundation/gizmos/Gizmo.ts ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Gizmo; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n\r\n\r\n\r\nclass Gizmo extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(substance) {\r\n        super();\r\n        this.__entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n        this.__isVisible = false;\r\n        this.__substance = substance;\r\n        this.setGizmoTag();\r\n    }\r\n    setGizmoTag() {\r\n        if (this.__topEntity) {\r\n            const sceneGraphs = _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flattenHierarchy(this.__topEntity.getSceneGraph(), false);\r\n            for (let sg of sceneGraphs) {\r\n                sg.entity.tryToSetTag({ tag: 'Being', value: 'gizmo' });\r\n            }\r\n        }\r\n    }\r\n    set isVisible(flg) {\r\n        this.__isVisible = flg;\r\n        if (this.__topEntity) {\r\n            this.__topEntity.getSceneGraph().setVisibilityRecursively(flg);\r\n        }\r\n    }\r\n    get isVisible() {\r\n        return this.__isVisible;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/gizmos/Gizmo.ts?");

/***/ }),

/***/ "./src/foundation/helpers/EntityHelper.ts":
/*!************************************************!*\
  !*** ./src/foundation/helpers/EntityHelper.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _components_CameraControllerComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/CameraControllerComponent */ \"./src/foundation/components/CameraControllerComponent.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction createGroupEntity() {\r\n    return _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance().createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]]);\r\n}\r\nfunction createMeshEntity() {\r\n    return _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance().createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"]]);\r\n}\r\nfunction createCameraEntity() {\r\n    return _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance().createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]]);\r\n}\r\nfunction createCameraWithControllerEntity() {\r\n    return _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance().createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"], _components_CameraControllerComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"]]);\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object.freeze({ createGroupEntity, createMeshEntity, createCameraEntity, createCameraWithControllerEntity }));\r\n\n\n//# sourceURL=webpack:///./src/foundation/helpers/EntityHelper.ts?");

/***/ }),

/***/ "./src/foundation/helpers/MaterialHelper.ts":
/*!**************************************************!*\
  !*** ./src/foundation/helpers/MaterialHelper.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../materials/core/Material */ \"./src/foundation/materials/core/Material.ts\");\n/* harmony import */ var _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../materials/singles/PbrShadingSingleMaterialNode */ \"./src/foundation/materials/singles/PbrShadingSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_ClassicShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../materials/singles/ClassicShadingSingleMaterialNode */ \"./src/foundation/materials/singles/ClassicShadingSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_EnvConstantSingleMaterialNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../materials/singles/EnvConstantSingleMaterialNode */ \"./src/foundation/materials/singles/EnvConstantSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_FXAA3QualitySingleMaterialNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../materials/singles/FXAA3QualitySingleMaterialNode */ \"./src/foundation/materials/singles/FXAA3QualitySingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_DepthEncodeSingleMaterialNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../materials/singles/DepthEncodeSingleMaterialNode */ \"./src/foundation/materials/singles/DepthEncodeSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_ShadowMapDecodeClassicSingleMaterialNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../materials/singles/ShadowMapDecodeClassicSingleMaterialNode */ \"./src/foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_GammaCorrectionSingleMaterialNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../materials/singles/GammaCorrectionSingleMaterialNode */ \"./src/foundation/materials/singles/GammaCorrectionSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_EntityUIDOutputSingleMaterialNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../materials/singles/EntityUIDOutputSingleMaterialNode */ \"./src/foundation/materials/singles/EntityUIDOutputSingleMaterialNode.ts\");\n/* harmony import */ var _materials_singles_MToonSingleMaterialNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../materials/singles/MToonSingleMaterialNode */ \"./src/foundation/materials/singles/MToonSingleMaterialNode.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_vert__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert */ \"./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_frag__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag */ \"./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag\");\n/* harmony import */ var _materials_singles_CustomSingleMaterialNode__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../materials/singles/CustomSingleMaterialNode */ \"./src/foundation/materials/singles/CustomSingleMaterialNode.ts\");\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction createMaterial(materialName, materialNodes, maxInstancesNumber) {\r\n    const isRegistMaterialType = _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isRegisteredMaterialType(materialName);\r\n    if (!isRegistMaterialType) {\r\n        _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__[\"default\"].registerMaterial(materialName, materialNodes, maxInstancesNumber);\r\n    }\r\n    const material = _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__[\"default\"].createMaterial(materialName, materialNodes);\r\n    return material;\r\n}\r\nfunction recreateMaterial(materialName, materialNodes, maxInstancesNumber) {\r\n    _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__[\"default\"].forceRegisterMaterial(materialName, materialNodes, maxInstancesNumber);\r\n    const material = _materials_core_Material__WEBPACK_IMPORTED_MODULE_1__[\"default\"].createMaterial(materialName, materialNodes);\r\n    return material;\r\n}\r\nfunction createEmptyMaterial() {\r\n    const materialName = 'Empty';\r\n    const material = createMaterial(materialName, [], _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType);\r\n    material.tryToSetUniqueName('EmptyMaterial', true);\r\n    return material;\r\n}\r\nfunction createPbrUberMaterial({ additionalName = '', isMorphing = false, isSkinning = false, isLighting = false, alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_15__[\"AlphaMode\"].Opaque, maxInstancesNumber = _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType } = {}) {\r\n    const materialName = 'PbrUber'\r\n        + `_${additionalName}_`\r\n        + (isMorphing ? '+morphing' : '')\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '' : '-lighting')\r\n        + ' alpha_' + alphaMode.str.toLowerCase();\r\n    const materialNode = new _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({ isMorphing, isSkinning, isLighting, alphaMode });\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createClassicUberMaterialOld({ additionalName = '', isSkinning = false, isLighting = false, alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_15__[\"AlphaMode\"].Opaque, maxInstancesNumber = _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType } = {}) {\r\n    const materialName = 'ClassicUberOld'\r\n        + `_${additionalName}_`\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '' : '-lighting');\r\n    const materialNode = new _materials_singles_ClassicShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"]({ isSkinning, isLighting, alphaMode });\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createClassicUberMaterial({ additionalName = '', isSkinning = true, isLighting = false, isMorphing = false, alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_15__[\"AlphaMode\"].Opaque, maxInstancesNumber = _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType } = {}) {\r\n    const materialName = 'ClassicUber'\r\n        + `_${additionalName}_`\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '' : '-lighting')\r\n        + ' alpha_' + alphaMode.str.toLowerCase();\r\n    const materialNode = new _materials_singles_CustomSingleMaterialNode__WEBPACK_IMPORTED_MODULE_13__[\"default\"]({\r\n        name: 'ClassicUber', isSkinning, isLighting, isMorphing, alphaMode,\r\n        vertexShader: _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_vert__WEBPACK_IMPORTED_MODULE_11__[\"default\"],\r\n        pixelShader: _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_frag__WEBPACK_IMPORTED_MODULE_12__[\"default\"]\r\n    });\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createEnvConstantMaterial({ additionalName = '', maxInstancesNumber = 10 } = {}) {\r\n    const materialName = 'EnvConstant' + `_${additionalName}`;\r\n    const materialNode = new _materials_singles_EnvConstantSingleMaterialNode__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createFXAA3QualityMaterial({ additionalName = '', maxInstancesNumber = 1 } = {}) {\r\n    const materialName = 'FXAA3Quality' + `_${additionalName}`;\r\n    const materialNode = new _materials_singles_FXAA3QualitySingleMaterialNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]();\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createDepthEncodeMaterial({ additionalName = '', isSkinning = false, maxInstancesNumber = 10 } = {}) {\r\n    const materialName = 'DepthEncode'\r\n        + `_${additionalName}_`\r\n        + (isSkinning ? '+skinning' : '');\r\n    const materialNode = new _materials_singles_DepthEncodeSingleMaterialNode__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({ isSkinning });\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createShadowMapDecodeClassicSingleMaterial({ additionalName = '', isMorphing = false, isSkinning = false, isLighting = true, isDebugging = false, colorAttachmentsNumber = 0, maxInstancesNumber = 20 } = {}, depthEncodeRenderPass) {\r\n    const materialName = 'ShadowMapDecodeClassic'\r\n        + `_${additionalName}_`\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '' : '-lighting');\r\n    const materialNode = new _materials_singles_ShadowMapDecodeClassicSingleMaterialNode__WEBPACK_IMPORTED_MODULE_7__[\"default\"]({\r\n        isMorphing, isSkinning, isLighting, isDebugging, colorAttachmentsNumber\r\n    }, depthEncodeRenderPass);\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createGammaCorrectionMaterial({ additionalName = '', maxInstancesNumber = 1 } = {}) {\r\n    const materialName = 'GammaCorrection' + `_${additionalName}`;\r\n    const materialNode = new _materials_singles_GammaCorrectionSingleMaterialNode__WEBPACK_IMPORTED_MODULE_8__[\"default\"]();\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createEntityUIDOutputMaterial({ additionalName = '', maxInstancesNumber = 10 } = {}) {\r\n    const materialName = 'EntityUIDOutput' + `_${additionalName}`;\r\n    const materialNode = new _materials_singles_EntityUIDOutputSingleMaterialNode__WEBPACK_IMPORTED_MODULE_9__[\"default\"]();\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction createMToonMaterial({ additionalName = '', isMorphing = false, isSkinning = false, isLighting = true, isOutline = false, materialProperties = undefined, textures = undefined, debugMode = undefined, maxInstancesNumber = _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType } = {}) {\r\n    const materialName = 'MToon'\r\n        + `_${additionalName}_`\r\n        + (isMorphing ? '+morphing' : '')\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '-lighting' : '')\r\n        + (isOutline ? '-outline' : '');\r\n    const materialNode = new _materials_singles_MToonSingleMaterialNode__WEBPACK_IMPORTED_MODULE_10__[\"default\"](isOutline, materialProperties, textures, isMorphing, isSkinning, isLighting, debugMode);\r\n    materialNode.isSingleOperation = true;\r\n    const material = createMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    materialNode.setMaterialParameters(material, isOutline);\r\n    return material;\r\n}\r\nfunction recreateCustomMaterial(vertexShaderStr, pixelShaderStr, { additionalName = '', isSkinning = true, isLighting = false, isMorphing = false, alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_15__[\"AlphaMode\"].Opaque, maxInstancesNumber = _core_Config__WEBPACK_IMPORTED_MODULE_0__[\"default\"].maxMaterialInstanceForEachType } = {}) {\r\n    const materialName = 'Custom'\r\n        + `_${additionalName}_`\r\n        + (isMorphing ? '+morphing' : '')\r\n        + (isSkinning ? '+skinning' : '')\r\n        + (isLighting ? '' : '-lighting')\r\n        + ' alpha_' + alphaMode.str.toLowerCase();\r\n    const materialNode = new _materials_singles_CustomSingleMaterialNode__WEBPACK_IMPORTED_MODULE_13__[\"default\"]({\r\n        name: materialName, isSkinning, isLighting, isMorphing, alphaMode,\r\n        vertexShader: { code: vertexShaderStr, shaderStage: 'vertex' },\r\n        pixelShader: { code: pixelShaderStr, shaderStage: 'fragment' }\r\n    });\r\n    materialNode.isSingleOperation = true;\r\n    const material = recreateMaterial(materialName, [materialNode], maxInstancesNumber);\r\n    return material;\r\n}\r\nfunction changeMaterial(entity, primitive, material) {\r\n    const meshRendererComponent = entity.getMeshRenderer();\r\n    primitive.material = material;\r\n    meshRendererComponent.moveStageTo(_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_14__[\"ProcessStage\"].Load);\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object.freeze({\r\n    createMaterial, recreateMaterial, recreateCustomMaterial,\r\n    createEmptyMaterial, createClassicUberMaterial, createPbrUberMaterial, createEnvConstantMaterial, createFXAA3QualityMaterial, createDepthEncodeMaterial,\r\n    createShadowMapDecodeClassicSingleMaterial, createGammaCorrectionMaterial, createEntityUIDOutputMaterial, createMToonMaterial, changeMaterial\r\n}));\r\n\n\n//# sourceURL=webpack:///./src/foundation/helpers/MaterialHelper.ts?");

/***/ }),

/***/ "./src/foundation/helpers/RenderableHelper.ts":
/*!****************************************************!*\
  !*** ./src/foundation/helpers/RenderableHelper.ts ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _renderer_FrameBuffer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../renderer/FrameBuffer */ \"./src/foundation/renderer/FrameBuffer.ts\");\n/* harmony import */ var _textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../textures/RenderTargetTexture */ \"./src/foundation/textures/RenderTargetTexture.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _textures_RenderBuffer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../textures/RenderBuffer */ \"./src/foundation/textures/RenderBuffer.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nfunction createTexturesForRenderTarget(width, height, textureNum, { level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_4__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_4__[\"PixelFormat\"].RGBA, type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].UnsignedByte, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge }) {\r\n    const frameBuffer = new _renderer_FrameBuffer__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\n    frameBuffer.create(width, height);\r\n    for (let i = 0; i < textureNum; i++) {\r\n        const renderTargetTexture = new _textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\r\n        renderTargetTexture.create({ width, height, level, internalFormat, format, type, magFilter, minFilter, wrapS, wrapT });\r\n        frameBuffer.setColorAttachmentAt(i, renderTargetTexture);\r\n    }\r\n    const renderBuffer = new _textures_RenderBuffer__WEBPACK_IMPORTED_MODULE_5__[\"default\"]();\r\n    renderBuffer.create(width, height, _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Depth16);\r\n    frameBuffer.setDepthAttachment(renderBuffer);\r\n    return frameBuffer;\r\n}\r\n/*\r\nfunction createTexturesForRenderTarget(width: number, height:number, textureNum:number,\r\n  {\r\n    level = 0,\r\n    internalFormat = PixelFormat.RGBA,\r\n    format = PixelFormat.RGBA,\r\n    type = ComponentType.UnsignedByte,\r\n    magFilter = TextureParameter.Linear,\r\n    minFilter = TextureParameter.Linear,\r\n    wrapS = TextureParameter.ClampToEdge,\r\n    wrapT = TextureParameter.ClampToEdge\r\n  }) {\r\n  const frameBuffer = new FrameBuffer();\r\n  frameBuffer.create(width, height);\r\n\r\n  for (let i=0; i<textureNum; i++) {\r\n    const renderTargetTexture = new RenderTargetTexture();\r\n    renderTargetTexture.create({width, height, level, internalFormat, format, type, magFilter, minFilter, wrapS, wrapT});\r\n    frameBuffer.setColorAttachmentAt(i, renderTargetTexture);\r\n  }\r\n\r\n\r\n\r\n  let format = gl.DEPTH_COMPONENT;\r\n  let internalFormat = gl.DEPTH_COMPONENT;\r\n  let type = gl.UNSIGNED_INT;\r\n  if (GLBoost.isThisGLVersion_2(gl)) {\r\n    type = gl.UNSIGNED_INT;\r\n    format = gl.DEPTH_COMPONENT;\r\n    internalFormat = gl.DEPTH_COMPONENT24;\r\n  } else if (glem.extDepthTex) {\r\n    type = glem.extDepthTex.UNSIGNED_INT_24_8_WEBGL;\r\n    format = gl.DEPTH_STENCIL;\r\n    internalFormat = gl.DEPTH_STENCIL;\r\n  }\r\n\r\n  const depthTexture = new RenderTargetTexture();\r\n  depthTexture.create({width: width, height: height, level: 0, internalFormat: TextureParameter.Depth16, format: TextureParameter.Depth16,\r\n     type: ComponentType.Float, magFilter: TextureParameter.Linear, minFilter: TextureParameter.Linear, wrapS: TextureParameter.ClampToEdge, wrapT: TextureParameter.ClampToEdge});\r\n\r\n  frameBuffer.setDepthAttachment(depthTexture);\r\n\r\n  return frameBuffer;\r\n}\r\n*/\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object.freeze({ createTexturesForRenderTarget }));\r\n\n\n//# sourceURL=webpack:///./src/foundation/helpers/RenderableHelper.ts?");

/***/ }),

/***/ "./src/foundation/importer/AnimationAssigner.ts":
/*!******************************************************!*\
  !*** ./src/foundation/importer/AnimationAssigner.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AnimationAssigner; });\n/* harmony import */ var _ModelConverter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ModelConverter */ \"./src/foundation/importer/ModelConverter.ts\");\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _components_AnimationComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/AnimationComponent */ \"./src/foundation/components/AnimationComponent.ts\");\n/* harmony import */ var _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/AnimationInterpolation */ \"./src/foundation/definitions/AnimationInterpolation.ts\");\n\r\n\r\n\r\n\r\nclass AnimationAssigner {\r\n    constructor() {\r\n    }\r\n    assignAnimation(rootEntity, gltfModel, vrmModel, isSameSkeleton = false) {\r\n        this.__setupAnimationForSameSkeleton(rootEntity, gltfModel, vrmModel, isSameSkeleton);\r\n        return rootEntity;\r\n    }\r\n    /**\r\n     * The static method to get singleton instance of this class.\r\n     * @return The singleton instance of ModelConverter class\r\n     */\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new AnimationAssigner();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    __getCorrespondingEntity(rootEntity, gltfModel, vrmModel, nodeIndex, nodeName, isSameSkeleton) {\r\n        if (isSameSkeleton) {\r\n            const rnEntities = rootEntity.getTagValue('rnEntitiesByNames');\r\n            const node = gltfModel.nodes[nodeIndex];\r\n            let rnEntity = rnEntities.get(node.name);\r\n            return rnEntity;\r\n        }\r\n        else {\r\n            const humanBones = vrmModel.extensions.VRM.humanoid.humanBones;\r\n            let humanoidBoneName;\r\n            const srcMapNodeIdName = new Map();\r\n            const srcMapNodeNameName = new Map();\r\n            for (let bone of humanBones) {\r\n                srcMapNodeIdName.set(bone.node, bone.bone);\r\n                srcMapNodeNameName.set(bone.name, bone.bone);\r\n            }\r\n            if (nodeName != null) {\r\n                humanoidBoneName = srcMapNodeNameName.get(nodeName);\r\n                if (humanoidBoneName == null) {\r\n                    humanoidBoneName = srcMapNodeIdName.get(nodeIndex);\r\n                }\r\n            }\r\n            const dstMapNameNodeId = rootEntity.getTagValue('humanoid_map_name_nodeId');\r\n            const dstBoneNodeId = dstMapNameNodeId.get(humanoidBoneName);\r\n            if (dstBoneNodeId != null) {\r\n                const rnEntities = rootEntity.getTagValue('rnEntities');\r\n                return rnEntities[dstBoneNodeId];\r\n            }\r\n            else {\r\n                return void 0;\r\n            }\r\n        }\r\n    }\r\n    __isHips(rootEntity, vrmModel, nodeIndex) {\r\n        const humanBones = vrmModel.extensions.VRM.humanoid.humanBones;\r\n        const srcMapNodeIdName = new Map();\r\n        for (let bone of humanBones) {\r\n            srcMapNodeIdName.set(bone.node, bone.bone);\r\n        }\r\n        const dstMapNameNodeId = rootEntity.getTagValue('humanoid_map_name_nodeId');\r\n        const humanoidBoneName = srcMapNodeIdName.get(nodeIndex);\r\n        if (humanoidBoneName === 'hips') {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    __setupAnimationForSameSkeleton(rootEntity, gltfModel, vrmModel, isSameSkeleton) {\r\n        if (gltfModel.animations) {\r\n            const modelConverter = _ModelConverter__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n            for (let animation of gltfModel.animations) {\r\n                for (let sampler of animation.samplers) {\r\n                    modelConverter._accessBinaryWithAccessor(sampler.input);\r\n                    modelConverter._accessBinaryWithAccessor(sampler.output);\r\n                }\r\n            }\r\n        }\r\n        const entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n        if (gltfModel.animations) {\r\n            for (let animation of gltfModel.animations) {\r\n                for (let channel of animation.channels) {\r\n                    const animInputArray = channel.sampler.input.extras.typedDataArray;\r\n                    const animOutputArray = channel.sampler.output.extras.typedDataArray;\r\n                    const interpolation = (channel.sampler.interpolation != null) ? channel.sampler.interpolation : 'LINEAR';\r\n                    let animationAttributeName = '';\r\n                    if (channel.target.path === 'translation') {\r\n                        animationAttributeName = 'translate';\r\n                    }\r\n                    else if (channel.target.path === 'rotation') {\r\n                        animationAttributeName = 'quaternion';\r\n                    }\r\n                    else {\r\n                        animationAttributeName = channel.target.path;\r\n                    }\r\n                    const node = gltfModel.nodes[channel.target.nodeIndex];\r\n                    const rnEntity = this.__getCorrespondingEntity(rootEntity, gltfModel, vrmModel, channel.target.nodeIndex, node.name, isSameSkeleton);\r\n                    if (rnEntity) {\r\n                        entityRepository.addComponentsToEntity([_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]], rnEntity.entityUID);\r\n                        const animationComponent = rnEntity.getComponent(_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\r\n                        if (animationComponent) {\r\n                            if (animationAttributeName === 'quaternion') {\r\n                                animationComponent.setAnimation(animationAttributeName, animInputArray, animOutputArray, _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].fromString(interpolation));\r\n                            }\r\n                            else if (animationAttributeName === 'translate' && this.__isHips(rootEntity, vrmModel, channel.target.nodeIndex)) {\r\n                                animationComponent.setAnimation(animationAttributeName, animInputArray, animOutputArray, _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_3__[\"AnimationInterpolation\"].fromString(interpolation));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/AnimationAssigner.ts?");

/***/ }),

/***/ "./src/foundation/importer/DrcPointCloudImporter.ts":
/*!**********************************************************!*\
  !*** ./src/foundation/importer/DrcPointCloudImporter.ts ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DrcPointCloudImporter; });\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n/* harmony import */ var _geometry_Primitive__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../geometry/Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/MaterialHelper */ \"./src/foundation/helpers/MaterialHelper.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _misc_RnPromise__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../misc/RnPromise */ \"./src/foundation/misc/RnPromise.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The draco Importer class.\r\n */\r\nclass DrcPointCloudImporter {\r\n    constructor() {\r\n    }\r\n    /**\r\n     * Import draco file of point cloud type\r\n     * WEIGHTS_0 and JOINTS_0 attribute and all the mesh type and is not support yet.\r\n     * @param uri - uri of drc file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    async importPointCloud(uri, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        if (options && options.files) {\r\n            for (let fileName in options.files) {\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                if (fileExtension === 'drc') {\r\n                    return await this.__decodeDraco(options.files[fileName], defaultOptions, basePath, options).catch((err) => {\r\n                        console.log('this.__decodeDraco error', err);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        const arrayBuffer = await _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchArrayBuffer(uri);\r\n        return await this.__decodeDraco(arrayBuffer, defaultOptions, basePath, options).catch((err) => {\r\n            console.log('this.__decodeDraco error', err);\r\n        });\r\n    }\r\n    /**\r\n     * Import the specified array buffer of draco file where the type must be point cloud.\r\n     * WEIGHTS_0 and JOINTS_0 attribute and all the mesh type and is not support yet.\r\n     * @param uri - uri of drc file\r\n     * @param arrayBuffer - fetched array buffer of drc file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    importArrayBuffer(uri, arrayBuffer, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        return this.__decodeDraco(arrayBuffer, defaultOptions, basePath, options).catch((err) => {\r\n            console.log('__loadFromArrayBuffer error', err);\r\n        });\r\n    }\r\n    async __loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options) {\r\n        const dataView = new DataView(arrayBuffer, 0, 20);\r\n        const isLittleEndian = true;\r\n        // Magic field\r\n        const magic = dataView.getUint32(0, isLittleEndian);\r\n        let result;\r\n        // 0x46546C67 is 'glTF' in ASCII codes.\r\n        if (magic !== 0x46546C67) {\r\n            //const json = await response.json();\r\n            const gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(arrayBuffer);\r\n            const json = JSON.parse(gotText);\r\n            result = await this._loadAsTextJson(json, options, defaultOptions, basePath).catch((err) => {\r\n                console.log('this.__loadAsTextJson error', err);\r\n            });\r\n        }\r\n        else {\r\n            result = await this._loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath).catch((err) => {\r\n                console.log('this.__loadAsBinaryJson error', err);\r\n            });\r\n        }\r\n        return result;\r\n    }\r\n    _getOptions(defaultOptions, json, options) {\r\n        if (json.asset && json.asset.extras && json.asset.extras.rnLoaderOptions) {\r\n            for (let optionName in json.asset.extras.rnLoaderOptions) {\r\n                defaultOptions[optionName] = json.asset.extras.rnLoaderOptions[optionName];\r\n            }\r\n        }\r\n        for (let optionName in options) {\r\n            defaultOptions[optionName] = options[optionName];\r\n        }\r\n        if (options && options.loaderExtension && typeof options.loaderExtension === \"string\") {\r\n            if (Rn[options.loaderExtension] != null) {\r\n                defaultOptions.loaderExtension = Rn[options.loaderExtension].getInstance();\r\n            }\r\n            else {\r\n                console.error(`${options.loaderExtension} not found!`);\r\n                defaultOptions.loaderExtension = void 0;\r\n            }\r\n        }\r\n        return defaultOptions;\r\n    }\r\n    async _loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath) {\r\n        let lengthOfJSonChunkData = dataView.getUint32(12, isLittleEndian);\r\n        let chunkType = dataView.getUint32(16, isLittleEndian);\r\n        // 0x4E4F534A means JSON format (0x4E4F534A is 'JSON' in ASCII codes)\r\n        if (chunkType !== 0x4E4F534A) {\r\n            throw new Error('invalid chunkType of chunk0 in this binary glTF file.');\r\n        }\r\n        let uint8ArrayJSonContent = new Uint8Array(arrayBuffer, 20, lengthOfJSonChunkData);\r\n        let gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].uint8ArrayToString(uint8ArrayJSonContent);\r\n        let gltfJson = JSON.parse(gotText);\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        let uint8array = new Uint8Array(arrayBuffer, 20 + lengthOfJSonChunkData + 8);\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"2\" };\r\n        }\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        try {\r\n            await this._loadInner(uint8array, basePath, gltfJson, options);\r\n        }\r\n        catch (err) {\r\n            console.log(\"this._loadInner error in _loadAsBinaryJson\", err);\r\n        }\r\n        return gltfJson;\r\n    }\r\n    async _loadAsTextJson(gltfJson, options, defaultOptions, basePath) {\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"2\" };\r\n        }\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        try {\r\n            await this._loadInner(undefined, basePath, gltfJson, options);\r\n        }\r\n        catch (err) {\r\n            console.log('this._loadInner error in _loadAsTextJson', err);\r\n        }\r\n        return gltfJson;\r\n    }\r\n    _loadInner(uint8array, basePath, gltfJson, options) {\r\n        let promises = [];\r\n        let resources = {\r\n            shaders: [],\r\n            buffers: [],\r\n            images: []\r\n        };\r\n        promises.push(this._loadResources(uint8array, basePath, gltfJson, options, resources));\r\n        promises.push(new Promise((resolve, reject) => {\r\n            this._loadJsonContent(gltfJson, options);\r\n            resolve();\r\n        }));\r\n        return Promise.all(promises);\r\n    }\r\n    _loadJsonContent(gltfJson, options) {\r\n        // Scene\r\n        this._loadDependenciesOfScenes(gltfJson);\r\n        // Node\r\n        this._loadDependenciesOfNodes(gltfJson);\r\n        // Mesh\r\n        this._loadDependenciesOfMeshes(gltfJson);\r\n        // Material\r\n        this._loadDependenciesOfMaterials(gltfJson);\r\n        // Texture\r\n        this._loadDependenciesOfTextures(gltfJson);\r\n        // Joint\r\n        this._loadDependenciesOfJoints(gltfJson);\r\n        // Animation\r\n        this._loadDependenciesOfAnimations(gltfJson);\r\n        // Accessor\r\n        this._loadDependenciesOfAccessors(gltfJson);\r\n        // BufferView\r\n        this._loadDependenciesOfBufferViews(gltfJson);\r\n        if (gltfJson.asset === void 0) {\r\n            gltfJson.asset = {};\r\n        }\r\n        if (gltfJson.asset.extras === void 0) {\r\n            gltfJson.asset.extras = {};\r\n        }\r\n    }\r\n    _loadDependenciesOfScenes(gltfJson) {\r\n        for (let scene of gltfJson.scenes) {\r\n            scene.nodesIndices = scene.nodes.concat();\r\n            for (let i in scene.nodesIndices) {\r\n                scene.nodes[i] = gltfJson.nodes[scene.nodes[i]];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfNodes(gltfJson) {\r\n        for (let node of gltfJson.nodes) {\r\n            // Hierarchy\r\n            if (node.children) {\r\n                node.childrenIndices = node.children.concat();\r\n                node.children = [];\r\n                for (let i in node.childrenIndices) {\r\n                    node.children[i] = gltfJson.nodes[node.childrenIndices[i]];\r\n                }\r\n            }\r\n            // Mesh\r\n            if (node.mesh !== void 0 && gltfJson.meshes !== void 0) {\r\n                node.meshIndex = node.mesh;\r\n                node.mesh = gltfJson.meshes[node.meshIndex];\r\n            }\r\n            // Skin\r\n            if (node.skin !== void 0 && gltfJson.skins !== void 0) {\r\n                node.skinIndex = node.skin;\r\n                node.skin = gltfJson.skins[node.skinIndex];\r\n                if (node.mesh.extras === void 0) {\r\n                    node.mesh.extras = {};\r\n                }\r\n                node.mesh.extras._skin = node.skin;\r\n            }\r\n            // Camera\r\n            if (node.camera !== void 0 && gltfJson.cameras !== void 0) {\r\n                node.cameraIndex = node.camera;\r\n                node.camera = gltfJson.cameras[node.cameraIndex];\r\n            }\r\n            // Lights\r\n            if (node.extensions !== void 0 && gltfJson.extensions !== void 0 && gltfJson.extensions.KHR_lights_punctual !== void 0) {\r\n                node.extensions.KHR_lights_punctual.lightIndex = node.extensions.KHR_lights_punctual.light;\r\n                node.extensions.KHR_lights_punctual.light = gltfJson.extensions.KHR_lights_punctual.lights[node.extensions.KHR_lights_punctual.lightIndex];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfMeshes(gltfJson) {\r\n        // Mesh\r\n        for (let mesh of gltfJson.meshes) {\r\n            for (let primitive of mesh.primitives) {\r\n                if (primitive.material !== void 0) {\r\n                    primitive.materialIndex = primitive.material;\r\n                    primitive.material = gltfJson.materials[primitive.materialIndex];\r\n                }\r\n                primitive.attributesIndex = Object.assign({}, primitive.attributes);\r\n                for (let attributeName in primitive.attributesIndex) {\r\n                    if (primitive.attributesIndex[attributeName] >= 0) {\r\n                        let accessor = gltfJson.accessors[primitive.attributesIndex[attributeName]];\r\n                        accessor.extras = {\r\n                            toGetAsTypedArray: true,\r\n                            attributeName: attributeName\r\n                        };\r\n                        primitive.attributes[attributeName] = accessor;\r\n                    }\r\n                    else {\r\n                        primitive.attributes[attributeName] = void 0;\r\n                    }\r\n                }\r\n                if (primitive.indices != null) {\r\n                    primitive.indicesIndex = primitive.indices;\r\n                    primitive.indices = gltfJson.accessors[primitive.indicesIndex];\r\n                }\r\n                if (primitive.targets != null) {\r\n                    primitive.targetIndices = primitive.targets;\r\n                    primitive.targets = [];\r\n                    for (let target of primitive.targetIndices) {\r\n                        const attributes = {};\r\n                        for (let attributeName in target) {\r\n                            if (target[attributeName] >= 0) {\r\n                                let accessor = gltfJson.accessors[target[attributeName]];\r\n                                accessor.extras = {\r\n                                    toGetAsTypedArray: true,\r\n                                    attributeName: attributeName\r\n                                };\r\n                                attributes[attributeName] = accessor;\r\n                            }\r\n                            else {\r\n                                attributes[attributeName] = void 0;\r\n                            }\r\n                        }\r\n                        primitive.targets.push(attributes);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _checkRnGltfLoaderOptionsExist(gltfModel) {\r\n        if (gltfModel.asset.extras && gltfModel.asset.extras.rnLoaderOptions) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    _loadDependenciesOfMaterials(gltfJson) {\r\n        if (!gltfJson.textures)\r\n            gltfJson.textures = [];\r\n        // Material\r\n        if (gltfJson.materials) {\r\n            for (let material of gltfJson.materials) {\r\n                if (material.pbrMetallicRoughness) {\r\n                    let baseColorTexture = material.pbrMetallicRoughness.baseColorTexture;\r\n                    if (baseColorTexture !== void 0) {\r\n                        baseColorTexture.texture = gltfJson.textures[baseColorTexture.index];\r\n                    }\r\n                    let metallicRoughnessTexture = material.pbrMetallicRoughness.metallicRoughnessTexture;\r\n                    if (metallicRoughnessTexture !== void 0) {\r\n                        metallicRoughnessTexture.texture = gltfJson.textures[metallicRoughnessTexture.index];\r\n                    }\r\n                }\r\n                let normalTexture = material.normalTexture;\r\n                if (normalTexture !== void 0) {\r\n                    normalTexture.texture = gltfJson.textures[normalTexture.index];\r\n                }\r\n                const occlusionTexture = material.occlusionTexture;\r\n                if (occlusionTexture !== void 0) {\r\n                    occlusionTexture.texture = gltfJson.textures[occlusionTexture.index];\r\n                }\r\n                const emissiveTexture = material.emissiveTexture;\r\n                if (emissiveTexture !== void 0) {\r\n                    emissiveTexture.texture = gltfJson.textures[emissiveTexture.index];\r\n                }\r\n                if (this._checkRnGltfLoaderOptionsExist(gltfJson) &&\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension &&\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension.setTextures) {\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension.setTextures(gltfJson, material);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfTextures(gltfJson) {\r\n        // Texture\r\n        if (gltfJson.textures) {\r\n            for (let texture of gltfJson.textures) {\r\n                if (texture.sampler !== void 0) {\r\n                    texture.samplerIndex = texture.sampler;\r\n                    texture.sampler = gltfJson.samplers[texture.samplerIndex];\r\n                }\r\n                if (texture.source !== void 0) {\r\n                    texture.sourceIndex = texture.source;\r\n                    texture.image = gltfJson.images[texture.sourceIndex];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfJoints(gltfJson) {\r\n        if (gltfJson.skins) {\r\n            for (let skin of gltfJson.skins) {\r\n                skin.skeletonIndex = skin.skeleton;\r\n                skin.skeleton = gltfJson.nodes[skin.skeletonIndex];\r\n                skin.inverseBindMatricesIndex = skin.inverseBindMatrices;\r\n                skin.inverseBindMatrices = gltfJson.accessors[skin.inverseBindMatricesIndex];\r\n                if (skin.skeleton == null) {\r\n                    skin.skeletonIndex = skin.joints[0];\r\n                    skin.skeleton = gltfJson.nodes[skin.skeletonIndex];\r\n                }\r\n                skin.jointsIndices = skin.joints;\r\n                skin.joints = [];\r\n                for (let jointIndex of skin.jointsIndices) {\r\n                    skin.joints.push(gltfJson.nodes[jointIndex]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAnimations(gltfJson) {\r\n        if (gltfJson.animations) {\r\n            for (let animation of gltfJson.animations) {\r\n                for (let channel of animation.channels) {\r\n                    channel.samplerIndex = channel.sampler;\r\n                    channel.sampler = animation.samplers[channel.samplerIndex];\r\n                    channel.target.nodeIndex = channel.target.node;\r\n                    channel.target.node = gltfJson.nodes[channel.target.nodeIndex];\r\n                }\r\n                for (let channel of animation.channels) {\r\n                    channel.sampler.inputIndex = channel.sampler.input;\r\n                    channel.sampler.outputIndex = channel.sampler.output;\r\n                    channel.sampler.input = gltfJson.accessors[channel.sampler.inputIndex];\r\n                    channel.sampler.output = gltfJson.accessors[channel.sampler.outputIndex];\r\n                    if (channel.sampler.output.extras === void 0) {\r\n                        channel.sampler.output.extras = {};\r\n                    }\r\n                    if (channel.target.path === 'rotation') {\r\n                        channel.sampler.output.extras.quaternionIfVec4 = true;\r\n                    }\r\n                    if (channel.target.path === 'weights') {\r\n                        const weightCount = channel.sampler.output.count / channel.sampler.input.count;\r\n                        channel.sampler.output.extras.weightCount = weightCount;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAccessors(gltfJson) {\r\n        // Accessor\r\n        for (let accessor of gltfJson.accessors) {\r\n            if (accessor.bufferView == null) {\r\n                accessor.bufferView = 0;\r\n            }\r\n            accessor.bufferViewIndex = accessor.bufferView;\r\n            accessor.bufferView = gltfJson.bufferViews[accessor.bufferViewIndex];\r\n            if (accessor.sparse != null) {\r\n                const sparse = accessor.sparse;\r\n                sparse.indices.indicesIndex = sparse.indices.bufferView;\r\n                sparse.indices.bufferView = gltfJson.bufferViews[sparse.indices.indicesIndex];\r\n                sparse.values.valuesIndex = sparse.values.bufferView;\r\n                sparse.values.bufferView = gltfJson.bufferViews[sparse.values.valuesIndex];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfBufferViews(gltfJson) {\r\n        // BufferView\r\n        for (let bufferView of gltfJson.bufferViews) {\r\n            if (bufferView.buffer !== void 0) {\r\n                bufferView.bufferIndex = bufferView.buffer;\r\n                bufferView.buffer = gltfJson.buffers[bufferView.bufferIndex];\r\n            }\r\n        }\r\n    }\r\n    _mergeExtendedJson(gltfJson, extendedData) {\r\n        let extendedJson = null;\r\n        if (extendedData instanceof ArrayBuffer) {\r\n            const extendedJsonStr = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(extendedData);\r\n            extendedJson = JSON.parse(extendedJsonStr);\r\n        }\r\n        else if (typeof extendedData === 'string') {\r\n            extendedJson = JSON.parse(extendedData);\r\n            extendedJson = extendedJson;\r\n        }\r\n        else if (typeof extendedData === 'object') {\r\n            extendedJson = extendedData;\r\n        }\r\n        else {\r\n        }\r\n        Object.assign(gltfJson, extendedJson);\r\n    }\r\n    _loadResources(uint8Array, basePath, gltfJson, options, resources) {\r\n        let promisesToLoadResources = [];\r\n        // Shaders Async load\r\n        // for (let _i in gltfJson.shaders) {\r\n        //   const i = _i as any as number;\r\n        //   resources.shaders[i] = {};\r\n        //   let shaderJson = gltfJson.shaders[i];\r\n        //   let shaderType = shaderJson.type;\r\n        //   if (typeof shaderJson.extensions !== 'undefined' && typeof shaderJson.extensions.KHR_binary_glTF !== 'undefined') {\r\n        //     resources.shaders[i].shaderText = this._accessBinaryAsShader(shaderJson.extensions.KHR_binary_glTF.bufferView, gltfJson, arrayBufferBinary);\r\n        //     resources.shaders[i].shaderType = shaderType;\r\n        //     continue;\r\n        //   }\r\n        //   let shaderUri = shaderJson.uri;\r\n        //   if (options.files) {\r\n        //     const splitted = shaderUri.split('/');\r\n        //     const filename = splitted[splitted.length - 1];\r\n        //     if (options.files[filename]) {\r\n        //       const arrayBuffer = options.files[filename];\r\n        //       resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //       resources.shaders[i].shaderType = shaderType;\r\n        //       continue;\r\n        //     }\r\n        //   }\r\n        //   if (shaderUri.match(/^data:/)) {\r\n        //     promisesToLoadResources.push(\r\n        //       new Promise((resolve, rejected) => {\r\n        //         let arrayBuffer = DataUtil.dataUriToArrayBuffer(shaderUri);\r\n        //         resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //         resources.shaders[i].shaderType = shaderType;\r\n        //         resolve();\r\n        //       })\r\n        //     );\r\n        //   } else {\r\n        //     shaderUri = basePath + shaderUri;\r\n        //     promisesToLoadResources.push(\r\n        //       DataUtil.loadResourceAsync(shaderUri, false,\r\n        //         (resolve:Function, response:any)=>{\r\n        //           resources.shaders[i].shaderText = response;\r\n        //           resources.shaders[i].shaderType = shaderType;\r\n        //           resolve(gltfJson);\r\n        //         },\r\n        //         (reject:Function, error:any)=>{\r\n        //         }\r\n        //       )\r\n        //     );\r\n        //   }\r\n        // }\r\n        // Buffers Async load\r\n        let rnpArrayBuffer;\r\n        for (let i in gltfJson.buffers) {\r\n            let bufferInfo = gltfJson.buffers[i];\r\n            let splitted;\r\n            let filename;\r\n            if (bufferInfo.uri) {\r\n                splitted = bufferInfo.uri.split('/');\r\n                filename = splitted[splitted.length - 1];\r\n            }\r\n            if (typeof bufferInfo.uri === 'undefined') {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_6__[\"default\"]((resolve, rejected) => {\r\n                    resources.buffers[i] = uint8Array;\r\n                    bufferInfo.buffer = uint8Array;\r\n                    resolve(uint8Array);\r\n                });\r\n            }\r\n            else if (bufferInfo.uri.match(/^data:application\\/(.*);base64,/)) {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_6__[\"default\"]((resolve, rejected) => {\r\n                    let arrayBuffer = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dataUriToArrayBuffer(bufferInfo.uri);\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(arrayBuffer);\r\n                });\r\n            }\r\n            else if (options.files && options.files[filename]) {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_6__[\"default\"]((resolve, rejected) => {\r\n                    const arrayBuffer = options.files[filename];\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(arrayBuffer);\r\n                });\r\n            }\r\n            else {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_6__[\"default\"](_misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].loadResourceAsync(basePath + bufferInfo.uri, true, (resolve, response) => {\r\n                    resources.buffers[i] = new Uint8Array(response);\r\n                    bufferInfo.buffer = new Uint8Array(response);\r\n                    resolve(response);\r\n                }, (reject, error) => {\r\n                }));\r\n            }\r\n            bufferInfo.bufferPromise = rnpArrayBuffer;\r\n            promisesToLoadResources.push(rnpArrayBuffer);\r\n        }\r\n        // Textures Async load\r\n        for (let _i in gltfJson.images) {\r\n            const i = _i;\r\n            let imageJson = gltfJson.images[i];\r\n            //let imageJson = gltfJson.images[textureJson.source];\r\n            //let samplerJson = gltfJson.samplers[textureJson.sampler];\r\n            let imageUri;\r\n            if (typeof imageJson.uri === 'undefined') {\r\n                let arrayBuffer = uint8Array;\r\n                if (uint8Array == null) {\r\n                    const bufferView = gltfJson.bufferViews[imageJson.bufferView];\r\n                    arrayBuffer = bufferView.buffer.buffer;\r\n                }\r\n                const imageUint8Array = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createUint8ArrayFromBufferViewInfo(gltfJson, imageJson.bufferView, uint8Array);\r\n                imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(imageUint8Array, imageJson.mimeType);\r\n            }\r\n            else {\r\n                let imageFileStr = imageJson.uri;\r\n                const splitted = imageFileStr.split('/');\r\n                const filename = splitted[splitted.length - 1];\r\n                if (options.files && options.files[filename]) {\r\n                    const arrayBuffer = options.files[filename];\r\n                    imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(new Uint8Array(arrayBuffer), imageJson.mimeType);\r\n                }\r\n                else if (imageFileStr.match(/^data:/)) {\r\n                    imageUri = imageFileStr;\r\n                }\r\n                else {\r\n                    imageUri = basePath + imageFileStr;\r\n                }\r\n            }\r\n            // if (options.extensionLoader && options.extensionLoader.setUVTransformToTexture) {\r\n            //   options.extensionLoader.setUVTransformToTexture(texture, samplerJson);\r\n            //\r\n            const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(imageUri, imageJson.mimeType).then(function (image) {\r\n                image.crossOrigin = 'Anonymous';\r\n                resources.images[i] = image;\r\n                imageJson.image = image;\r\n            });\r\n            promisesToLoadResources.push(promise);\r\n        }\r\n        if (options.defaultTextures) {\r\n            const basePath = options.defaultTextures.basePath;\r\n            const textureInfos = options.defaultTextures.textureInfos;\r\n            for (let textureInfo of textureInfos) {\r\n                const fileName = textureInfo.fileName;\r\n                const uri = basePath + fileName;\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                const mimeType = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getMimeTypeFromExtension(fileExtension);\r\n                const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(uri, mimeType).then(function (image) {\r\n                    image.crossOrigin = 'Anonymous';\r\n                    textureInfo.image = { image: image };\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n        }\r\n        return Promise.all(promisesToLoadResources).catch((err) => {\r\n            console.log('Promise.all error', err);\r\n        });\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new DrcPointCloudImporter();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    __decodeDraco(arrayBuffer, defaultOptions, basePath, options) {\r\n        return this.__decodeBuffer(arrayBuffer).then((json) => {\r\n            const gotText = JSON.stringify(json);\r\n            const gltfJson = JSON.parse(gotText);\r\n            return this._loadAsTextJson(gltfJson, options, defaultOptions, basePath).catch((err) => {\r\n                console.log('this.__loadAsTextJson error', err);\r\n            });\r\n        });\r\n    }\r\n    __decodeBuffer(arrayBuffer) {\r\n        const draco = new DracoDecoderModule();\r\n        const decoder = new draco.Decoder();\r\n        const dracoGeometry = this.__getGeometryFromDracoBuffer(draco, decoder, arrayBuffer);\r\n        if (dracoGeometry == null) {\r\n            throw new Error('invalid dracoGeometry.');\r\n        }\r\n        if (dracoGeometry.geometryType !== draco.POINT_CLOUD) {\r\n            throw new Error('invalid geometryType of drc file.');\r\n        }\r\n        const posAttId = decoder.GetAttributeId(dracoGeometry, draco.POSITION);\r\n        if (posAttId === -1) {\r\n            draco.destroy(decoder);\r\n            draco.destroy(dracoGeometry);\r\n            throw new Error('Draco: No position attribute found.');\r\n        }\r\n        const attributeNames = ['POSITION', 'NORMAL', 'COLOR', 'TEX_COORD', 'GENERIC'];\r\n        const numPoints = dracoGeometry.num_points();\r\n        const attributeDataAll = [];\r\n        const attributeComponents = [];\r\n        let bufferLength = 0;\r\n        for (let i = 0; i < attributeNames.length; i++) {\r\n            const attId = decoder.GetAttributeId(dracoGeometry, draco[attributeNames[i]]);\r\n            if (attId === -1) {\r\n                attributeNames.splice(i, 1);\r\n                i--;\r\n                continue;\r\n            }\r\n            const attribute = decoder.GetAttribute(dracoGeometry, attId);\r\n            const attributeData = new draco.DracoFloat32Array();\r\n            decoder.GetAttributeFloatForAllPoints(dracoGeometry, attribute, attributeData);\r\n            attributeDataAll[i] = attributeData;\r\n            const numComponent = attribute.num_components();\r\n            attributeComponents[i] = numComponent;\r\n            if (attributeNames[i] === 'COLOR') {\r\n                bufferLength += numPoints * 4;\r\n            }\r\n            else {\r\n                bufferLength += numPoints * numComponent;\r\n            }\r\n        }\r\n        const buffer = new Float32Array(bufferLength);\r\n        for (let i = 0, currentBufferIndex = 0; i < attributeNames.length; i++) {\r\n            if (attributeNames[i] === 'COLOR' && attributeComponents[i] === 3) {\r\n                for (var j = 0; j < numPoints; currentBufferIndex += 4, j += 3) {\r\n                    buffer[currentBufferIndex] = attributeDataAll[i].GetValue(j);\r\n                    buffer[currentBufferIndex + 1] = attributeDataAll[i].GetValue(j + 1);\r\n                    buffer[currentBufferIndex + 2] = attributeDataAll[i].GetValue(j + 2);\r\n                    buffer[currentBufferIndex + 3] = 1.0; // alpha value\r\n                }\r\n            }\r\n            else if (attributeNames[i] === 'TEX_COORD') {\r\n                for (var j = 0; j < numPoints; currentBufferIndex += 2, j++) {\r\n                    buffer[currentBufferIndex] = attributeDataAll[i].GetValue(2 * j);\r\n                    buffer[currentBufferIndex + 1] = 1.0 - attributeDataAll[i].GetValue(2 * j + 1);\r\n                }\r\n            }\r\n            else {\r\n                for (var j = 0; j < numPoints * attributeComponents[i]; currentBufferIndex++, j++) {\r\n                    buffer[currentBufferIndex] = attributeDataAll[i].GetValue(j);\r\n                }\r\n            }\r\n            draco.destroy(attributeDataAll[i]);\r\n        }\r\n        draco.destroy(decoder);\r\n        draco.destroy(dracoGeometry);\r\n        return this.__decodedBufferToJSON(buffer, numPoints, attributeNames, attributeComponents);\r\n    }\r\n    async __decodedBufferToJSON(buffer, numPoints, attributeNames, attributeComponents) {\r\n        const json = {\r\n            \"asset\": {\r\n                version: \"2.0\"\r\n            },\r\n            \"extensionsUsed\": [\r\n                \"KHR_materials_unlit\"\r\n            ],\r\n            \"extensionsRequired\": [\r\n                \"KHR_materials_unlit\"\r\n            ],\r\n            \"nodes\": [\r\n                {\r\n                    \"name\": \"Node\",\r\n                    \"mesh\": 0\r\n                }\r\n            ],\r\n            \"scenes\": [\r\n                {\r\n                    \"nodes\": [0]\r\n                }\r\n            ],\r\n            \"materials\": [\r\n                {\r\n                    \"name\": \"point-cloud_material\",\r\n                    \"pbrMetallicRoughness\": {\r\n                        \"baseColorFactor\": [1.0, 1.0, 1.0, 1.0]\r\n                    },\r\n                    \"extensions\": {\r\n                        \"KHR_materials_unlit\": {}\r\n                    }\r\n                },\r\n            ]\r\n        };\r\n        await this.__setBuffersToJSON(buffer, json);\r\n        this.__setAccessorsAndBufferViewsToJSON(numPoints, attributeNames, attributeComponents, json);\r\n        this.__setMeshesToJSON(attributeNames, json);\r\n        return new Promise((resolve, reject) => {\r\n            resolve(json);\r\n        });\r\n    }\r\n    __setBuffersToJSON(buffer, json) {\r\n        return this.__convertBufferToURI(buffer.buffer).then((uri) => {\r\n            json[\"buffers\"] = [\r\n                {\r\n                    \"name\": \"input\",\r\n                    \"byteLength\": buffer.byteLength,\r\n                    \"uri\": uri\r\n                }\r\n            ];\r\n        }).catch((err) => {\r\n            console.log('this.__convertBufferToURI error:', err);\r\n        });\r\n    }\r\n    __convertBufferToURI(arrayBuffer) {\r\n        return new Promise((resolve, reject) => {\r\n            const blob = new Blob([arrayBuffer], { type: 'application/octet-stream' });\r\n            const fr = new FileReader();\r\n            fr.onload = () => {\r\n                resolve(fr.result);\r\n            };\r\n            fr.onerror = () => {\r\n                reject(fr.error);\r\n            };\r\n            fr.readAsDataURL(blob);\r\n        });\r\n    }\r\n    __setAccessorsAndBufferViewsToJSON(numPoints, attributeNames, attributeComponents, json) {\r\n        const accessors = [];\r\n        const bufferViews = [];\r\n        let byteOffsetOfBufferView = 0;\r\n        for (let i = 0, indexOfBufferView = 0; i < attributeNames.length; indexOfBufferView++) {\r\n            const numOfComponents = attributeComponents[i];\r\n            let type;\r\n            if (numOfComponents === 1) {\r\n                type = \"SCALAR\";\r\n            }\r\n            else {\r\n                type = \"VEC\" + numOfComponents;\r\n            }\r\n            let byteOffsetOfAccessor = 0;\r\n            const attributeName = attributeNames[i];\r\n            while (i < attributeNames.length) {\r\n                accessors.push({\r\n                    \"name\": \"point-cloud_\" + attributeName + \"_\" + i,\r\n                    \"componentType\": 5126,\r\n                    \"count\": numPoints,\r\n                    \"type\": type,\r\n                    \"bufferView\": indexOfBufferView,\r\n                    \"byteOffset\": byteOffsetOfAccessor\r\n                });\r\n                if (attributeNames[i] === 'COLOR') {\r\n                    byteOffsetOfAccessor += numPoints * 4 * 4;\r\n                }\r\n                else {\r\n                    byteOffsetOfAccessor += numPoints * numOfComponents * 4;\r\n                }\r\n                i++;\r\n                if (attributeName != attributeNames[i]) {\r\n                    break;\r\n                }\r\n            }\r\n            bufferViews[indexOfBufferView] = {\r\n                \"name\": \"bufferView_\" + attributeName,\r\n                \"buffer\": 0,\r\n                \"byteLength\": byteOffsetOfAccessor,\r\n                \"byteOffset\": byteOffsetOfBufferView,\r\n                \"byteStride\": numOfComponents * 4,\r\n                \"target\": 34962 // gl.ARRAY_BUFFER\r\n            };\r\n            byteOffsetOfBufferView += byteOffsetOfAccessor;\r\n        }\r\n        json[\"accessors\"] = accessors;\r\n        json[\"bufferViews\"] = bufferViews;\r\n    }\r\n    __setMeshesToJSON(attributeNames, json) {\r\n        const attributes = {};\r\n        for (let i = 0; i < attributeNames.length; i++) {\r\n            if (attributeNames[i] === 'TEX_COORD') {\r\n                attributes['TEXCOORD_0'] = i;\r\n            }\r\n            else if (attributeNames[i] === 'GENERIC') {\r\n                attributes['TANGENT'] = i;\r\n            }\r\n            else {\r\n                attributes[attributeNames[i]] = i;\r\n            }\r\n        }\r\n        const mesh = {\r\n            \"name\": \"Node-Mesh\",\r\n            \"primitives\": [\r\n                {\r\n                    \"mode\": 0,\r\n                    \"material\": 0,\r\n                    \"attributes\": attributes\r\n                }\r\n            ]\r\n        };\r\n        json[\"meshes\"] = [mesh];\r\n    }\r\n    /**\r\n     * Import Draco file of point cloud type.\r\n     * WEIGHTS_0 and JOINTS_0 attribute and all the mesh type and is not support yet.\r\n     * @param uri - uri of glTF file\r\n     * @param options - options for loading process\r\n     * @returns a primitive of Rhodonite object\r\n     */\r\n    async importPointCloudToPrimitive(uri, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        if (options && options.files) {\r\n            for (let fileName in options.files) {\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                if (fileExtension === 'gltf' || fileExtension === 'glb') {\r\n                    return await this.__loadFromArrayBuffer(options.files[fileName], defaultOptions, basePath, options).catch((err) => {\r\n                        console.log('this.__loadFromArrayBuffer error', err);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        const arrayBuffer = await _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchArrayBuffer(uri);\r\n        return this.__decodeDracoDirect(arrayBuffer, options);\r\n    }\r\n    // tangent is not available\r\n    __decodeDracoDirect(arrayBuffer, options) {\r\n        const draco = new DracoDecoderModule();\r\n        const decoder = new draco.Decoder();\r\n        const dracoGeometry = this.__getGeometryFromDracoBuffer(draco, decoder, arrayBuffer);\r\n        if (dracoGeometry == null) {\r\n            throw new Error('invalid dracoGeometry.');\r\n        }\r\n        if (dracoGeometry.geometryType !== draco.POINT_CLOUD) {\r\n            throw new Error('invalid geometryType of drc file.');\r\n        }\r\n        const attributeCompositionTypes = [];\r\n        const attributeSemantics = [];\r\n        const attributes = [];\r\n        this.__getPositions(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes);\r\n        this.__getColors(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes);\r\n        this.__getNormals(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes);\r\n        this.__getTextureCoords(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes);\r\n        const primitive = _geometry_Primitive__WEBPACK_IMPORTED_MODULE_1__[\"default\"].createPrimitive({\r\n            attributeCompositionTypes: attributeCompositionTypes,\r\n            attributeSemantics: attributeSemantics,\r\n            attributes: attributes,\r\n            material: _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_2__[\"default\"].createClassicUberMaterial({ isSkinning: false, isLighting: true }),\r\n            primitiveMode: _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_4__[\"PrimitiveMode\"].Points\r\n        });\r\n        draco.destroy(decoder);\r\n        draco.destroy(dracoGeometry);\r\n        return new Promise((resolve, reject) => {\r\n            resolve(primitive);\r\n        });\r\n    }\r\n    __getGeometryFromDracoBuffer(draco, decoder, arrayBuffer) {\r\n        const buffer = new draco.DecoderBuffer();\r\n        buffer.Init(new Int8Array(arrayBuffer), arrayBuffer.byteLength);\r\n        const geometryType = decoder.GetEncodedGeometryType(buffer);\r\n        let dracoGeometry;\r\n        let decodingStatus;\r\n        if (geometryType === draco.TRIANGULAR_MESH) {\r\n            dracoGeometry = new draco.Mesh();\r\n            decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\r\n        }\r\n        else if (geometryType === draco.POINT_CLOUD) {\r\n            dracoGeometry = new draco.PointCloud();\r\n            decodingStatus = decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\r\n        }\r\n        else {\r\n            const errorMsg = 'Unknown geometry type.';\r\n            console.error(errorMsg);\r\n        }\r\n        dracoGeometry.geometryType = geometryType; // store\r\n        if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\r\n            let errorMsg = 'Decoding failed: ';\r\n            errorMsg += decodingStatus.error_msg();\r\n            console.error(errorMsg);\r\n            draco.destroy(decoder);\r\n            draco.destroy(dracoGeometry);\r\n            return void 0;\r\n        }\r\n        draco.destroy(buffer);\r\n        return dracoGeometry;\r\n    }\r\n    __getPositions(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes) {\r\n        const posAttId = decoder.GetAttributeId(dracoGeometry, draco.POSITION);\r\n        if (posAttId === -1) {\r\n            draco.destroy(decoder);\r\n            draco.destroy(dracoGeometry);\r\n            throw new Error('Draco: No position attribute found.');\r\n        }\r\n        const posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);\r\n        const posAttributeData = new draco.DracoFloat32Array();\r\n        decoder.GetAttributeFloatForAllPoints(dracoGeometry, posAttribute, posAttributeData);\r\n        const numPoints = dracoGeometry.num_points();\r\n        const numVertices = numPoints * 3;\r\n        const positions = new Float32Array(numVertices);\r\n        for (var i = 0; i < numVertices; i += 1) {\r\n            positions[i] = posAttributeData.GetValue(i); // XYZ XYZ\r\n        }\r\n        attributeCompositionTypes.push(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3);\r\n        attributeSemantics.push(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_5__[\"VertexAttribute\"].Position);\r\n        attributes.push(positions);\r\n        draco.destroy(posAttributeData);\r\n        return positions;\r\n    }\r\n    __getColors(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes) {\r\n        // Get color attributes if exists.\r\n        const colorAttId = decoder.GetAttributeId(dracoGeometry, draco.COLOR);\r\n        if (colorAttId === -1) {\r\n            return null;\r\n        }\r\n        else {\r\n            //console.log('Loaded color attribute.');\r\n            const colAttribute = decoder.GetAttribute(dracoGeometry, colorAttId);\r\n            const colAttributeData = new draco.DracoFloat32Array();\r\n            decoder.GetAttributeFloatForAllPoints(dracoGeometry, colAttribute, colAttributeData);\r\n            const numPoints = dracoGeometry.num_points();\r\n            const numComponents = colAttribute.num_components();\r\n            const numVertices = numPoints * 4;\r\n            const colors = new Float32Array(numVertices);\r\n            for (let i = 0; i < numVertices; i += numComponents) {\r\n                colors[i] = colAttributeData.GetValue(i);\r\n                colors[i + 1] = colAttributeData.GetValue(i + 1);\r\n                colors[i + 2] = colAttributeData.GetValue(i + 2);\r\n                if (numComponents == 4) {\r\n                    colors[i + 3] = colAttributeData.GetValue(i + 3);\r\n                }\r\n                else {\r\n                    colors[i + 3] = 1.0;\r\n                }\r\n            }\r\n            attributeCompositionTypes.push(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3);\r\n            attributeSemantics.push(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_5__[\"VertexAttribute\"].Color0);\r\n            attributes.push(colors);\r\n            draco.destroy(colAttributeData);\r\n            return colors;\r\n        }\r\n    }\r\n    __getNormals(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes) {\r\n        // Get normal attributes if exists.\r\n        const normalAttId = decoder.GetAttributeId(dracoGeometry, draco.NORMAL);\r\n        if (normalAttId === -1) {\r\n            return null;\r\n        }\r\n        else {\r\n            //console.log('Loaded normal attribute.');\r\n            const norAttribute = decoder.GetAttribute(dracoGeometry, normalAttId);\r\n            const norAttributeData = new draco.DracoFloat32Array();\r\n            decoder.GetAttributeFloatForAllPoints(dracoGeometry, norAttribute, norAttributeData);\r\n            const numPoints = dracoGeometry.num_points();\r\n            const numVertices = numPoints * 3;\r\n            const normals = new Float32Array(numVertices);\r\n            for (var i = 0; i < numVertices; i += 1) {\r\n                normals[i] = norAttributeData.GetValue(i); // XYZ XYZ\r\n            }\r\n            attributeCompositionTypes.push(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3);\r\n            attributeSemantics.push(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_5__[\"VertexAttribute\"].Normal);\r\n            attributes.push(normals);\r\n            draco.destroy(norAttributeData);\r\n            return normals;\r\n        }\r\n    }\r\n    __getTextureCoords(draco, decoder, dracoGeometry, attributeCompositionTypes, attributeSemantics, attributes) {\r\n        // Get texture coordinate attributes if exists.\r\n        const texCoordAttId = decoder.GetAttributeId(dracoGeometry, draco.TEX_COORD);\r\n        if (texCoordAttId === -1) {\r\n            return null;\r\n        }\r\n        else {\r\n            const texCoordAttribute = decoder.GetAttribute(dracoGeometry, texCoordAttId);\r\n            const texCoordAttributeData = new draco.DracoFloat32Array();\r\n            decoder.GetAttributeFloatForAllPoints(dracoGeometry, texCoordAttribute, texCoordAttributeData);\r\n            const numPoints = dracoGeometry.num_points();\r\n            const numVertices = numPoints * 2;\r\n            const texCoords = new Float32Array(numVertices);\r\n            for (var i = 0; i < numVertices; i += 1) {\r\n                texCoords[i] = texCoordAttributeData.GetValue(i); // XYZ XYZ\r\n            }\r\n            attributeCompositionTypes.push(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec2);\r\n            attributeSemantics.push(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_5__[\"VertexAttribute\"].Texcoord0);\r\n            attributes.push(texCoords);\r\n            draco.destroy(texCoordAttributeData);\r\n            return texCoords;\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/DrcPointCloudImporter.ts?");

/***/ }),

/***/ "./src/foundation/importer/FormatDetector.ts":
/*!***************************************************!*\
  !*** ./src/foundation/importer/FormatDetector.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return detectFormat; });\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n\r\nasync function detectFormat(uri, files) {\r\n    if (files) {\r\n        for (let fileName in files) {\r\n            const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n            if (fileExtension === 'gltf' || fileExtension === 'glb') {\r\n                return new Promise((resolve, reject) => {\r\n                    checkArrayBufferOfGltf(files[fileName], resolve);\r\n                });\r\n            }\r\n            else if (fileExtension === 'drc') {\r\n                return new Promise((resolve, reject) => {\r\n                    resolve('Draco');\r\n                });\r\n            }\r\n            else if (fileExtension === 'vrm') {\r\n                return new Promise((resolve, reject) => {\r\n                    resolve('VRM');\r\n                });\r\n            }\r\n        }\r\n    }\r\n    const splitted = uri.split('.');\r\n    const fileExtension = splitted[splitted.length - 1];\r\n    if (fileExtension === 'efk') {\r\n        return new Promise((resolve, reject) => {\r\n            resolve('Effekseer');\r\n        });\r\n    }\r\n    else if (fileExtension === 'drc') {\r\n        return new Promise((resolve, reject) => {\r\n            resolve('Draco');\r\n        });\r\n    }\r\n    else if (fileExtension === 'vrm') {\r\n        return new Promise((resolve, reject) => {\r\n            resolve('VRM');\r\n        });\r\n    }\r\n    // glTF\r\n    return _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].loadResourceAsync(uri, true, (resolve, response) => {\r\n        const arrayBuffer = response;\r\n        checkArrayBufferOfGltf(arrayBuffer, resolve);\r\n        console.warn('discard downloaded arrayBuffer');\r\n    }, (rejects, status) => {\r\n        console.log(status);\r\n    });\r\n}\r\nfunction checkArrayBufferOfGltf(arrayBuffer, resolve) {\r\n    const isLittleEndian = true;\r\n    const dataView = new DataView(arrayBuffer, 0, 20);\r\n    // Magic field\r\n    const magic = dataView.getUint32(0, isLittleEndian);\r\n    // 0x46546C67 is 'glTF' in ASCII codes.\r\n    if (magic !== 0x46546C67) {\r\n        // It must be normal glTF (NOT binary) file...\r\n        let gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(arrayBuffer);\r\n        let gltfJson = JSON.parse(gotText);\r\n        let glTFVer = checkGLTFVersion(gltfJson);\r\n        resolve(\"glTF\" + glTFVer);\r\n        return;\r\n    }\r\n    let glTFVer = dataView.getUint32(4, isLittleEndian);\r\n    resolve(\"glTF\" + glTFVer);\r\n}\r\nfunction checkGLTFVersion(gltfJson) {\r\n    let glTFVer = 1.0;\r\n    if (gltfJson.asset && gltfJson.asset.version) {\r\n        glTFVer = parseFloat(gltfJson.asset.version);\r\n    }\r\n    return glTFVer;\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/FormatDetector.ts?");

/***/ }),

/***/ "./src/foundation/importer/Gltf1Importer.ts":
/*!**************************************************!*\
  !*** ./src/foundation/importer/Gltf1Importer.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Gltf1Importer; });\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n\r\nclass Gltf1Importer {\r\n    constructor() {\r\n    }\r\n    /**\r\n     * the method to load glTF1 file.\r\n     * @param uri - uri of glTF file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    async import(uri, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        if (options && options.files) {\r\n            for (let fileName in options.files) {\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                if (fileExtension === 'gltf' || fileExtension === 'glb') {\r\n                    return await this.__loadFromArrayBuffer(options.files[fileName], defaultOptions, basePath, options);\r\n                }\r\n            }\r\n        }\r\n        const arrayBuffer = await _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchArrayBuffer(uri);\r\n        return await this.__loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options);\r\n    }\r\n    /**\r\n     * Import glTF1 file\r\n     * @param uri - uri of glTF file\r\n     * @param arrayBuffer - fetched glTF file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    importArrayBuffer(uri, arrayBuffer, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        return this.__loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options).catch((err) => {\r\n            console.log('__loadFromArrayBuffer error', err);\r\n        });\r\n    }\r\n    async __loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options) {\r\n        const dataView = new DataView(arrayBuffer, 0, 20);\r\n        const isLittleEndian = true;\r\n        // Magic field\r\n        const magic = dataView.getUint32(0, isLittleEndian);\r\n        let result;\r\n        // 0x46546C67 is 'glTF' in ASCII codes.\r\n        if (magic !== 0x46546C67) {\r\n            //const json = await response.json();\r\n            const gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(arrayBuffer);\r\n            const json = JSON.parse(gotText);\r\n            result = await this._loadAsTextJson(json, options, defaultOptions, basePath);\r\n        }\r\n        else {\r\n            result = await this._loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath);\r\n        }\r\n        return result;\r\n    }\r\n    _getOptions(defaultOptions, json, options) {\r\n        if (json.asset && json.asset.extras && json.asset.extras.rnLoaderOptions) {\r\n            for (let optionName in json.asset.extras.rnLoaderOptions) {\r\n                defaultOptions[optionName] = json.asset.extras.rnLoaderOptions[optionName];\r\n            }\r\n        }\r\n        for (let optionName in options) {\r\n            defaultOptions[optionName] = options[optionName];\r\n        }\r\n        if (options && options.loaderExtension && typeof options.loaderExtension === \"string\") {\r\n            if (Rn[options.loaderExtension] != null) {\r\n                defaultOptions.loaderExtension = Rn[options.loaderExtension].getInstance();\r\n            }\r\n            else {\r\n                console.error(`${options.loaderExtension} not found!`);\r\n                defaultOptions.loaderExtension = void 0;\r\n            }\r\n        }\r\n        return defaultOptions;\r\n    }\r\n    async _loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath) {\r\n        let gltfVer = dataView.getUint32(4, isLittleEndian);\r\n        if (gltfVer !== 1) {\r\n            throw new Error('invalid version field in this binary glTF file.');\r\n        }\r\n        let lengthOfJSonChunkData = dataView.getUint32(12, isLittleEndian);\r\n        let chunkType = dataView.getUint32(16, isLittleEndian);\r\n        // 0 means JSON format\r\n        if (chunkType !== 0) {\r\n            throw new Error('invalid chunkType of chunk0 in this binary glTF file.');\r\n        }\r\n        let uint8ArrayJSonContent = new Uint8Array(arrayBuffer, 20, lengthOfJSonChunkData);\r\n        let gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].uint8ArrayToString(uint8ArrayJSonContent);\r\n        let gltfJson = JSON.parse(gotText);\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        let uint8array = new Uint8Array(arrayBuffer, 20 + lengthOfJSonChunkData);\r\n        if (gltfJson.asset === undefined) {\r\n            gltfJson.asset = {};\r\n        }\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"1\" };\r\n        }\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        const result = await this._loadInner(uint8array, basePath, gltfJson, options);\r\n        return result[0][0];\r\n    }\r\n    async _loadAsTextJson(gltfJson, options, defaultOptions, basePath) {\r\n        if (gltfJson.asset === undefined) {\r\n            gltfJson.asset = {};\r\n        }\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"1\" };\r\n        }\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        const result = await this._loadInner(undefined, basePath, gltfJson, options);\r\n        return result[0][0];\r\n    }\r\n    _loadInner(uint8array, basePath, gltfJson, options) {\r\n        let promises = [];\r\n        let resources = {\r\n            shaders: [],\r\n            buffers: [],\r\n            images: []\r\n        };\r\n        promises.push(this._loadResources(uint8array, basePath, gltfJson, options, resources));\r\n        promises.push(new Promise((resolve, reject) => {\r\n            this._loadJsonContent(gltfJson, options);\r\n            resolve();\r\n        }));\r\n        return Promise.all(promises);\r\n    }\r\n    _loadJsonContent(gltfJson, options) {\r\n        this._convertToGltf2LikeStructure(gltfJson);\r\n        // Scene\r\n        this._loadDependenciesOfScenes(gltfJson);\r\n        // Node\r\n        this._loadDependenciesOfNodes(gltfJson);\r\n        // Mesh\r\n        this._loadDependenciesOfMeshes(gltfJson);\r\n        // Material\r\n        this._loadDependenciesOfMaterials(gltfJson);\r\n        // Texture\r\n        this._loadDependenciesOfTextures(gltfJson);\r\n        // Joint\r\n        this._loadDependenciesOfJoints(gltfJson);\r\n        // Animation\r\n        this._loadDependenciesOfAnimations(gltfJson);\r\n        // Accessor\r\n        this._loadDependenciesOfAccessors(gltfJson);\r\n        // BufferView\r\n        this._loadDependenciesOfBufferViews(gltfJson);\r\n    }\r\n    _convertToGltf2LikeStructure(gltfJson) {\r\n        gltfJson.bufferDic = gltfJson.buffers;\r\n        this.__createProperty(gltfJson, gltfJson.bufferDic, \"buffers\");\r\n        gltfJson.sceneDic = gltfJson.scenes;\r\n        this.__createProperty(gltfJson, gltfJson.sceneDic, \"scenes\");\r\n        gltfJson.meshDic = gltfJson.meshes;\r\n        {\r\n            let count = 0;\r\n            gltfJson.nodeDic = gltfJson.nodes;\r\n            gltfJson.nodes = [];\r\n            gltfJson.nodesIndices = [];\r\n            for (let nodeName in gltfJson.nodeDic) {\r\n                gltfJson.nodesIndices.push(count);\r\n                const node = gltfJson.nodeDic[nodeName];\r\n                node._index = count++;\r\n                gltfJson.nodes.push(node);\r\n            }\r\n        }\r\n        gltfJson.skinDic = gltfJson.skins;\r\n        this.__createProperty(gltfJson, gltfJson.skinDic, \"skins\");\r\n        gltfJson.materialDic = gltfJson.materials;\r\n        this.__createProperty(gltfJson, gltfJson.materialDic, \"materials\");\r\n        gltfJson.animationDic = gltfJson.animations;\r\n        this.__createProperty(gltfJson, gltfJson.animationDic, \"animations\");\r\n        gltfJson.accessorDic = gltfJson.accessors;\r\n        gltfJson.bufferViewDic = gltfJson.bufferViews;\r\n        gltfJson.cameraDic = gltfJson.cameras;\r\n        gltfJson.imageDic = gltfJson.images;\r\n        gltfJson.samplerDic = gltfJson.samplers;\r\n        gltfJson.shaderDic = gltfJson.shaders;\r\n        gltfJson.textureDic = gltfJson.textures;\r\n    }\r\n    __createProperty(gltfJson, gltfPropertyDic, gltfPropertyName) {\r\n        if (gltfJson[gltfPropertyName] == null) {\r\n            return;\r\n        }\r\n        const propertyNumber = Object.keys(gltfPropertyDic).length;\r\n        const propertyArray = gltfJson[gltfPropertyName] = new Array(propertyNumber);\r\n        let i = 0;\r\n        for (let propertyName in gltfPropertyDic) {\r\n            propertyArray[i] = gltfPropertyDic[propertyName];\r\n            i++;\r\n        }\r\n    }\r\n    _loadDependenciesOfScenes(gltfJson) {\r\n        for (let sceneName in gltfJson.sceneDic) {\r\n            const scene = gltfJson.sceneDic[sceneName];\r\n            scene.nodeNames = scene.nodes;\r\n            scene.nodes = [];\r\n            scene.nodesIndices = [];\r\n            for (let name of scene.nodeNames) {\r\n                scene.nodes.push(gltfJson.nodeDic[name]);\r\n                // calc index of 'name' in gltfJson.nodeDic enumerate\r\n                let count = 0;\r\n                for (let nodeName in gltfJson.nodeDic) {\r\n                    if (nodeName === name) {\r\n                        break;\r\n                    }\r\n                    count++;\r\n                }\r\n                scene.nodesIndices.push(count);\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfNodes(gltfJson) {\r\n        for (let node of gltfJson.nodes) {\r\n            //const node = (gltfJson.nodeDic as any)[nodeName];\r\n            // Hierarchy\r\n            if (node.children) {\r\n                node.childrenNames = node.children.concat();\r\n                node.children = [];\r\n                node.childrenIndices = [];\r\n                for (let name of node.childrenNames) {\r\n                    const childNode = gltfJson.nodeDic[name];\r\n                    node.children.push(childNode);\r\n                    node.childrenIndices.push(childNode._index);\r\n                }\r\n            }\r\n            // Mesh\r\n            if (node.meshes !== void 0 && gltfJson.meshes !== void 0) {\r\n                node.meshNames = node.meshes;\r\n                node.meshes = [];\r\n                for (let name of node.meshNames) {\r\n                    node.meshes.push(gltfJson.meshDic[name]);\r\n                }\r\n                node.mesh = node.meshes[1];\r\n                if (node.meshes == null || node.meshes.length === 0) {\r\n                    node.mesh = node.meshes[0];\r\n                }\r\n                else {\r\n                    const mergedMesh = {\r\n                        name: '',\r\n                        primitives: []\r\n                    };\r\n                    for (let i = 0; i < node.meshes.length; i++) {\r\n                        mergedMesh.name += '_' + node.meshes[i].name;\r\n                        Array.prototype.push.apply(mergedMesh.primitives, node.meshes[i].primitives);\r\n                    }\r\n                    mergedMesh.name += '_merged';\r\n                    node.mesh = mergedMesh;\r\n                    node.meshes = void 0;\r\n                }\r\n            }\r\n            // Skin\r\n            if (node.skin !== void 0 && gltfJson.skins !== void 0) {\r\n                if (typeof node.skin === 'string') {\r\n                    node.skinName = node.skin;\r\n                    node.skin = gltfJson.skinDic[node.skinName];\r\n                }\r\n                // if (node.mesh.extras === void 0) {\r\n                //   node.mesh.extras = {};\r\n                // }\r\n                //node.mesh.extras._skin = node.skin;\r\n            }\r\n            // Camera\r\n            if (node.camera !== void 0 && gltfJson.cameras !== void 0) {\r\n                node.cameraName = node.camera;\r\n                node.camera = gltfJson.cameraDic[node.cameraName];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfMeshes(gltfJson) {\r\n        // Mesh\r\n        for (let meshName in gltfJson.meshDic) {\r\n            const mesh = gltfJson.meshDic[meshName];\r\n            for (let primitive of mesh.primitives) {\r\n                if (primitive.material !== void 0) {\r\n                    primitive.materialName = primitive.material;\r\n                    primitive.material = gltfJson.materialDic[primitive.materialName];\r\n                    primitive.materialIndex = gltfJson.materials.indexOf(primitive.material);\r\n                }\r\n                primitive.attributeNames = Object.assign({}, primitive.attributes);\r\n                primitive.attributes = [];\r\n                for (let attributeName in primitive.attributeNames) {\r\n                    if (primitive.attributeNames[attributeName] != null) {\r\n                        const accessorName = primitive.attributeNames[attributeName];\r\n                        let accessor = gltfJson.accessorDic[accessorName];\r\n                        if (attributeName === 'JOINT') {\r\n                            attributeName = 'JOINTS_0';\r\n                            delete primitive.attributes['JOINT'];\r\n                        }\r\n                        else if (attributeName === 'WEIGHT') {\r\n                            attributeName = 'WEIGHTS_0';\r\n                            delete primitive.attributes['WEIGHT'];\r\n                        }\r\n                        accessor.extras = {\r\n                            toGetAsTypedArray: true,\r\n                            attributeName: attributeName\r\n                        };\r\n                        primitive.attributes.push(accessor);\r\n                    }\r\n                    else {\r\n                        //primitive.attributes[attributeName] = void 0;\r\n                    }\r\n                }\r\n                if (primitive.indices !== void 0) {\r\n                    primitive.indicesName = primitive.indices;\r\n                    primitive.indices = gltfJson.accessorDic[primitive.indicesName];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _isKHRMaterialsCommon(materialJson) {\r\n        if (typeof materialJson.extensions !== 'undefined' && typeof materialJson.extensions.KHR_materials_common !== 'undefined') {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    _loadDependenciesOfMaterials(gltfJson) {\r\n        // Material\r\n        if (gltfJson.materials) {\r\n            for (let materialStr in gltfJson.materials) {\r\n                let material = gltfJson.materials[materialStr];\r\n                const origMaterial = material;\r\n                if (this._isKHRMaterialsCommon(material)) {\r\n                    material = material.extensions.KHR_materials_common;\r\n                }\r\n                const setParameters = (values, isParameter) => {\r\n                    for (let valueName in values) {\r\n                        let value = null;\r\n                        if (isParameter) {\r\n                            value = values[valueName].value;\r\n                            if (typeof value === 'undefined') {\r\n                                continue;\r\n                            }\r\n                        }\r\n                        else {\r\n                            value = values[valueName];\r\n                        }\r\n                        if (typeof value === 'string') {\r\n                            let textureStr = value;\r\n                            let texturePurpose;\r\n                            if (valueName === 'diffuse' || (material.technique === \"CONSTANT\" && valueName === 'ambient')) {\r\n                                origMaterial.diffuseColorTexture = {};\r\n                                origMaterial.diffuseColorTexture.texture = gltfJson.textures[value];\r\n                            }\r\n                            else if (valueName === 'emission' && textureStr.match(/_normal$/)) {\r\n                                origMaterial.emissionTexture = {};\r\n                                origMaterial.emissionTexture.texture = gltfJson.textures[value];\r\n                            }\r\n                            origMaterial.extras = {};\r\n                            origMaterial.extras.technique = material.technique;\r\n                        }\r\n                        else {\r\n                            if (valueName === 'diffuse') {\r\n                                origMaterial.diffuseColorFactor = value;\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n                setParameters(material.values, false);\r\n                if (material.technique && gltfJson.techniques) {\r\n                    if (typeof gltfJson.techniques[material.technique] !== \"undefined\") {\r\n                        setParameters(gltfJson.techniques[material.technique].parameters, true);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfTextures(gltfJson) {\r\n        // Texture\r\n        if (gltfJson.textures) {\r\n            for (let textureName in gltfJson.textureDic) {\r\n                const texture = gltfJson.textureDic[textureName];\r\n                if (texture.sampler !== void 0) {\r\n                    texture.samplerName = texture.sampler;\r\n                    texture.sampler = gltfJson.samplerDic[texture.samplerName];\r\n                }\r\n                if (texture.source !== void 0) {\r\n                    texture.sourceName = texture.source;\r\n                    texture.image = gltfJson.imageDic[texture.sourceName];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfJoints(gltfJson) {\r\n        if (gltfJson.skins) {\r\n            for (let skinName in gltfJson.skinDic) {\r\n                const skin = gltfJson.skinDic[skinName];\r\n                skin.joints = [];\r\n                skin.jointsIndices = [];\r\n                for (let jointName of skin.jointNames) {\r\n                    const joint = gltfJson.nodeDic[jointName];\r\n                    skin.joints.push(joint);\r\n                    skin.jointsIndices.push(joint._index);\r\n                }\r\n                skin.skeletonNames = skin.skeletons;\r\n                if (skin.skeletonNames) {\r\n                    for (let name of skin.skeletonNames) {\r\n                        skin.skeleton = skin.skeletons.push(gltfJson.nodeDic[name]);\r\n                    }\r\n                }\r\n                else {\r\n                    skin.skeleton = skin.joints[0];\r\n                }\r\n                skin.skeletonIndex = skin.skeleton._index;\r\n                skin.inverseBindMatricesName = skin.inverseBindMatrices;\r\n                skin.inverseBindMatrices = gltfJson.accessorDic[skin.inverseBindMatricesName];\r\n                skin.joints_tmp = skin.joints;\r\n                skin.joints = [];\r\n                for (let joint of skin.joints_tmp) {\r\n                    skin.joints.push(gltfJson.nodeDic[joint.name]);\r\n                }\r\n                skin.joints_tmp = void 0;\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAnimations(gltfJson) {\r\n        if (gltfJson.animations) {\r\n            for (let animationName in gltfJson.animationDic) {\r\n                const animation = gltfJson.animationDic[animationName];\r\n                animation.samplerDic = animation.samplers;\r\n                animation.samplers = [];\r\n                for (let channel of animation.channels) {\r\n                    channel.sampler = animation.samplerDic[channel.sampler];\r\n                    channel.target.node = gltfJson.nodeDic[channel.target.id];\r\n                    channel.target.nodeIndex = channel.target.node._index;\r\n                    channel.sampler.input = gltfJson.accessors[animation.parameters['TIME']];\r\n                    channel.sampler.output = gltfJson.accessors[animation.parameters[channel.target.path]];\r\n                    animation.samplers.push(channel.sampler);\r\n                    if (channel.target.path === 'rotation') {\r\n                        if (channel.sampler.output.extras === void 0) {\r\n                            channel.sampler.output.extras = {};\r\n                        }\r\n                        channel.sampler.output.extras.quaternionIfVec4 = true;\r\n                    }\r\n                }\r\n                animation.channelDic = animation.channels;\r\n                animation.channels = [];\r\n                for (let channel of animation.channelDic) {\r\n                    animation.channels.push(channel);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAccessors(gltfJson) {\r\n        // Accessor\r\n        for (let accessorName in gltfJson.accessorDic) {\r\n            const accessor = gltfJson.accessorDic[accessorName];\r\n            if (accessor.bufferView !== void 0) {\r\n                accessor.bufferViewName = accessor.bufferView;\r\n                accessor.bufferView = gltfJson.bufferViewDic[accessor.bufferViewName];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfBufferViews(gltfJson) {\r\n        // BufferView\r\n        for (let bufferViewName in gltfJson.bufferViewDic) {\r\n            const bufferView = gltfJson.bufferViewDic[bufferViewName];\r\n            if (bufferView.buffer !== void 0) {\r\n                bufferView.bufferName = bufferView.buffer;\r\n                bufferView.buffer = gltfJson.bufferDic[bufferView.bufferName];\r\n                let bufferIdx = 0;\r\n                for (let bufferName in gltfJson.bufferDic) {\r\n                    if (bufferName === bufferView.bufferName) {\r\n                        bufferView.bufferIndex = bufferIdx;\r\n                    }\r\n                    bufferIdx++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _mergeExtendedJson(gltfJson, extendedData) {\r\n        let extendedJson = null;\r\n        if (extendedData instanceof ArrayBuffer) {\r\n            const extendedJsonStr = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(extendedData);\r\n            extendedJson = JSON.parse(extendedJsonStr);\r\n        }\r\n        else if (typeof extendedData === 'string') {\r\n            extendedJson = JSON.parse(extendedData);\r\n            extendedJson = extendedJson;\r\n        }\r\n        else if (typeof extendedData === 'object') {\r\n            extendedJson = extendedData;\r\n        }\r\n        else {\r\n        }\r\n        Object.assign(gltfJson, extendedJson);\r\n    }\r\n    _loadResources(uint8Array, basePath, gltfJson, options, resources) {\r\n        let promisesToLoadResources = [];\r\n        // Shaders Async load\r\n        // for (let _i in gltfJson.shaders) {\r\n        //   const i = _i as any as number;\r\n        //   resources.shaders[i] = {};\r\n        //   let shaderJson = gltfJson.shaders[i];\r\n        //   let shaderType = shaderJson.type;\r\n        //   if (typeof shaderJson.extensions !== 'undefined' && typeof shaderJson.extensions.KHR_binary_glTF !== 'undefined') {\r\n        //     resources.shaders[i].shaderText = this._accessBinaryAsShader(shaderJson.extensions.KHR_binary_glTF.bufferView, gltfJson, arrayBufferBinary);\r\n        //     resources.shaders[i].shaderType = shaderType;\r\n        //     continue;\r\n        //   }\r\n        //   let shaderUri = shaderJson.uri;\r\n        //   if (options.files) {\r\n        //     const splitted = shaderUri.split('/');\r\n        //     const filename = splitted[splitted.length - 1];\r\n        //     if (options.files[filename]) {\r\n        //       const arrayBuffer = options.files[filename];\r\n        //       resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //       resources.shaders[i].shaderType = shaderType;\r\n        //       continue;\r\n        //     }\r\n        //   }\r\n        //   if (shaderUri.match(/^data:/)) {\r\n        //     promisesToLoadResources.push(\r\n        //       new Promise((resolve, rejected) => {\r\n        //         let arrayBuffer = DataUtil.dataUriToArrayBuffer(shaderUri);\r\n        //         resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //         resources.shaders[i].shaderType = shaderType;\r\n        //         resolve();\r\n        //       })\r\n        //     );\r\n        //   } else {\r\n        //     shaderUri = basePath + shaderUri;\r\n        //     promisesToLoadResources.push(\r\n        //       DataUtil.loadResourceAsync(shaderUri, false,\r\n        //         (resolve:Function, response:any)=>{\r\n        //           resources.shaders[i].shaderText = response;\r\n        //           resources.shaders[i].shaderType = shaderType;\r\n        //           resolve(gltfJson);\r\n        //         },\r\n        //         (reject:Function, error:any)=>{\r\n        //         }\r\n        //       )\r\n        //     );\r\n        //   }\r\n        // }\r\n        // Buffers Async load\r\n        for (let i in gltfJson.buffers) {\r\n            let bufferInfo = gltfJson.buffers[i];\r\n            let filename = '';\r\n            if (bufferInfo.uri) {\r\n                const splitUri = bufferInfo.uri.split('/');\r\n                filename = splitUri[splitUri.length - 1];\r\n            }\r\n            if (typeof bufferInfo.uri === 'undefined') {\r\n                promisesToLoadResources.push(new Promise((resolve, rejected) => {\r\n                    resources.buffers[i] = uint8Array;\r\n                    bufferInfo.buffer = uint8Array;\r\n                    resolve(gltfJson);\r\n                }));\r\n            }\r\n            else if (bufferInfo.uri === '' || bufferInfo.uri === 'data:,') {\r\n                promisesToLoadResources.push(new Promise((resolve, rejected) => {\r\n                    resources.buffers[i] = uint8Array;\r\n                    bufferInfo.buffer = uint8Array;\r\n                    resolve(gltfJson);\r\n                }));\r\n            }\r\n            else if (bufferInfo.uri.match(/^data:application\\/(.*);base64,/)) {\r\n                promisesToLoadResources.push(new Promise((resolve, rejected) => {\r\n                    const arrayBuffer = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dataUriToArrayBuffer(bufferInfo.uri);\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(gltfJson);\r\n                }));\r\n            }\r\n            else if (options.files && this.__containsFileName(options.files, filename)) {\r\n                promisesToLoadResources.push(new Promise((resolve, reject) => {\r\n                    const fullPath = this.__getFullPathOfFileName(options.files, filename);\r\n                    const arrayBuffer = options.files[fullPath];\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(gltfJson);\r\n                }));\r\n            }\r\n            else {\r\n                promisesToLoadResources.push(_misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].loadResourceAsync(basePath + bufferInfo.uri, true, (resolve, response) => {\r\n                    resources.buffers[i] = new Uint8Array(response);\r\n                    bufferInfo.buffer = new Uint8Array(response);\r\n                    resolve(gltfJson);\r\n                }, (reject, error) => {\r\n                }));\r\n            }\r\n        }\r\n        // Textures Async load\r\n        for (let _i in gltfJson.images) {\r\n            const i = _i;\r\n            let imageJson = gltfJson.images[i];\r\n            //let imageJson = gltfJson.images[textureJson.source];\r\n            //let samplerJson = gltfJson.samplers[textureJson.sampler];\r\n            let imageUri;\r\n            if (typeof imageJson.extensions !== 'undefined' && typeof imageJson.extensions.KHR_binary_glTF !== 'undefined') {\r\n                const imageUint8Array = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createUint8ArrayFromBufferViewInfo(gltfJson, imageJson.extensions.KHR_binary_glTF.bufferView, uint8Array);\r\n                imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(imageUint8Array, imageJson.extensions.KHR_binary_glTF.mimeType);\r\n            }\r\n            else if (typeof imageJson.uri === 'undefined') {\r\n                const imageUint8Array = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createUint8ArrayFromBufferViewInfo(gltfJson, imageJson.bufferView, uint8Array);\r\n                imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(imageUint8Array, imageJson.mimeType);\r\n            }\r\n            else {\r\n                const imageFileStr = imageJson.uri;\r\n                const splitUri = imageFileStr.split('/');\r\n                const filename = splitUri[splitUri.length - 1];\r\n                if (options.files && this.__containsFileName(options.files, filename)) {\r\n                    const fullPath = this.__getFullPathOfFileName(options.files, filename);\r\n                    const arrayBuffer = options.files[fullPath];\r\n                    imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(new Uint8Array(arrayBuffer), imageJson.mimeType);\r\n                }\r\n                else if (imageFileStr.match(/^data:/)) {\r\n                    imageUri = imageFileStr;\r\n                }\r\n                else {\r\n                    imageUri = basePath + imageFileStr;\r\n                }\r\n            }\r\n            if (imageUri.match(/basis$/)) {\r\n                const promise = new Promise(async (resolve) => {\r\n                    const response = await fetch(imageUri);\r\n                    const buffer = await response.arrayBuffer();\r\n                    const uint8Array = new Uint8Array(buffer);\r\n                    imageJson.basis = uint8Array;\r\n                    resolve();\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n            else if (imageJson.uri != null && imageJson.uri.match(/basis$/)) {\r\n                const promise = new Promise((resolve) => {\r\n                    imageJson.basis = new Uint8Array(options.files[imageJson.uri]);\r\n                    resolve();\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n            else {\r\n                const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(imageUri, imageJson.mimeType).then(function (image) {\r\n                    image.crossOrigin = 'Anonymous';\r\n                    resources.images[i] = image;\r\n                    imageJson.image = image;\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n        }\r\n        if (options.defaultTextures) {\r\n            const basePath = options.defaultTextures.basePath;\r\n            const textureInfos = options.defaultTextures.textureInfos;\r\n            for (let textureInfo of textureInfos) {\r\n                const fileName = textureInfo.fileName;\r\n                const uri = basePath + fileName;\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                const mimeType = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getMimeTypeFromExtension(fileExtension);\r\n                const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(uri, mimeType).then(function (image) {\r\n                    image.crossOrigin = 'Anonymous';\r\n                    textureInfo.image = { image: image };\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n        }\r\n        return Promise.all(promisesToLoadResources);\r\n    }\r\n    __containsFileName(optionsFiles, filename) {\r\n        for (let key in optionsFiles) {\r\n            const split = key.split('/');\r\n            const last = split[split.length - 1];\r\n            if (last === filename) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    __getFullPathOfFileName(optionsFiles, filename) {\r\n        for (let key in optionsFiles) {\r\n            const split = key.split('/');\r\n            const last = split[split.length - 1];\r\n            if (last === filename) {\r\n                return key;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new Gltf1Importer();\r\n        }\r\n        return this.__instance;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/Gltf1Importer.ts?");

/***/ }),

/***/ "./src/foundation/importer/Gltf2Importer.ts":
/*!**************************************************!*\
  !*** ./src/foundation/importer/Gltf2Importer.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Gltf2Importer; });\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n/* harmony import */ var _misc_RnPromise__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../misc/RnPromise */ \"./src/foundation/misc/RnPromise.ts\");\n\r\n\r\n/**\r\n * The glTF2 Importer class.\r\n */\r\nclass Gltf2Importer {\r\n    constructor() {\r\n    }\r\n    /**\r\n     * Import glTF2 file\r\n     * @param uri - uri of glTF file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    async import(uri, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        if (options && options.files) {\r\n            for (let fileName in options.files) {\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                if (fileExtension === 'gltf' || fileExtension === 'glb') {\r\n                    return await this.__loadFromArrayBuffer(options.files[fileName], defaultOptions, basePath, options).catch((err) => {\r\n                        console.log('this.__loadFromArrayBuffer error', err);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        const arrayBuffer = await _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchArrayBuffer(uri);\r\n        const glTFJson = await this.__loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options).catch((err) => {\r\n            console.log('this.__loadFromArrayBuffer error', err);\r\n        });\r\n        return glTFJson;\r\n    }\r\n    /**\r\n     * Import glTF2 array buffer.\r\n     * @param uri - uri of glTF file\r\n     * @param arrayBuffer - fetched glTF file\r\n     * @param options - options for loading process\r\n     * @returns a glTF2 based JSON pre-processed\r\n     */\r\n    importArrayBuffer(uri, arrayBuffer, options) {\r\n        const basePath = uri.substring(0, uri.lastIndexOf('/')) + '/'; // location of model file as basePath\r\n        const defaultOptions = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createDefaultGltfOptions();\r\n        return this.__loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options).catch((err) => {\r\n            console.log('__loadFromArrayBuffer error', err);\r\n        });\r\n    }\r\n    async __loadFromArrayBuffer(arrayBuffer, defaultOptions, basePath, options) {\r\n        const dataView = new DataView(arrayBuffer, 0, 20);\r\n        const isLittleEndian = true;\r\n        // Magic field\r\n        const magic = dataView.getUint32(0, isLittleEndian);\r\n        let result;\r\n        // 0x46546C67 is 'glTF' in ASCII codes.\r\n        if (magic !== 0x46546C67) {\r\n            //const json = await response.json();\r\n            const gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(arrayBuffer);\r\n            const json = JSON.parse(gotText);\r\n            result = await this._loadAsTextJson(json, options, defaultOptions, basePath).catch((err) => {\r\n                console.log('this.__loadAsTextJson error', err);\r\n            });\r\n        }\r\n        else {\r\n            result = await this._loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath).catch((err) => {\r\n                console.log('this.__loadAsBinaryJson error', err);\r\n            });\r\n        }\r\n        return result;\r\n    }\r\n    _getOptions(defaultOptions, json, options) {\r\n        if (json.asset && json.asset.extras && json.asset.extras.rnLoaderOptions) {\r\n            for (let optionName in json.asset.extras.rnLoaderOptions) {\r\n                defaultOptions[optionName] = json.asset.extras.rnLoaderOptions[optionName];\r\n            }\r\n        }\r\n        for (let optionName in options) {\r\n            defaultOptions[optionName] = options[optionName];\r\n        }\r\n        if (options && options.loaderExtension && typeof options.loaderExtension === \"string\") {\r\n            if (Rn[options.loaderExtension] != null) {\r\n                defaultOptions.loaderExtension = Rn[options.loaderExtension].getInstance();\r\n            }\r\n            else {\r\n                console.error(`${options.loaderExtension} not found!`);\r\n                defaultOptions.loaderExtension = void 0;\r\n            }\r\n        }\r\n        return defaultOptions;\r\n    }\r\n    async _loadAsBinaryJson(dataView, isLittleEndian, arrayBuffer, options, defaultOptions, basePath) {\r\n        let gltfVer = dataView.getUint32(4, isLittleEndian);\r\n        if (gltfVer !== 2) {\r\n            throw new Error('invalid version field in this binary glTF file.');\r\n        }\r\n        let lengthOfJSonChunkData = dataView.getUint32(12, isLittleEndian);\r\n        let chunkType = dataView.getUint32(16, isLittleEndian);\r\n        // 0x4E4F534A means JSON format (0x4E4F534A is 'JSON' in ASCII codes)\r\n        if (chunkType !== 0x4E4F534A) {\r\n            throw new Error('invalid chunkType of chunk0 in this binary glTF file.');\r\n        }\r\n        let uint8ArrayJSonContent = new Uint8Array(arrayBuffer, 20, lengthOfJSonChunkData);\r\n        let gotText = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].uint8ArrayToString(uint8ArrayJSonContent);\r\n        let gltfJson = JSON.parse(gotText);\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        let uint8array = new Uint8Array(arrayBuffer, 20 + lengthOfJSonChunkData + 8);\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"2\" };\r\n        }\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        try {\r\n            await this._loadInner(uint8array, basePath, gltfJson, options);\r\n        }\r\n        catch (err) {\r\n            console.log(\"this._loadInner error in _loadAsBinaryJson\", err);\r\n        }\r\n        return gltfJson;\r\n    }\r\n    async _loadAsTextJson(gltfJson, options, defaultOptions, basePath) {\r\n        if (gltfJson.asset.extras === undefined) {\r\n            gltfJson.asset.extras = { fileType: \"glTF\", version: \"2\" };\r\n        }\r\n        options = this._getOptions(defaultOptions, gltfJson, options);\r\n        this._mergeExtendedJson(gltfJson, options.extendedJson);\r\n        gltfJson.asset.extras.basePath = basePath;\r\n        gltfJson.asset.extras.rnLoaderOptions = options;\r\n        try {\r\n            await this._loadInner(undefined, basePath, gltfJson, options);\r\n        }\r\n        catch (err) {\r\n            console.log('this._loadInner error in _loadAsTextJson', err);\r\n        }\r\n        return gltfJson;\r\n    }\r\n    _loadInner(uint8array, basePath, gltfJson, options) {\r\n        let promises = [];\r\n        let resources = {\r\n            shaders: [],\r\n            buffers: [],\r\n            images: []\r\n        };\r\n        promises.push(this._loadResources(uint8array, basePath, gltfJson, options, resources));\r\n        promises.push(new Promise((resolve, reject) => {\r\n            this._loadJsonContent(gltfJson, options);\r\n            resolve();\r\n        }));\r\n        return Promise.all(promises);\r\n    }\r\n    _loadJsonContent(gltfJson, options) {\r\n        // Scene\r\n        this._loadDependenciesOfScenes(gltfJson);\r\n        // Node\r\n        this._loadDependenciesOfNodes(gltfJson);\r\n        // Mesh\r\n        this._loadDependenciesOfMeshes(gltfJson);\r\n        // Material\r\n        this._loadDependenciesOfMaterials(gltfJson);\r\n        // Texture\r\n        this._loadDependenciesOfTextures(gltfJson);\r\n        // Joint\r\n        this._loadDependenciesOfJoints(gltfJson);\r\n        // Animation\r\n        this._loadDependenciesOfAnimations(gltfJson);\r\n        // Accessor\r\n        this._loadDependenciesOfAccessors(gltfJson);\r\n        // BufferView\r\n        this._loadDependenciesOfBufferViews(gltfJson);\r\n        if (gltfJson.asset === void 0) {\r\n            gltfJson.asset = {};\r\n        }\r\n        if (gltfJson.asset.extras === void 0) {\r\n            gltfJson.asset.extras = {};\r\n        }\r\n    }\r\n    _loadDependenciesOfScenes(gltfJson) {\r\n        for (let scene of gltfJson.scenes) {\r\n            scene.nodesIndices = scene.nodes.concat();\r\n            for (let i in scene.nodesIndices) {\r\n                scene.nodes[i] = gltfJson.nodes[scene.nodes[i]];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfNodes(gltfJson) {\r\n        for (let node of gltfJson.nodes) {\r\n            // Hierarchy\r\n            if (node.children) {\r\n                node.childrenIndices = node.children.concat();\r\n                node.children = [];\r\n                for (let i in node.childrenIndices) {\r\n                    node.children[i] = gltfJson.nodes[node.childrenIndices[i]];\r\n                }\r\n            }\r\n            // Mesh\r\n            if (node.mesh !== void 0 && gltfJson.meshes !== void 0) {\r\n                node.meshIndex = node.mesh;\r\n                node.mesh = gltfJson.meshes[node.meshIndex];\r\n            }\r\n            // Skin\r\n            if (node.skin !== void 0 && gltfJson.skins !== void 0) {\r\n                node.skinIndex = node.skin;\r\n                node.skin = gltfJson.skins[node.skinIndex];\r\n                if (node.mesh.extras === void 0) {\r\n                    node.mesh.extras = {};\r\n                }\r\n                node.mesh.extras._skin = node.skin;\r\n            }\r\n            // Camera\r\n            if (node.camera !== void 0 && gltfJson.cameras !== void 0) {\r\n                node.cameraIndex = node.camera;\r\n                node.camera = gltfJson.cameras[node.cameraIndex];\r\n            }\r\n            // Lights\r\n            if (node.extensions !== void 0 && gltfJson.extensions !== void 0 && gltfJson.extensions.KHR_lights_punctual !== void 0) {\r\n                node.extensions.KHR_lights_punctual.lightIndex = node.extensions.KHR_lights_punctual.light;\r\n                node.extensions.KHR_lights_punctual.light = gltfJson.extensions.KHR_lights_punctual.lights[node.extensions.KHR_lights_punctual.lightIndex];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfMeshes(gltfJson) {\r\n        // Mesh\r\n        for (let mesh of gltfJson.meshes) {\r\n            for (let primitive of mesh.primitives) {\r\n                if (primitive.material !== void 0) {\r\n                    primitive.materialIndex = primitive.material;\r\n                    primitive.material = gltfJson.materials[primitive.materialIndex];\r\n                }\r\n                primitive.attributesIndex = Object.assign({}, primitive.attributes);\r\n                for (let attributeName in primitive.attributesIndex) {\r\n                    if (primitive.attributesIndex[attributeName] >= 0) {\r\n                        let accessor = gltfJson.accessors[primitive.attributesIndex[attributeName]];\r\n                        accessor.extras = {\r\n                            toGetAsTypedArray: true,\r\n                            attributeName: attributeName\r\n                        };\r\n                        primitive.attributes[attributeName] = accessor;\r\n                    }\r\n                    else {\r\n                        primitive.attributes[attributeName] = void 0;\r\n                    }\r\n                }\r\n                if (primitive.indices != null) {\r\n                    primitive.indicesIndex = primitive.indices;\r\n                    primitive.indices = gltfJson.accessors[primitive.indicesIndex];\r\n                }\r\n                if (primitive.targets != null) {\r\n                    primitive.targetIndices = primitive.targets;\r\n                    primitive.targets = [];\r\n                    for (let target of primitive.targetIndices) {\r\n                        const attributes = {};\r\n                        for (let attributeName in target) {\r\n                            if (target[attributeName] >= 0) {\r\n                                let accessor = gltfJson.accessors[target[attributeName]];\r\n                                accessor.extras = {\r\n                                    toGetAsTypedArray: true,\r\n                                    attributeName: attributeName\r\n                                };\r\n                                attributes[attributeName] = accessor;\r\n                            }\r\n                            else {\r\n                                attributes[attributeName] = void 0;\r\n                            }\r\n                        }\r\n                        primitive.targets.push(attributes);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _checkRnGltfLoaderOptionsExist(gltfModel) {\r\n        if (gltfModel.asset.extras && gltfModel.asset.extras.rnLoaderOptions) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    _loadDependenciesOfMaterials(gltfJson) {\r\n        if (!gltfJson.textures)\r\n            gltfJson.textures = [];\r\n        // Material\r\n        if (gltfJson.materials) {\r\n            for (let material of gltfJson.materials) {\r\n                if (material.pbrMetallicRoughness) {\r\n                    let baseColorTexture = material.pbrMetallicRoughness.baseColorTexture;\r\n                    if (baseColorTexture !== void 0) {\r\n                        baseColorTexture.texture = gltfJson.textures[baseColorTexture.index];\r\n                    }\r\n                    let metallicRoughnessTexture = material.pbrMetallicRoughness.metallicRoughnessTexture;\r\n                    if (metallicRoughnessTexture !== void 0) {\r\n                        metallicRoughnessTexture.texture = gltfJson.textures[metallicRoughnessTexture.index];\r\n                    }\r\n                }\r\n                let normalTexture = material.normalTexture;\r\n                if (normalTexture !== void 0) {\r\n                    normalTexture.texture = gltfJson.textures[normalTexture.index];\r\n                }\r\n                const occlusionTexture = material.occlusionTexture;\r\n                if (occlusionTexture !== void 0) {\r\n                    occlusionTexture.texture = gltfJson.textures[occlusionTexture.index];\r\n                }\r\n                const emissiveTexture = material.emissiveTexture;\r\n                if (emissiveTexture !== void 0) {\r\n                    emissiveTexture.texture = gltfJson.textures[emissiveTexture.index];\r\n                }\r\n                if (this._checkRnGltfLoaderOptionsExist(gltfJson) &&\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension &&\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension.setTextures) {\r\n                    gltfJson.asset.extras.rnLoaderOptions.loaderExtension.setTextures(gltfJson, material);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfTextures(gltfJson) {\r\n        // Texture\r\n        if (gltfJson.textures) {\r\n            for (let texture of gltfJson.textures) {\r\n                if (texture.sampler !== void 0) {\r\n                    texture.samplerIndex = texture.sampler;\r\n                    texture.sampler = gltfJson.samplers[texture.samplerIndex];\r\n                }\r\n                if (texture.source !== void 0) {\r\n                    texture.sourceIndex = texture.source;\r\n                    texture.image = gltfJson.images[texture.sourceIndex];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfJoints(gltfJson) {\r\n        if (gltfJson.skins) {\r\n            for (let skin of gltfJson.skins) {\r\n                skin.skeletonIndex = skin.skeleton;\r\n                skin.skeleton = gltfJson.nodes[skin.skeletonIndex];\r\n                skin.inverseBindMatricesIndex = skin.inverseBindMatrices;\r\n                skin.inverseBindMatrices = gltfJson.accessors[skin.inverseBindMatricesIndex];\r\n                if (skin.skeleton == null) {\r\n                    skin.skeletonIndex = skin.joints[0];\r\n                    skin.skeleton = gltfJson.nodes[skin.skeletonIndex];\r\n                }\r\n                skin.jointsIndices = skin.joints;\r\n                skin.joints = [];\r\n                for (let jointIndex of skin.jointsIndices) {\r\n                    skin.joints.push(gltfJson.nodes[jointIndex]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAnimations(gltfJson) {\r\n        if (gltfJson.animations) {\r\n            for (let animation of gltfJson.animations) {\r\n                for (let channel of animation.channels) {\r\n                    channel.samplerIndex = channel.sampler;\r\n                    channel.sampler = animation.samplers[channel.samplerIndex];\r\n                    channel.target.nodeIndex = channel.target.node;\r\n                    channel.target.node = gltfJson.nodes[channel.target.nodeIndex];\r\n                }\r\n                for (let channel of animation.channels) {\r\n                    channel.sampler.inputIndex = channel.sampler.input;\r\n                    channel.sampler.outputIndex = channel.sampler.output;\r\n                    channel.sampler.input = gltfJson.accessors[channel.sampler.inputIndex];\r\n                    channel.sampler.output = gltfJson.accessors[channel.sampler.outputIndex];\r\n                    if (channel.sampler.output.extras === void 0) {\r\n                        channel.sampler.output.extras = {};\r\n                    }\r\n                    if (channel.target.path === 'rotation') {\r\n                        channel.sampler.output.extras.quaternionIfVec4 = true;\r\n                    }\r\n                    if (channel.target.path === 'weights') {\r\n                        const weightCount = channel.sampler.output.count / channel.sampler.input.count;\r\n                        channel.sampler.output.extras.weightCount = weightCount;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfAccessors(gltfJson) {\r\n        // Accessor\r\n        for (let accessor of gltfJson.accessors) {\r\n            if (accessor.bufferView == null) {\r\n                accessor.bufferView = 0;\r\n            }\r\n            accessor.bufferViewIndex = accessor.bufferView;\r\n            accessor.bufferView = gltfJson.bufferViews[accessor.bufferViewIndex];\r\n            if (accessor.sparse != null) {\r\n                const sparse = accessor.sparse;\r\n                sparse.indices.indicesIndex = sparse.indices.bufferView;\r\n                sparse.indices.bufferView = gltfJson.bufferViews[sparse.indices.indicesIndex];\r\n                sparse.values.valuesIndex = sparse.values.bufferView;\r\n                sparse.values.bufferView = gltfJson.bufferViews[sparse.values.valuesIndex];\r\n            }\r\n        }\r\n    }\r\n    _loadDependenciesOfBufferViews(gltfJson) {\r\n        // BufferView\r\n        for (let bufferView of gltfJson.bufferViews) {\r\n            if (bufferView.buffer !== void 0) {\r\n                bufferView.bufferIndex = bufferView.buffer;\r\n                bufferView.buffer = gltfJson.buffers[bufferView.bufferIndex];\r\n            }\r\n        }\r\n    }\r\n    _mergeExtendedJson(gltfJson, extendedData) {\r\n        let extendedJson = null;\r\n        if (extendedData instanceof ArrayBuffer) {\r\n            const extendedJsonStr = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].arrayBufferToString(extendedData);\r\n            extendedJson = JSON.parse(extendedJsonStr);\r\n        }\r\n        else if (typeof extendedData === 'string') {\r\n            extendedJson = JSON.parse(extendedData);\r\n            extendedJson = extendedJson;\r\n        }\r\n        else if (typeof extendedData === 'object') {\r\n            extendedJson = extendedData;\r\n        }\r\n        else {\r\n        }\r\n        Object.assign(gltfJson, extendedJson);\r\n    }\r\n    _loadResources(uint8Array, basePath, gltfJson, options, resources) {\r\n        let promisesToLoadResources = [];\r\n        // Shaders Async load\r\n        // for (let _i in gltfJson.shaders) {\r\n        //   const i = _i as any as number;\r\n        //   resources.shaders[i] = {};\r\n        //   let shaderJson = gltfJson.shaders[i];\r\n        //   let shaderType = shaderJson.type;\r\n        //   if (typeof shaderJson.extensions !== 'undefined' && typeof shaderJson.extensions.KHR_binary_glTF !== 'undefined') {\r\n        //     resources.shaders[i].shaderText = this._accessBinaryAsShader(shaderJson.extensions.KHR_binary_glTF.bufferView, gltfJson, arrayBufferBinary);\r\n        //     resources.shaders[i].shaderType = shaderType;\r\n        //     continue;\r\n        //   }\r\n        //   let shaderUri = shaderJson.uri;\r\n        //   if (options.files) {\r\n        //     const splitted = shaderUri.split('/');\r\n        //     const filename = splitted[splitted.length - 1];\r\n        //     if (options.files[filename]) {\r\n        //       const arrayBuffer = options.files[filename];\r\n        //       resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //       resources.shaders[i].shaderType = shaderType;\r\n        //       continue;\r\n        //     }\r\n        //   }\r\n        //   if (shaderUri.match(/^data:/)) {\r\n        //     promisesToLoadResources.push(\r\n        //       new Promise((resolve, rejected) => {\r\n        //         let arrayBuffer = DataUtil.dataUriToArrayBuffer(shaderUri);\r\n        //         resources.shaders[i].shaderText = DataUtil.arrayBufferToString(arrayBuffer);\r\n        //         resources.shaders[i].shaderType = shaderType;\r\n        //         resolve();\r\n        //       })\r\n        //     );\r\n        //   } else {\r\n        //     shaderUri = basePath + shaderUri;\r\n        //     promisesToLoadResources.push(\r\n        //       DataUtil.loadResourceAsync(shaderUri, false,\r\n        //         (resolve:Function, response:any)=>{\r\n        //           resources.shaders[i].shaderText = response;\r\n        //           resources.shaders[i].shaderType = shaderType;\r\n        //           resolve(gltfJson);\r\n        //         },\r\n        //         (reject:Function, error:any)=>{\r\n        //         }\r\n        //       )\r\n        //     );\r\n        //   }\r\n        // }\r\n        // Buffers Async load\r\n        let rnpArrayBuffer;\r\n        for (let i in gltfJson.buffers) {\r\n            let bufferInfo = gltfJson.buffers[i];\r\n            let filename = '';\r\n            if (bufferInfo.uri) {\r\n                const splitUri = bufferInfo.uri.split('/');\r\n                filename = splitUri[splitUri.length - 1];\r\n            }\r\n            if (typeof bufferInfo.uri === 'undefined') {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_1__[\"default\"]((resolve, rejected) => {\r\n                    resources.buffers[i] = uint8Array;\r\n                    bufferInfo.buffer = uint8Array;\r\n                    resolve(uint8Array);\r\n                });\r\n            }\r\n            else if (bufferInfo.uri.match(/^data:application\\/(.*);base64,/)) {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_1__[\"default\"]((resolve, rejected) => {\r\n                    let arrayBuffer = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dataUriToArrayBuffer(bufferInfo.uri);\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(arrayBuffer);\r\n                });\r\n            }\r\n            else if (options.files && this.__containsFileName(options.files, filename)) {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_1__[\"default\"]((resolve, rejected) => {\r\n                    const fullPath = this.__getFullPathOfFileName(options.files, filename);\r\n                    const arrayBuffer = options.files[fullPath];\r\n                    resources.buffers[i] = new Uint8Array(arrayBuffer);\r\n                    bufferInfo.buffer = new Uint8Array(arrayBuffer);\r\n                    resolve(arrayBuffer);\r\n                });\r\n            }\r\n            else {\r\n                rnpArrayBuffer = new _misc_RnPromise__WEBPACK_IMPORTED_MODULE_1__[\"default\"](_misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].loadResourceAsync(basePath + bufferInfo.uri, true, (resolve, response) => {\r\n                    resources.buffers[i] = new Uint8Array(response);\r\n                    bufferInfo.buffer = new Uint8Array(response);\r\n                    resolve(response);\r\n                }, (reject, error) => {\r\n                }));\r\n            }\r\n            bufferInfo.bufferPromise = rnpArrayBuffer;\r\n            promisesToLoadResources.push(rnpArrayBuffer);\r\n        }\r\n        // Textures Async load\r\n        for (let _i in gltfJson.images) {\r\n            const i = _i;\r\n            let imageJson = gltfJson.images[i];\r\n            //let imageJson = gltfJson.images[textureJson.source];\r\n            //let samplerJson = gltfJson.samplers[textureJson.sampler];\r\n            let imageUri;\r\n            if (typeof imageJson.uri === 'undefined') {\r\n                let arrayBuffer = uint8Array;\r\n                if (uint8Array == null) {\r\n                    const bufferView = gltfJson.bufferViews[imageJson.bufferView];\r\n                    arrayBuffer = bufferView.buffer.buffer;\r\n                }\r\n                const imageUint8Array = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createUint8ArrayFromBufferViewInfo(gltfJson, imageJson.bufferView, uint8Array);\r\n                imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(imageUint8Array, imageJson.mimeType);\r\n            }\r\n            else {\r\n                const imageFileStr = imageJson.uri;\r\n                const splitUri = imageFileStr.split('/');\r\n                const filename = splitUri[splitUri.length - 1];\r\n                if (options.files && this.__containsFileName(options.files, filename)) {\r\n                    const fullPath = this.__getFullPathOfFileName(options.files, filename);\r\n                    const arrayBuffer = options.files[fullPath];\r\n                    imageUri = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createBlobImageUriFromUint8Array(new Uint8Array(arrayBuffer), imageJson.mimeType);\r\n                }\r\n                else if (imageFileStr.match(/^data:/)) {\r\n                    imageUri = imageFileStr;\r\n                }\r\n                else {\r\n                    imageUri = basePath + imageFileStr;\r\n                }\r\n            }\r\n            // if (options.extensionLoader && options.extensionLoader.setUVTransformToTexture) {\r\n            //   options.extensionLoader.setUVTransformToTexture(texture, samplerJson);\r\n            // }\r\n            if (imageUri.match(/basis$/)) {\r\n                const promise = new Promise(async (resolve) => {\r\n                    const response = await fetch(imageUri);\r\n                    const buffer = await response.arrayBuffer();\r\n                    const uint8Array = new Uint8Array(buffer);\r\n                    imageJson.basis = uint8Array;\r\n                    resolve();\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n            else if (imageJson.uri != null && imageJson.uri.match(/basis$/)) {\r\n                const promise = new Promise((resolve) => {\r\n                    imageJson.basis = new Uint8Array(options.files[imageJson.uri]);\r\n                    resolve();\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n            else {\r\n                const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(imageUri, imageJson.mimeType).then(function (image) {\r\n                    image.crossOrigin = 'Anonymous';\r\n                    resources.images[i] = image;\r\n                    imageJson.image = image;\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n        }\r\n        if (options.defaultTextures) {\r\n            const basePath = options.defaultTextures.basePath;\r\n            const textureInfos = options.defaultTextures.textureInfos;\r\n            for (let textureInfo of textureInfos) {\r\n                const fileName = textureInfo.fileName;\r\n                const uri = basePath + fileName;\r\n                const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getExtension(fileName);\r\n                const mimeType = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getMimeTypeFromExtension(fileExtension);\r\n                const promise = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_0__[\"default\"].createImageFromUri(uri, mimeType).then(function (image) {\r\n                    image.crossOrigin = 'Anonymous';\r\n                    textureInfo.image = { image: image };\r\n                });\r\n                promisesToLoadResources.push(promise);\r\n            }\r\n        }\r\n        return Promise.all(promisesToLoadResources).catch((err) => {\r\n            console.log('Promise.all error', err);\r\n        });\r\n    }\r\n    __containsFileName(optionsFiles, filename) {\r\n        for (let key in optionsFiles) {\r\n            const split = key.split('/');\r\n            const last = split[split.length - 1];\r\n            if (last === filename) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    __getFullPathOfFileName(optionsFiles, filename) {\r\n        for (let key in optionsFiles) {\r\n            const split = key.split('/');\r\n            const last = split[split.length - 1];\r\n            if (last === filename) {\r\n                return key;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new Gltf2Importer();\r\n        }\r\n        return this.__instance;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/Gltf2Importer.ts?");

/***/ }),

/***/ "./src/foundation/importer/GltfImporter.ts":
/*!*************************************************!*\
  !*** ./src/foundation/importer/GltfImporter.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GltfImporter; });\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _FormatDetector__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FormatDetector */ \"./src/foundation/importer/FormatDetector.ts\");\n/* harmony import */ var _Gltf2Importer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Gltf2Importer */ \"./src/foundation/importer/Gltf2Importer.ts\");\n/* harmony import */ var _ModelConverter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ModelConverter */ \"./src/foundation/importer/ModelConverter.ts\");\n/* harmony import */ var _components_PhysicsComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/PhysicsComponent */ \"./src/foundation/components/PhysicsComponent.ts\");\n/* harmony import */ var _physics_SphereCollider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../physics/SphereCollider */ \"./src/foundation/physics/SphereCollider.ts\");\n/* harmony import */ var _textures_Texture__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../textures/Texture */ \"./src/foundation/textures/Texture.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _physics_VRMColliderGroup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../physics/VRMColliderGroup */ \"./src/foundation/physics/VRMColliderGroup.ts\");\n/* harmony import */ var _physics_VRMSpringBoneGroup__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../physics/VRMSpringBoneGroup */ \"./src/foundation/physics/VRMSpringBoneGroup.ts\");\n/* harmony import */ var _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../physics/VRMSpringBonePhysicsStrategy */ \"./src/foundation/physics/VRMSpringBonePhysicsStrategy.ts\");\n/* harmony import */ var _Gltf1Importer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Gltf1Importer */ \"./src/foundation/importer/Gltf1Importer.ts\");\n/* harmony import */ var _DrcPointCloudImporter__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./DrcPointCloudImporter */ \"./src/foundation/importer/DrcPointCloudImporter.ts\");\n/* harmony import */ var _renderer_Expression__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../renderer/Expression */ \"./src/foundation/renderer/Expression.ts\");\n/* harmony import */ var _renderer_RenderPass__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../renderer/RenderPass */ \"./src/foundation/renderer/RenderPass.ts\");\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Importer class which can import GLTF and VRM.\r\n */\r\nclass GltfImporter {\r\n    constructor() { }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new GltfImporter();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    /**\r\n     * For VRM file only\r\n     * Generate JSON.\r\n     */\r\n    async importJsonOfVRM(uri, options) {\r\n        options = this._getOptions(options);\r\n        const gltf2Importer = _Gltf2Importer__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n        const gltfModel = await gltf2Importer.import(uri, options);\r\n        this._readVRMHumanoidInfo(gltfModel);\r\n        return gltfModel;\r\n    }\r\n    /**\r\n     * Import GLTF or VRM file.\r\n     * @param uris uri or array of uri of glTF file\r\n     * @param options options for loading process where if you use files option, key name of files must be uri of the value array buffer\r\n     * @returns gltf expression where:\r\n     *            renderPasses[0]: model entities\r\n     *            renderPasses[1]: model outlines\r\n     */\r\n    async import(uris, options) {\r\n        if (!Array.isArray(uris)) {\r\n            uris = [uris];\r\n        }\r\n        options = this.__initOptions(options);\r\n        const renderPasses = await this.__importMultipleModels(uris, options);\r\n        if (options && options.cameraComponent) {\r\n            for (let renderPass of renderPasses) {\r\n                renderPass.cameraComponent = options.cameraComponent;\r\n            }\r\n        }\r\n        return this.__setRenderPassesToExpression(renderPasses, options);\r\n    }\r\n    __initOptions(options) {\r\n        var _a;\r\n        if (options == null) {\r\n            options = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__[\"default\"].createDefaultGltfOptions();\r\n        }\r\n        else {\r\n            if (options.files == null) {\r\n                options.files = {};\r\n            }\r\n            for (let file in options.files) {\r\n                if (file.match(/.*\\.vrm$/) == null) {\r\n                    continue;\r\n                }\r\n                const fileName = file.split('.vrm')[0];\r\n                if (fileName) {\r\n                    const arraybuffer = options.files[file];\r\n                    options.files[fileName + '.glb'] = arraybuffer;\r\n                    delete options.files[file];\r\n                }\r\n            }\r\n            if (Array.isArray(options.defaultMaterialHelperArgumentArray) === false) {\r\n                options.defaultMaterialHelperArgumentArray = [{}];\r\n            }\r\n            else {\r\n                // avoid needless processing\r\n                if (((_a = options.defaultMaterialHelperArgumentArray[0]) === null || _a === void 0 ? void 0 : _a.isMorphing) === false) {\r\n                    options.maxMorphTargetNumber = 0;\r\n                }\r\n            }\r\n        }\r\n        return options;\r\n    }\r\n    __setRenderPassesToExpression(renderPasses, options) {\r\n        var _a;\r\n        const expression = (_a = options.expression) !== null && _a !== void 0 ? _a : new _renderer_Expression__WEBPACK_IMPORTED_MODULE_13__[\"default\"]();\r\n        if (expression.renderPasses !== renderPasses) {\r\n            expression.clearRenderPasses();\r\n            expression.addRenderPasses(renderPasses);\r\n        }\r\n        return expression;\r\n    }\r\n    __importMultipleModels(uris, options) {\r\n        var _a;\r\n        const importPromises = [];\r\n        const renderPasses = ((_a = options.expression) === null || _a === void 0 ? void 0 : _a.renderPasses) || [];\r\n        if (renderPasses.length === 0) {\r\n            renderPasses.push(new _renderer_RenderPass__WEBPACK_IMPORTED_MODULE_14__[\"default\"]());\r\n        }\r\n        for (let fileName in options.files) { // filename is uri\r\n            const fileExtension = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__[\"default\"].getExtension(fileName);\r\n            if (this.__isValidExtension(fileExtension)) {\r\n                importPromises.push(this.__importToRenderPassesFromArrayBufferPromise(fileName, renderPasses, options, fileName));\r\n            }\r\n        }\r\n        for (let uri of uris) {\r\n            if (uri.length === 0 || options.files[uri] != null) {\r\n                // import from uri where the file is not fetched yet\r\n                continue;\r\n            }\r\n            importPromises.push(this.__importToRenderPassesFromUriPromise(uri, renderPasses, options));\r\n        }\r\n        return Promise.all(importPromises).then(() => {\r\n            return renderPasses;\r\n        });\r\n    }\r\n    __isValidExtension(fileExtension) {\r\n        if (fileExtension === 'gltf' || fileExtension === 'glb' ||\r\n            fileExtension === 'vrm' || fileExtension === 'drc') {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    __importToRenderPassesFromUriPromise(uri, renderPasses, options) {\r\n        return _misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__[\"default\"].fetchArrayBuffer(uri).then((arrayBuffer) => {\r\n            options.files[uri] = arrayBuffer;\r\n            return this.__importToRenderPassesFromArrayBufferPromise(uri, renderPasses, options, uri);\r\n        });\r\n    }\r\n    __importToRenderPassesFromArrayBufferPromise(fileName, renderPasses, options, uri) {\r\n        const optionalFileType = options.fileType;\r\n        return this.__getFileTypeFromFilePromise(fileName, options, optionalFileType).then((fileType) => {\r\n            return new Promise((resolve, reject) => {\r\n                let importer;\r\n                const modelConverter = _ModelConverter__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\r\n                const file = options.files[fileName];\r\n                options.isImportVRM = false;\r\n                switch (fileType) {\r\n                    case 'glTF1':\r\n                        importer = _Gltf1Importer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getInstance();\r\n                        importer.importArrayBuffer(uri, file, options).then((gltfModel) => {\r\n                            const rootGroup = modelConverter.convertToRhodoniteObject(gltfModel);\r\n                            renderPasses[0].addEntities([rootGroup]);\r\n                            resolve();\r\n                        });\r\n                        break;\r\n                    case 'glTF2':\r\n                        importer = _Gltf2Importer__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n                        importer.importArrayBuffer(uri, file, options).then((gltfModel) => {\r\n                            const rootGroup = modelConverter.convertToRhodoniteObject(gltfModel);\r\n                            renderPasses[0].addEntities([rootGroup]);\r\n                            resolve();\r\n                        });\r\n                        break;\r\n                    case 'Draco':\r\n                        importer = _DrcPointCloudImporter__WEBPACK_IMPORTED_MODULE_12__[\"default\"].getInstance();\r\n                        importer.importArrayBuffer(uri, file, options).then((gltfModel) => {\r\n                            if (gltfModel == null) {\r\n                                console.error('importArrayBuffer error is occurred');\r\n                                reject();\r\n                            }\r\n                            else {\r\n                                const rootGroup = modelConverter.convertToRhodoniteObject(gltfModel);\r\n                                renderPasses[0].addEntities([rootGroup]);\r\n                                resolve();\r\n                            }\r\n                        });\r\n                        break;\r\n                    case 'VRM':\r\n                        options.isImportVRM = true;\r\n                        this.__importVRM(uri, file, renderPasses, options).then(() => {\r\n                            resolve();\r\n                        });\r\n                        break;\r\n                    default:\r\n                        console.error('detect invalid format');\r\n                        reject();\r\n                }\r\n            });\r\n        });\r\n    }\r\n    __getFileTypeFromFilePromise(fileName, options, optionalFileType) {\r\n        return new Promise((resolve) => {\r\n            if (optionalFileType != null) {\r\n                resolve(optionalFileType);\r\n            }\r\n            else {\r\n                Object(_FormatDetector__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('', { [fileName]: options.files[fileName] }).then((fileType) => {\r\n                    resolve(fileType);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    __importVRM(uri, file, renderPasses, options) {\r\n        const gltf2Importer = _Gltf2Importer__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n        return gltf2Importer.importArrayBuffer(uri, file, options).then((gltfModel) => {\r\n            var _a;\r\n            const textures = this._createTextures(gltfModel);\r\n            const defaultMaterialHelperArgumentArray = gltfModel.asset.extras.rnLoaderOptions.defaultMaterialHelperArgumentArray;\r\n            defaultMaterialHelperArgumentArray[0].textures = textures;\r\n            this._initializeMaterialProperties(gltfModel, textures.length);\r\n            let rootGroup;\r\n            const modelConverter = _ModelConverter__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\r\n            const existOutline = this._existOutlineMaterial(gltfModel.extensions.VRM);\r\n            if (existOutline) {\r\n                renderPasses[1] = (_a = renderPasses[1]) !== null && _a !== void 0 ? _a : new _renderer_RenderPass__WEBPACK_IMPORTED_MODULE_14__[\"default\"]();\r\n                const renderPassOutline = renderPasses[1];\r\n                renderPassOutline.toClearColorBuffer = false;\r\n                renderPassOutline.toClearDepthBuffer = false;\r\n                gltfModel.extensions.VRM.rnExtension = { renderPassOutline: renderPassOutline };\r\n                rootGroup = modelConverter.convertToRhodoniteObject(gltfModel);\r\n                renderPassOutline.addEntities([rootGroup]);\r\n            }\r\n            else {\r\n                rootGroup = modelConverter.convertToRhodoniteObject(gltfModel);\r\n            }\r\n            const renderPassMain = renderPasses[0];\r\n            renderPassMain.addEntities([rootGroup]);\r\n            this._readSpringBone(rootGroup, gltfModel);\r\n            this._readVRMHumanoidInfo(gltfModel, rootGroup);\r\n        });\r\n    }\r\n    _getOptions(options) {\r\n        if (options != null) {\r\n            for (let file in options.files) {\r\n                const fileName = file.split('.vrm')[0];\r\n                if (fileName) {\r\n                    const arraybuffer = options.files[file];\r\n                    options.files[fileName + '.glb'] = arraybuffer;\r\n                    delete options.files[file];\r\n                }\r\n            }\r\n            //set default values\r\n            options.isImportVRM = true;\r\n            if (options.defaultMaterialHelperArgumentArray == null) {\r\n                options.defaultMaterialHelperArgumentArray = [{}];\r\n            }\r\n            if (!options.defaultMaterialHelperArgumentArray[0].isMorphing) {\r\n                options.maxMorphTargetNumber = 0;\r\n            }\r\n        }\r\n        else {\r\n            options = {\r\n                files: {},\r\n                loaderExtension: null,\r\n                defaultMaterialHelperName: null,\r\n                defaultMaterialHelperArgumentArray: [{ isLighting: true, isMorphing: true, isSkinning: true }],\r\n                statesOfElements: [\r\n                    {\r\n                        targets: [],\r\n                        states: {\r\n                            enable: [],\r\n                            functions: {}\r\n                        },\r\n                        isTransparent: true,\r\n                        opacity: 1.0,\r\n                        isTextureImageToLoadPreMultipliedAlpha: false,\r\n                    }\r\n                ],\r\n                isImportVRM: true,\r\n            };\r\n        }\r\n        return options;\r\n    }\r\n    _readVRMHumanoidInfo(gltfModel, rootEntity) {\r\n        const humanBones = gltfModel.extensions.VRM.humanoid.humanBones;\r\n        const mapNameNodeId = new Map();\r\n        // const mapNameNodeName: Map<string, string> = new Map();\r\n        for (let bone of humanBones) {\r\n            mapNameNodeId.set(bone.bone, bone.node);\r\n            const boneNode = gltfModel.nodes[bone.node];\r\n            bone.name = boneNode.name;\r\n        }\r\n        if (rootEntity != null) {\r\n            rootEntity.tryToSetTag({\r\n                tag: 'humanoid_map_name_nodeId',\r\n                value: mapNameNodeId\r\n            });\r\n        }\r\n        // rootEntity.tryToSetTag({\r\n        //   tag: 'humanoid_map_name_nodeName',\r\n        //   value: mapNameNodeName\r\n        // });\r\n    }\r\n    _readSpringBone(rootEntity, gltfModel) {\r\n        const entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        const boneGroups = [];\r\n        for (let boneGroup of gltfModel.extensions.VRM.secondaryAnimation.boneGroups) {\r\n            const vrmSpringBoneGroup = new _physics_VRMSpringBoneGroup__WEBPACK_IMPORTED_MODULE_9__[\"default\"]();\r\n            vrmSpringBoneGroup.tryToSetUniqueName(boneGroup.comment, true);\r\n            vrmSpringBoneGroup.dragForce = boneGroup.dragForce;\r\n            vrmSpringBoneGroup.stiffnessForce = boneGroup.stiffiness;\r\n            vrmSpringBoneGroup.gravityPower = boneGroup.gravityPower;\r\n            vrmSpringBoneGroup.gravityDir = new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](boneGroup.gravityDir.x, boneGroup.gravityDir.y, boneGroup.gravityDir.z);\r\n            vrmSpringBoneGroup.colliderGroupIndices = boneGroup.colliderGroups;\r\n            vrmSpringBoneGroup.hitRadius = boneGroup.hitRadius;\r\n            for (let idxOfArray in boneGroup.bones) {\r\n                const boneNodeIndex = boneGroup.bones[idxOfArray];\r\n                const entity = gltfModel.asset.extras.rnEntities[boneNodeIndex];\r\n                vrmSpringBoneGroup.rootBones.push(entity.getSceneGraph());\r\n                // const boneNodeIndex = boneGroup.bones[idxOfArray];\r\n                // const entity = gltfModel.asset.extras!.rnEntities![boneNodeIndex];\r\n                // entityRepository.addComponentsToEntity([PhysicsComponent], entity.entityUID);\r\n            }\r\n            boneGroups.push(vrmSpringBoneGroup);\r\n        }\r\n        _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_10__[\"default\"].setBoneGroups(boneGroups);\r\n        for (let boneGroup of boneGroups) {\r\n            for (let sg of boneGroup.rootBones) {\r\n                this.addPhysicsComponentRecursively(entityRepository, sg);\r\n            }\r\n        }\r\n        const colliderGroups = [];\r\n        for (let colliderGroupIdx in gltfModel.extensions.VRM.secondaryAnimation.colliderGroups) {\r\n            const colliderGroup = gltfModel.extensions.VRM.secondaryAnimation.colliderGroups[colliderGroupIdx];\r\n            const vrmColliderGroup = new _physics_VRMColliderGroup__WEBPACK_IMPORTED_MODULE_8__[\"default\"]();\r\n            colliderGroups.push(vrmColliderGroup);\r\n            const colliders = [];\r\n            for (let collider of colliderGroup.colliders) {\r\n                const sphereCollider = new _physics_SphereCollider__WEBPACK_IMPORTED_MODULE_5__[\"default\"]();\r\n                sphereCollider.position = new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](collider.offset.x, collider.offset.y, collider.offset.z);\r\n                sphereCollider.radius = collider.radius;\r\n                colliders.push(sphereCollider);\r\n            }\r\n            vrmColliderGroup.colliders = colliders;\r\n            const baseSg = gltfModel.asset.extras.rnEntities[colliderGroup.node].getSceneGraph();\r\n            vrmColliderGroup.baseSceneGraph = baseSg;\r\n            _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_10__[\"default\"].addColliderGroup(parseInt(colliderGroupIdx), vrmColliderGroup);\r\n        }\r\n    }\r\n    addPhysicsComponentRecursively(entityRepository, sg) {\r\n        const entity = sg.entity;\r\n        entityRepository.addComponentsToEntity([_components_PhysicsComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"]], entity.entityUID);\r\n        _physics_VRMSpringBonePhysicsStrategy__WEBPACK_IMPORTED_MODULE_10__[\"default\"].initialize(sg);\r\n        if (sg.children.length > 0) {\r\n            for (let child of sg.children) {\r\n                this.addPhysicsComponentRecursively(entityRepository, child);\r\n            }\r\n        }\r\n    }\r\n    _createTextures(gltfModel) {\r\n        if (!gltfModel.textures)\r\n            gltfModel.textures = [];\r\n        const gltfTextures = gltfModel.textures;\r\n        const rnTextures = [];\r\n        for (let i = 0; i < gltfTextures.length; i++) {\r\n            const rnTexture = _ModelConverter__WEBPACK_IMPORTED_MODULE_3__[\"default\"]._createTexture({ texture: gltfTextures[i] }, gltfModel);\r\n            rnTextures[i] = rnTexture;\r\n        }\r\n        const dummyWhiteTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_6__[\"default\"]();\r\n        dummyWhiteTexture.generate1x1TextureFrom();\r\n        rnTextures.push(dummyWhiteTexture);\r\n        const dummyBlackTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_6__[\"default\"]();\r\n        dummyBlackTexture.generate1x1TextureFrom(\"rgba(0, 0, 0, 1)\");\r\n        rnTextures.push(dummyBlackTexture);\r\n        return rnTextures;\r\n    }\r\n    _existOutlineMaterial(extensionsVRM) {\r\n        const materialProperties = extensionsVRM.materialProperties;\r\n        if (materialProperties != null) {\r\n            for (let materialProperty of materialProperties) {\r\n                if (materialProperty.floatProperties._OutlineWidthMode !== 0) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    _initializeMaterialProperties(gltfModel, texturesLength) {\r\n        const materialProperties = gltfModel.extensions.VRM.materialProperties;\r\n        for (let materialProperty of materialProperties) {\r\n            if (materialProperty.shader === \"VRM/MToon\") {\r\n                this.__initializeMToonMaterialProperties(gltfModel, texturesLength);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    __initializeMToonMaterialProperties(gltfModel, texturesLength) {\r\n        const materialProperties = gltfModel.extensions.VRM.materialProperties;\r\n        const dummyWhiteTextureNumber = texturesLength - 2;\r\n        const dummyBlackTextureNumber = texturesLength - 1;\r\n        for (let i = 0; i < materialProperties.length; i++) {\r\n            const floatProperties = materialProperties[i].floatProperties;\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_BlendMode\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_BumpScale\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_CullMode\", 2.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_Cutoff\", 0.5);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_DebugMode\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_DstBlend\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_IndirectLightIntensity\", 0.1);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_LightColorAttenuation\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineColorMode\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineCullMode\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineLightingMix\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineScaledMaxDistance\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineWidth\", 0.5);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_OutlineWidthMode\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_ReceiveShadowRate\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_RimFresnelPower\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_RimLift\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_RimLightingMix\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_ShadeShift\", 0.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_ShadeToony\", 0.9);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_ShadingGradeRate\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_SrcBlend\", 1.0);\r\n            this.__initializeForUndefinedProperty(floatProperties, \"_ZWrite\", 1.0);\r\n            // this.__initializeForUndefinedProperty(floatProperties,\"_UvAnimScrollX\", 0.0);\r\n            // this.__initializeForUndefinedProperty(floatProperties,\"_UvAnimScrollY\", 0.0);\r\n            // this.__initializeForUndefinedProperty(floatProperties,\"_UvAnimRotation\", 0.0);\r\n            const vectorProperties = materialProperties[i].vectorProperties;\r\n            this.__initializeForUndefinedProperty(vectorProperties, \"_Color\", [1, 1, 1, 1]);\r\n            this.__initializeForUndefinedProperty(vectorProperties, \"_EmissionColor\", [0, 0, 0]);\r\n            this.__initializeForUndefinedProperty(vectorProperties, \"_OutlineColor\", [0, 0, 0, 1]);\r\n            this.__initializeForUndefinedProperty(vectorProperties, \"_ShadeColor\", [0.97, 0.81, 0.86, 1]);\r\n            this.__initializeForUndefinedProperty(vectorProperties, \"_RimColor\", [0, 0, 0]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_BumpMap\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_EmissionMap\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_MainTex\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_OutlineWidthTexture\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_ReceiveShadowTexture\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_ShadeTexture\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_ShadingGradeTexture\", [0, 0, 1, 1]);\r\n            // this.__initializeForUndefinedProperty(vectorProperties, \"_SphereAdd\", [0, 0, 1, 1]);\r\n            // set num of texture array\r\n            const textureProperties = materialProperties[i].textureProperties;\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_BumpMap\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_EmissionMap\", dummyBlackTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_MainTex\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_OutlineWidthTexture\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_ReceiveShadowTexture\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_RimTexture\", dummyBlackTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_ShadeTexture\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_ShadingGradeTexture\", dummyWhiteTextureNumber);\r\n            this.__initializeForUndefinedProperty(textureProperties, \"_SphereAdd\", dummyBlackTextureNumber);\r\n            // this.__initializeForUndefinedProperty(textureProperties, \"_UvAnimMaskTexture\", dummyWhiteTextureNumber);\r\n        }\r\n    }\r\n    __initializeForUndefinedProperty(object, propertyName, initialValue) {\r\n        if (object[propertyName] == null)\r\n            object[propertyName] = initialValue;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/GltfImporter.ts?");

/***/ }),

/***/ "./src/foundation/importer/ModelConverter.ts":
/*!***************************************************!*\
  !*** ./src/foundation/importer/ModelConverter.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ModelConverter; });\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Quaternion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _geometry_Primitive__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../geometry/Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _memory_Buffer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../memory/Buffer */ \"./src/foundation/memory/Buffer.ts\");\n/* harmony import */ var _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../definitions/CameraType */ \"./src/foundation/definitions/CameraType.ts\");\n/* harmony import */ var _textures_Texture__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../textures/Texture */ \"./src/foundation/textures/Texture.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _components_AnimationComponent__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../components/AnimationComponent */ \"./src/foundation/components/AnimationComponent.ts\");\n/* harmony import */ var _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../definitions/AnimationInterpolation */ \"./src/foundation/definitions/AnimationInterpolation.ts\");\n/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../components/SkeletalComponent */ \"./src/foundation/components/SkeletalComponent.ts\");\n/* harmony import */ var _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n/* harmony import */ var _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../helpers/MaterialHelper */ \"./src/foundation/helpers/MaterialHelper.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _math_Vector2__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../math/Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../definitions/ShadingModel */ \"./src/foundation/definitions/ShadingModel.ts\");\n/* harmony import */ var _geometry_Mesh__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../geometry/Mesh */ \"./src/foundation/geometry/Mesh.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _components_LightComponent__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../components/LightComponent */ \"./src/foundation/components/LightComponent.ts\");\n/* harmony import */ var _definitions_LightType__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../definitions/LightType */ \"./src/foundation/definitions/LightType.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../materials/singles/PbrShadingSingleMaterialNode */ \"./src/foundation/materials/singles/PbrShadingSingleMaterialNode.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A converter class from glTF2 model to Rhodonite Native data\r\n */\r\nclass ModelConverter {\r\n    constructor() {\r\n    }\r\n    /**\r\n     * The static method to get singleton instance of this class.\r\n     * @return The singleton instance of ModelConverter class\r\n     */\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new ModelConverter();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    _getDefaultShader(options) {\r\n        let defaultShader = null;\r\n        // if (options && typeof options.defaultShaderClass !== \"undefined\") {\r\n        //   if (typeof options.defaultShaderClass === \"string\") {\r\n        //     defaultShader = GLBoost[options.defaultShaderClass];\r\n        //   } else {\r\n        //     defaultShader = options.defaultShaderClass;\r\n        //   }\r\n        // }\r\n        return defaultShader;\r\n    }\r\n    __generateEntity(components, gltfModel) {\r\n        const repo = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        const entity = repo.createEntity(components);\r\n        entity.tryToSetTag({ tag: 'SourceType', value: gltfModel.asset.extras.fileType });\r\n        entity.tryToSetTag({ tag: 'SourceTypeVersion', value: gltfModel.asset.extras.version });\r\n        return entity;\r\n    }\r\n    __generateGroupEntity(gltfModel) {\r\n        const entity = this.__generateEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]], gltfModel);\r\n        return entity;\r\n    }\r\n    __generateMeshEntity(gltfModel) {\r\n        const entity = this.__generateEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"]], gltfModel);\r\n        return entity;\r\n    }\r\n    __generateCameraEntity(gltfModel) {\r\n        const entity = this.__generateEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_14__[\"default\"]], gltfModel);\r\n        return entity;\r\n    }\r\n    __generateLightEntity(gltfModel) {\r\n        const entity = this.__generateEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _components_LightComponent__WEBPACK_IMPORTED_MODULE_29__[\"default\"]], gltfModel);\r\n        return entity;\r\n    }\r\n    convertToRhodoniteObject(gltfModel) {\r\n        gltfModel.asset.extras.rnMeshesAtGltMeshIdx = [];\r\n        const rnBuffers = this.createRnBuffer(gltfModel);\r\n        gltfModel.asset.extras.rnMaterials = [];\r\n        // Mesh, Camera, Group, ...\r\n        const { rnEntities, rnEntitiesByNames } = this.__setupObjects(gltfModel, rnBuffers);\r\n        gltfModel.asset.extras.rnEntities = rnEntities;\r\n        // Transform\r\n        this._setupTransform(gltfModel, rnEntities);\r\n        // Skeleton\r\n        this._setupSkeleton(gltfModel, rnEntities);\r\n        // Hierarchy\r\n        this._setupHierarchy(gltfModel, rnEntities);\r\n        // Camera\r\n        //this._setupCamera(gltfModel, groups);\r\n        // Animation\r\n        this._setupAnimation(gltfModel, rnEntities);\r\n        // Root Group\r\n        const rootGroup = this.__generateGroupEntity(gltfModel);\r\n        rootGroup.tryToSetUniqueName('FileRoot', true);\r\n        rootGroup.tryToSetTag({ tag: 'ObjectType', value: 'top' });\r\n        if (gltfModel.scenes[0].nodesIndices) {\r\n            for (let nodesIndex of gltfModel.scenes[0].nodesIndices) {\r\n                rootGroup.getSceneGraph().addChild(rnEntities[nodesIndex].getSceneGraph());\r\n            }\r\n        }\r\n        rootGroup.tryToSetTag({ tag: 'rnEntities', value: rnEntities });\r\n        rootGroup.tryToSetTag({ tag: 'rnEntitiesByNames', value: rnEntitiesByNames });\r\n        rootGroup.tryToSetTag({ tag: 'gltfModel', value: gltfModel });\r\n        return rootGroup;\r\n    }\r\n    _setupCamera(gltfModel) {\r\n    }\r\n    createRnBuffer(gltfModel) {\r\n        const rnBuffers = [];\r\n        for (let buffer of gltfModel.buffers) {\r\n            const rnBuffer = new _memory_Buffer__WEBPACK_IMPORTED_MODULE_9__[\"default\"]({\r\n                byteLength: buffer.byteLength,\r\n                buffer: buffer.buffer,\r\n                name: `gltf2Buffer_0_(${buffer.uri})`\r\n            });\r\n            rnBuffers.push(rnBuffer);\r\n        }\r\n        return rnBuffers;\r\n    }\r\n    _setupTransform(gltfModel, groups) {\r\n        for (let node_i in gltfModel.nodes) {\r\n            let group = groups[node_i];\r\n            let nodeJson = gltfModel.nodes[node_i];\r\n            if (nodeJson.translation) {\r\n                group.getTransform().translate = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](nodeJson.translation[0], nodeJson.translation[1], nodeJson.translation[2]);\r\n            }\r\n            if (nodeJson.scale) {\r\n                group.getTransform().scale = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](nodeJson.scale[0], nodeJson.scale[1], nodeJson.scale[2]);\r\n            }\r\n            if (nodeJson.rotation) {\r\n                group.getTransform().quaternion = new _math_Quaternion__WEBPACK_IMPORTED_MODULE_5__[\"default\"](nodeJson.rotation[0], nodeJson.rotation[1], nodeJson.rotation[2], nodeJson.rotation[3]);\r\n            }\r\n            if (nodeJson.matrix) {\r\n                group.getTransform().matrix = new _math_Matrix44__WEBPACK_IMPORTED_MODULE_6__[\"default\"](nodeJson.matrix, true);\r\n            }\r\n        }\r\n    }\r\n    _setupHierarchy(gltfModel, rnEntities) {\r\n        const groupSceneComponents = rnEntities.map(group => { return group.getSceneGraph(); });\r\n        for (let node_i in gltfModel.nodes) {\r\n            const parentNode_i = parseInt(node_i);\r\n            let node = gltfModel.nodes[parentNode_i];\r\n            if (node.childrenIndices) {\r\n                let parentGroup = groupSceneComponents[parentNode_i];\r\n                for (let childNode_i of node.childrenIndices) {\r\n                    let childGroup = groupSceneComponents[childNode_i];\r\n                    parentGroup.addChild(childGroup);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n    _setupAnimation(gltfModel, rnEntities) {\r\n        var _a;\r\n        if (gltfModel.animations) {\r\n            for (let animation of gltfModel.animations) {\r\n                for (let sampler of animation.samplers) {\r\n                    this._accessBinaryWithAccessor(sampler.input);\r\n                    this._accessBinaryWithAccessor(sampler.output);\r\n                }\r\n            }\r\n        }\r\n        const entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        if (gltfModel.animations) {\r\n            for (let animation of gltfModel.animations) {\r\n                for (let channel of animation.channels) {\r\n                    const animInputArray = channel.sampler.input.extras.typedDataArray;\r\n                    const animOutputArray = channel.sampler.output.extras.typedDataArray;\r\n                    const interpolation = (_a = channel.sampler.interpolation) !== null && _a !== void 0 ? _a : 'LINEAR';\r\n                    let animationAttributeName = '';\r\n                    if (channel.target.path === 'translation') {\r\n                        animationAttributeName = 'translate';\r\n                    }\r\n                    else if (channel.target.path === 'rotation') {\r\n                        animationAttributeName = 'quaternion';\r\n                    }\r\n                    else {\r\n                        animationAttributeName = channel.target.path;\r\n                    }\r\n                    let rnEntity = rnEntities[channel.target.nodeIndex];\r\n                    if (rnEntity) {\r\n                        entityRepository.addComponentsToEntity([_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_18__[\"default\"]], rnEntity.entityUID);\r\n                        const animationComponent = rnEntity.getComponent(_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_18__[\"default\"]);\r\n                        if (animationComponent) {\r\n                            animationComponent.setAnimation(animationAttributeName, animInputArray, animOutputArray, _definitions_AnimationInterpolation__WEBPACK_IMPORTED_MODULE_19__[\"AnimationInterpolation\"].fromString(interpolation));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _setupSkeleton(gltfModel, rnEntities) {\r\n        var _a, _b, _c;\r\n        if (gltfModel.skins == null) {\r\n            return;\r\n        }\r\n        const globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_35__[\"default\"].getInstance();\r\n        const entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        for (let skin of gltfModel.skins) {\r\n            // globalDataRepository.takeOne(ShaderSemantics.BoneQuaternion);\r\n            // globalDataRepository.takeOne(ShaderSemantics.BoneTranslateScale);\r\n            if (skin.inverseBindMatrices) {\r\n                this._accessBinaryWithAccessor(skin.inverseBindMatrices);\r\n            }\r\n        }\r\n        for (let node_i in gltfModel.nodes) {\r\n            let node = gltfModel.nodes[node_i];\r\n            let sg = rnEntities[node_i].getSceneGraph();\r\n            let skeletalComponent;\r\n            if (node.skin != null) {\r\n                let rnEntity = rnEntities[node_i];\r\n                entityRepository.addComponentsToEntity([_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_21__[\"default\"]], rnEntity.entityUID);\r\n                skeletalComponent = rnEntity.getComponent(_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_21__[\"default\"]);\r\n                //        skeletalComponent.isSkinning = false;\r\n                skeletalComponent._jointIndices = node.skin.jointsIndices;\r\n                if (node.skin.bindShapeMatrix != null) {\r\n                    skeletalComponent._bindShapeMatrix = new _math_Matrix44__WEBPACK_IMPORTED_MODULE_6__[\"default\"](node.skin.bindShapeMatrix, true);\r\n                }\r\n            }\r\n            if ((_a = node.skin) === null || _a === void 0 ? void 0 : _a.skeleton) {\r\n                sg.isRootJoint = true;\r\n                // if (node.meshes) {\r\n                //   // let rnEntity = rnEntities[node_i];\r\n                //   // entityRepository\r\n                //   // for (let mesh of node.meshes) {\r\n                //   //   mesh\r\n                //   //   const entity = this.__generateMeshEntity() {\r\n                //   //   }\r\n                //   // }\r\n                //   // skeletalComponent!.jointsHierarchy = rnEntities[node.skin.skeletonIndex].getSceneGraph();\r\n                // } else \r\n                if (node.mesh) {\r\n                    const joints = [];\r\n                    for (let i of node.skin.jointsIndices) {\r\n                        joints.push(rnEntities[i].getSceneGraph());\r\n                    }\r\n                    skeletalComponent.joints = joints;\r\n                    if (node.skin.skeletonIndex != null) {\r\n                        skeletalComponent.jointsHierarchy = rnEntities[node.skin.skeletonIndex].getSceneGraph();\r\n                    }\r\n                    else {\r\n                        skeletalComponent.jointsHierarchy = joints[0];\r\n                    }\r\n                }\r\n            }\r\n            if ((_b = node.skin) === null || _b === void 0 ? void 0 : _b.joints) {\r\n                for (let joint_i of node.skin.jointsIndices) {\r\n                    let sg = rnEntities[joint_i].getSceneGraph();\r\n                    sg.jointIndex = joint_i;\r\n                }\r\n            }\r\n            if (((_c = node.skin) === null || _c === void 0 ? void 0 : _c.inverseBindMatrices) != null) {\r\n                skeletalComponent._inverseBindMatrices = node.skin.inverseBindMatrices.extras.typedDataArray;\r\n            }\r\n        }\r\n    }\r\n    __setupObjects(gltfModel, rnBuffers) {\r\n        var _a, _b;\r\n        const rnEntities = [];\r\n        const rnEntitiesByNames = new Map();\r\n        for (let node_i in gltfModel.nodes) {\r\n            let node = gltfModel.nodes[parseInt(node_i)];\r\n            let entity;\r\n            if (node.mesh != null) {\r\n                let meshIdxOrName = node.meshIndex;\r\n                if (meshIdxOrName == null) {\r\n                    meshIdxOrName = node.meshNames[0];\r\n                }\r\n                const meshEntity = this.__setupMesh(node, node.mesh, meshIdxOrName, rnBuffers, gltfModel);\r\n                if (node.name) {\r\n                    meshEntity.tryToSetUniqueName(node.name, true);\r\n                }\r\n                if (node.mesh.name) {\r\n                    const meshComponent = meshEntity.getComponent(_components_MeshComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"]);\r\n                    meshComponent.tryToSetUniqueName(node.mesh.name, true);\r\n                }\r\n                entity = meshEntity;\r\n            }\r\n            else if (node.camera != null) {\r\n                const cameraEntity = this.__setupCamera(node.camera, gltfModel);\r\n                if (node.name) {\r\n                    cameraEntity.tryToSetUniqueName(node.name, true);\r\n                }\r\n                entity = cameraEntity;\r\n            }\r\n            else if ((_a = node.extensions) === null || _a === void 0 ? void 0 : _a.KHR_lights_punctual) {\r\n                const lightEntity = this.__setupLight(node.extensions.KHR_lights_punctual.light, gltfModel);\r\n                entity = lightEntity;\r\n            }\r\n            else {\r\n                const group = this.__generateGroupEntity(gltfModel);\r\n                if (node.name) {\r\n                    group.tryToSetUniqueName(node.name, true);\r\n                }\r\n                entity = group;\r\n            }\r\n            entity.tryToSetTag({ tag: 'gltf_node_index', value: '' + node_i });\r\n            rnEntities.push(entity);\r\n            rnEntitiesByNames.set(node.name, entity);\r\n            if (this.__isMorphing(node, gltfModel)) {\r\n                let weights;\r\n                if (node.weights) {\r\n                    weights = node.weights;\r\n                }\r\n                else if (node.mesh.weights) {\r\n                    weights = node.mesh.weights;\r\n                }\r\n                else {\r\n                    weights = new Array(node.mesh.primitives[0].targets.length);\r\n                    for (let i = 0; i < weights.length; i++) {\r\n                        weights[i] = 0;\r\n                    }\r\n                }\r\n                const entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n                entityRepository.addComponentsToEntity([_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_34__[\"default\"]], entity.entityUID);\r\n                const blendShapeComponent = entity.getComponent(_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_34__[\"default\"]);\r\n                blendShapeComponent.weights = weights;\r\n                if ((_b = node.mesh.primitives[0].extras) === null || _b === void 0 ? void 0 : _b.targetNames) {\r\n                    blendShapeComponent.targetNames = node.mesh.primitives[0].extras.targetNames;\r\n                }\r\n            }\r\n        }\r\n        return { rnEntities, rnEntitiesByNames };\r\n    }\r\n    __isMorphing(node, gltfModel) {\r\n        var _a, _b, _c;\r\n        const argument = (_c = (_b = (_a = gltfModel === null || gltfModel === void 0 ? void 0 : gltfModel.asset) === null || _a === void 0 ? void 0 : _a.extras) === null || _b === void 0 ? void 0 : _b.rnLoaderOptions) === null || _c === void 0 ? void 0 : _c.defaultMaterialHelperArgumentArray[0];\r\n        if ((argument === null || argument === void 0 ? void 0 : argument.isMorphing) === false) {\r\n            return false;\r\n        }\r\n        else {\r\n            return node.mesh != null && node.mesh.primitives[0].targets != null;\r\n        }\r\n    }\r\n    __setupLight(light, gltfModel) {\r\n        const lightEntity = this.__generateLightEntity(gltfModel);\r\n        const lightComponent = lightEntity.getComponent(_components_LightComponent__WEBPACK_IMPORTED_MODULE_29__[\"default\"]);\r\n        if (light.name != null) {\r\n            lightComponent.tryToSetUniqueName(light.name, true);\r\n            lightComponent.type = _definitions_LightType__WEBPACK_IMPORTED_MODULE_30__[\"LightType\"].fromString(light.type);\r\n            let color = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 1, 1);\r\n            let intensity = 1;\r\n            if (light.color != null) {\r\n                color = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](light.color);\r\n            }\r\n            if (light.intensity != null) {\r\n                intensity = light.intensity;\r\n            }\r\n            lightComponent.intensity = _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].multiply(color, intensity);\r\n            if (light.range != null) {\r\n                lightComponent.range = light.range;\r\n            }\r\n        }\r\n        return lightEntity;\r\n    }\r\n    __setupCamera(camera, gltfModel) {\r\n        const cameraEntity = this.__generateCameraEntity(gltfModel);\r\n        const cameraComponent = cameraEntity.getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_14__[\"default\"]);\r\n        cameraComponent.direction = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, -1);\r\n        if (gltfModel.asset && gltfModel.asset.LastSaved_ApplicationVendor) {\r\n            // For an old exporter compatibility\r\n            cameraComponent.direction = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 0, 0);\r\n            cameraComponent.directionInner = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 0, 0);\r\n        }\r\n        cameraComponent.up = new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 1, 0);\r\n        cameraComponent.type = _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__[\"CameraType\"].fromString(camera.type);\r\n        if (cameraComponent.type === _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__[\"CameraType\"].Perspective) {\r\n            cameraComponent.aspect = camera.perspective.aspectRatio ? camera.perspective.aspectRatio : 1;\r\n            cameraComponent.setFovyAndChangeFocalLength(_math_MathUtil__WEBPACK_IMPORTED_MODULE_20__[\"MathUtil\"].radianToDegree(camera.perspective.yfov));\r\n            cameraComponent.zNear = camera.perspective.znear;\r\n            cameraComponent.zFar = camera.perspective.zfar ? camera.perspective.zfar : 100000;\r\n        }\r\n        else if (cameraComponent.type === _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__[\"CameraType\"].Orthographic) {\r\n            cameraComponent.xMag = camera.orthographic.zmag;\r\n            cameraComponent.yMag = camera.orthographic.ymag;\r\n            cameraComponent.zNear = camera.orthographic.znear;\r\n            cameraComponent.zFar = camera.orthographic.zfar;\r\n        }\r\n        return cameraEntity;\r\n    }\r\n    __setupMesh(node, mesh, meshIndex, rnBuffers, gltfModel) {\r\n        var _a;\r\n        const meshEntity = this.__generateMeshEntity(gltfModel);\r\n        const existingRnMesh = gltfModel.asset.extras.rnMeshesAtGltMeshIdx[meshIndex];\r\n        let rnPrimitiveMode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_10__[\"PrimitiveMode\"].Triangles;\r\n        const meshComponent = meshEntity.getMesh();\r\n        const rnMesh = new _geometry_Mesh__WEBPACK_IMPORTED_MODULE_27__[\"default\"]();\r\n        const rnLoaderOptions = gltfModel.asset.extras.rnLoaderOptions;\r\n        if ((rnLoaderOptions === null || rnLoaderOptions === void 0 ? void 0 : rnLoaderOptions.tangentCalculationMode) != null) {\r\n            rnMesh.tangentCalculationMode = rnLoaderOptions.tangentCalculationMode;\r\n        }\r\n        if ((rnLoaderOptions === null || rnLoaderOptions === void 0 ? void 0 : rnLoaderOptions.isPreComputeForRayCastPickingEnable) != null) {\r\n            rnMesh.isPreComputeForRayCastPickingEnable = rnLoaderOptions.isPreComputeForRayCastPickingEnable;\r\n        }\r\n        let originalRnMesh = rnMesh;\r\n        if (existingRnMesh != null) {\r\n            rnMesh.setOriginalMesh(existingRnMesh);\r\n            originalRnMesh = existingRnMesh;\r\n        }\r\n        else {\r\n            for (let i in mesh.primitives) {\r\n                let primitive = mesh.primitives[i];\r\n                if (primitive.mode != null) {\r\n                    rnPrimitiveMode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_10__[\"PrimitiveMode\"].from(primitive.mode);\r\n                }\r\n                const rnPrimitive = new _geometry_Primitive__WEBPACK_IMPORTED_MODULE_8__[\"default\"]();\r\n                const material = this.__setupMaterial(rnPrimitive, node, gltfModel, primitive, primitive.material);\r\n                if (material.isEmptyMaterial() === false) {\r\n                    ModelConverter.setDefaultTextures(material, gltfModel);\r\n                }\r\n                // indices\r\n                let indicesRnAccessor;\r\n                const map = new Map();\r\n                if ((_a = primitive.extensions) === null || _a === void 0 ? void 0 : _a.KHR_draco_mesh_compression) {\r\n                    indicesRnAccessor = this.__decodeDraco(primitive, rnBuffers, gltfModel, map);\r\n                    if (indicesRnAccessor == null) {\r\n                        break;\r\n                    }\r\n                }\r\n                else {\r\n                    // attributes\r\n                    if (primitive.indices) {\r\n                        indicesRnAccessor = this.__getRnAccessor(primitive.indices, rnBuffers[primitive.indices.bufferView.bufferIndex]);\r\n                    }\r\n                    for (let attributeName in primitive.attributes) {\r\n                        const attributeAccessor = primitive.attributes[attributeName];\r\n                        const attributeRnAccessor = this.__getRnAccessor(attributeAccessor, rnBuffers[attributeAccessor.bufferView.bufferIndex]);\r\n                        if (attributeAccessor.sparse) {\r\n                            this.setSparseAccessor(attributeAccessor, attributeRnAccessor);\r\n                        }\r\n                        map.set(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_13__[\"VertexAttribute\"].fromString(attributeAccessor.extras.attributeName), attributeRnAccessor);\r\n                    }\r\n                }\r\n                rnPrimitive.setData(map, rnPrimitiveMode, material, indicesRnAccessor);\r\n                // morph targets\r\n                if (primitive.targets != null) {\r\n                    // set default number\r\n                    let maxMorphTargetNumber = 4;\r\n                    if ((rnLoaderOptions === null || rnLoaderOptions === void 0 ? void 0 : rnLoaderOptions.maxMorphTargetNumber) != null) {\r\n                        maxMorphTargetNumber = rnLoaderOptions.maxMorphTargetNumber;\r\n                    }\r\n                    const targets = [];\r\n                    for (let i = 0; i < primitive.targets.length; i++) {\r\n                        if (i >= maxMorphTargetNumber) {\r\n                            break;\r\n                        }\r\n                        const target = primitive.targets[i];\r\n                        const targetMap = new Map();\r\n                        for (let attributeName in target) {\r\n                            let attributeAccessor = target[attributeName];\r\n                            const attributeRnAccessor = this.__getRnAccessor(attributeAccessor, rnBuffers[attributeAccessor.bufferView.bufferIndex]);\r\n                            const attributeRnAccessorInGPUVertexData = this.__copyRnAccessorAndBufferView(attributeRnAccessor);\r\n                            targetMap.set(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_13__[\"VertexAttribute\"].fromString(attributeName), attributeRnAccessorInGPUVertexData);\r\n                        }\r\n                        targets.push(targetMap);\r\n                    }\r\n                    rnPrimitive.setTargets(targets);\r\n                }\r\n                rnMesh.addPrimitive(rnPrimitive);\r\n            }\r\n            if (mesh.weights) {\r\n                rnMesh.weights = mesh.weights;\r\n            }\r\n        }\r\n        meshComponent.setMesh(rnMesh);\r\n        gltfModel.asset.extras.rnMeshesAtGltMeshIdx[meshIndex] = originalRnMesh;\r\n        return meshEntity;\r\n    }\r\n    setSparseAccessor(accessor, rnAccessor) {\r\n        var _a, _b, _c, _d;\r\n        const uint8Array = accessor.bufferView.buffer.buffer;\r\n        const count = accessor.sparse.count;\r\n        // indices\r\n        const accessorIndices = accessor.sparse.indices;\r\n        const bufferViewIndices = accessorIndices.bufferView;\r\n        const byteOffsetIndices = ((_a = bufferViewIndices.byteOffset) !== null && _a !== void 0 ? _a : 0) + ((_b = accessorIndices.byteOffset) !== null && _b !== void 0 ? _b : 0);\r\n        const componentBytesIndices = this._checkBytesPerComponent(accessorIndices);\r\n        const byteLengthIndices = componentBytesIndices * count; // index is scalar\r\n        const dataViewIndices = new DataView(uint8Array.buffer, byteOffsetIndices + uint8Array.byteOffset, byteLengthIndices);\r\n        const dataViewMethodIndices = this._checkDataViewMethod(accessorIndices);\r\n        // sparse values\r\n        const accessorValues = accessor.sparse.values;\r\n        const bufferViewValues = accessorValues.bufferView;\r\n        const byteOffsetValues = ((_c = bufferViewValues.byteOffset) !== null && _c !== void 0 ? _c : 0) + ((_d = accessorValues.byteOffset) !== null && _d !== void 0 ? _d : 0);\r\n        const componentBytesValues = this._checkBytesPerComponent(accessor);\r\n        const componentNValues = this._checkComponentNumber(accessor);\r\n        const byteLengthValues = componentBytesValues * componentNValues * count;\r\n        const dataViewValues = new DataView(uint8Array.buffer, byteOffsetValues + uint8Array.byteOffset, byteLengthValues);\r\n        const dataViewMethodValues = this._checkDataViewMethod(accessor);\r\n        // set sparse values\r\n        const typedArray = rnAccessor.getTypedArray();\r\n        const littleEndian = true;\r\n        for (let i = 0; i < count; i++) {\r\n            const index = dataViewIndices[dataViewMethodIndices](componentBytesIndices * i, littleEndian);\r\n            for (let j = 0; j < componentNValues; j++) {\r\n                const value = dataViewValues[dataViewMethodValues](componentBytesValues * componentNValues * i + componentBytesValues * j, littleEndian);\r\n                typedArray[index * componentNValues + j] = value;\r\n            }\r\n        }\r\n    }\r\n    static setDefaultTextures(material, gltfModel) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\r\n        if (((_b = (_a = gltfModel.asset.extras) === null || _a === void 0 ? void 0 : _a.rnLoaderOptions) === null || _b === void 0 ? void 0 : _b.defaultTextures) == null) {\r\n            return;\r\n        }\r\n        const options = gltfModel.asset.extras.rnLoaderOptions;\r\n        const defaultTextures = gltfModel.asset.extras.rnLoaderOptions.defaultTextures;\r\n        const basePath = defaultTextures.basePath;\r\n        const textureInfos = defaultTextures.textureInfos;\r\n        for (let textureInfo of textureInfos) {\r\n            const rnTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_16__[\"default\"]();\r\n            //options\r\n            rnTexture.autoDetectTransparency = options.autoDetectTextureTransparency === true;\r\n            rnTexture.autoResize = options.autoResizeTexture === true;\r\n            const textureOption = {\r\n                magFilter: (_d = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_c = textureInfo.sampler) === null || _c === void 0 ? void 0 : _c.magFilter)) !== null && _d !== void 0 ? _d : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Linear,\r\n                minFilter: (_f = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_e = textureInfo.sampler) === null || _e === void 0 ? void 0 : _e.minFilter)) !== null && _f !== void 0 ? _f : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Linear,\r\n                wrapS: (_h = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_g = textureInfo.sampler) === null || _g === void 0 ? void 0 : _g.wrapS)) !== null && _h !== void 0 ? _h : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Repeat,\r\n                wrapT: (_k = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_j = textureInfo.sampler) === null || _j === void 0 ? void 0 : _j.wrapT)) !== null && _k !== void 0 ? _k : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Repeat\r\n            };\r\n            const fileName = textureInfo.fileName;\r\n            const uri = basePath + fileName;\r\n            rnTexture.name = uri;\r\n            const image = textureInfo.image;\r\n            if (image === null || image === void 0 ? void 0 : image.image) {\r\n                const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_39__[\"default\"].getWebGLResourceRepository();\r\n                const isWebGL1 = !((_l = webglResourceRepository.currentWebGLContextWrapper) === null || _l === void 0 ? void 0 : _l.isWebGL2);\r\n                if (isWebGL1 && !this.__sizeIsPowerOfTwo(image.image) && this.__needResizeToPowerOfTwoOnWebGl1(textureOption)) {\r\n                    rnTexture.autoResize = true;\r\n                }\r\n                rnTexture.generateTextureFromImage(image.image, textureOption);\r\n            }\r\n            else if (image === null || image === void 0 ? void 0 : image.basis) {\r\n                rnTexture.generateTextureFromBasis(image.basis, textureOption);\r\n            }\r\n            else {\r\n                console.warn(\"default image not found\");\r\n                continue;\r\n            }\r\n            const shaderSemantics = textureInfo.shaderSemantics;\r\n            material.setTextureParameter(shaderSemantics, rnTexture);\r\n        }\r\n    }\r\n    __setMorphingAndSkinningArgument(node, argumentOfMaterialHelper, isMorphingOriginal, isSkinningOriginal, gltfModel) {\r\n        var _a;\r\n        if (isMorphingOriginal) {\r\n            argumentOfMaterialHelper.isMorphing = this.__isMorphing(node, gltfModel);\r\n        }\r\n        if (isSkinningOriginal) {\r\n            const existSkin = node.skin != null;\r\n            argumentOfMaterialHelper.isSkinning = existSkin;\r\n            argumentOfMaterialHelper.additionalName = existSkin ? `skin${((_a = node.skinIndex) !== null && _a !== void 0 ? _a : node.skinName)}` : \"\";\r\n        }\r\n    }\r\n    __setVRMMaterial(rnPrimitive, node, gltfModel, primitive, argumentArray) {\r\n        const VRMProperties = gltfModel.extensions.VRM;\r\n        const shaderName = VRMProperties.materialProperties[primitive.materialIndex].shader;\r\n        if (shaderName === \"VRM/MToon\") {\r\n            // argument\r\n            const argumentOfMaterialHelper = argumentArray[0];\r\n            const rnExtension = VRMProperties.rnExtension;\r\n            const isMorphingOriginal = argumentOfMaterialHelper.isMorphing;\r\n            const isSkinningOriginal = argumentOfMaterialHelper.isSkinning;\r\n            this.__setMorphingAndSkinningArgument(node, argumentOfMaterialHelper, isMorphingOriginal, isSkinningOriginal, gltfModel);\r\n            const materialProperties = gltfModel.extensions.VRM.materialProperties[primitive.materialIndex];\r\n            argumentOfMaterialHelper.materialProperties = materialProperties;\r\n            // outline\r\n            let renderPassOutline;\r\n            if (rnExtension) {\r\n                renderPassOutline = rnExtension.renderPassOutline;\r\n            }\r\n            //exist outline\r\n            if (renderPassOutline != null) {\r\n                let outlineMaterial;\r\n                if (materialProperties.floatProperties._OutlineWidthMode !== 0) {\r\n                    argumentOfMaterialHelper.isOutline = true;\r\n                    outlineMaterial = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createMToonMaterial(argumentOfMaterialHelper);\r\n                    argumentOfMaterialHelper.isOutline = false;\r\n                }\r\n                else {\r\n                    outlineMaterial = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createEmptyMaterial();\r\n                }\r\n                renderPassOutline.setMaterialForPrimitive(outlineMaterial, rnPrimitive);\r\n            }\r\n            const material = _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createMToonMaterial(argumentOfMaterialHelper);\r\n            argumentOfMaterialHelper.isMorphing = isMorphingOriginal;\r\n            argumentOfMaterialHelper.isSkinning = isSkinningOriginal;\r\n            return material;\r\n        }\r\n        else if (argumentArray[0].isOutline) {\r\n            return _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createEmptyMaterial();\r\n            ;\r\n        }\r\n        // use another material\r\n        return undefined;\r\n    }\r\n    __generateAppropriateMaterial(rnPrimitive, node, gltfModel, primitive, materialJson) {\r\n        var _a, _b, _c, _d;\r\n        if (((_a = gltfModel.asset.extras) === null || _a === void 0 ? void 0 : _a.rnLoaderOptions) != null) {\r\n            const rnLoaderOptions = gltfModel.asset.extras.rnLoaderOptions;\r\n            if ((_b = rnLoaderOptions.loaderExtension) === null || _b === void 0 ? void 0 : _b.isNeededToUseThisMaterial(gltfModel)) {\r\n                const loaderExtension = gltfModel.asset.extras.rnLoaderOptions.loaderExtension;\r\n                return loaderExtension.generateMaterial();\r\n            }\r\n            const argumentArray = rnLoaderOptions.defaultMaterialHelperArgumentArray;\r\n            if (rnLoaderOptions.isImportVRM) {\r\n                const material = this.__setVRMMaterial(rnPrimitive, node, gltfModel, primitive, argumentArray);\r\n                if (material != null)\r\n                    return material;\r\n            }\r\n            const materialHelperName = rnLoaderOptions.defaultMaterialHelperName;\r\n            if (materialHelperName != null) {\r\n                return _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"][materialHelperName](...argumentArray);\r\n            }\r\n        }\r\n        let maxMaterialInstanceNumber = _core_Config__WEBPACK_IMPORTED_MODULE_31__[\"default\"].maxMaterialInstanceForEachType;\r\n        if (gltfModel.meshes.length > _core_Config__WEBPACK_IMPORTED_MODULE_31__[\"default\"].maxMaterialInstanceForEachType) {\r\n            maxMaterialInstanceNumber = gltfModel.meshes.length + _core_Config__WEBPACK_IMPORTED_MODULE_31__[\"default\"].maxMaterialInstanceForEachType / 2;\r\n        }\r\n        const isMorphing = this.__isMorphing(node, gltfModel);\r\n        const isSkinning = this.__isSkinning(node, gltfModel);\r\n        const isLighting = this.__isLighting(gltfModel, materialJson);\r\n        const alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_22__[\"AlphaMode\"].fromGlTFString((materialJson === null || materialJson === void 0 ? void 0 : materialJson.alphaMode) || 'OPAQUE');\r\n        const additionalName = (node.skin != null) ? `skin${((_c = node.skinIndex) !== null && _c !== void 0 ? _c : node.skinName)}` : void 0;\r\n        if (parseFloat((_d = gltfModel.asset) === null || _d === void 0 ? void 0 : _d.version) >= 2) {\r\n            return _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createPbrUberMaterial({\r\n                isMorphing, isSkinning, isLighting, alphaMode,\r\n                additionalName: additionalName, maxInstancesNumber: maxMaterialInstanceNumber\r\n            });\r\n        }\r\n        else {\r\n            return _helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_23__[\"default\"].createClassicUberMaterial({\r\n                isSkinning, isLighting, alphaMode,\r\n                additionalName: additionalName, maxInstancesNumber: maxMaterialInstanceNumber\r\n            });\r\n        }\r\n    }\r\n    __isLighting(gltfModel, materialJson) {\r\n        var _a, _b, _c, _d;\r\n        const argument = (_c = (_b = (_a = gltfModel === null || gltfModel === void 0 ? void 0 : gltfModel.asset) === null || _a === void 0 ? void 0 : _a.extras) === null || _b === void 0 ? void 0 : _b.rnLoaderOptions) === null || _c === void 0 ? void 0 : _c.defaultMaterialHelperArgumentArray[0];\r\n        if ((argument === null || argument === void 0 ? void 0 : argument.isLighting) != null) {\r\n            return argument.isLighting;\r\n        }\r\n        else {\r\n            return (((_d = materialJson === null || materialJson === void 0 ? void 0 : materialJson.extensions) === null || _d === void 0 ? void 0 : _d.KHR_materials_unlit) != null) ? false : true;\r\n        }\r\n    }\r\n    __isSkinning(node, gltfModel) {\r\n        var _a, _b, _c;\r\n        const argument = (_c = (_b = (_a = gltfModel === null || gltfModel === void 0 ? void 0 : gltfModel.asset) === null || _a === void 0 ? void 0 : _a.extras) === null || _b === void 0 ? void 0 : _b.rnLoaderOptions) === null || _c === void 0 ? void 0 : _c.defaultMaterialHelperArgumentArray[0];\r\n        if ((argument === null || argument === void 0 ? void 0 : argument.isSkinning) === false) {\r\n            return false;\r\n        }\r\n        else {\r\n            return (node.skin != null) ? true : false;\r\n        }\r\n    }\r\n    __setupMaterial(rnPrimitive, node, gltfModel, primitive, materialJson) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n        let material = (_a = gltfModel.asset.extras) === null || _a === void 0 ? void 0 : _a.rnMaterials[primitive.materialIndex];\r\n        if ((material === null || material === void 0 ? void 0 : material.isSkinning) === this.__isSkinning(node, gltfModel) && material.isMorphing === this.__isMorphing(node, gltfModel)) {\r\n            return material;\r\n        }\r\n        else {\r\n            const newMaterial = this.__generateAppropriateMaterial(rnPrimitive, node, gltfModel, primitive, materialJson);\r\n            gltfModel.asset.extras.rnMaterials[primitive.materialIndex] = newMaterial;\r\n            material = newMaterial;\r\n        }\r\n        // avoid unexpected initialization\r\n        if (!this.__needParameterInitialization(materialJson, material.materialTypeName))\r\n            return material;\r\n        const pbrMetallicRoughness = materialJson.pbrMetallicRoughness;\r\n        if (pbrMetallicRoughness != null) {\r\n            const baseColorFactor = pbrMetallicRoughness.baseColorFactor;\r\n            if (baseColorFactor != null) {\r\n                material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].BaseColorFactor, new _math_Vector4__WEBPACK_IMPORTED_MODULE_17__[\"default\"](baseColorFactor));\r\n            }\r\n            const baseColorTexture = pbrMetallicRoughness.baseColorTexture;\r\n            if (baseColorTexture != null) {\r\n                const rnTexture = ModelConverter._createTexture(baseColorTexture, gltfModel);\r\n                material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].BaseColorTexture, rnTexture);\r\n            }\r\n            ModelConverter._setupTextureTransform(baseColorTexture, material, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].baseColorTextureTransform, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].baseColorTextureRotation);\r\n            const occlusionTexture = materialJson.occlusionTexture;\r\n            if (occlusionTexture != null) {\r\n                const rnTexture = ModelConverter._createTexture(occlusionTexture, gltfModel);\r\n                material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].OcclusionTexture, rnTexture);\r\n            }\r\n            let metallicFactor = pbrMetallicRoughness.metallicFactor;\r\n            metallicFactor = metallicFactor !== null && metallicFactor !== void 0 ? metallicFactor : 1;\r\n            let roughnessFactor = pbrMetallicRoughness.roughnessFactor;\r\n            roughnessFactor = roughnessFactor !== null && roughnessFactor !== void 0 ? roughnessFactor : 1;\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].MetallicRoughnessFactor, new _math_Vector2__WEBPACK_IMPORTED_MODULE_25__[\"default\"](metallicFactor, roughnessFactor));\r\n            const metallicRoughnessTexture = pbrMetallicRoughness.metallicRoughnessTexture;\r\n            if (metallicRoughnessTexture != null) {\r\n                const rnTexture = ModelConverter._createTexture(metallicRoughnessTexture, gltfModel);\r\n                material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].MetallicRoughnessTexture, rnTexture);\r\n            }\r\n            ModelConverter._setupTextureTransform(metallicRoughnessTexture, material, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].metallicRoughnessTextureTransform, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].metallicRoughnessTextureRotation);\r\n        }\r\n        else {\r\n            let param = _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Phong.index;\r\n            if ((_b = materialJson.extras) === null || _b === void 0 ? void 0 : _b.technique) {\r\n                switch (materialJson.extras.technique) {\r\n                    case _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Constant.str:\r\n                        param = _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Constant.index;\r\n                        break;\r\n                    case _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Lambert.str:\r\n                        param = _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Lambert.index;\r\n                        break;\r\n                    case _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].BlinnPhong.str:\r\n                        param = _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].BlinnPhong.index;\r\n                        break;\r\n                    case _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Phong.str:\r\n                        param = _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_26__[\"ShadingModel\"].Phong.index;\r\n                        break;\r\n                }\r\n                material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].ShadingModel, new _math_Scalar__WEBPACK_IMPORTED_MODULE_37__[\"default\"](param));\r\n            }\r\n        }\r\n        const emissiveTexture = materialJson.emissiveTexture;\r\n        if (emissiveTexture != null) {\r\n            const rnTexture = ModelConverter._createTexture(emissiveTexture, gltfModel);\r\n            material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].EmissiveTexture, rnTexture);\r\n        }\r\n        const options = gltfModel.asset.extras.rnLoaderOptions;\r\n        let alphaMode = materialJson.alphaMode;\r\n        if (options === null || options === void 0 ? void 0 : options.alphaMode) {\r\n            alphaMode = options.alphaMode;\r\n        }\r\n        if (alphaMode != null) {\r\n            material.alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_22__[\"AlphaMode\"].fromGlTFString(alphaMode);\r\n            // set alpha threshold except for VRM\r\n            if (material.alphaMode === _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_22__[\"AlphaMode\"].Mask\r\n                && !((_d = (_c = gltfModel.asset.extras) === null || _c === void 0 ? void 0 : _c.rnLoaderOptions) === null || _d === void 0 ? void 0 : _d.isImportVRM)) {\r\n                material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].AlphaCutoff, new _math_Scalar__WEBPACK_IMPORTED_MODULE_37__[\"default\"]((_e = materialJson.alphaCutoff) !== null && _e !== void 0 ? _e : 0.5));\r\n            }\r\n        }\r\n        const doubleSided = materialJson.doubleSided;\r\n        if (doubleSided != null) {\r\n            material.cullFace = !doubleSided;\r\n        }\r\n        // For glTF1.0\r\n        const diffuseColorTexture = materialJson.diffuseColorTexture;\r\n        if (diffuseColorTexture != null) {\r\n            const rnTexture = ModelConverter._createTexture(diffuseColorTexture, gltfModel);\r\n            material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].DiffuseColorTexture, rnTexture);\r\n            if (this._checkRnGltfLoaderOptionsExist(gltfModel) && ((_g = (_f = gltfModel.asset.extras) === null || _f === void 0 ? void 0 : _f.rnLoaderOptions) === null || _g === void 0 ? void 0 : _g.loaderExtension)) {\r\n                const loaderExtension = gltfModel.asset.extras.rnLoaderOptions.loaderExtension;\r\n                if (loaderExtension.setUVTransformToTexture) {\r\n                    loaderExtension.setUVTransformToTexture(material, diffuseColorTexture.texture.sampler);\r\n                }\r\n            }\r\n        }\r\n        const diffuseColorFactor = materialJson.diffuseColorFactor;\r\n        if (diffuseColorFactor != null) {\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].DiffuseColorFactor, new _math_Vector4__WEBPACK_IMPORTED_MODULE_17__[\"default\"](diffuseColorFactor));\r\n        }\r\n        const normalTexture = materialJson.normalTexture;\r\n        if (normalTexture != null) {\r\n            const rnTexture = ModelConverter._createTexture(normalTexture, gltfModel);\r\n            material.setTextureParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_24__[\"ShaderSemantics\"].NormalTexture, rnTexture);\r\n        }\r\n        ModelConverter._setupTextureTransform(normalTexture, material, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].normalTextureTransform, _materials_singles_PbrShadingSingleMaterialNode__WEBPACK_IMPORTED_MODULE_36__[\"default\"].normalTextureRotation);\r\n        // ModelConverter._setupTextureTransform(normalTexture, material, 'normalTextureTransform', 'normalTextureRotation')\r\n        // For Extension\r\n        if (this._checkRnGltfLoaderOptionsExist(gltfModel) && ((_j = (_h = gltfModel.asset.extras) === null || _h === void 0 ? void 0 : _h.rnLoaderOptions) === null || _j === void 0 ? void 0 : _j.loaderExtension)) {\r\n            const loaderExtension = gltfModel.asset.extras.rnLoaderOptions.loaderExtension;\r\n            loaderExtension.setupMaterial(gltfModel, materialJson, material);\r\n        }\r\n        return material;\r\n    }\r\n    static _createTexture(textureType, gltfModel) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        const options = (_a = gltfModel.asset.extras) === null || _a === void 0 ? void 0 : _a.rnLoaderOptions;\r\n        const rnTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_16__[\"default\"]();\r\n        rnTexture.autoDetectTransparency = (options === null || options === void 0 ? void 0 : options.autoDetectTextureTransparency) === true;\r\n        rnTexture.autoResize = (options === null || options === void 0 ? void 0 : options.autoResizeTexture) === true;\r\n        const texture = textureType.texture;\r\n        const textureOption = {\r\n            magFilter: (_c = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_b = texture.sampler) === null || _b === void 0 ? void 0 : _b.magFilter)) !== null && _c !== void 0 ? _c : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Linear,\r\n            minFilter: (_e = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_d = texture.sampler) === null || _d === void 0 ? void 0 : _d.minFilter)) !== null && _e !== void 0 ? _e : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Linear,\r\n            wrapS: (_g = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_f = texture.sampler) === null || _f === void 0 ? void 0 : _f.wrapS)) !== null && _g !== void 0 ? _g : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Repeat,\r\n            wrapT: (_j = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].from((_h = texture.sampler) === null || _h === void 0 ? void 0 : _h.wrapT)) !== null && _j !== void 0 ? _j : _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Repeat\r\n        };\r\n        if (texture.image.image) {\r\n            const image = texture.image.image;\r\n            const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_39__[\"default\"].getWebGLResourceRepository();\r\n            const isWebGL1 = !((_k = webglResourceRepository.currentWebGLContextWrapper) === null || _k === void 0 ? void 0 : _k.isWebGL2);\r\n            if (isWebGL1 && !this.__sizeIsPowerOfTwo(image) && this.__needResizeToPowerOfTwoOnWebGl1(textureOption)) {\r\n                rnTexture.autoResize = true;\r\n            }\r\n            rnTexture.generateTextureFromImage(image, textureOption);\r\n            if (texture.image.uri) {\r\n                rnTexture.name = texture.image.url;\r\n            }\r\n            else {\r\n                const ext = texture.image.mimeType.split('/')[1];\r\n                rnTexture.name = texture.image.name + `.${ext}`;\r\n            }\r\n        }\r\n        else if (texture.image.basis) {\r\n            rnTexture.generateTextureFromBasis(texture.image.basis, textureOption);\r\n            if (texture.image.uri) {\r\n                rnTexture.name = texture.image.url;\r\n            }\r\n            else {\r\n                const ext = texture.image.mimeType.split('/')[1];\r\n                rnTexture.name = texture.image.name + `.${ext}`;\r\n            }\r\n        }\r\n        return rnTexture;\r\n    }\r\n    static __needResizeToPowerOfTwoOnWebGl1(textureOption) {\r\n        if (textureOption.wrapS !== _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].ClampToEdge ||\r\n            textureOption.wrapT !== _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].ClampToEdge ||\r\n            (textureOption.minFilter !== _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Linear &&\r\n                textureOption.minFilter !== _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_38__[\"TextureParameter\"].Nearest)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    static __sizeIsPowerOfTwo(image) {\r\n        const width = image.width;\r\n        const height = image.height;\r\n        if ((width & width - 1) == 0 && (height & height - 1) == 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    __needParameterInitialization(materialJson, materialTypeName) {\r\n        if (materialJson == null)\r\n            return false;\r\n        if (materialTypeName.match(/PbrUber/) != null ||\r\n            materialTypeName.match(/ClassicUber/) != null) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    _checkRnGltfLoaderOptionsExist(gltfModel) {\r\n        var _a;\r\n        if ((_a = gltfModel.asset.extras) === null || _a === void 0 ? void 0 : _a.rnLoaderOptions) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    _adjustByteAlign(typedArrayClass, uint8Array, alignSize, byteOffset, length) {\r\n        if ((byteOffset % alignSize) != 0) {\r\n            return new typedArrayClass(uint8Array.buffer.slice(byteOffset + uint8Array.byteOffset), 0, length);\r\n        }\r\n        else {\r\n            return new typedArrayClass(uint8Array.buffer, byteOffset + uint8Array.byteOffset, length);\r\n        }\r\n    }\r\n    _checkBytesPerComponent(accessor) {\r\n        var bytesPerComponent = 0;\r\n        switch (accessor.componentType) {\r\n            case 5120: // gl.BYTE\r\n                bytesPerComponent = 1;\r\n                break;\r\n            case 5121: // gl.UNSIGNED_BYTE\r\n                bytesPerComponent = 1;\r\n                break;\r\n            case 5122: // gl.SHORT\r\n                bytesPerComponent = 2;\r\n                break;\r\n            case 5123: // gl.UNSIGNED_SHORT\r\n                bytesPerComponent = 2;\r\n                break;\r\n            case 5124: // gl.INT\r\n                bytesPerComponent = 4;\r\n                break;\r\n            case 5125: // gl.UNSIGNED_INT\r\n                bytesPerComponent = 4;\r\n                break;\r\n            case 5126: // gl.FLOAT\r\n                bytesPerComponent = 4;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return bytesPerComponent;\r\n    }\r\n    _checkComponentNumber(accessor) {\r\n        var componentN = 0;\r\n        switch (accessor.type) {\r\n            case 'SCALAR':\r\n                componentN = 1;\r\n                break;\r\n            case 'VEC2':\r\n                componentN = 2;\r\n                break;\r\n            case 'VEC3':\r\n                componentN = 3;\r\n                break;\r\n            case 'VEC4':\r\n                componentN = 4;\r\n                break;\r\n            case 'MAT4':\r\n                componentN = 16;\r\n                break;\r\n        }\r\n        return componentN;\r\n    }\r\n    _checkDataViewMethod(accessor) {\r\n        var dataViewMethod = '';\r\n        switch (accessor.componentType) {\r\n            case 5120: // gl.BYTE\r\n                dataViewMethod = 'getInt8';\r\n                break;\r\n            case 5121: // gl.UNSIGNED_BYTE\r\n                dataViewMethod = 'getUint8';\r\n                break;\r\n            case 5122: // gl.SHORT\r\n                dataViewMethod = 'getInt16';\r\n                break;\r\n            case 5123: // gl.UNSIGNED_SHORT\r\n                dataViewMethod = 'getUint16';\r\n                break;\r\n            case 5124: // gl.INT\r\n                dataViewMethod = 'getInt32';\r\n                break;\r\n            case 5125: // gl.UNSIGNED_INT\r\n                dataViewMethod = 'getUint32';\r\n                break;\r\n            case 5126: // gl.FLOAT\r\n                dataViewMethod = 'getFloat32';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return dataViewMethod;\r\n    }\r\n    static _isSystemLittleEndian() {\r\n        return !!(new Uint8Array((new Uint16Array([0x00ff])).buffer))[0];\r\n    }\r\n    _accessBinaryWithAccessor(accessor) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const bufferView = accessor.bufferView;\r\n        const byteOffset = ((_a = bufferView.byteOffset) !== null && _a !== void 0 ? _a : 0) + ((_b = accessor.byteOffset) !== null && _b !== void 0 ? _b : 0);\r\n        const buffer = bufferView.buffer;\r\n        const uint8Array = buffer.buffer;\r\n        const componentN = this._checkComponentNumber(accessor);\r\n        const componentBytes = this._checkBytesPerComponent(accessor);\r\n        const dataViewMethod = this._checkDataViewMethod(accessor);\r\n        if (accessor.extras === void 0) {\r\n            accessor.extras = {};\r\n        }\r\n        accessor.extras.componentN = componentN;\r\n        accessor.extras.componentBytes = componentBytes;\r\n        accessor.extras.dataViewMethod = dataViewMethod;\r\n        const byteLength = componentBytes * componentN * accessor.count;\r\n        let typedDataArray = [];\r\n        if ((_c = accessor.extras) === null || _c === void 0 ? void 0 : _c.toGetAsTypedArray) {\r\n            if (ModelConverter._isSystemLittleEndian()) {\r\n                if (dataViewMethod === 'getFloat32') {\r\n                    typedDataArray = this._adjustByteAlign(Float32Array, uint8Array, 4, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getInt8') {\r\n                    typedDataArray = new Int8Array(uint8Array, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getUint8') {\r\n                    typedDataArray = new Uint8Array(uint8Array, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getInt16') {\r\n                    typedDataArray = this._adjustByteAlign(Int16Array, uint8Array, 2, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getUint16') {\r\n                    typedDataArray = this._adjustByteAlign(Uint16Array, uint8Array, 2, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getInt32') {\r\n                    typedDataArray = this._adjustByteAlign(Int32Array, uint8Array, 4, byteOffset, byteLength / componentBytes);\r\n                }\r\n                else if (dataViewMethod === 'getUint32') {\r\n                    typedDataArray = this._adjustByteAlign(Uint32Array, uint8Array, 4, byteOffset, byteLength / componentBytes);\r\n                }\r\n            }\r\n            else {\r\n                const dataView = new DataView(uint8Array.buffer, byteOffset + uint8Array.byteOffset, byteLength);\r\n                const byteDelta = componentBytes * componentN;\r\n                const littleEndian = true;\r\n                for (let pos = 0; pos < byteLength; pos += byteDelta) {\r\n                    switch (accessor.type) {\r\n                        case 'SCALAR':\r\n                            typedDataArray.push(dataView[dataViewMethod](pos, littleEndian));\r\n                            break;\r\n                        case 'VEC2':\r\n                            typedDataArray.push(dataView[dataViewMethod](pos, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes, littleEndian));\r\n                            break;\r\n                        case 'VEC3':\r\n                            typedDataArray.push(dataView[dataViewMethod](pos, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes * 2, littleEndian));\r\n                            break;\r\n                        case 'VEC4':\r\n                            typedDataArray.push(dataView[dataViewMethod](pos, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes * 2, littleEndian));\r\n                            typedDataArray.push(dataView[dataViewMethod](pos + componentBytes * 3, littleEndian));\r\n                            break;\r\n                    }\r\n                }\r\n                if (dataViewMethod === 'getInt8') {\r\n                    typedDataArray = new Int8Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getUint8') {\r\n                    typedDataArray = new Uint8Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getInt16') {\r\n                    typedDataArray = new Int16Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getUint16') {\r\n                    typedDataArray = new Uint16Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getInt32') {\r\n                    typedDataArray = new Int32Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getUint32') {\r\n                    typedDataArray = new Uint32Array(typedDataArray);\r\n                }\r\n                else if (dataViewMethod === 'getFloat32') {\r\n                    typedDataArray = new Float32Array(typedDataArray);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            const dataView = new DataView(uint8Array.buffer, byteOffset + uint8Array.byteOffset, byteLength);\r\n            let byteDelta = componentBytes * componentN;\r\n            if ((_d = accessor.extras) === null || _d === void 0 ? void 0 : _d.weightCount) {\r\n                byteDelta = componentBytes * componentN * accessor.extras.weightCount;\r\n            }\r\n            const littleEndian = true;\r\n            for (let pos = 0; pos < byteLength; pos += byteDelta) {\r\n                switch (accessor.type) {\r\n                    case 'SCALAR':\r\n                        if ((_e = accessor.extras) === null || _e === void 0 ? void 0 : _e.weightCount) {\r\n                            const array = [];\r\n                            for (let i = 0; i < accessor.extras.weightCount; i++) {\r\n                                array.push(dataView[dataViewMethod](pos + componentBytes * i, littleEndian));\r\n                            }\r\n                            typedDataArray.push(array);\r\n                        }\r\n                        else {\r\n                            typedDataArray.push(dataView[dataViewMethod](pos, littleEndian));\r\n                        }\r\n                        break;\r\n                    case 'VEC2':\r\n                        typedDataArray.push(new _math_Vector2__WEBPACK_IMPORTED_MODULE_25__[\"default\"](dataView[dataViewMethod](pos, littleEndian), dataView[dataViewMethod](pos + componentBytes, littleEndian)));\r\n                        break;\r\n                    case 'VEC3':\r\n                        typedDataArray.push(new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](dataView[dataViewMethod](pos, littleEndian), dataView[dataViewMethod](pos + componentBytes, littleEndian), dataView[dataViewMethod](pos + componentBytes * 2, littleEndian)));\r\n                        break;\r\n                    case 'VEC4':\r\n                        if ((_f = accessor.extras) === null || _f === void 0 ? void 0 : _f.quaternionIfVec4) {\r\n                            typedDataArray.push(new _math_Quaternion__WEBPACK_IMPORTED_MODULE_5__[\"default\"](dataView[dataViewMethod](pos, littleEndian), dataView[dataViewMethod](pos + componentBytes, littleEndian), dataView[dataViewMethod](pos + componentBytes * 2, littleEndian), dataView[dataViewMethod](pos + componentBytes * 3, littleEndian)));\r\n                        }\r\n                        else {\r\n                            typedDataArray.push(new _math_Vector4__WEBPACK_IMPORTED_MODULE_17__[\"default\"](dataView[dataViewMethod](pos, littleEndian), dataView[dataViewMethod](pos + componentBytes, littleEndian), dataView[dataViewMethod](pos + componentBytes * 2, littleEndian), dataView[dataViewMethod](pos + componentBytes * 3, littleEndian)));\r\n                        }\r\n                        break;\r\n                    case 'MAT4':\r\n                        const matrixComponents = [];\r\n                        for (let i = 0; i < 16; i++) {\r\n                            matrixComponents[i] = dataView[dataViewMethod](pos + componentBytes * i, littleEndian);\r\n                        }\r\n                        typedDataArray.push(new _math_Matrix44__WEBPACK_IMPORTED_MODULE_6__[\"default\"](matrixComponents, true));\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        accessor.extras.typedDataArray = typedDataArray;\r\n        return typedDataArray;\r\n    }\r\n    __addOffsetToIndices(meshComponent) {\r\n        const primitiveNumber = meshComponent.mesh.getPrimitiveNumber();\r\n        let offsetSum = 0;\r\n        for (let i = 0; i < primitiveNumber; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            const indicesAccessor = primitive.indicesAccessor;\r\n            if (indicesAccessor) {\r\n                const elementNumber = indicesAccessor.elementCount;\r\n                for (let j = 0; j < elementNumber; j++) {\r\n                    const index = indicesAccessor.getScalar(j, {});\r\n                    indicesAccessor.setScalar(j, index + offsetSum, {});\r\n                }\r\n                offsetSum += elementNumber;\r\n            }\r\n        }\r\n    }\r\n    __getRnAccessor(accessor, rnBuffer) {\r\n        var _a, _b, _c, _d;\r\n        const bufferView = accessor.bufferView;\r\n        const rnBufferView = rnBuffer.takeBufferViewWithByteOffset({\r\n            byteLengthToNeed: bufferView.byteLength,\r\n            byteStride: (_a = bufferView.byteStride) !== null && _a !== void 0 ? _a : 0,\r\n            byteOffset: (_b = bufferView.byteOffset) !== null && _b !== void 0 ? _b : 0,\r\n            isAoS: false\r\n        });\r\n        let rnAccessor;\r\n        if (accessor.byteStride != null) {\r\n            rnAccessor = rnBufferView.takeFlexibleAccessorWithByteOffset({\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(accessor.type),\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__[\"ComponentType\"].from(accessor.componentType),\r\n                count: accessor.count,\r\n                byteStride: accessor.byteStride,\r\n                byteOffset: (_c = accessor.byteOffset) !== null && _c !== void 0 ? _c : 0,\r\n                max: accessor.max,\r\n                min: accessor.min,\r\n                normalized: accessor.normalized\r\n            });\r\n        }\r\n        else {\r\n            rnAccessor = rnBufferView.takeAccessorWithByteOffset({\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(accessor.type),\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__[\"ComponentType\"].from(accessor.componentType),\r\n                count: accessor.count,\r\n                byteOffset: (_d = accessor.byteOffset) !== null && _d !== void 0 ? _d : 0,\r\n                max: accessor.max,\r\n                min: accessor.min,\r\n                normalized: accessor.normalized\r\n            });\r\n        }\r\n        return rnAccessor;\r\n    }\r\n    __copyRnAccessorAndBufferView(srcRnAccessor) {\r\n        const byteSize = srcRnAccessor.elementCount * 4 /* vec4 */ * 4 /* bytes */;\r\n        const dstRnBuffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_33__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_32__[\"BufferUse\"].GPUVertexData);\r\n        const dstRnBufferView = dstRnBuffer.takeBufferView({\r\n            byteLengthToNeed: byteSize,\r\n            byteStride: 4 /* vec4 */ * 4 /* bytes */,\r\n            isAoS: false\r\n        });\r\n        const dstRnAccessor = dstRnBufferView.takeAccessor({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__[\"ComponentType\"].Float,\r\n            count: srcRnAccessor.elementCount,\r\n            max: srcRnAccessor.max,\r\n            min: srcRnAccessor.min,\r\n            normalized: srcRnAccessor.normalized\r\n        });\r\n        for (let i = 0; i < srcRnAccessor.elementCount; i++) {\r\n            dstRnAccessor.setElementFromAccessor(i, srcRnAccessor);\r\n        }\r\n        return dstRnAccessor;\r\n    }\r\n    __createRnAccessor(accessor, numOfAttributes, compositionNum, rnBuffer) {\r\n        var _a, _b;\r\n        const rnBufferView = rnBuffer.takeBufferView({\r\n            byteLengthToNeed: numOfAttributes * compositionNum * 4,\r\n            byteStride: 0,\r\n            isAoS: false\r\n        });\r\n        let rnAccessor;\r\n        if (accessor.byteStride != null) {\r\n            rnAccessor = rnBufferView.takeFlexibleAccessorWithByteOffset({\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(accessor.type),\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__[\"ComponentType\"].from(accessor.componentType),\r\n                count: numOfAttributes,\r\n                byteStride: accessor.byteStride,\r\n                byteOffset: (_a = accessor.byteOffset) !== null && _a !== void 0 ? _a : 0,\r\n                max: accessor.max,\r\n                min: accessor.min,\r\n                normalized: accessor.normalized\r\n            });\r\n        }\r\n        else {\r\n            rnAccessor = rnBufferView.takeAccessorWithByteOffset({\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(accessor.type),\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_12__[\"ComponentType\"].from(accessor.componentType),\r\n                count: numOfAttributes,\r\n                byteOffset: (_b = accessor.byteOffset) !== null && _b !== void 0 ? _b : 0,\r\n                max: accessor.max,\r\n                min: accessor.min,\r\n                normalized: accessor.normalized\r\n            });\r\n        }\r\n        return rnAccessor;\r\n    }\r\n    __getRnBufferView(bufferView, rnBuffer) {\r\n        var _a, _b;\r\n        const rnBufferView = rnBuffer.takeBufferViewWithByteOffset({\r\n            byteLengthToNeed: bufferView.byteLength,\r\n            byteStride: (_a = bufferView.byteStride) !== null && _a !== void 0 ? _a : 0,\r\n            byteOffset: (_b = bufferView.byteOffset) !== null && _b !== void 0 ? _b : 0,\r\n            isAoS: false\r\n        });\r\n        return rnBufferView;\r\n    }\r\n    __getGeometryFromDracoBuffer(draco, decoder, arrayBuffer) {\r\n        const buffer = new draco.DecoderBuffer();\r\n        buffer.Init(new Int8Array(arrayBuffer), arrayBuffer.byteLength);\r\n        const geometryType = decoder.GetEncodedGeometryType(buffer);\r\n        let dracoGeometry;\r\n        let decodingStatus;\r\n        if (geometryType === draco.TRIANGULAR_MESH) {\r\n            dracoGeometry = new draco.Mesh();\r\n            decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\r\n        }\r\n        else if (geometryType == draco.POINT_CLOUD) {\r\n            dracoGeometry = new draco.PointCloud();\r\n            decodingStatus = decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\r\n        }\r\n        else {\r\n            const errorMsg = 'Unknown geometry type.';\r\n            console.error(errorMsg);\r\n        }\r\n        dracoGeometry.geometryType = geometryType; // store\r\n        if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\r\n            let errorMsg = 'Decoding failed: ';\r\n            errorMsg += decodingStatus.error_msg();\r\n            console.error(errorMsg);\r\n            draco.destroy(decoder);\r\n            draco.destroy(dracoGeometry);\r\n            return void 0;\r\n        }\r\n        draco.destroy(buffer);\r\n        return dracoGeometry;\r\n    }\r\n    __getIndicesFromDraco(draco, decoder, dracoGeometry, triangleStripDrawMode) {\r\n        // For mesh, we need to generate the faces.\r\n        const geometryType = dracoGeometry.geometryType;\r\n        if (geometryType !== draco.TRIANGULAR_MESH) {\r\n            return void 0;\r\n        }\r\n        let indices;\r\n        if (triangleStripDrawMode) {\r\n            const stripsArray = new draco.DracoInt32Array();\r\n            decoder.GetTriangleStripsFromMesh(dracoGeometry, stripsArray);\r\n            indices = new Uint32Array(stripsArray.size());\r\n            for (var i = 0; i < stripsArray.size(); ++i) {\r\n                indices[i] = stripsArray.GetValue(i);\r\n            }\r\n            draco.destroy(stripsArray);\r\n        }\r\n        else { // TRIANGLES\r\n            const numFaces = dracoGeometry.num_faces();\r\n            const numIndices = numFaces * 3;\r\n            indices = new Uint32Array(numIndices);\r\n            const ia = new draco.DracoInt32Array();\r\n            for (let i = 0; i < numFaces; ++i) {\r\n                decoder.GetFaceFromMesh(dracoGeometry, i, ia);\r\n                var index = i * 3;\r\n                indices[index] = ia.GetValue(0);\r\n                indices[index + 1] = ia.GetValue(1);\r\n                indices[index + 2] = ia.GetValue(2);\r\n            }\r\n            draco.destroy(ia);\r\n        }\r\n        return indices;\r\n    }\r\n    __decodeDraco(primitive, rnBuffers, gltfModel, map) {\r\n        const bufferView = gltfModel.bufferViews[primitive.extensions.KHR_draco_mesh_compression.bufferView];\r\n        const rnBufferView = this.__getRnBufferView(bufferView, rnBuffers[bufferView.bufferIndex]);\r\n        const arraybufferOfBufferView = new Uint8Array(rnBufferView.getUint8Array()).buffer;\r\n        const draco = new DracoDecoderModule();\r\n        const decoder = new draco.Decoder();\r\n        const dracoGeometry = this.__getGeometryFromDracoBuffer(draco, decoder, arraybufferOfBufferView);\r\n        if (dracoGeometry == null) {\r\n            draco.destroy(dracoGeometry);\r\n            draco.destroy(decoder);\r\n            return void 0;\r\n        }\r\n        const numPoints = dracoGeometry.num_points();\r\n        const rnBufferForDraco = this.__createBufferForDecompressedData(primitive, numPoints);\r\n        // decode indices\r\n        const primitiveMode = _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_10__[\"PrimitiveMode\"].from(primitive.mode);\r\n        let isTriangleStrip = false;\r\n        if (primitiveMode === _definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_10__[\"PrimitiveMode\"].TriangleStrip) {\r\n            isTriangleStrip = true;\r\n        }\r\n        const indices = this.__getIndicesFromDraco(draco, decoder, dracoGeometry, isTriangleStrip);\r\n        const indicesRnAccessor = this.__createRnAccessor(primitive.indices, indices.length, 1, rnBufferForDraco);\r\n        for (let i = 0; i < indices.length; i++) {\r\n            indicesRnAccessor.setScalar(i, indices[i], {});\r\n        }\r\n        // decode attributes\r\n        for (let attributeName in primitive.attributes) {\r\n            const dracoAttributeId = primitive.extensions.KHR_draco_mesh_compression.attributes[attributeName];\r\n            const attributeGltf2Accessor = primitive.attributes[attributeName];\r\n            let attributeRnAccessor;\r\n            if (dracoAttributeId == null) {\r\n                // non-encoded data\r\n                attributeRnAccessor = this.__getRnAccessor(attributeGltf2Accessor, rnBuffers[attributeGltf2Accessor.bufferView.bufferIndex]);\r\n            }\r\n            else {\r\n                // encoded data\r\n                const compositionNum = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(attributeGltf2Accessor.type).getNumberOfComponents();\r\n                attributeRnAccessor = this.__createRnAccessor(attributeGltf2Accessor, numPoints, compositionNum, rnBufferForDraco);\r\n                const dracoAttributePointer = decoder.GetAttributeByUniqueId(dracoGeometry, dracoAttributeId);\r\n                const decompressedAttributeData = new draco.DracoFloat32Array();\r\n                decoder.GetAttributeFloatForAllPoints(dracoGeometry, dracoAttributePointer, decompressedAttributeData);\r\n                for (let i = 0; i < numPoints; i++) {\r\n                    if (compositionNum === 1) {\r\n                        attributeRnAccessor.setScalar(i, decompressedAttributeData.GetValue(i * compositionNum), {});\r\n                    }\r\n                    else if (compositionNum === 2) {\r\n                        attributeRnAccessor.setVec2(i, decompressedAttributeData.GetValue(i * compositionNum), decompressedAttributeData.GetValue(i * compositionNum + 1), {});\r\n                    }\r\n                    else if (compositionNum === 3) {\r\n                        attributeRnAccessor.setVec3(i, decompressedAttributeData.GetValue(i * compositionNum), decompressedAttributeData.GetValue(i * compositionNum + 1), decompressedAttributeData.GetValue(i * compositionNum + 2), {});\r\n                    }\r\n                    else if (compositionNum === 4) {\r\n                        attributeRnAccessor.setVec4(i, decompressedAttributeData.GetValue(i * compositionNum), decompressedAttributeData.GetValue(i * compositionNum + 1), decompressedAttributeData.GetValue(i * compositionNum + 2), decompressedAttributeData.GetValue(i * compositionNum + 3), {});\r\n                    }\r\n                }\r\n                draco.destroy(decompressedAttributeData);\r\n            }\r\n            if (attributeGltf2Accessor.sparse) {\r\n                this.setSparseAccessor(attributeGltf2Accessor, attributeRnAccessor);\r\n            }\r\n            map.set(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_13__[\"VertexAttribute\"].fromString(attributeGltf2Accessor.extras.attributeName), attributeRnAccessor);\r\n        }\r\n        draco.destroy(dracoGeometry);\r\n        draco.destroy(decoder);\r\n        return indicesRnAccessor;\r\n    }\r\n    static _setupTextureTransform(textureJson, rnMaterial, textureTransformShaderSemantic, textureRotationShaderSemantic) {\r\n        var _a;\r\n        if ((_a = textureJson === null || textureJson === void 0 ? void 0 : textureJson.extensions) === null || _a === void 0 ? void 0 : _a.KHR_texture_transform) {\r\n            const transform = new _math_MutableVector4__WEBPACK_IMPORTED_MODULE_28__[\"default\"](1.0, 1.0, 0.0, 0.0);\r\n            let rotation = 0;\r\n            const transformJson = textureJson.extensions.KHR_texture_transform;\r\n            if (transformJson.scale != null) {\r\n                transform.x = transformJson.scale[0];\r\n                transform.y = transformJson.scale[1];\r\n            }\r\n            if (transformJson.offset != null) {\r\n                transform.z = transformJson.offset[0];\r\n                transform.w = transformJson.offset[1];\r\n            }\r\n            if (transformJson.rotation != null) {\r\n                rotation = transformJson.rotation;\r\n            }\r\n            rnMaterial.setParameter(textureTransformShaderSemantic, transform);\r\n            rnMaterial.setParameter(textureRotationShaderSemantic, rotation);\r\n        }\r\n    }\r\n    __createBufferForDecompressedData(primitive, numPoints) {\r\n        let byteLengthOfBufferForDraco = 0;\r\n        if (primitive.indices) {\r\n            const count = primitive.indices.count;\r\n            byteLengthOfBufferForDraco += count * 4;\r\n        }\r\n        const drcAttributes = primitive.extensions.KHR_draco_mesh_compression.attributes;\r\n        for (let attributeName in primitive.attributes) {\r\n            if (drcAttributes[attributeName] == null) {\r\n                // non-encoded data\r\n                continue;\r\n            }\r\n            const accessor = primitive.attributes[attributeName];\r\n            const compositionNum = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_11__[\"CompositionType\"].fromString(accessor.type).getNumberOfComponents();\r\n            const attributeByteLength = numPoints * compositionNum * 4;\r\n            byteLengthOfBufferForDraco += attributeByteLength;\r\n        }\r\n        return new _memory_Buffer__WEBPACK_IMPORTED_MODULE_9__[\"default\"]({\r\n            byteLength: byteLengthOfBufferForDraco,\r\n            buffer: new ArrayBuffer(byteLengthOfBufferForDraco),\r\n            name: 'Draco'\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/ModelConverter.ts?");

/***/ }),

/***/ "./src/foundation/importer/VRMImporter.ts":
/*!************************************************!*\
  !*** ./src/foundation/importer/VRMImporter.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VRMImporter; });\n/* harmony import */ var _GltfImporter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GltfImporter */ \"./src/foundation/importer/GltfImporter.ts\");\n/* harmony import */ var _Gltf2Importer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Gltf2Importer */ \"./src/foundation/importer/Gltf2Importer.ts\");\n/* harmony import */ var _ModelConverter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ModelConverter */ \"./src/foundation/importer/ModelConverter.ts\");\n\r\n\r\n\r\n/**\r\n * The VRM Importer class.\r\n * This class will be integrated into GltfImporter.\r\n */\r\nclass VRMImporter {\r\n    constructor() { }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new VRMImporter();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    /**\r\n     * Import VRM file.\r\n     */\r\n    async import(uri, options) {\r\n        const gltfImporter = _GltfImporter__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        options = gltfImporter._getOptions(options);\r\n        const gltf2Importer = _Gltf2Importer__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n        const gltfModel = await gltf2Importer.import(uri, options);\r\n        const textures = gltfImporter._createTextures(gltfModel);\r\n        const defaultMaterialHelperArgumentArray = gltfModel.asset.extras.rnLoaderOptions.defaultMaterialHelperArgumentArray;\r\n        defaultMaterialHelperArgumentArray[0].textures = textures;\r\n        gltfImporter._initializeMaterialProperties(gltfModel, textures.length);\r\n        // setup rootGroup\r\n        let rootGroups;\r\n        const modelConverter = _ModelConverter__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n        const rootGroupMain = modelConverter.convertToRhodoniteObject(gltfModel);\r\n        const existOutline = gltfImporter._existOutlineMaterial(gltfModel.extensions.VRM);\r\n        if (existOutline) {\r\n            defaultMaterialHelperArgumentArray[0].isOutline = true;\r\n            const rootGroupOutline = modelConverter.convertToRhodoniteObject(gltfModel);\r\n            rootGroups = [rootGroupMain, rootGroupOutline];\r\n        }\r\n        else {\r\n            rootGroups = [rootGroupMain];\r\n        }\r\n        gltfImporter._readSpringBone(rootGroupMain, gltfModel);\r\n        gltfImporter._readVRMHumanoidInfo(gltfModel, rootGroupMain);\r\n        return rootGroups;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/importer/VRMImporter.ts?");

/***/ }),

/***/ "./src/foundation/materials/core/AbstractMaterialNode.ts":
/*!***************************************************************!*\
  !*** ./src/foundation/materials/core/AbstractMaterialNode.ts ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AbstractMaterialNode; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _textures_Texture__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../textures/Texture */ \"./src/foundation/textures/Texture.ts\");\n/* harmony import */ var _textures_CubeTexture__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../textures/CubeTexture */ \"./src/foundation/textures/CubeTexture.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _math_MutableVector2__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../math/MutableVector2 */ \"./src/foundation/math/MutableVector2.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n/* harmony import */ var _system_SystemState__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../system/SystemState */ \"./src/foundation/system/SystemState.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass AbstractMaterialNode extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(shader, shaderFunctionName, { isMorphing = false, isSkinning = false, isLighting = false } = {}, vertexShaderityObject, pixelShaderityObject) {\r\n        super();\r\n        this.__semantics = [];\r\n        this.__vertexInputs = [];\r\n        this.__pixelInputs = [];\r\n        this.__vertexOutputs = [];\r\n        this.__pixelOutputs = [];\r\n        this.__defaultInputValues = new Map();\r\n        this.__vertexInputConnections = [];\r\n        this.__pixelInputConnections = [];\r\n        this.isSingleOperation = false;\r\n        this.__definitions = '';\r\n        this.shaderType = _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_16__[\"ShaderType\"].VertexAndPixelShader;\r\n        this.__shader = shader;\r\n        this.__shaderFunctionName = shaderFunctionName;\r\n        this.__materialNodeUid = ++AbstractMaterialNode.__invalidMaterialNodeCount;\r\n        AbstractMaterialNode.materialNodes[AbstractMaterialNode.__invalidMaterialNodeCount] = this;\r\n        this.__isMorphing = isMorphing;\r\n        this.__isSkinning = isSkinning;\r\n        this.__isLighting = isLighting;\r\n        AbstractMaterialNode.__dummyBlackTexture.tryToSetUniqueName('dummyBlackTexture', true);\r\n        AbstractMaterialNode.__dummyWhiteTexture.tryToSetUniqueName('dummyWhiteTexture', true);\r\n        AbstractMaterialNode.__dummyBlueTexture.tryToSetUniqueName('dummyBlueTexture', true);\r\n        AbstractMaterialNode.__dummyBlackCubeTexture.tryToSetUniqueName('dummyBlackCubeTexture', true);\r\n        this.__vertexShaderityObject = vertexShaderityObject;\r\n        this.__pixelShaderityObject = pixelShaderityObject;\r\n        this.__webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n        this.__definitions += `#define RN_MATERIAL_NODE_NAME ${shaderFunctionName}\\n`;\r\n    }\r\n    get shaderFunctionName() {\r\n        return this.__shaderFunctionName;\r\n    }\r\n    get shader() {\r\n        return this.__shader;\r\n    }\r\n    get vertexShaderityObject() {\r\n        return this.__vertexShaderityObject;\r\n    }\r\n    get pixelShaderityObject() {\r\n        return this.__pixelShaderityObject;\r\n    }\r\n    get definitions() {\r\n        return this.__definitions;\r\n    }\r\n    static getMaterialNode(materialNodeUid) {\r\n        return AbstractMaterialNode.materialNodes[materialNodeUid];\r\n    }\r\n    get materialNodeUid() {\r\n        return this.__materialNodeUid;\r\n    }\r\n    get _semanticsInfoArray() {\r\n        return this.__semantics;\r\n    }\r\n    get isSkinning() {\r\n        return this.__isSkinning;\r\n    }\r\n    get isMorphing() {\r\n        return this.__isMorphing;\r\n    }\r\n    get isLighting() {\r\n        return this.__isLighting;\r\n    }\r\n    setShaderSemanticsInfoArray(shaderSemanticsInfoArray) {\r\n        const infoArray = [];\r\n        for (let info of shaderSemanticsInfoArray) {\r\n            infoArray.push(info);\r\n        }\r\n        this.__semantics = infoArray;\r\n        if (!AbstractMaterialNode.__semanticsMap.has(this.shaderFunctionName)) {\r\n            AbstractMaterialNode.__semanticsMap.set(this.shaderFunctionName, new Map());\r\n        }\r\n        const map = AbstractMaterialNode.__semanticsMap.get(this.shaderFunctionName);\r\n        for (let semantic of this.__semantics) {\r\n            map.set(semantic.semantic.str, semantic);\r\n        }\r\n    }\r\n    getShaderSemanticInfoFromName(name) {\r\n        const map = AbstractMaterialNode.__semanticsMap.get(this.shaderFunctionName);\r\n        return map.get(name);\r\n    }\r\n    addVertexInputConnection(inputMaterialNode, outputNameOfPrev, inputNameOfThis) {\r\n        this.__vertexInputConnections.push({ materialNodeUid: inputMaterialNode.materialNodeUid, outputNameOfPrev: outputNameOfPrev, inputNameOfThis: inputNameOfThis });\r\n    }\r\n    addPixelInputConnection(inputMaterialNode, outputNameOfPrev, inputNameOfThis) {\r\n        this.__pixelInputConnections.push({ materialNodeUid: inputMaterialNode.materialNodeUid, outputNameOfPrev: outputNameOfPrev, inputNameOfThis: inputNameOfThis });\r\n    }\r\n    get vertexInputConnections() {\r\n        return this.__vertexInputConnections;\r\n    }\r\n    get pixelInputConnections() {\r\n        return this.__pixelInputConnections;\r\n    }\r\n    getVertexInput(name) {\r\n        for (let input of this.__vertexInputs) {\r\n            if (input.name === name) {\r\n                return input;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getVertexInputs() {\r\n        return this.__vertexInputs;\r\n    }\r\n    getVertexOutput(name) {\r\n        for (let output of this.__vertexOutputs) {\r\n            if (output.name === name) {\r\n                return output;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getVertexOutputs() {\r\n        return this.__vertexOutputs;\r\n    }\r\n    getPixelInput(name) {\r\n        for (let input of this.__pixelInputs) {\r\n            if (input.name === name) {\r\n                return input;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getPixelInputs() {\r\n        return this.__pixelInputs;\r\n    }\r\n    getPixelOutput(name) {\r\n        for (let output of this.__pixelOutputs) {\r\n            if (output.name === name) {\r\n                return output;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getPixelOutputs() {\r\n        return this.__pixelOutputs;\r\n    }\r\n    static initDefaultTextures() {\r\n        if (this.__dummyWhiteTexture.isTextureReady) {\r\n            return;\r\n        }\r\n        this.__dummyWhiteTexture.generate1x1TextureFrom();\r\n        this.__dummyBlueTexture.generate1x1TextureFrom(\"rgba(127.5, 127.5, 255, 1)\");\r\n        this.__dummyBlackTexture.generate1x1TextureFrom(\"rgba(0, 0, 0, 1)\");\r\n        this.__dummyBlackCubeTexture.load1x1Texture(\"rgba(0, 0, 0, 1)\");\r\n    }\r\n    static get dummyWhiteTexture() {\r\n        return this.__dummyWhiteTexture;\r\n    }\r\n    static get dummyBlackTexture() {\r\n        return this.__dummyBlackTexture;\r\n    }\r\n    static get dummyBlueTexture() {\r\n        return this.__dummyBlueTexture;\r\n    }\r\n    static get dummyBlackCubeTexture() {\r\n        return this.__dummyWhiteTexture;\r\n    }\r\n    setWorldMatrix(shaderProgram, worldMatrix) {\r\n        shaderProgram._gl.uniformMatrix4fv(shaderProgram.worldMatrix, false, worldMatrix.v);\r\n    }\r\n    setNormalMatrix(shaderProgram, normalMatrix) {\r\n        shaderProgram._gl.uniformMatrix3fv(shaderProgram.normalMatrix, false, normalMatrix.v);\r\n    }\r\n    setViewInfo(shaderProgram, cameraComponent, material, setUniform) {\r\n        if (cameraComponent) {\r\n            const cameraPosition = cameraComponent.worldPosition;\r\n            if (setUniform) {\r\n                shaderProgram._gl.uniformMatrix4fv(shaderProgram.viewMatrix, false, cameraComponent.viewMatrix.v);\r\n                shaderProgram._gl.uniform3fv(shaderProgram.viewPosition, cameraPosition.v);\r\n            }\r\n            else {\r\n                // material.setParameter(ShaderSemantics.ViewMatrix, cameraComponent.viewMatrix);\r\n                // material.setParameter(ShaderSemantics.ViewPosition, cameraPosition);\r\n            }\r\n        }\r\n        else {\r\n            const mat = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"].identity();\r\n            const pos = new _math_Vector3__WEBPACK_IMPORTED_MODULE_8__[\"default\"](0, 0, 10);\r\n            if (setUniform) {\r\n                shaderProgram._gl.uniformMatrix4fv(shaderProgram.viewMatrix, false, mat.v);\r\n                shaderProgram._gl.uniform3fv(shaderProgram.viewPosition, pos.v);\r\n            }\r\n            else {\r\n                // material.setParameter(ShaderSemantics.ViewMatrix, mat);\r\n                // material.setParameter(ShaderSemantics.ViewPosition, pos);\r\n            }\r\n        }\r\n    }\r\n    setProjection(shaderProgram, cameraComponent, material, setUniform) {\r\n        if (cameraComponent) {\r\n            if (setUniform) {\r\n                shaderProgram._gl.uniformMatrix4fv(shaderProgram.projectionMatrix, false, cameraComponent.projectionMatrix.v);\r\n            }\r\n            else {\r\n                // material.setParameter(ShaderSemantics.ProjectionMatrix, cameraComponent.projectionMatrix);\r\n            }\r\n        }\r\n        else {\r\n            if (setUniform) {\r\n                this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemantics\"].ProjectionMatrix.str, true, _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"].identity());\r\n            }\r\n        }\r\n    }\r\n    setSkinning(shaderProgram, skeletalComponent, setUniform) {\r\n        if (!this.__isSkinning) {\r\n            return;\r\n        }\r\n        if (skeletalComponent) {\r\n            if (setUniform) {\r\n                if (_core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_14__[\"BoneDataType\"].Mat4x4) {\r\n                    const jointMatricesArray = skeletalComponent.jointMatricesArray;\r\n                    shaderProgram._gl.uniformMatrix4fv(shaderProgram.boneMatrix, false, jointMatricesArray);\r\n                }\r\n                else if (_core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_14__[\"BoneDataType\"].Vec4x2) {\r\n                    const jointQuaternionArray = skeletalComponent.jointQuaternionArray;\r\n                    const jointTranslateScaleArray = skeletalComponent.jointTranslateScaleArray;\r\n                    shaderProgram._gl.uniform4fv(shaderProgram.boneQuaternion, jointQuaternionArray);\r\n                    shaderProgram._gl.uniform4fv(shaderProgram.boneTranslateScale, jointTranslateScaleArray);\r\n                }\r\n                else if (_core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_14__[\"BoneDataType\"].Vec4x1) {\r\n                    const jointCompressedChunk = skeletalComponent.jointCompressedChunk;\r\n                    const jointCompressedInfo = skeletalComponent.jointCompressedInfo;\r\n                    shaderProgram._gl.uniform4fv(shaderProgram.boneCompressedChunk, jointCompressedChunk);\r\n                    shaderProgram._gl.uniform4fv(shaderProgram.boneCompressedInfo, jointCompressedInfo.v);\r\n                }\r\n                shaderProgram._gl.uniform1i(shaderProgram.skinningMode, 0);\r\n            }\r\n        }\r\n        else {\r\n            if (setUniform) {\r\n                shaderProgram._gl.uniform1i(shaderProgram.skinningMode, -1);\r\n            }\r\n        }\r\n    }\r\n    setLightsInfo(shaderProgram, lightComponents, material, setUniform) {\r\n        if (!this.__isLighting) {\r\n            return;\r\n        }\r\n        if (setUniform) {\r\n            shaderProgram._gl.uniform1i(shaderProgram.lightNumber, lightComponents.length);\r\n            const length = Math.min(lightComponents.length, _core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxLightNumberInShader);\r\n            if (AbstractMaterialNode.__lightPositions.length !== 4 * length) {\r\n                AbstractMaterialNode.__lightPositions = new Float32Array(4 * length);\r\n                AbstractMaterialNode.__lightDirections = new Float32Array(4 * length);\r\n                AbstractMaterialNode.__lightIntensities = new Float32Array(4 * length);\r\n            }\r\n            for (let i = 0; i < lightComponents.length; i++) {\r\n                if (i >= _core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxLightNumberInShader) {\r\n                    break;\r\n                }\r\n                if (shaderProgram.lightPosition == null) {\r\n                    break;\r\n                }\r\n                const lightComponent = lightComponents[i];\r\n                const sceneGraphComponent = lightComponent.entity.getSceneGraph();\r\n                const worldLightPosition = sceneGraphComponent.worldPosition;\r\n                const worldLightDirection = lightComponent.direction;\r\n                const worldLightIntensity = lightComponent.intensity;\r\n                AbstractMaterialNode.__lightPositions[i * 4 + 0] = worldLightPosition.x;\r\n                AbstractMaterialNode.__lightPositions[i * 4 + 1] = worldLightPosition.y;\r\n                AbstractMaterialNode.__lightPositions[i * 4 + 2] = worldLightPosition.z;\r\n                AbstractMaterialNode.__lightPositions[i * 4 + 3] = lightComponent.type.index;\r\n                AbstractMaterialNode.__lightDirections[i * 4 + 0] = worldLightDirection.x;\r\n                AbstractMaterialNode.__lightDirections[i * 4 + 1] = worldLightDirection.y;\r\n                AbstractMaterialNode.__lightDirections[i * 4 + 2] = worldLightDirection.z;\r\n                AbstractMaterialNode.__lightDirections[i * 4 + 3] = 0;\r\n                AbstractMaterialNode.__lightIntensities[i * 4 + 0] = worldLightIntensity.x;\r\n                AbstractMaterialNode.__lightIntensities[i * 4 + 1] = worldLightIntensity.y;\r\n                AbstractMaterialNode.__lightIntensities[i * 4 + 2] = worldLightIntensity.z;\r\n                AbstractMaterialNode.__lightIntensities[i * 4 + 3] = 0;\r\n            }\r\n            if (length > 0) {\r\n                shaderProgram._gl.uniform4fv(shaderProgram.lightPosition, AbstractMaterialNode.__lightPositions);\r\n                shaderProgram._gl.uniform4fv(shaderProgram.lightDirection, AbstractMaterialNode.__lightDirections);\r\n                shaderProgram._gl.uniform4fv(shaderProgram.lightIntensity, AbstractMaterialNode.__lightIntensities);\r\n            }\r\n        }\r\n    }\r\n    setMorphInfo(shaderProgram, meshComponent, blendShapeComponent, primitive) {\r\n        if (!this.__isMorphing) {\r\n            return;\r\n        }\r\n        if (primitive.targets.length === 0) {\r\n            shaderProgram._gl.uniform1i(shaderProgram.morphTargetNumber, 0);\r\n            return;\r\n        }\r\n        const memoryManager = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getInstance();\r\n        shaderProgram._gl.uniform1i(shaderProgram.morphTargetNumber, primitive.targets.length);\r\n        const array = primitive.targets.map((target) => {\r\n            const accessor = target.get(_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_10__[\"VertexAttribute\"].Position);\r\n            let offset = 0;\r\n            if (_system_SystemState__WEBPACK_IMPORTED_MODULE_15__[\"default\"].currentProcessApproach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_13__[\"ProcessApproach\"].FastestWebGL1) {\r\n                offset = memoryManager.createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_12__[\"BufferUse\"].GPUInstanceData).takenSizeInByte;\r\n            }\r\n            return (offset + accessor.byteOffsetInBuffer) / 4 / 4;\r\n        });\r\n        shaderProgram._gl.uniform1fv(shaderProgram.dataTextureMorphOffsetPosition, array);\r\n        let weights;\r\n        if (meshComponent.mesh.weights.length > 0) {\r\n            weights = meshComponent.mesh.weights;\r\n        }\r\n        else if (blendShapeComponent.weights.length > 0) {\r\n            weights = blendShapeComponent.weights;\r\n        }\r\n        else {\r\n            weights = new Float32Array(primitive.targets.length);\r\n        }\r\n        shaderProgram._gl.uniform1fv(shaderProgram.morphWeights, weights);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n    }\r\n    setDefaultInputValue(inputName, value) {\r\n        this.__defaultInputValues.set(inputName, value);\r\n    }\r\n}\r\nAbstractMaterialNode.__semanticsMap = new Map();\r\nAbstractMaterialNode.__invalidMaterialNodeUid = -1;\r\nAbstractMaterialNode.__invalidMaterialNodeCount = -1;\r\nAbstractMaterialNode.materialNodes = [];\r\nAbstractMaterialNode.__transposedMatrix44 = new _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_9__[\"default\"]([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\r\nAbstractMaterialNode.__dummyWhiteTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\r\nAbstractMaterialNode.__dummyBlueTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\r\nAbstractMaterialNode.__dummyBlackTexture = new _textures_Texture__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\r\nAbstractMaterialNode.__dummyBlackCubeTexture = new _textures_CubeTexture__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\r\nAbstractMaterialNode.__tmp_vector4 = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_7__[\"default\"].zero();\r\nAbstractMaterialNode.__tmp_vector2 = _math_MutableVector2__WEBPACK_IMPORTED_MODULE_6__[\"default\"].zero();\r\nAbstractMaterialNode.__lightPositions = new Float32Array(0);\r\nAbstractMaterialNode.__lightDirections = new Float32Array(0);\r\nAbstractMaterialNode.__lightIntensities = new Float32Array(0);\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/core/AbstractMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/core/AbstractShaderNode.ts":
/*!*************************************************************!*\
  !*** ./src/foundation/materials/core/AbstractShaderNode.ts ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AbstractShaderNode; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n\r\nclass AbstractShaderNode extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(shaderNodeName, shaderCode, shader) {\r\n        super();\r\n        this.__inputs = [];\r\n        this.__outputs = [];\r\n        this.__inputConnections = [];\r\n        this.__shaderFunctionName = shaderNodeName;\r\n        this.__shaderCode = shaderCode;\r\n        this.__shaderNodeUid = ++AbstractShaderNode.__invalidShaderNodeCount;\r\n        AbstractShaderNode.shaderNodes[AbstractShaderNode.__invalidShaderNodeCount] = this;\r\n        this.__shader = shader;\r\n    }\r\n    get shaderFunctionName() {\r\n        return this.__shaderFunctionName;\r\n    }\r\n    get shaderCode() {\r\n        return this.__shaderCode;\r\n    }\r\n    get shaderNodeUid() {\r\n        return this.__shaderNodeUid;\r\n    }\r\n    getInput(name) {\r\n        for (let input of this.__inputs) {\r\n            if (input.name === name) {\r\n                return input;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getInputs() {\r\n        return this.__inputs;\r\n    }\r\n    getOutput(name) {\r\n        for (let output of this.__outputs) {\r\n            if (output.name === name) {\r\n                return output;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    getOutputs() {\r\n        return this.__outputs;\r\n    }\r\n    addInputConnection(inputShaderNode, outputNameOfPrev, inputNameOfThis) {\r\n        this.__inputConnections.push({ shaderNodeUid: inputShaderNode.shaderNodeUid, outputNameOfPrev: outputNameOfPrev, inputNameOfThis: inputNameOfThis });\r\n    }\r\n    get inputConnections() {\r\n        return this.__inputConnections;\r\n    }\r\n    get shader() {\r\n        return this.__shader;\r\n    }\r\n}\r\nAbstractShaderNode.shaderNodes = [];\r\nAbstractShaderNode.__invalidShaderNodeUid = -1;\r\nAbstractShaderNode.__invalidShaderNodeCount = -1;\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/core/AbstractShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/core/Material.ts":
/*!***************************************************!*\
  !*** ./src/foundation/materials/core/Material.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Material; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../math/MathClassUtil */ \"./src/foundation/math/MathClassUtil.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _definitions_BufferUse__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _misc_DataUtil__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _system_System__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../system/System */ \"./src/foundation/system/System.ts\");\n/* harmony import */ var _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _ShaderityUtility__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./ShaderityUtility */ \"./src/foundation/materials/core/ShaderityUtility.ts\");\n/* harmony import */ var _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The material class.\r\n * This class has one or more material nodes.\r\n */\r\nclass Material extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(materialTid, materialTypeName, materialNodes) {\r\n        super();\r\n        this.__materialNodes = [];\r\n        this.__fields = new Map();\r\n        this.__fieldsForNonSystem = new Map();\r\n        this.__fieldsInfo = new Map();\r\n        this._shaderProgramUid = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Opaque;\r\n        this.__materialSid = -1;\r\n        this.cullFace = true; // If true, enable gl.CULL_FACE\r\n        this.cullFrontFaceCCW = true;\r\n        this.__blendEquationMode = 32774; // gl.FUNC_ADD\r\n        this.__blendEquationModeAlpha = null; // use blendEquation instead of blendEquationSeparate\r\n        this.__blendFuncSrcFactor = 770; // gl.SRC_ALPHA\r\n        this.__blendFuncDstFactor = 771; // gl.ONE_MINUS_SRC_ALPHA\r\n        this.__blendFuncAlphaSrcFactor = 1; // gl.ONE\r\n        this.__blendFuncAlphaDstFactor = 1; // gl.ONE\r\n        this.__materialNodes = materialNodes;\r\n        this.__materialTid = materialTid;\r\n        this.__materialTypeName = materialTypeName;\r\n        Material.__materials.push(this);\r\n        Material.__instancesByTypes.set(materialTypeName, this);\r\n        this.tryToSetUniqueName(materialTypeName, true);\r\n        this.initialize();\r\n    }\r\n    get materialTypeName() {\r\n        return this.__materialTypeName;\r\n    }\r\n    /**\r\n     * Gets materialTID.\r\n     */\r\n    get materialTID() {\r\n        return this.__materialTid;\r\n    }\r\n    get fieldsInfoArray() {\r\n        return Array.from(this.__fieldsInfo.values());\r\n    }\r\n    /**\r\n     * Creates an instance of this Material class.\r\n     * @param materialTypeName The material type to create.\r\n     * @param materialNodes_ The material nodes to add to the created material.\r\n     */\r\n    static createMaterial(materialTypeName, materialNodes_) {\r\n        let materialNodes = materialNodes_;\r\n        if (!materialNodes) {\r\n            materialNodes = Material.__materialTypes.get(materialTypeName);\r\n        }\r\n        return new Material(Material.__materialTids.get(materialTypeName), materialTypeName, materialNodes);\r\n    }\r\n    static isRegisteredMaterialType(materialTypeName) {\r\n        return Material.__materialTypes.has(materialTypeName);\r\n    }\r\n    static _calcAlignedByteLength(semanticInfo) {\r\n        const compositionNumber = semanticInfo.compositionType.getNumberOfComponents();\r\n        const componentSizeInByte = semanticInfo.componentType.getSizeInBytes();\r\n        const semanticInfoByte = compositionNumber * componentSizeInByte;\r\n        let alignedByteLength = semanticInfoByte;\r\n        if (alignedByteLength % 16 !== 0) {\r\n            alignedByteLength = semanticInfoByte + 16 - semanticInfoByte % 16;\r\n        }\r\n        if (_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].isArray(semanticInfo.compositionType)) {\r\n            const maxArrayLength = semanticInfo.maxIndex;\r\n            if (maxArrayLength != null) {\r\n                alignedByteLength *= maxArrayLength;\r\n            }\r\n            else {\r\n                console.error('semanticInfo has invalid maxIndex!');\r\n                alignedByteLength *= 100;\r\n            }\r\n        }\r\n        return alignedByteLength;\r\n    }\r\n    static __allocateBufferView(materialTypeName, materialNodes) {\r\n        let totalByteLength = 0;\r\n        const alignedByteLengthAndSemanticInfoArray = [];\r\n        for (let materialNode of materialNodes) {\r\n            for (let semanticInfo of materialNode._semanticsInfoArray) {\r\n                const alignedByteLength = Material._calcAlignedByteLength(semanticInfo);\r\n                let dataCount = 1;\r\n                if (!semanticInfo.soloDatum) {\r\n                    dataCount = Material.__maxInstances.get(materialTypeName);\r\n                }\r\n                totalByteLength += alignedByteLength * dataCount;\r\n                alignedByteLengthAndSemanticInfoArray.push({ alignedByte: alignedByteLength, semanticInfo: semanticInfo });\r\n            }\r\n        }\r\n        if (!this.__accessors.has(materialTypeName)) {\r\n            this.__accessors.set(materialTypeName, new Map());\r\n        }\r\n        const buffer = _core_MemoryManager__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getInstance().createOrGetBuffer(_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_8__[\"BufferUse\"].GPUInstanceData);\r\n        let bufferView;\r\n        if (this.__bufferViews.has(materialTypeName)) {\r\n            bufferView = this.__bufferViews.get(materialTypeName);\r\n        }\r\n        else {\r\n            bufferView = buffer.takeBufferView({\r\n                byteLengthToNeed: totalByteLength,\r\n                byteStride: 0,\r\n                byteAlign: 16,\r\n                isAoS: false\r\n            });\r\n            this.__bufferViews.set(materialTypeName, bufferView);\r\n        }\r\n        for (let i = 0; i < alignedByteLengthAndSemanticInfoArray.length; i++) {\r\n            const alignedByte = alignedByteLengthAndSemanticInfoArray[i].alignedByte;\r\n            const semanticInfo = alignedByteLengthAndSemanticInfoArray[i].semanticInfo;\r\n            let count = 1;\r\n            if (!semanticInfo.soloDatum) {\r\n                count = Material.__maxInstances.get(materialTypeName);\r\n            }\r\n            let maxArrayLength = semanticInfo.maxIndex;\r\n            if (_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].isArray(semanticInfo.compositionType) && maxArrayLength == null) {\r\n                maxArrayLength = 100;\r\n            }\r\n            const accessor = bufferView.takeFlexibleAccessor({\r\n                compositionType: semanticInfo.compositionType,\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float,\r\n                count: count,\r\n                byteStride: alignedByte,\r\n                arrayLength: maxArrayLength,\r\n                byteAlign: 16\r\n            });\r\n            const propertyName = this._getPropertyIndex(semanticInfo);\r\n            if (semanticInfo.soloDatum) {\r\n                const typedArray = accessor.takeOne();\r\n                let map = this.__soloDatumFields.get(materialTypeName);\r\n                if (map == null) {\r\n                    map = new Map();\r\n                    this.__soloDatumFields.set(materialTypeName, map);\r\n                }\r\n                map.set(this._getPropertyIndex(semanticInfo), {\r\n                    info: semanticInfo,\r\n                    value: _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_4__[\"default\"].initWithFloat32Array(semanticInfo.initialValue, semanticInfo.initialValue, typedArray, semanticInfo.compositionType)\r\n                });\r\n            }\r\n            else {\r\n                const properties = this.__accessors.get(materialTypeName);\r\n                properties.set(propertyName, accessor);\r\n            }\r\n        }\r\n        return bufferView;\r\n    }\r\n    /**\r\n     * Registers the material type.\r\n     * @param materialTypeName The type name of the material.\r\n     * @param materialNodes The material nodes to register.\r\n     * @param maxInstancesNumber The maximum number to create the material instances.\r\n     */\r\n    static registerMaterial(materialTypeName, materialNodes, maxInstanceNumber = _core_Config__WEBPACK_IMPORTED_MODULE_9__[\"default\"].maxMaterialInstanceForEachType) {\r\n        if (!Material.__materialTypes.has(materialTypeName)) {\r\n            Material.__materialTypes.set(materialTypeName, materialNodes);\r\n            const materialTid = ++Material.__materialTidCount;\r\n            Material.__materialTids.set(materialTypeName, materialTid);\r\n            Material.__maxInstances.set(materialTypeName, maxInstanceNumber);\r\n            Material.__allocateBufferView(materialTypeName, materialNodes);\r\n            Material.__materialInstanceCountOfType.set(materialTypeName, 0);\r\n            return true;\r\n        }\r\n        else {\r\n            console.info(`${materialTypeName} is already registered.`);\r\n            return false;\r\n        }\r\n    }\r\n    static forceRegisterMaterial(materialTypeName, materialNodes, maxInstanceNumber = _core_Config__WEBPACK_IMPORTED_MODULE_9__[\"default\"].maxMaterialInstanceForEachType) {\r\n        Material.__materialTypes.set(materialTypeName, materialNodes);\r\n        const materialTid = ++Material.__materialTidCount;\r\n        Material.__materialTids.set(materialTypeName, materialTid);\r\n        Material.__maxInstances.set(materialTypeName, maxInstanceNumber);\r\n        Material.__allocateBufferView(materialTypeName, materialNodes);\r\n        Material.__materialInstanceCountOfType.set(materialTypeName, 0);\r\n        return true;\r\n    }\r\n    static getAllMaterials() {\r\n        return Material.__materials;\r\n    }\r\n    setMaterialNodes(materialNodes) {\r\n        this.__materialNodes = materialNodes;\r\n    }\r\n    get materialSID() {\r\n        return this.__materialSid;\r\n    }\r\n    get isSkinning() {\r\n        return this.__materialNodes[0].isSkinning;\r\n    }\r\n    get isMorphing() {\r\n        return this.__materialNodes[0].isMorphing;\r\n    }\r\n    get isLighting() {\r\n        return this.__materialNodes[0].isLighting;\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n    static _getPropertyIndex(semanticInfo) {\r\n        let propertyIndex = semanticInfo.semantic.index;\r\n        if (semanticInfo.index != null) {\r\n            propertyIndex += semanticInfo.index;\r\n            propertyIndex *= -1;\r\n        }\r\n        return propertyIndex;\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n    static _getPropertyIndex2(shaderSemantic, index) {\r\n        let propertyIndex = shaderSemantic.index;\r\n        if (index != null) {\r\n            propertyIndex += index;\r\n            propertyIndex *= -1;\r\n        }\r\n        return propertyIndex;\r\n    }\r\n    initialize() {\r\n        let countOfThisType = Material.__materialInstanceCountOfType.get(this.__materialTypeName);\r\n        this.__materialSid = countOfThisType++;\r\n        Material.__materialInstanceCountOfType.set(this.__materialTypeName, countOfThisType);\r\n        this.__materialNodes.forEach((materialNode) => {\r\n            const semanticsInfoArray = materialNode._semanticsInfoArray;\r\n            const accessorMap = Material.__accessors.get(this.__materialTypeName);\r\n            semanticsInfoArray.forEach((semanticsInfo) => {\r\n                const propertyIndex = Material._getPropertyIndex(semanticsInfo);\r\n                this.__fieldsInfo.set(propertyIndex, semanticsInfo);\r\n                if (!semanticsInfo.soloDatum) {\r\n                    const accessor = accessorMap.get(propertyIndex);\r\n                    const typedArray = accessor.takeOne();\r\n                    const shaderVariable = {\r\n                        info: semanticsInfo,\r\n                        value: _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_4__[\"default\"].initWithFloat32Array(semanticsInfo.initialValue, semanticsInfo.initialValue, typedArray, semanticsInfo.compositionType)\r\n                    };\r\n                    this.__fields.set(propertyIndex, shaderVariable);\r\n                    if (!semanticsInfo.isSystem) {\r\n                        this.__fieldsForNonSystem.set(propertyIndex, shaderVariable);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n    setParameter(shaderSemantic, value, index) {\r\n        const propertyIndex = Material._getPropertyIndex2(shaderSemantic, index);\r\n        const info = this.__fieldsInfo.get(propertyIndex);\r\n        if (info != null) {\r\n            let valueObj;\r\n            if (info.soloDatum) {\r\n                valueObj = Material.__soloDatumFields.get(this.__materialTypeName).get(propertyIndex);\r\n            }\r\n            else {\r\n                valueObj = this.__fields.get(propertyIndex);\r\n            }\r\n            _math_MathClassUtil__WEBPACK_IMPORTED_MODULE_4__[\"default\"]._setForce(valueObj.value, value);\r\n        }\r\n    }\r\n    setTextureParameter(shaderSemantic, value) {\r\n        if (this.__fieldsInfo.has(shaderSemantic.index)) {\r\n            const array = this.__fields.get(shaderSemantic.index);\r\n            const shaderVariable = {\r\n                value: [array.value[0], value],\r\n                info: array.info\r\n            };\r\n            this.__fields.set(shaderSemantic.index, shaderVariable);\r\n            if (!array.info.isSystem) {\r\n                this.__fieldsForNonSystem.set(shaderSemantic.index, shaderVariable);\r\n            }\r\n            if (shaderSemantic === _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_2__[\"ShaderSemantics\"].DiffuseColorTexture || shaderSemantic === _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_2__[\"ShaderSemantics\"].BaseColorTexture) {\r\n                if (value.isTransparent) {\r\n                    this.alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Translucent;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    getParameter(shaderSemantic) {\r\n        var _a, _b;\r\n        const info = this.__fieldsInfo.get(shaderSemantic.index);\r\n        if (info != null) {\r\n            if (info.soloDatum) {\r\n                return (_a = Material.__soloDatumFields.get(this.__materialTypeName).get(shaderSemantic.index)) === null || _a === void 0 ? void 0 : _a.value;\r\n            }\r\n            else {\r\n                return (_b = this.__fields.get(shaderSemantic.index)) === null || _b === void 0 ? void 0 : _b.value;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    setUniformLocations(shaderProgramUid) {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getWebGLResourceRepository();\r\n        const map = new Map();\r\n        let array = [];\r\n        this.__materialNodes.forEach((materialNode) => {\r\n            const semanticsInfoArray = materialNode._semanticsInfoArray;\r\n            array = array.concat(semanticsInfoArray);\r\n        });\r\n        webglResourceRepository.setupUniformLocations(shaderProgramUid, array);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        this.__materialNodes.forEach((materialNode) => {\r\n            if (materialNode.setParametersForGPU) {\r\n                materialNode.setParametersForGPU({ material, shaderProgram, firstTime, args });\r\n            }\r\n        });\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getWebGLResourceRepository();\r\n        if (args.setUniform) {\r\n            this.__fieldsForNonSystem.forEach((value) => {\r\n                const info = value.info;\r\n                if (firstTime || info.updateInterval !== _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_17__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly) {\r\n                    webglResourceRepository.setUniformValue(shaderProgram, info.semantic.str, firstTime, value.value, info.index);\r\n                }\r\n                else {\r\n                    if (info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Texture2D || info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].TextureCube) {\r\n                        webglResourceRepository.bindTexture(info, value.value);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.__fieldsForNonSystem.forEach((value) => {\r\n                const info = value.info;\r\n                if (info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Texture2D || info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].TextureCube) {\r\n                    if (firstTime || info.updateInterval !== _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_17__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly) {\r\n                        webglResourceRepository.setUniformValue(shaderProgram, info.semantic.str, firstTime, value.value, info.index);\r\n                    }\r\n                    else {\r\n                        webglResourceRepository.bindTexture(info, value.value);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        this.setSoloDatumParametersForGPU({ shaderProgram, firstTime, args });\r\n    }\r\n    setSoloDatumParametersForGPU({ shaderProgram, firstTime, args }) {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getWebGLResourceRepository();\r\n        const materialTypeName = this.__materialTypeName;\r\n        const map = Material.__soloDatumFields.get(materialTypeName);\r\n        if (map == null)\r\n            return;\r\n        map.forEach((value, key) => {\r\n            const info = value.info;\r\n            if (args.setUniform || info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Texture2D || info.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].TextureCube) {\r\n                if (!info.isSystem) {\r\n                    if (firstTime || info.updateInterval !== _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_17__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly) {\r\n                        webglResourceRepository.setUniformValue(shaderProgram, info.semantic.str, firstTime, value.value, info.index);\r\n                    }\r\n                    else {\r\n                        webglResourceRepository.bindTexture(info, value.value);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    __setupGlobalShaderDefinition() {\r\n        var _a, _b, _c;\r\n        let definitions = '';\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getWebGLResourceRepository();\r\n        if ((_a = webglResourceRepository.currentWebGLContextWrapper) === null || _a === void 0 ? void 0 : _a.isWebGL2) {\r\n            definitions += '#version 300 es\\n#define GLSL_ES3\\n';\r\n        }\r\n        definitions += `#define RN_MATERIAL_TYPE_NAME ${this.__materialTypeName}\\n`;\r\n        if (_system_System__WEBPACK_IMPORTED_MODULE_13__[\"default\"].getInstance().processApproach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_14__[\"ProcessApproach\"].FastestWebGL1) {\r\n            definitions += '#define RN_IS_FASTEST_MODE\\n';\r\n        }\r\n        if ((_b = webglResourceRepository.currentWebGLContextWrapper) === null || _b === void 0 ? void 0 : _b.webgl1ExtSTL) {\r\n            definitions += '#define WEBGL1_EXT_SHADER_TEXTURE_LOD\\n';\r\n        }\r\n        if ((_c = webglResourceRepository.currentWebGLContextWrapper) === null || _c === void 0 ? void 0 : _c.webgl1ExtDRV) {\r\n            definitions += '#define WEBGL1_EXT_STANDARD_DERIVATIVES\\n';\r\n        }\r\n        if (_core_Config__WEBPACK_IMPORTED_MODULE_9__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_16__[\"BoneDataType\"].Mat4x4) {\r\n            definitions += '#define RN_BONE_DATA_TYPE_MAT4X4\\n';\r\n        }\r\n        else if (_core_Config__WEBPACK_IMPORTED_MODULE_9__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_16__[\"BoneDataType\"].Vec4x2) {\r\n            definitions += '#define RN_BONE_DATA_TYPE_VEC4X2\\n';\r\n        }\r\n        else if (_core_Config__WEBPACK_IMPORTED_MODULE_9__[\"default\"].boneDataType === _definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_16__[\"BoneDataType\"].Vec4x1) {\r\n            definitions += '#define RN_BONE_DATA_TYPE_VEC4X1\\n';\r\n        }\r\n        return definitions;\r\n    }\r\n    createProgramAsSingleOperation(vertexShaderMethodDefinitions_uniform, propertySetter) {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getWebGLResourceRepository();\r\n        const materialNode = this.__materialNodes[0];\r\n        const glslShader = materialNode.shader;\r\n        let { vertexPropertiesStr, pixelPropertiesStr } = this._getProperties(propertySetter);\r\n        let definitions = materialNode.definitions;\r\n        // Shader Construction\r\n        let vertexShader = this.__setupGlobalShaderDefinition();\r\n        let pixelShader = this.__setupGlobalShaderDefinition();\r\n        let vertexShaderBody = '';\r\n        let pixelShaderBody = '';\r\n        if (materialNode.vertexShaderityObject != null) {\r\n            vertexShaderBody = _ShaderityUtility__WEBPACK_IMPORTED_MODULE_15__[\"default\"].getInstance().getVertexShaderBody(materialNode.vertexShaderityObject, { getters: vertexPropertiesStr, definitions: definitions, matricesGetters: vertexShaderMethodDefinitions_uniform });\r\n            pixelShaderBody = _ShaderityUtility__WEBPACK_IMPORTED_MODULE_15__[\"default\"].getInstance().getPixelShaderBody(materialNode.pixelShaderityObject, { getters: pixelPropertiesStr, definitions: definitions });\r\n        }\r\n        else {\r\n            vertexShaderBody = glslShader.getVertexShaderBody({ getters: vertexPropertiesStr, definitions: definitions, matricesGetters: vertexShaderMethodDefinitions_uniform });\r\n            pixelShaderBody = glslShader.getPixelShaderBody({ getters: pixelPropertiesStr, definitions: definitions, materialNode: materialNode });\r\n        }\r\n        vertexShader += vertexShaderBody.replace(/#version\\s+300\\s+es/, '');\r\n        pixelShader += pixelShaderBody.replace(/#version\\s+300\\s+es/, '');\r\n        const wholeShaderText = vertexShader + pixelShader;\r\n        // Cache\r\n        let shaderProgramUid = Material.__shaderStringMap.get(wholeShaderText);\r\n        if (shaderProgramUid) {\r\n            this._shaderProgramUid = shaderProgramUid;\r\n            return shaderProgramUid;\r\n        }\r\n        const hash = _misc_DataUtil__WEBPACK_IMPORTED_MODULE_11__[\"default\"].toCRC32(wholeShaderText);\r\n        shaderProgramUid = Material.__shaderHashMap.get(hash);\r\n        if (shaderProgramUid) {\r\n            this._shaderProgramUid = shaderProgramUid;\r\n            return this._shaderProgramUid;\r\n        }\r\n        else {\r\n            let attributeNames;\r\n            let attributeSemantics;\r\n            if (materialNode.vertexShaderityObject != null) {\r\n                const reflection = _ShaderityUtility__WEBPACK_IMPORTED_MODULE_15__[\"default\"].getInstance().getReflection(materialNode.vertexShaderityObject);\r\n                attributeNames = reflection.names;\r\n                attributeSemantics = reflection.semantics;\r\n            }\r\n            else {\r\n                attributeNames = glslShader.attributeNames;\r\n                attributeSemantics = glslShader.attributeSemantics;\r\n            }\r\n            this._shaderProgramUid = webglResourceRepository.createShaderProgram({\r\n                materialTypeName: this.__materialTypeName,\r\n                vertexShaderStr: vertexShader,\r\n                fragmentShaderStr: pixelShader,\r\n                attributeNames: attributeNames,\r\n                attributeSemantics: attributeSemantics\r\n            });\r\n            Material.__shaderStringMap.set(wholeShaderText, this._shaderProgramUid);\r\n            Material.__shaderHashMap.set(hash, this._shaderProgramUid);\r\n            return this._shaderProgramUid;\r\n        }\r\n    }\r\n    /**\r\n     * @private\r\n     * @param propertySetter\r\n     */\r\n    _getProperties(propertySetter) {\r\n        let vertexPropertiesStr = '';\r\n        let pixelPropertiesStr = '';\r\n        this.__fieldsInfo.forEach((value, propertyIndex) => {\r\n            const info = this.__fieldsInfo.get(propertyIndex);\r\n            if (info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_10__[\"ShaderType\"].VertexShader || info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_10__[\"ShaderType\"].VertexAndPixelShader) {\r\n                vertexPropertiesStr += propertySetter(this.__materialTypeName, info, propertyIndex, false);\r\n            }\r\n            if (info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_10__[\"ShaderType\"].PixelShader || info.stage === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_10__[\"ShaderType\"].VertexAndPixelShader) {\r\n                pixelPropertiesStr += propertySetter(this.__materialTypeName, info, propertyIndex, false);\r\n            }\r\n        });\r\n        const globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_12__[\"default\"].getInstance();\r\n        [vertexPropertiesStr, pixelPropertiesStr] = globalDataRepository.addPropertiesStr(vertexPropertiesStr, pixelPropertiesStr, propertySetter);\r\n        return { vertexPropertiesStr, pixelPropertiesStr };\r\n    }\r\n    createProgram(vertexShaderMethodDefinitions_uniform, propertySetter) {\r\n        return this.createProgramAsSingleOperation(vertexShaderMethodDefinitions_uniform, propertySetter);\r\n    }\r\n    isBlend() {\r\n        if (this.alphaMode === _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Translucent ||\r\n            this.alphaMode === _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Additive) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    static getLocationOffsetOfMemberOfMaterial(materialTypeName, propertyIndex) {\r\n        const material = Material.__instancesByTypes.get(materialTypeName);\r\n        const info = material.__fieldsInfo.get(propertyIndex);\r\n        if (info.soloDatum) {\r\n            const value = Material.__soloDatumFields.get(material.__materialTypeName).get(propertyIndex);\r\n            return value.value.v.byteOffset / 4 / 4;\r\n        }\r\n        else {\r\n            const properties = this.__accessors.get(materialTypeName);\r\n            const accessor = properties.get(propertyIndex);\r\n            return accessor.byteOffsetInBuffer / 4 / 4;\r\n        }\r\n    }\r\n    static getAccessorOfMemberOfMaterial(materialTypeName, propertyIndex) {\r\n        const material = Material.__instancesByTypes.get(materialTypeName);\r\n        const info = material.__fieldsInfo.get(propertyIndex);\r\n        if (info.soloDatum) {\r\n            return void 0;\r\n        }\r\n        else {\r\n            const properties = this.__accessors.get(materialTypeName);\r\n            const accessor = properties.get(propertyIndex);\r\n            return accessor;\r\n        }\r\n    }\r\n    get alphaMode() {\r\n        return this.__alphaMode;\r\n    }\r\n    set alphaMode(mode) {\r\n        this.__alphaMode = mode;\r\n    }\r\n    /**\r\n     * Change the blendEquations\r\n     * This method works only if this alphaMode is the translucent\r\n     * @param blendEquationMode the argument of gl.blendEquation of the first argument of gl.blendEquationSeparate such as gl.FUNC_ADD\r\n     * @param blendEquationModeAlpha the second argument of gl.blendEquationSeparate\r\n     */\r\n    setBlendEquationMode(blendEquationMode, blendEquationModeAlpha) {\r\n        this.__blendEquationMode = blendEquationMode;\r\n        this.__blendEquationModeAlpha = blendEquationModeAlpha !== null && blendEquationModeAlpha !== void 0 ? blendEquationModeAlpha : null;\r\n    }\r\n    /**\r\n     * Change the blendFuncSeparateFactors\r\n     * This method works only if this alphaMode is the translucent\r\n     */\r\n    setBlendFuncSeparateFactor(blendFuncSrcFactor, blendFuncDstFactor, blendFuncAlphaSrcFactor, blendFuncAlphaDstFactor) {\r\n        this.__blendFuncSrcFactor = blendFuncSrcFactor;\r\n        this.__blendFuncDstFactor = blendFuncDstFactor;\r\n        this.__blendFuncAlphaSrcFactor = blendFuncAlphaSrcFactor;\r\n        this.__blendFuncAlphaDstFactor = blendFuncAlphaDstFactor;\r\n    }\r\n    /**\r\n     * Change the blendFuncFactors\r\n     * This method works only if this alphaMode is the translucent\r\n     */\r\n    setBlendFuncFactor(blendFuncSrcFactor, blendFuncDstFactor) {\r\n        this.__blendFuncSrcFactor = blendFuncSrcFactor;\r\n        this.__blendFuncDstFactor = blendFuncDstFactor;\r\n        this.__blendFuncAlphaSrcFactor = null;\r\n        this.__blendFuncAlphaDstFactor = null;\r\n    }\r\n    get blendEquationMode() {\r\n        return this.__blendEquationMode;\r\n    }\r\n    get blendEquationModeAlpha() {\r\n        return this.__blendEquationModeAlpha;\r\n    }\r\n    get blendFuncSrcFactor() {\r\n        return this.__blendFuncSrcFactor;\r\n    }\r\n    get blendFuncDstFactor() {\r\n        return this.__blendFuncDstFactor;\r\n    }\r\n    get blendFuncAlphaSrcFactor() {\r\n        return this.__blendFuncAlphaSrcFactor;\r\n    }\r\n    get blendFuncAlphaDstFactor() {\r\n        return this.__blendFuncAlphaDstFactor;\r\n    }\r\n    isEmptyMaterial() {\r\n        if (this.__materialNodes.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    getShaderSemanticInfoFromName(name) {\r\n        for (let materialNode of this.__materialNodes) {\r\n            return materialNode.getShaderSemanticInfoFromName(name);\r\n        }\r\n        return void 0;\r\n    }\r\n}\r\nMaterial.__soloDatumFields = new Map();\r\nMaterial.__shaderHashMap = new Map();\r\nMaterial.__shaderStringMap = new Map();\r\nMaterial.__materials = [];\r\nMaterial.__instancesByTypes = new Map();\r\nMaterial.__materialTidCount = -1;\r\nMaterial.__materialTids = new Map();\r\nMaterial.__materialInstanceCountOfType = new Map();\r\nMaterial.__materialTypes = new Map();\r\nMaterial.__maxInstances = new Map();\r\nMaterial.__bufferViews = new Map();\r\nMaterial.__accessors = new Map();\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/core/Material.ts?");

/***/ }),

/***/ "./src/foundation/materials/core/ShaderGraphResolver.ts":
/*!**************************************************************!*\
  !*** ./src/foundation/materials/core/ShaderGraphResolver.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ShaderGraphResolver; });\n/* harmony import */ var _AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaders_GLSLShader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../webgl/shaders/GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_common_mainPrerequisites_glsl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/common/mainPrerequisites.glsl */ \"./src/webgl/shaderity_shaders/common/mainPrerequisites.glsl\");\n/* harmony import */ var _webgl_shaderity_shaders_common_prerequisites_glsl__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/common/prerequisites.glsl */ \"./src/webgl/shaderity_shaders/common/prerequisites.glsl\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ShaderGraphResolver {\r\n    static createVertexShaderCode(vertexNodes) {\r\n        var _a;\r\n        const shaderNodes = vertexNodes.concat();\r\n        // Find Start Node\r\n        let firstShaderNode = this.__findBeginNode(shaderNodes);\r\n        // Topological Sorting\r\n        const sortedShaderNodes = this.__sortTopologically(firstShaderNode, shaderNodes);\r\n        // Add additional functions by system\r\n        let vertexShaderPrerequisites = '';\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        let in_ = 'attribute';\r\n        if ((_a = webglResourceRepository.currentWebGLContextWrapper) === null || _a === void 0 ? void 0 : _a.isWebGL2) {\r\n            in_ = 'in';\r\n        }\r\n        vertexShaderPrerequisites += `\r\n#version 300 es\r\nprecision highp float;\r\nprecision highp int;\r\n${_webgl_shaderity_shaders_common_prerequisites_glsl__WEBPACK_IMPORTED_MODULE_8__[\"default\"].code}\r\n\r\n    ${in_} float a_instanceID;\\n`;\r\n        vertexShaderPrerequisites += `\r\nuniform bool u_vertexAttributesExistenceArray[${_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttribute\"].AttributeTypeNumber}];\r\n`;\r\n        vertexShaderPrerequisites += '/* shaderity: @{matricesGetters} */';\r\n        vertexShaderPrerequisites += '/* shaderity: @{getters} */';\r\n        let shaderBody = '';\r\n        // function definitions\r\n        shaderBody += ShaderGraphResolver.getFunctionDefinition(sortedShaderNodes, _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].VertexShader);\r\n        // main process\r\n        shaderBody += ShaderGraphResolver.__constructShaderWithNodes(sortedShaderNodes);\r\n        const shader = vertexShaderPrerequisites + shaderBody;\r\n        return { shader, shaderBody };\r\n    }\r\n    static createPixelShaderCode(pixelNodes) {\r\n        const shaderNodes = pixelNodes.concat();\r\n        // Find Start Node\r\n        let firstShaderNode = this.__findBeginNode(shaderNodes);\r\n        // Topological Sorting\r\n        const sortedShaderNodes = this.__sortTopologically(firstShaderNode, shaderNodes);\r\n        // Add additional functions by system\r\n        let pixelShaderPrerequisites = '';\r\n        pixelShaderPrerequisites += `\r\n#version 300 es\r\nprecision highp float;\r\nprecision highp int;\r\n${_webgl_shaderity_shaders_common_prerequisites_glsl__WEBPACK_IMPORTED_MODULE_8__[\"default\"].code}\r\n`;\r\n        pixelShaderPrerequisites += '/* shaderity: @{getters} */';\r\n        let shaderBody = '';\r\n        // function definitions\r\n        shaderBody += ShaderGraphResolver.getFunctionDefinition(sortedShaderNodes, _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].PixelShader);\r\n        // main process\r\n        shaderBody += ShaderGraphResolver.__constructShaderWithNodes(sortedShaderNodes);\r\n        const shader = pixelShaderPrerequisites + shaderBody;\r\n        return { shader, shaderBody };\r\n    }\r\n    static __findBeginNode(shaderNodes) {\r\n        let firstShaderNode;\r\n        for (let i = 0; i < shaderNodes.length; i++) {\r\n            const shaderNode = shaderNodes[i];\r\n            if (shaderNode.inputConnections.length === 0) {\r\n                firstShaderNode = shaderNode;\r\n            }\r\n        }\r\n        return firstShaderNode;\r\n    }\r\n    static __sortTopologically(firstShaderNode, shaderNodes) {\r\n        const ignoredInputUids = [firstShaderNode.shaderNodeUid];\r\n        const sortedNodeArray = [firstShaderNode];\r\n        // remove node which don't have inputConnections (except first node)\r\n        shaderNodes.splice(shaderNodes.indexOf(firstShaderNode), 1);\r\n        do {\r\n            let shaderNodeWhichHasNoInputs;\r\n            shaderNodes.forEach((shaderNode) => {\r\n                let inputCount = 0;\r\n                for (let inputConnection of shaderNode.inputConnections) {\r\n                    if (ignoredInputUids.indexOf(inputConnection.shaderNodeUid) === -1) {\r\n                        inputCount++;\r\n                    }\r\n                }\r\n                if (inputCount === 0) {\r\n                    shaderNodeWhichHasNoInputs = shaderNode;\r\n                }\r\n            });\r\n            sortedNodeArray.push(shaderNodeWhichHasNoInputs);\r\n            ignoredInputUids.push(shaderNodeWhichHasNoInputs.shaderNodeUid);\r\n            shaderNodes.splice(shaderNodes.indexOf(shaderNodeWhichHasNoInputs), 1);\r\n        } while (shaderNodes.length !== 0);\r\n        return sortedNodeArray;\r\n    }\r\n    static getFunctionDefinition(shaderNodes, shaderType) {\r\n        let shaderText = '';\r\n        const existVertexFunctions = [];\r\n        for (let i = 0; i < shaderNodes.length; i++) {\r\n            const materialNode = shaderNodes[i];\r\n            if (existVertexFunctions.indexOf(materialNode.shaderFunctionName) !== -1) {\r\n                continue;\r\n            }\r\n            if (materialNode.shaderCode) {\r\n                shaderText += materialNode.shaderCode;\r\n            }\r\n            else {\r\n                if (shaderType === _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].VertexShader) {\r\n                    shaderText += materialNode.shader.vertexShaderDefinitions;\r\n                }\r\n                else {\r\n                    shaderText += materialNode.shader.pixelShaderDefinitions;\r\n                }\r\n            }\r\n            existVertexFunctions.push(materialNode.shaderFunctionName);\r\n        }\r\n        return shaderText;\r\n    }\r\n    static __constructShaderWithNodes(materialNodes) {\r\n        let shaderBody = '';\r\n        const isAnyTypeInput = function (input) {\r\n            return input.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Unknown ||\r\n                input.componentType === _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Unknown;\r\n        };\r\n        shaderBody += _webgl_shaders_GLSLShader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].glslMainBegin;\r\n        shaderBody += _webgl_shaderity_shaders_common_mainPrerequisites_glsl__WEBPACK_IMPORTED_MODULE_7__[\"default\"].code;\r\n        const varInputNames = [];\r\n        const varOutputNames = [];\r\n        const existingInputs = [];\r\n        const existingOutputsVarName = new Map();\r\n        const existingOutputs = [];\r\n        for (let i = 1; i < materialNodes.length; i++) {\r\n            const materialNode = materialNodes[i];\r\n            if (varInputNames[i] == null) {\r\n                varInputNames[i] = [];\r\n            }\r\n            if (i - 1 >= 0) {\r\n                if (varOutputNames[i - 1] == null) {\r\n                    varOutputNames[i - 1] = [];\r\n                }\r\n            }\r\n            const inputConnections = materialNode.inputConnections;\r\n            for (let j = 0; j < inputConnections.length; j++) {\r\n                const inputConnection = inputConnections[j];\r\n                const inputNode = _AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shaderNodes[inputConnection.shaderNodeUid];\r\n                if (isAnyTypeInput(materialNode.getInputs()[j])) {\r\n                    continue;\r\n                }\r\n                const outputSocketOfPrev = inputNode.getOutput(inputConnection.outputNameOfPrev);\r\n                const inputSocketOfThis = materialNode.getInput(inputConnection.inputNameOfThis);\r\n                let varName = `${outputSocketOfPrev.name}_${inputConnection.shaderNodeUid}_to_${materialNode.shaderNodeUid}`;\r\n                if (existingInputs.indexOf(inputNode.shaderNodeUid) === -1) {\r\n                    const glslTypeStr = inputSocketOfThis.compositionType.getGlslStr(inputSocketOfThis.componentType);\r\n                    const glslInitialValue = inputSocketOfThis.compositionType.getGlslInitialValue(inputSocketOfThis.componentType);\r\n                    const rowStr = `${glslTypeStr} ${varName} = ${glslInitialValue};\\n`;\r\n                    shaderBody += rowStr;\r\n                }\r\n                const existVarName = existingOutputsVarName.get(inputNode.shaderNodeUid);\r\n                if (existVarName) {\r\n                    varName = existVarName;\r\n                }\r\n                varInputNames[i].push(varName);\r\n                existingInputs.push(inputConnection.shaderNodeUid);\r\n            }\r\n            for (let j = i; j < materialNodes.length; j++) {\r\n                const targetMaterialNode = materialNodes[j];\r\n                const prevMaterialNodeInner = materialNodes[i - 1];\r\n                const targetNodeInputConnections = targetMaterialNode.inputConnections;\r\n                for (let k = 0; k < targetNodeInputConnections.length; k++) {\r\n                    const inputConnection = targetNodeInputConnections[k];\r\n                    if (prevMaterialNodeInner != null && inputConnection.shaderNodeUid !== prevMaterialNodeInner.shaderNodeUid) {\r\n                        continue;\r\n                    }\r\n                    const inputNode = _AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shaderNodes[inputConnection.shaderNodeUid];\r\n                    if (!isAnyTypeInput(targetMaterialNode.getInputs()[k])) {\r\n                        if (existingOutputs.indexOf(inputNode.shaderNodeUid) === -1) {\r\n                            const outputSocketOfPrev = inputNode.getOutput(inputConnection.outputNameOfPrev);\r\n                            const varName = `${outputSocketOfPrev.name}_${inputConnection.shaderNodeUid}_to_${targetMaterialNode.shaderNodeUid}`;\r\n                            if (i - 1 >= 0) {\r\n                                varOutputNames[i - 1].push(varName);\r\n                            }\r\n                            existingOutputsVarName.set(inputConnection.shaderNodeUid, varName);\r\n                        }\r\n                        existingOutputs.push(inputConnection.shaderNodeUid);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        let ifCondition = '';\r\n        for (let i = 0; i < materialNodes.length; i++) {\r\n            const materialNode = materialNodes[i];\r\n            const functionName = materialNode.shaderFunctionName;\r\n            if (varInputNames[i] == null) {\r\n                varInputNames[i] = [];\r\n            }\r\n            if (varOutputNames[i] == null) {\r\n                varOutputNames[i] = [];\r\n            }\r\n            let rowStr = '';\r\n            if (functionName === 'ifStatement') {\r\n                ifCondition = varInputNames[i][0];\r\n            }\r\n            else {\r\n                if (functionName.match(/^blockBegin_/)) {\r\n                    rowStr += `if (${ifCondition}) {\\n`;\r\n                    ifCondition = '';\r\n                }\r\n                if (materialNode.getInputs().length != varInputNames[i].length ||\r\n                    materialNode.getOutputs().length != varOutputNames[i].length) {\r\n                    continue;\r\n                }\r\n                const varNames = varInputNames[i].concat(varOutputNames[i]);\r\n                if (varNames.length > 0) {\r\n                    // Call node functions\r\n                    rowStr += `${functionName}(`;\r\n                    for (let k = 0; k < varNames.length; k++) {\r\n                        const varName = varNames[k];\r\n                        if (varName == null) {\r\n                            continue;\r\n                        }\r\n                        if (k !== 0) {\r\n                            rowStr += ', ';\r\n                        }\r\n                        rowStr += varNames[k];\r\n                    }\r\n                    rowStr += ');\\n';\r\n                }\r\n                if (functionName.match(/^blockEnd_/)) {\r\n                    rowStr += `}\\n`;\r\n                }\r\n            }\r\n            shaderBody += rowStr;\r\n        }\r\n        shaderBody += _webgl_shaders_GLSLShader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].glslMainEnd;\r\n        return shaderBody;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/core/ShaderGraphResolver.ts?");

/***/ }),

/***/ "./src/foundation/materials/core/ShaderityUtility.ts":
/*!***********************************************************!*\
  !*** ./src/foundation/materials/core/ShaderityUtility.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ShaderityUtility; });\n/* harmony import */ var shaderity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! shaderity */ \"./node_modules/shaderity/dist/index.js\");\n/* harmony import */ var shaderity__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(shaderity__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _webgl_WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../webgl/WebGLResourceRepository */ \"./src/webgl/WebGLResourceRepository.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _math_MutableVector2__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../math/MutableVector2 */ \"./src/foundation/math/MutableVector2.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _math_MutableScalar__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../math/MutableScalar */ \"./src/foundation/math/MutableScalar.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ShaderityUtility {\r\n    constructor() {\r\n        this.__shaderity = shaderity__WEBPACK_IMPORTED_MODULE_0___default.a.getInstance();\r\n        this.__webglResourceRepository = _webgl_WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance();\r\n        const attributeSemanticsMap = new Map();\r\n        attributeSemanticsMap.set('instanceid', 'INSTANCE');\r\n        attributeSemanticsMap.set('barycentriccoord', 'BARY_CENTRIC_COORD');\r\n        this.__shaderity.addAttributeSemanticsMap(attributeSemanticsMap);\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new ShaderityUtility();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getVertexShaderBody(shaderityObject, args) {\r\n        var _a, _b;\r\n        const obj = this.__shaderity.fillTemplate(shaderityObject, {\r\n            definitions: (typeof args.definitions !== 'undefined') ? args.definitions : '',\r\n            matricesGetters: (typeof args.matricesGetters !== 'undefined') ? args.matricesGetters : '',\r\n            getters: (typeof args.getters !== 'undefined') ? args.getters : '',\r\n            WellKnownComponentTIDs: _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_3__[\"WellKnownComponentTIDs\"]\r\n        });\r\n        const isWebGL2 = (_b = (_a = this.__webglResourceRepository) === null || _a === void 0 ? void 0 : _a.currentWebGLContextWrapper) === null || _b === void 0 ? void 0 : _b.isWebGL2;\r\n        const code = this.__shaderity.transformTo(isWebGL2 ? 'WebGL2' : 'WebGL1', obj).code;\r\n        return code;\r\n    }\r\n    getPixelShaderBody(shaderityObject, args) {\r\n        var _a, _b;\r\n        const obj = this.__shaderity.fillTemplate(shaderityObject, {\r\n            definitions: (typeof args.definitions !== 'undefined') ? args.definitions : '',\r\n            getters: (typeof args.getters !== 'undefined') ? args.getters : '',\r\n            Config: _core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\r\n            WellKnownComponentTIDs: _components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_3__[\"WellKnownComponentTIDs\"]\r\n        });\r\n        const isWebGL2 = (_b = (_a = this.__webglResourceRepository) === null || _a === void 0 ? void 0 : _a.currentWebGLContextWrapper) === null || _b === void 0 ? void 0 : _b.isWebGL2;\r\n        const code = this.__shaderity.transformTo(isWebGL2 ? 'WebGL2' : 'WebGL1', obj).code;\r\n        return code;\r\n    }\r\n    getReflection(shaderityObject) {\r\n        const reflection = this.__shaderity.reflect(shaderityObject);\r\n        const reflectionSoA = {};\r\n        reflectionSoA.names = reflection.attributesNames;\r\n        reflectionSoA.semantics = reflection.attributesSemantics.map((semantic) => { return _definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].fromString(semantic); });\r\n        ;\r\n        reflectionSoA.compositions = reflection.attributesTypes.map((type) => { return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].fromGlslString(type); });\r\n        ;\r\n        reflectionSoA.components = reflection.attributesTypes.map((type) => { return _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].fromGlslString(type); });\r\n        ;\r\n        return reflectionSoA;\r\n    }\r\n    copyShaderityObject(obj) {\r\n        const copiedObj = {\r\n            code: obj.code,\r\n            shaderStage: obj.shaderStage\r\n        };\r\n        return copiedObj;\r\n    }\r\n    getShaderDataRefection(shaderityObject, existingShaderInfoMap) {\r\n        const copiedShaderityObject = this.copyShaderityObject(shaderityObject);\r\n        const splitCode = shaderityObject.code.split(/\\r\\n|\\n/);\r\n        const uniformOmittedShaderRows = [];\r\n        const shaderSemanticsInfoArray = [];\r\n        for (let row of splitCode) {\r\n            const reg = /^(?![\\/])[\\t ]*uniform[\\t ]+(\\w+)[\\t ]+(\\w+);[\\t ]*(\\/\\/)*[\\t ]*(.*)/;\r\n            const match = row.match(reg);\r\n            if (match) {\r\n                const shaderSemanticsInfo = {};\r\n                const type = match[1];\r\n                let variableName = match[2];\r\n                const u_prefixedName = variableName.match(/u_(\\w+)/);\r\n                if (u_prefixedName) {\r\n                    variableName = u_prefixedName[1];\r\n                    shaderSemanticsInfo.none_u_prefix = false;\r\n                }\r\n                else {\r\n                    shaderSemanticsInfo.none_u_prefix = true;\r\n                }\r\n                const info = match[4];\r\n                const skipProcess = info.match(/skipProcess[\\t ]*=[\\t ]*(\\w+)[,\\t ]*/);\r\n                if (skipProcess) {\r\n                    if (skipProcess[1] == 'true') {\r\n                        uniformOmittedShaderRows.push(row);\r\n                        continue;\r\n                    }\r\n                }\r\n                const systemSemantic = _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].fromStringCaseSensitively(variableName);\r\n                shaderSemanticsInfo.semantic = systemSemantic;\r\n                if (systemSemantic == null) {\r\n                    if (existingShaderInfoMap) {\r\n                        const semanticInfo = existingShaderInfoMap.get(variableName);\r\n                        if (semanticInfo != null) {\r\n                            shaderSemanticsInfo.semantic = semanticInfo.semantic;\r\n                        }\r\n                        else {\r\n                            const semantic = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemanticsClass\"]({ str: variableName });\r\n                            shaderSemanticsInfo.semantic = semantic;\r\n                        }\r\n                    }\r\n                    else {\r\n                        const semantic = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemanticsClass\"]({ str: variableName });\r\n                        shaderSemanticsInfo.semantic = semantic;\r\n                    }\r\n                }\r\n                shaderSemanticsInfo.componentType = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].fromGlslString(type);\r\n                shaderSemanticsInfo.compositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].fromGlslString(type);\r\n                const soloDatum = info.match(/soloDatum[\\t ]*=[\\t ]*(\\w+)[,\\t ]*/);\r\n                let bool = false;\r\n                if (soloDatum) {\r\n                    const soloDatumText = soloDatum[1];\r\n                    if (soloDatumText === 'true') {\r\n                        bool = true;\r\n                    }\r\n                }\r\n                shaderSemanticsInfo.soloDatum = bool;\r\n                const isSystem = info.match(/isSystem[\\t ]*=[\\t ]*(\\w+)[,\\t ]*/);\r\n                let isSystemFlg = false;\r\n                if (isSystem) {\r\n                    const isSystemText = isSystem[1];\r\n                    if (isSystemText === 'true') {\r\n                        isSystemFlg = true;\r\n                    }\r\n                }\r\n                shaderSemanticsInfo.isSystem = isSystemFlg;\r\n                const updateInterval = info.match(/updateInterval[\\t ]*=[\\t ]*(\\w+)[,\\t ]*/);\r\n                let updateIntervalObj = _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_15__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly;\r\n                if (updateInterval) {\r\n                    const updateIntervalText = updateInterval[1];\r\n                    if (updateIntervalText.toLowerCase() === 'everytime') {\r\n                        updateIntervalObj = _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_15__[\"ShaderVariableUpdateInterval\"].EveryTime;\r\n                    }\r\n                }\r\n                shaderSemanticsInfo.updateInterval = updateIntervalObj;\r\n                const initialValue = info.match(/initialValue[\\t ]*=[\\t ]*(.+)[,\\t ]*/);\r\n                if (initialValue) {\r\n                    const initialValueText = initialValue[1];\r\n                    const tuple = initialValueText.match(/\\(([\\d\\w., ]+)\\)/);\r\n                    const checkCompositionNumber = (expected) => {\r\n                        if (shaderSemanticsInfo.compositionType !== expected) {\r\n                            console.error('component number of initialValue is invalid!');\r\n                        }\r\n                    };\r\n                    if (tuple) {\r\n                        const text = tuple[1];\r\n                        const split = text.split(',');\r\n                        switch (split.length) {\r\n                            case 2:\r\n                                if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D) {\r\n                                    const color = split[1].charAt(0).toUpperCase() + split[1].slice(1);\r\n                                    shaderSemanticsInfo.initialValue = [parseInt(split[0]), _AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_14__[\"default\"][`dummy${color}Texture`]];\r\n                                }\r\n                                else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].TextureCube) {\r\n                                    const color = split[1].charAt(0).toUpperCase() + split[1].slice(1);\r\n                                    shaderSemanticsInfo.initialValue = [parseInt(split[0]), _AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_14__[\"default\"][`dummy${color}CubeTexture`]];\r\n                                }\r\n                                else {\r\n                                    checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec2);\r\n                                    shaderSemanticsInfo.initialValue = new _math_MutableVector2__WEBPACK_IMPORTED_MODULE_8__[\"default\"](parseFloat(split[0]), parseFloat(split[1]));\r\n                                }\r\n                                break;\r\n                            case 3:\r\n                                checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3);\r\n                                shaderSemanticsInfo.initialValue = new _math_MutableVector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"](parseFloat(split[0]), parseFloat(split[1]), parseFloat(split[2]));\r\n                                break;\r\n                            case 4:\r\n                                checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4);\r\n                                shaderSemanticsInfo.initialValue = new _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"](parseFloat(split[0]), parseFloat(split[1]), parseFloat(split[2]), parseFloat(split[3]));\r\n                                break;\r\n                            case 9:\r\n                                checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat3);\r\n                                shaderSemanticsInfo.initialValue = new _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_12__[\"default\"](parseFloat(split[0]), parseFloat(split[1]), parseFloat(split[2]), parseFloat(split[3]), parseFloat(split[4]), parseFloat(split[5]), parseFloat(split[6]), parseFloat(split[7]), parseFloat(split[8]));\r\n                                break;\r\n                            case 16:\r\n                                checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat4);\r\n                                shaderSemanticsInfo.initialValue = new _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_13__[\"default\"](parseFloat(split[0]), parseFloat(split[1]), parseFloat(split[2]), parseFloat(split[3]), parseFloat(split[4]), parseFloat(split[5]), parseFloat(split[6]), parseFloat(split[7]), parseFloat(split[8]), parseFloat(split[9]), parseFloat(split[10]), parseFloat(split[11]), parseFloat(split[12]), parseFloat(split[13]), parseFloat(split[14]), parseFloat(split[15]));\r\n                                break;\r\n                            default:\r\n                                console.error('Invalid format');\r\n                        }\r\n                    }\r\n                    else {\r\n                        checkCompositionNumber(_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar);\r\n                        shaderSemanticsInfo.initialValue = new _math_MutableScalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](parseFloat(initialValueText));\r\n                    }\r\n                }\r\n                else {\r\n                    if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar) {\r\n                        shaderSemanticsInfo.initialValue = new _math_MutableScalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](0);\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec2) {\r\n                        shaderSemanticsInfo.initialValue = _math_MutableVector2__WEBPACK_IMPORTED_MODULE_8__[\"default\"].zero();\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3) {\r\n                        shaderSemanticsInfo.initialValue = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_9__[\"default\"].zero();\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4) {\r\n                        shaderSemanticsInfo.initialValue = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_10__[\"default\"].zero();\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat3) {\r\n                        shaderSemanticsInfo.initialValue = _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_12__[\"default\"].identity();\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat4) {\r\n                        shaderSemanticsInfo.initialValue = _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_13__[\"default\"].identity();\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D) {\r\n                        shaderSemanticsInfo.initialValue = [0, _AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_14__[\"default\"].dummyWhiteTexture];\r\n                    }\r\n                    else if (shaderSemanticsInfo.compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].TextureCube) {\r\n                        shaderSemanticsInfo.initialValue = [0, _AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_14__[\"default\"].dummyBlackTexture];\r\n                    }\r\n                }\r\n                shaderSemanticsInfoArray.push(shaderSemanticsInfo);\r\n            }\r\n            else {\r\n                uniformOmittedShaderRows.push(row);\r\n            }\r\n        }\r\n        copiedShaderityObject.code = uniformOmittedShaderRows.join('\\n');\r\n        return {\r\n            shaderSemanticsInfoArray: shaderSemanticsInfoArray,\r\n            shaderityObject: copiedShaderityObject\r\n        };\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/core/ShaderityUtility.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/AddShaderNode.ts":
/*!*********************************************************!*\
  !*** ./src/foundation/materials/nodes/AddShaderNode.ts ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AddShaderNode; });\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_Add_glsl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/Add.glsl */ \"./src/webgl/shaderity_shaders/nodes/Add.glsl\");\n\r\n\r\n\r\nclass AddShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('add', _webgl_shaderity_shaders_nodes_Add_glsl__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'lhs',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'rhs',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/AddShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/AttributeNormalShaderNode.ts":
/*!*********************************************************************!*\
  !*** ./src/foundation/materials/nodes/AttributeNormalShaderNode.ts ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AttributePositionShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_AttributeNormal_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/AttributeNormal.vert */ \"./src/webgl/shaderity_shaders/nodes/AttributeNormal.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass AttributePositionShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('attributeNormal', _webgl_shaderity_shaders_nodes_AttributeNormal_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec3,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/AttributeNormalShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/AttributePositionShaderNode.ts":
/*!***********************************************************************!*\
  !*** ./src/foundation/materials/nodes/AttributePositionShaderNode.ts ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AttributePositionShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_AttributePosition_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/AttributePosition.vert */ \"./src/webgl/shaderity_shaders/nodes/AttributePosition.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass AttributePositionShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('attributePosition', _webgl_shaderity_shaders_nodes_AttributePosition_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/AttributePositionShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/BlockBeginShaderNode.ts":
/*!****************************************************************!*\
  !*** ./src/foundation/materials/nodes/BlockBeginShaderNode.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BlockBeginShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaders_nodes_BlockBeginShader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/BlockBeginShader */ \"./src/webgl/shaders/nodes/BlockBeginShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass BlockBeginShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('blockBegin');\r\n        this.__valueInputs = [];\r\n        this.__valueOutputs = [];\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_BlockBeginShader__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.__shaderFunctionName, this.__valueInputs, this.__valueOutputs);\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Bool,\r\n            name: 'blockStart',\r\n        });\r\n    }\r\n    addInputAndOutput(compositionType, componentType) {\r\n        const input = {\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: `value_${this.__valueInputs.length}`,\r\n        };\r\n        const output = {\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: `outValue_${this.__valueOutputs.length}`,\r\n        };\r\n        this.__inputs.push(input);\r\n        this.__outputs.push(output);\r\n        this.__valueInputs.push(input);\r\n        this.__valueOutputs.push(output);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/BlockBeginShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/BlockEndShaderNode.ts":
/*!**************************************************************!*\
  !*** ./src/foundation/materials/nodes/BlockEndShaderNode.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BlockEndShaderNode; });\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n/* harmony import */ var _webgl_shaders_nodes_BlockEndShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/BlockEndShader */ \"./src/webgl/shaders/nodes/BlockEndShader.ts\");\n\r\n\r\nclass BlockEndShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super('blockEnd');\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_BlockEndShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.__shaderFunctionName, this.__inputs, this.__outputs);\r\n    }\r\n    addInputAndOutput(compositionType, componentType) {\r\n        const input = {\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: `value_${this.__inputs.length}`,\r\n        };\r\n        const output = {\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: `outValue_${this.__outputs.length}`,\r\n        };\r\n        this.__inputs.push(input);\r\n        this.__outputs.push(output);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/BlockEndShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/ConstantVariableShaderNode.ts":
/*!**********************************************************************!*\
  !*** ./src/foundation/materials/nodes/ConstantVariableShaderNode.ts ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ConstantVariableShaderNode; });\n/* harmony import */ var _webgl_shaders_nodes_ConstantVariableShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/ConstantVariableShader */ \"./src/webgl/shaders/nodes/ConstantVariableShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\nclass ConstantVariableShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('constantVariable', undefined, undefined);\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_ConstantVariableShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.__shaderFunctionName, compositionType, componentType);\r\n        this.__outputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n    setDefaultInputValue(inputName, value) {\r\n        if (inputName === 'value') {\r\n            this.__shader.setConstantValue(value);\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/ConstantVariableShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/DotProductShaderNode.ts":
/*!****************************************************************!*\
  !*** ./src/foundation/materials/nodes/DotProductShaderNode.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DotProductShaderNode; });\n/* harmony import */ var _webgl_shaderity_shaders_nodes_DotProduct_glsl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/DotProduct.glsl */ \"./src/webgl/shaderity_shaders/nodes/DotProduct.glsl\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n\r\n\r\n\r\n\r\nclass DotProductShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('dotProduct', _webgl_shaderity_shaders_nodes_DotProduct_glsl__WEBPACK_IMPORTED_MODULE_0__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'lhs',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n            name: 'rhs',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/DotProductShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/GreaterShaderNode.ts":
/*!*************************************************************!*\
  !*** ./src/foundation/materials/nodes/GreaterShaderNode.ts ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GreaterShaderNode; });\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_Greater_glsl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/Greater.glsl */ \"./src/webgl/shaderity_shaders/nodes/Greater.glsl\");\n\r\n\r\n\r\n\r\nclass GreaterShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('greater', _webgl_shaderity_shaders_nodes_Greater_glsl__WEBPACK_IMPORTED_MODULE_3__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'lhs',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_2__[\"ComponentType\"].Float,\r\n            name: 'rhs',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_2__[\"ComponentType\"].Bool,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/GreaterShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/IfStatementShaderNode.ts":
/*!*****************************************************************!*\
  !*** ./src/foundation/materials/nodes/IfStatementShaderNode.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return IfStatementShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaders_nodes_IfStatementShader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/IfStatementShader */ \"./src/webgl/shaders/nodes/IfStatementShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass IfStatementShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('ifStatement', undefined, new _webgl_shaders_nodes_IfStatementShader__WEBPACK_IMPORTED_MODULE_2__[\"default\"]());\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Bool,\r\n            name: 'condition',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Unknown,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Unknown,\r\n            name: 'ifStart',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/IfStatementShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/MultiplyShaderNode.ts":
/*!**************************************************************!*\
  !*** ./src/foundation/materials/nodes/MultiplyShaderNode.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MultiplyShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_Multiply_glsl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/Multiply.glsl */ \"./src/webgl/shaderity_shaders/nodes/Multiply.glsl\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\nclass MultiplyShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_2__[\"default\"] {\r\n    constructor(lhsCompositionType, lhsComponentType, rhsCompositionType, rhsComponentType) {\r\n        super('multiply', _webgl_shaderity_shaders_nodes_Multiply_glsl__WEBPACK_IMPORTED_MODULE_1__[\"default\"].code);\r\n        let outValueCompositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Unknown;\r\n        if (lhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4 && rhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4) {\r\n            outValueCompositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4;\r\n        }\r\n        else if (lhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4 && rhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4) {\r\n            outValueCompositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4;\r\n        }\r\n        else if (lhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar && rhsCompositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar) {\r\n            outValueCompositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar;\r\n        }\r\n        this.__inputs.push({\r\n            compositionType: lhsCompositionType,\r\n            componentType: lhsComponentType,\r\n            name: 'lhs',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: rhsCompositionType,\r\n            componentType: rhsComponentType,\r\n            name: 'rhs',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: outValueCompositionType,\r\n            componentType: lhsComponentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/MultiplyShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/NormalMatrixShaderNode.ts":
/*!******************************************************************!*\
  !*** ./src/foundation/materials/nodes/NormalMatrixShaderNode.ts ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return NormalMatrixShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_NormalMatrix_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/NormalMatrix.vert */ \"./src/webgl/shaderity_shaders/nodes/NormalMatrix.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass NormalMatrixShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('normalMatrix', _webgl_shaderity_shaders_nodes_NormalMatrix_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat3,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/NormalMatrixShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/NormalizeShaderNode.ts":
/*!***************************************************************!*\
  !*** ./src/foundation/materials/nodes/NormalizeShaderNode.ts ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return NormalizeShaderNode; });\n/* harmony import */ var _webgl_shaderity_shaders_nodes_Normalize_glsl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/Normalize.glsl */ \"./src/webgl/shaderity_shaders/nodes/Normalize.glsl\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\nclass NormalizeShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('normalize', _webgl_shaderity_shaders_nodes_Normalize_glsl__WEBPACK_IMPORTED_MODULE_0__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'value',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/NormalizeShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/OutColorShaderNode.ts":
/*!**************************************************************!*\
  !*** ./src/foundation/materials/nodes/OutColorShaderNode.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return OutColorShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaders_nodes_EndShader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/EndShader */ \"./src/webgl/shaders/nodes/EndShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass OutColorShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('outColor', undefined, _webgl_shaders_nodes_EndShader__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance());\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'value',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/OutColorShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/OutPositionShaderNode.ts":
/*!*****************************************************************!*\
  !*** ./src/foundation/materials/nodes/OutPositionShaderNode.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return OutPositionShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaders_nodes_EndShader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/EndShader */ \"./src/webgl/shaders/nodes/EndShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass OutPositionShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('outPosition', undefined, _webgl_shaders_nodes_EndShader__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance());\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'value',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/OutPositionShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/ProjectionMatrixShaderNode.ts":
/*!**********************************************************************!*\
  !*** ./src/foundation/materials/nodes/ProjectionMatrixShaderNode.ts ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ProjectionMatrixShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_ProjectionMatrix_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/ProjectionMatrix.vert */ \"./src/webgl/shaderity_shaders/nodes/ProjectionMatrix.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass ProjectionMatrixShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('projectionMatrix', _webgl_shaderity_shaders_nodes_ProjectionMatrix_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/ProjectionMatrixShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/ScalarToVector4ShaderNode.ts":
/*!*********************************************************************!*\
  !*** ./src/foundation/materials/nodes/ScalarToVector4ShaderNode.ts ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ScalarToVector4ShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_ScalarToVector4_glsl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/ScalarToVector4.glsl */ \"./src/webgl/shaderity_shaders/nodes/ScalarToVector4.glsl\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass ScalarToVector4ShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('scalarToVector4', _webgl_shaderity_shaders_nodes_ScalarToVector4_glsl__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'x',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'y',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'z',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'w',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/ScalarToVector4ShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/UniformDataShaderNode.ts":
/*!*****************************************************************!*\
  !*** ./src/foundation/materials/nodes/UniformDataShaderNode.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return UniformDataShaderNode; });\n/* harmony import */ var _webgl_shaders_nodes_UniformDataShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/UniformDataShader */ \"./src/webgl/shaders/nodes/UniformDataShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\nclass UniformDataShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('uniformData');\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_UniformDataShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.__shaderFunctionName, compositionType, componentType);\r\n        this.__outputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n    setDefaultInputValue(inputName, value) {\r\n        if (inputName === 'value') {\r\n            this.__shader.setDefaultValue(value);\r\n        }\r\n    }\r\n    setUniformDataName(value) {\r\n        this.__shader.setVariableName(value);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/UniformDataShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/VaryingInVariableShaderNode.ts":
/*!***********************************************************************!*\
  !*** ./src/foundation/materials/nodes/VaryingInVariableShaderNode.ts ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VaryingInVariableShaderNode; });\n/* harmony import */ var _webgl_shaders_nodes_VaryingVariableShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/VaryingVariableShader */ \"./src/webgl/shaders/nodes/VaryingVariableShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\nclass VaryingInVariableShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('varyingInVariable');\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_VaryingVariableShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.__shaderFunctionName, compositionType, componentType);\r\n        this.__outputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'outValue',\r\n            isClosed: true\r\n        });\r\n    }\r\n    setVaryingVariableName(value) {\r\n        this.__shader.setVariableName(value);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/VaryingInVariableShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/VaryingOutVariableShaderNode.ts":
/*!************************************************************************!*\
  !*** ./src/foundation/materials/nodes/VaryingOutVariableShaderNode.ts ***!
  \************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VaryingOutVariableShaderNode; });\n/* harmony import */ var _webgl_shaders_nodes_VaryingVariableShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../webgl/shaders/nodes/VaryingVariableShader */ \"./src/webgl/shaders/nodes/VaryingVariableShader.ts\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\nclass VaryingOutVariableShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor(compositionType, componentType) {\r\n        super('varyingOutVariable');\r\n        this.__shaderFunctionName += '_' + this.__shaderNodeUid;\r\n        this.__shader = new _webgl_shaders_nodes_VaryingVariableShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.__shaderFunctionName, compositionType, componentType);\r\n        this.__inputs.push({\r\n            compositionType: compositionType,\r\n            componentType: componentType,\r\n            name: 'value',\r\n        });\r\n    }\r\n    setVaryingVariableName(value) {\r\n        this.__shader.setVariableName(value);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/VaryingOutVariableShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/Vector3AndScalarToVector4ShaderNode.ts":
/*!*******************************************************************************!*\
  !*** ./src/foundation/materials/nodes/Vector3AndScalarToVector4ShaderNode.ts ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Vector3AndScalarToVector4ShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_Vector3AndScalarToVector4_glsl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/Vector3AndScalarToVector4.glsl */ \"./src/webgl/shaderity_shaders/nodes/Vector3AndScalarToVector4.glsl\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass Vector3AndScalarToVector4ShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('vector3AndScalarToVector4', _webgl_shaderity_shaders_nodes_Vector3AndScalarToVector4_glsl__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec3,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'xyz',\r\n        });\r\n        this.__inputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Scalar,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'w',\r\n        });\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Vec4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/Vector3AndScalarToVector4ShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/ViewMatrixShaderNode.ts":
/*!****************************************************************!*\
  !*** ./src/foundation/materials/nodes/ViewMatrixShaderNode.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ViewMatrixShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_ViewMatrix_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/ViewMatrix.vert */ \"./src/webgl/shaderity_shaders/nodes/ViewMatrix.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass ViewMatrixShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('viewMatrix', _webgl_shaderity_shaders_nodes_ViewMatrix_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/ViewMatrixShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/nodes/WorldMatrixShaderNode.ts":
/*!*****************************************************************!*\
  !*** ./src/foundation/materials/nodes/WorldMatrixShaderNode.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WorldMatrixShaderNode; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_nodes_WorldMatrix_vert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/nodes/WorldMatrix.vert */ \"./src/webgl/shaderity_shaders/nodes/WorldMatrix.vert\");\n/* harmony import */ var _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/AbstractShaderNode */ \"./src/foundation/materials/core/AbstractShaderNode.ts\");\n\r\n\r\n\r\n\r\nclass WorldMatrixShaderNode extends _core_AbstractShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super('worldMatrix', _webgl_shaderity_shaders_nodes_WorldMatrix_vert__WEBPACK_IMPORTED_MODULE_2__[\"default\"].code);\r\n        this.__outputs.push({\r\n            compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat4,\r\n            componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Float,\r\n            name: 'outValue',\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/nodes/WorldMatrixShaderNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/ClassicShadingSingleMaterialNode.ts":
/*!******************************************************************************!*\
  !*** ./src/foundation/materials/singles/ClassicShadingSingleMaterialNode.ts ***!
  \******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ClassicShadingSingleMaterialNode; });\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/SkeletalComponent */ \"./src/foundation/components/SkeletalComponent.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../definitions/ShadingModel */ \"./src/foundation/definitions/ShadingModel.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_vert__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert */ \"./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_frag__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag */ \"./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ClassicShadingSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ isSkinning, isLighting, alphaMode }) {\r\n        super(null, \"classicShading\"\r\n            + (isSkinning ? '+skinning' : '')\r\n            + (isLighting ? '' : '-lighting')\r\n            + ' alpha_' + alphaMode.str.toLowerCase(), { isMorphing: false, isLighting: isLighting, isSkinning: isSkinning }, _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_vert__WEBPACK_IMPORTED_MODULE_13__[\"default\"], _webgl_shaderity_shaders_classicSingleShader_classicSingleShader_frag__WEBPACK_IMPORTED_MODULE_14__[\"default\"]);\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].ShadingModel, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_5__[\"default\"](_definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_10__[\"ShadingModel\"].Constant.index), min: 0, max: 3,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].Shininess, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_5__[\"default\"](5), min: 0, max: Number.MAX_VALUE,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].DiffuseColorFactor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_12__[\"default\"](1, 1, 1, 1), min: 0, max: 2,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].DiffuseColorTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Texture2D,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [0, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__dummyWhiteTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].NormalTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Texture2D,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [1, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__dummyBlueTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            }\r\n        ];\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].PointSize, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_5__[\"default\"](30.0), min: 0, max: 100,\r\n        }, {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].PointDistanceAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"](0.0, 0.1, 0.01), min: 0, max: 1,\r\n        });\r\n        if (isLighting) {\r\n            this.__definitions += '#define RN_IS_LIGHTING\\n';\r\n        }\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n        }\r\n        this.__definitions += '#define RN_IS_ALPHAMODE_' + alphaMode.str + '\\n';\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].AlphaCutoff, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 1.0, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_5__[\"default\"](0.01)\r\n        });\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n        }\r\n        /// Matrices\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].main);\r\n        }\r\n        this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n        this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n        /// Skinning\r\n        const skeletalComponent = args.entity.getComponent(_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\r\n        this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n        // Lights\r\n        this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/ClassicShadingSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/CustomSingleMaterialNode.ts":
/*!**********************************************************************!*\
  !*** ./src/foundation/materials/singles/CustomSingleMaterialNode.ts ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CustomSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../definitions/HdriFormat */ \"./src/foundation/definitions/HdriFormat.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _core_ShaderityUtility__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../core/ShaderityUtility */ \"./src/foundation/materials/core/ShaderityUtility.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CustomSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor({ name, isMorphing, isSkinning, isLighting, alphaMode, vertexShader, pixelShader }) {\r\n        super(null, name\r\n            + (isMorphing ? '+morphing' : '')\r\n            + (isSkinning ? '+skinning' : '')\r\n            + (isLighting ? '' : '-lighting')\r\n            + ' alpha_' + alphaMode.str.toLowerCase(), { isMorphing, isSkinning, isLighting });\r\n        const vertexShaderData = CustomSingleMaterialNode.__shaderityUtility.getShaderDataRefection(vertexShader, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__semanticsMap.get(this.shaderFunctionName));\r\n        const pixelShaderData = CustomSingleMaterialNode.__shaderityUtility.getShaderDataRefection(pixelShader, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__semanticsMap.get(this.shaderFunctionName));\r\n        this.__vertexShaderityObject = vertexShaderData.shaderityObject;\r\n        this.__pixelShaderityObject = pixelShaderData.shaderityObject;\r\n        const shaderSemanticsInfoArray = [];\r\n        for (let vertexShaderSemanticsInfo of vertexShaderData.shaderSemanticsInfoArray) {\r\n            vertexShaderSemanticsInfo.stage = _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].VertexShader;\r\n            shaderSemanticsInfoArray.push(vertexShaderSemanticsInfo);\r\n        }\r\n        for (let pixelShaderSemanticsInfo of pixelShaderData.shaderSemanticsInfoArray) {\r\n            const foundShaderSemanticsInfo = shaderSemanticsInfoArray.find((vertexInfo) => {\r\n                if (vertexInfo.semantic.str === pixelShaderSemanticsInfo.semantic.str) {\r\n                    return true;\r\n                }\r\n                else {\r\n                    return false;\r\n                }\r\n            });\r\n            if (foundShaderSemanticsInfo) {\r\n                foundShaderSemanticsInfo.stage = _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].VertexAndPixelShader;\r\n            }\r\n            else {\r\n                pixelShaderSemanticsInfo.stage = _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_3__[\"ShaderType\"].PixelShader;\r\n                shaderSemanticsInfoArray.push(pixelShaderSemanticsInfo);\r\n            }\r\n        }\r\n        if (isLighting) {\r\n            this.__definitions += '#define RN_IS_LIGHTING\\n';\r\n        }\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n        }\r\n        if (isMorphing) {\r\n            this.__definitions += '#define RN_IS_MORPHING\\n';\r\n        }\r\n        this.__definitions += '#define RN_IS_ALPHAMODE_' + alphaMode.str + '\\n';\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n            if (firstTime) {\r\n                /// Matrices\r\n                let cameraComponent = args.renderPass.cameraComponent;\r\n                if (cameraComponent == null) {\r\n                    cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"].main);\r\n                }\r\n                this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n                this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n                // Lights\r\n                this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n            }\r\n            /// Skinning\r\n            const skeletalComponent = args.entity.getSkeletal();\r\n            this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n        }\r\n        // Env map\r\n        if (args.diffuseCube && args.diffuseCube.isTextureReady) {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseEnvTexture.str, firstTime, [5, args.diffuseCube]);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseEnvTexture.str, firstTime, [5, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackCubeTexture]);\r\n        }\r\n        if (args.specularCube && args.specularCube.isTextureReady) {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SpecularEnvTexture.str, firstTime, [6, args.specularCube]);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SpecularEnvTexture.str, firstTime, [6, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackCubeTexture]);\r\n        }\r\n        if (args.setUniform) {\r\n            if (firstTime) {\r\n                const { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType } = this.setupHdriParameters(args);\r\n                this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].IBLParameter.str, firstTime, {\r\n                    x: mipmapLevelNumber,\r\n                    y: meshRenderComponent.diffuseCubeMapContribution,\r\n                    z: meshRenderComponent.specularCubeMapContribution, w: meshRenderComponent.rotationOfCubeMap\r\n                });\r\n                this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].HDRIFormat.str, firstTime, { x: diffuseHdriType, y: specularHdriType });\r\n            }\r\n        }\r\n        else {\r\n            const { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType } = this.setupHdriParameters(args);\r\n            const tmp_vector4 = _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__tmp_vector4;\r\n            tmp_vector4.x = mipmapLevelNumber;\r\n            tmp_vector4.y = meshRenderComponent.diffuseCubeMapContribution;\r\n            tmp_vector4.z = meshRenderComponent.specularCubeMapContribution;\r\n            tmp_vector4.w = meshRenderComponent.rotationOfCubeMap;\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].IBLParameter, tmp_vector4);\r\n            const tmp_vector2 = _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__tmp_vector2;\r\n            tmp_vector2.x = diffuseHdriType;\r\n            tmp_vector2.y = specularHdriType;\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].HDRIFormat, tmp_vector2);\r\n        }\r\n        // Morph\r\n        this.setMorphInfo(shaderProgram, args.entity.getComponent(_components_MeshComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"]), args.entity.getComponent(_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_8__[\"default\"]), args.primitive);\r\n    }\r\n    setupHdriParameters(args) {\r\n        let mipmapLevelNumber = 1;\r\n        if (args.specularCube) {\r\n            mipmapLevelNumber = args.specularCube.mipmapLevelNumber;\r\n        }\r\n        const meshRenderComponent = args.entity.getMeshRenderer();\r\n        let diffuseHdriType = _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_6__[\"HdriFormat\"].LDR_SRGB.index;\r\n        let specularHdriType = _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_6__[\"HdriFormat\"].LDR_SRGB.index;\r\n        if (meshRenderComponent.diffuseCubeMap) {\r\n            diffuseHdriType = meshRenderComponent.diffuseCubeMap.hdriFormat.index;\r\n        }\r\n        if (meshRenderComponent.specularCubeMap) {\r\n            specularHdriType = meshRenderComponent.specularCubeMap.hdriFormat.index;\r\n        }\r\n        return { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType };\r\n    }\r\n}\r\nCustomSingleMaterialNode.__pbrCookTorranceBrdfLutDataUrlUid = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid;\r\nCustomSingleMaterialNode.IsOutputHDR = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'isOutputHDR' });\r\nCustomSingleMaterialNode.baseColorTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'baseColorTextureTransform' });\r\nCustomSingleMaterialNode.baseColorTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'baseColorTextureRotation' });\r\nCustomSingleMaterialNode.normalTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'normalTextureTransform' });\r\nCustomSingleMaterialNode.normalTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'normalTextureRotation' });\r\nCustomSingleMaterialNode.metallicRoughnessTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'metallicRoughnessTextureTransform' });\r\nCustomSingleMaterialNode.metallicRoughnessTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'metallicRoughnessTextureRotation' });\r\nCustomSingleMaterialNode.__shaderityUtility = _core_ShaderityUtility__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getInstance();\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/CustomSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/DepthEncodeSingleMaterialNode.ts":
/*!***************************************************************************!*\
  !*** ./src/foundation/materials/singles/DepthEncodeSingleMaterialNode.ts ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DepthEncodeSingleMaterialNode; });\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _webgl_shaders_DepthEncodeShader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../webgl/shaders/DepthEncodeShader */ \"./src/webgl/shaders/DepthEncodeShader.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/SkeletalComponent */ \"./src/foundation/components/SkeletalComponent.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass DepthEncodeSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ isSkinning }) {\r\n        super(_webgl_shaders_DepthEncodeShader__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance(), 'depthEncodeShading' + (isSkinning ? '+skinning' : ''), { isMorphing: false, isSkinning, isLighting: false });\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: DepthEncodeSingleMaterialNode.zNearInner, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_6__[\"default\"](0.1), min: 0.0001, max: Number.MAX_SAFE_INTEGER\r\n            },\r\n            {\r\n                semantic: DepthEncodeSingleMaterialNode.zFarInner, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_6__[\"default\"](10000.0), min: 0.0001, max: Number.MAX_SAFE_INTEGER\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].PointSize, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_6__[\"default\"](30.0), min: 0, max: 100,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemantics\"].PointDistanceAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n                initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_11__[\"default\"](0.0, 0.1, 0.01), min: 0, max: 1,\r\n            }\r\n        ];\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING';\r\n        }\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].main);\r\n        }\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n            if (DepthEncodeSingleMaterialNode.__lastZNear !== cameraComponent.zNearInner) {\r\n                shaderProgram._gl.uniform1f(shaderProgram.zNearInner, cameraComponent.zNearInner);\r\n                DepthEncodeSingleMaterialNode.__lastZNear = cameraComponent.zNearInner;\r\n            }\r\n            if (DepthEncodeSingleMaterialNode.__lastZFar !== cameraComponent.zFarInner) {\r\n                shaderProgram._gl.uniform1f(shaderProgram.zFarInner, cameraComponent.zFarInner);\r\n                DepthEncodeSingleMaterialNode.__lastZFar = cameraComponent.zFarInner;\r\n            }\r\n        }\r\n        else {\r\n            material.setParameter(DepthEncodeSingleMaterialNode.zNearInner, cameraComponent.zNearInner);\r\n            material.setParameter(DepthEncodeSingleMaterialNode.zFarInner, cameraComponent.zFarInner);\r\n        }\r\n        /// Skinning\r\n        const skeletalComponent = args.entity.getComponent(_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_10__[\"default\"]);\r\n        this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n    }\r\n}\r\nDepthEncodeSingleMaterialNode.zNearInner = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemanticsClass\"]({ str: 'zNearInner' });\r\nDepthEncodeSingleMaterialNode.zFarInner = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_7__[\"ShaderSemanticsClass\"]({ str: 'zFarInner' });\r\nDepthEncodeSingleMaterialNode.__lastZNear = 0.0;\r\nDepthEncodeSingleMaterialNode.__lastZFar = 0.0;\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/DepthEncodeSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/EntityUIDOutputSingleMaterialNode.ts":
/*!*******************************************************************************!*\
  !*** ./src/foundation/materials/singles/EntityUIDOutputSingleMaterialNode.ts ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EntityUIDOutputSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/SkeletalComponent */ \"./src/foundation/components/SkeletalComponent.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_EntityUIDOutputSingleShader_EntityUIDOutputSingleShader_vert__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.vert */ \"./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_EntityUIDOutputSingleShader_EntityUIDOutputSingleShader_frag__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.frag */ \"./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.frag\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass EntityUIDOutputSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super(null, \"entityUidOutputShading\"\r\n            + (true ? '+skinning' : undefined)\r\n            + (false ? undefined : '-lighting'), { isMorphing: false, isSkinning: true, isLighting: false }, _webgl_shaderity_shaders_EntityUIDOutputSingleShader_EntityUIDOutputSingleShader_vert__WEBPACK_IMPORTED_MODULE_13__[\"default\"], _webgl_shaderity_shaders_EntityUIDOutputSingleShader_EntityUIDOutputSingleShader_frag__WEBPACK_IMPORTED_MODULE_14__[\"default\"]);\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].WorldMatrix, isComponentData: true, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_11__[\"default\"].zero()\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].NormalMatrix, isComponentData: true, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat3, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: _math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_12__[\"default\"].zero()\r\n            },\r\n            // {semantic: ShaderSemantics.ViewMatrix, isComponentData: true, compositionType: CompositionType.Mat4, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, initialValue: MutableMatrix44.zero() },\r\n            // {semantic: ShaderSemantics.ProjectionMatrix, isComponentData: true, compositionType: CompositionType.Mat4, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, initialValue: MutableMatrix44.zero() },\r\n            // {\r\n            //   semantic: ShaderSemantics.ViewPosition,\r\n            //   compositionType: CompositionType.Vec3,\r\n            //   componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader,\r\n            //   min: -Number.MAX_VALUE,\r\n            //   max: Number.MAX_VALUE,\r\n            //   isSystem: true,\r\n            //   updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n            //   initialValue: new Vector3(0, 0, 0),\r\n            //   soloDatum: true\r\n            // },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointSize, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_6__[\"default\"](30.0), min: 0, max: 100,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointDistanceAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n                initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0.0, 0.1, 0.01), min: 0, max: 1,\r\n            },\r\n        ];\r\n        if (true) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n        }\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n        }\r\n        /// Matrices\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"].main);\r\n        }\r\n        this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n        this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n        /// Skinning\r\n        const skeletalComponent = args.entity.getComponent(_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_10__[\"default\"]);\r\n        this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n        // Lights\r\n        this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/EntityUIDOutputSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/EnvConstantSingleMaterialNode.ts":
/*!***************************************************************************!*\
  !*** ./src/foundation/materials/singles/EnvConstantSingleMaterialNode.ts ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EnvConstantSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _webgl_shaders_EnvConstantShader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../webgl/shaders/EnvConstantShader */ \"./src/webgl/shaders/EnvConstantShader.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass EnvConstantSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super(_webgl_shaders_EnvConstantShader__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance(), \"envConstantShading\");\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: EnvConstantSingleMaterialNode.EnvHdriFormat, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_6__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0), min: 0, max: 5,\r\n            },\r\n            {\r\n                semantic: EnvConstantSingleMaterialNode.envRotation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_6__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0), min: -Math.PI, max: Math.PI,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseColorFactor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_6__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 1, 1, 1), min: 0, max: 2,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ColorEnvTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].TextureCube,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_6__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_10__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [0, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackCubeTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n        ];\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n        }\r\n        /// Matrices\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"].main);\r\n        }\r\n        if (cameraComponent) {\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n        }\r\n    }\r\n}\r\nEnvConstantSingleMaterialNode.envRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'envRotation' });\r\nEnvConstantSingleMaterialNode.EnvHdriFormat = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'EnvHdriFormat' });\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/EnvConstantSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/FXAA3QualitySingleMaterialNode.ts":
/*!****************************************************************************!*\
  !*** ./src/foundation/materials/singles/FXAA3QualitySingleMaterialNode.ts ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FXAA3QualitySingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_Vector2__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../math/Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_FXAA3QualityShader_FXAA3QualitySingleShader_vert__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.vert */ \"./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_FXAA3QualityShader_FXAA3QualitySingleShader_frag__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.frag */ \"./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.frag\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass FXAA3QualitySingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super(null, \"FXAA3QualityShading\", { isMorphing: false, isSkinning: false, isLighting: false }, _webgl_shaderity_shaders_FXAA3QualityShader_FXAA3QualitySingleShader_vert__WEBPACK_IMPORTED_MODULE_9__[\"default\"], _webgl_shaderity_shaders_FXAA3QualityShader_FXAA3QualitySingleShader_frag__WEBPACK_IMPORTED_MODULE_10__[\"default\"]);\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BaseColorTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_8__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [0, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ScreenInfo, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec2, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_5__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_8__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"](0, 0), min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n        ];\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n        }\r\n        /// Matrices\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"].main);\r\n        }\r\n        if (cameraComponent) {\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/FXAA3QualitySingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/GammaCorrectionSingleMaterialNode.ts":
/*!*******************************************************************************!*\
  !*** ./src/foundation/materials/singles/GammaCorrectionSingleMaterialNode.ts ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GammaCorrectionSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_GammaCorrectionShader_GammaCorrectionShader_vert__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.vert */ \"./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_GammaCorrectionShader_GammaCorrectionShader_frag__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.frag */ \"./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.frag\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GammaCorrectionSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super(null, \"GammaCorrection\", {}, _webgl_shaderity_shaders_GammaCorrectionShader_GammaCorrectionShader_vert__WEBPACK_IMPORTED_MODULE_8__[\"default\"], _webgl_shaderity_shaders_GammaCorrectionShader_GammaCorrectionShader_frag__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BaseColorTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_4__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_7__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [0, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture], min: 0, max: 10,\r\n            }\r\n        ];\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n        }\r\n        /// Matrices\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].main);\r\n        }\r\n        if (cameraComponent) {\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/GammaCorrectionSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/MToonSingleMaterialNode.ts":
/*!*********************************************************************!*\
  !*** ./src/foundation/materials/singles/MToonSingleMaterialNode.ts ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MToonSingleMaterialNode; });\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n/* harmony import */ var _components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _webgl_shaders_MToonShader__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../webgl/shaders/MToonShader */ \"./src/webgl/shaders/MToonShader.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _math_VectorN__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../math/VectorN */ \"./src/foundation/math/VectorN.ts\");\n/* harmony import */ var _misc_MiscUtil__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MToonSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(isOutline, materialProperties, textures, isMorphing, isSkinning, isLighting, debugMode) {\r\n        super(_webgl_shaders_MToonShader__WEBPACK_IMPORTED_MODULE_10__[\"default\"].getInstance(), 'MToonShading'\r\n            + (isMorphing ? '+morphing' : '')\r\n            + (isSkinning ? '+skinning' : '')\r\n            + (isLighting ? '' : '-lighting'), { isMorphing: isMorphing, isSkinning: isSkinning, isLighting: isLighting });\r\n        this.__OutlineWidthModeIsScreen = false;\r\n        this.__floatProperties = {};\r\n        this.__vectorProperties = {};\r\n        this.__textureProperties = {};\r\n        const shaderSemanticsInfoArray = [];\r\n        if (materialProperties != null) {\r\n            this.__floatProperties = materialProperties.floatProperties;\r\n            this.__vectorProperties = materialProperties.vectorProperties;\r\n            this.__textureProperties = materialProperties.textureProperties;\r\n        }\r\n        else {\r\n            this.__floatProperties._BlendMode = 0.0;\r\n            this.__floatProperties._BumpScale = 1.0;\r\n            this.__floatProperties._CullMode = 2.0;\r\n            this.__floatProperties._Cutoff = 0.5;\r\n            this.__floatProperties._DebugMode = 0.0;\r\n            this.__floatProperties._DstBlend = 0.0;\r\n            this.__floatProperties._IndirectLightIntensity = 0.1;\r\n            this.__floatProperties._LightColorAttenuation = 0.0;\r\n            this.__floatProperties._OutlineColorMode = 0.0;\r\n            this.__floatProperties._OutlineCullMode = 1.0;\r\n            this.__floatProperties._OutlineLightingMix = 1.0;\r\n            this.__floatProperties._OutlineScaledMaxDistance = 1.0;\r\n            this.__floatProperties._OutlineWidth = 0.5;\r\n            this.__floatProperties._OutlineWidthMode = 0.0;\r\n            this.__floatProperties._ReceiveShadowRate = 1.0;\r\n            this.__floatProperties._RimFresnelPower = 1.0;\r\n            this.__floatProperties._RimLift = 0.0;\r\n            this.__floatProperties._RimLightingMix = 0.0;\r\n            this.__floatProperties._ShadeShift = 0.0;\r\n            this.__floatProperties._ShadeToony = 0.9;\r\n            this.__floatProperties._ShadingGradeRate = 1.0;\r\n            this.__floatProperties._SrcBlend = 1.0;\r\n            this.__floatProperties._ZWrite = 1.0;\r\n            // this.__floatProperties._UvAnimScrollX = 0.0;\r\n            // this.__floatProperties._UvAnimScrollY = 0.0;\r\n            // this.__floatProperties._UvAnimRotation = 0.0;\r\n            this.__vectorProperties._Color = [1, 1, 1, 1];\r\n            this.__vectorProperties._EmissionColor = [0, 0, 0];\r\n            this.__vectorProperties._OutlineColor = [0, 0, 0, 1];\r\n            this.__vectorProperties._ShadeColor = [0.97, 0.81, 0.86, 1];\r\n            this.__vectorProperties._RimColor = [0, 0, 0];\r\n            // this.__vectorProperties._BumpMap = [0, 0, 1, 1];\r\n            // this.__vectorProperties._EmissionMap = [0, 0, 1, 1];\r\n            // this.__vectorProperties._MainTex = [0, 0, 1, 1];\r\n            // this.__vectorProperties._OutlineWidthTexture = [0, 0, 1, 1];\r\n            // this.__vectorProperties._ReceiveShadowTexture = [0, 0, 1, 1];\r\n            // this.__vectorProperties._ShadeTexture = [0, 0, 1, 1];\r\n            // this.__vectorProperties._ShadingGradeTexture = [0, 0, 1, 1];\r\n            // this.__vectorProperties._SphereAdd = [0, 0, 1, 1];\r\n            this.__textureProperties._BumpMap = 0;\r\n            this.__textureProperties._EmissionMap = 1;\r\n            this.__textureProperties._MainTex = 0;\r\n            this.__textureProperties._OutlineWidthTexture = 0;\r\n            this.__textureProperties._ReceiveShadowTexture = 0;\r\n            this.__textureProperties._RimTexture = 1;\r\n            this.__textureProperties._ShadeTexture = 0;\r\n            this.__textureProperties._ShadingGradeTexture = 0;\r\n            this.__textureProperties._SphereAdd = 1;\r\n            // this.__textureProperties._UvAnimMaskTexture = 0;\r\n            textures = [\r\n                _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__dummyWhiteTexture,\r\n                _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__dummyBlackTexture\r\n            ];\r\n        }\r\n        if (debugMode) {\r\n            this.__floatProperties._DebugMode = debugMode;\r\n        }\r\n        // non-Texture\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: MToonSingleMaterialNode._Cutoff, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._Cutoff), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._Color, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec4,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_16__[\"default\"](this.__vectorProperties._Color), min: 0, max: 1,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadeColor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](this.__vectorProperties._ShadeColor), min: 0, max: 1,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._BumpScale, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._BumpScale), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ReceiveShadowRate, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._ReceiveShadowRate), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadingGradeRate, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._ShadingGradeRate), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadeShift, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._ShadeShift), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadeToony, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._ShadeToony), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._LightColorAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._LightColorAttenuation), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._AmbientColor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](0.5785, 0.5785, 0.5785), min: 0, max: 1,\r\n        }, \r\n        // {\r\n        //   semantic: MToonSingleMaterialNode._IndirectLightIntensity, componentType: ComponentType.Float, compositionType: CompositionType.Scalar,\r\n        //   stage: ShaderType.PixelShader, isSystem: false, updateInterval: ShaderVariableUpdateInterval.EveryTime, soloDatum: false,\r\n        //   initialValue: new Scalar(this.floatPropertiesArray._IndirectLightIntensity), min: 0, max: 1\r\n        // },\r\n        {\r\n            semantic: MToonSingleMaterialNode._RimColor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](this.__vectorProperties._RimColor), min: 0, max: 1,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._RimLightingMix, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._RimLightingMix), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._RimFresnelPower, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._RimFresnelPower), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._RimLift, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._RimLift), min: 0, max: 1\r\n        }, {\r\n            semantic: MToonSingleMaterialNode.CameraUp, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: true, soloDatum: true,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](0, 1, 0), min: 0, max: 1,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._EmissionColor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](this.__vectorProperties._EmissionColor), min: 0, max: 1,\r\n        }, \r\n        // {\r\n        //   semantic: MToonSingleMaterialNode._UvAnimScrollX, componentType: ComponentType.Float, compositionType: CompositionType.Scalar,\r\n        //   stage: ShaderType.PixelShader, isSystem: false, updateInterval: ShaderVariableUpdateInterval.EveryTime, soloDatum: false,\r\n        //   initialValue: new Scalar(this.floatPropertiesArray._UvAnimScrollX), min: 0, max: 1\r\n        // },\r\n        // {\r\n        //   semantic: MToonSingleMaterialNode._UvAnimScrollY, componentType: ComponentType.Float, compositionType: CompositionType.Scalar,\r\n        //   stage: ShaderType.PixelShader, isSystem: false, updateInterval: ShaderVariableUpdateInterval.EveryTime, soloDatum: false,\r\n        //   initialValue:  new Scalar(this.floatPropertiesArray._UvAnimScrollY), min: 0, max: 1\r\n        // },\r\n        // {\r\n        //   semantic: MToonSingleMaterialNode._UvAnimRotation, componentType: ComponentType.Float, compositionType: CompositionType.Scalar,\r\n        //   stage: ShaderType.PixelShader, isSystem: false, updateInterval: ShaderVariableUpdateInterval.EveryTime, soloDatum: false,\r\n        //   initialValue: new Scalar(this.floatPropertiesArray._UvAnimRotation), min: 0, max: 1\r\n        // },\r\n        {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemantics\"].Wireframe, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](0, 0, 1), min: 0, max: 10,\r\n        });\r\n        // Texture\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: MToonSingleMaterialNode._MainTex, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [0, textures[this.__textureProperties._MainTex]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadeTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [1, textures[this.__textureProperties._ShadeTexture]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ReceiveShadowTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [2, textures[this.__textureProperties._ReceiveShadowTexture]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._ShadingGradeTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [3, textures[this.__textureProperties._ShadingGradeTexture]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._RimTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [4, textures[this.__textureProperties._RimTexture]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._SphereAdd, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [5, textures[this.__textureProperties._SphereAdd]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        }, {\r\n            semantic: MToonSingleMaterialNode._EmissionMap, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n            initialValue: [6, textures[this.__textureProperties._EmissionMap]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n        });\r\n        if (!_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_18__[\"MiscUtil\"].isIOS()) {\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: MToonSingleMaterialNode._BumpMap, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [8, textures[this.__textureProperties._BumpMap]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            });\r\n            if (this.__textureProperties._BumpMap !== textures.length - 2) { //textures.length - 2 is dummyTexture\r\n                this.__definitions += '#define RN_MTOON_HAS_BUMPMAP\\n';\r\n            }\r\n        }\r\n        // _DebugMode\r\n        switch (this.__floatProperties._DebugMode) {\r\n            case 1:\r\n                this.__definitions += '#define RN_MTOON_DEBUG_NORMAL\\n';\r\n                break;\r\n            case 2:\r\n                this.__definitions += '#define RN_MTOON_DEBUG_LITSHADERATE\\n';\r\n                break;\r\n        }\r\n        if (isOutline) {\r\n            this.__definitions += '#define RN_MTOON_IS_OUTLINE\\n';\r\n            // _OutlineWidthMode\r\n            switch (this.__floatProperties._OutlineWidthMode) {\r\n                case 0:\r\n                    this.__definitions += '#define RN_MTOON_OUTLINE_NONE\\n';\r\n                    break;\r\n                case 1:\r\n                    this.__definitions += '#define RN_MTOON_OUTLINE_WIDTH_WORLD\\n';\r\n                    break;\r\n                case 2:\r\n                    this.__definitions += '#define RN_MTOON_OUTLINE_WIDTH_SCREEN\\n';\r\n                    this.__OutlineWidthModeIsScreen = true;\r\n                    break;\r\n            }\r\n            // _OutlineColorMode\r\n            switch (this.__floatProperties._OutlineColorMode) {\r\n                case 0:\r\n                    this.__definitions += '#define RN_MTOON_OUTLINE_COLOR_FIXED\\n';\r\n                    break;\r\n                case 1:\r\n                    this.__definitions += '#define RN_MTOON_OUTLINE_COLOR_MIXED\\n';\r\n                    break;\r\n            }\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: MToonSingleMaterialNode._OutlineWidth, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._OutlineWidth), min: 0, max: 1\r\n            }, {\r\n                semantic: MToonSingleMaterialNode._OutlineScaledMaxDistance, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._OutlineScaledMaxDistance), min: 0, max: 1\r\n            }, {\r\n                semantic: MToonSingleMaterialNode._OutlineColor, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Vec3,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"](this.__vectorProperties._OutlineColor), min: 0, max: 1,\r\n            }, {\r\n                semantic: MToonSingleMaterialNode._OutlineLightingMix, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this.__floatProperties._OutlineLightingMix), min: 0, max: 1\r\n            }, {\r\n                semantic: MToonSingleMaterialNode.Aspect, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](1.0), min: 0, max: 1,\r\n            });\r\n            if (!_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_18__[\"MiscUtil\"].isIOS()) {\r\n                shaderSemanticsInfoArray.push({\r\n                    semantic: MToonSingleMaterialNode._OutlineWidthTexture, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Texture2D,\r\n                    stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_14__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                    initialValue: [9, textures[this.__textureProperties._OutlineWidthTexture]], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n                });\r\n                if (this.__textureProperties._OutlineWidthTexture !== textures.length - 2) { //textures.length - 2 is dummyTexture\r\n                    this.__definitions += '#define RN_MTOON_HAS_OUTLINE_WIDTH_TEXTURE\\n';\r\n                }\r\n            }\r\n        }\r\n        if (isLighting) {\r\n            this.__definitions += '#define RN_IS_LIGHTING\\n';\r\n        }\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n        }\r\n        if (isMorphing) {\r\n            this.__definitions += '#define RN_IS_MORPHING\\n';\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemantics\"].MorphTargetNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_11__[\"default\"](0), min: 0, max: _core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].maxVertexMorphNumberInShader, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemantics\"].DataTextureMorphOffsetPosition, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_17__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemantics\"].MorphWeights, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_6__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_7__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_17__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_8__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            });\r\n        }\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setMaterialParameters(material, isOutline) {\r\n        if (MToonSingleMaterialNode.usableBlendEquationModeAlpha == null) {\r\n            MToonSingleMaterialNode.__initializeUsableBlendEquationModeAlpha();\r\n        }\r\n        if (this.__floatProperties._BlendMode !== 0) {\r\n            switch (this.__floatProperties._BlendMode) {\r\n                case 1:\r\n                    this.__definitions += '#define RN_ALPHATEST_ON\\n';\r\n                    material.alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Mask;\r\n                    break;\r\n                case 2:\r\n                    this.__definitions += '#define RN_ALPHABLEND_ON\\n';\r\n                    material.alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Translucent;\r\n                    break;\r\n                case 3:\r\n                    this.__definitions += '#define RN_ALPHABLEND_ON\\n';\r\n                    material.alphaMode = _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_1__[\"AlphaMode\"].Translucent;\r\n                    break;\r\n            }\r\n            const blendEquationMode = 32774; // gl.FUNC_ADD\r\n            const blendEquationModeAlpha = MToonSingleMaterialNode.usableBlendEquationModeAlpha;\r\n            const blendFuncSrcFactor = MToonSingleMaterialNode.unityBlendEnumCorrespondence(this.__floatProperties._SrcBlend);\r\n            const blendFuncDstFactor = MToonSingleMaterialNode.unityBlendEnumCorrespondence(this.__floatProperties._DstBlend);\r\n            material.setBlendEquationMode(blendEquationMode, blendEquationModeAlpha);\r\n            material.setBlendFuncFactor(blendFuncSrcFactor, blendFuncDstFactor);\r\n        }\r\n        if (isOutline) {\r\n            switch (this.__floatProperties._OutlineCullMode) {\r\n                case 0:\r\n                    material.cullFace = false;\r\n                    break;\r\n                case 1:\r\n                    material.cullFace = true;\r\n                    material.cullFrontFaceCCW = false;\r\n                    break;\r\n                case 2:\r\n                    material.cullFace = true;\r\n                    material.cullFrontFaceCCW = true;\r\n                    break;\r\n            }\r\n        }\r\n        else {\r\n            switch (this.__floatProperties._CullMode) {\r\n                case 0:\r\n                    material.cullFace = false;\r\n                    break;\r\n                case 1:\r\n                    material.cullFace = true;\r\n                    material.cullFrontFaceCCW = false;\r\n                    break;\r\n                case 2:\r\n                    material.cullFace = true;\r\n                    material.cullFrontFaceCCW = true;\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    static __initializeUsableBlendEquationModeAlpha() {\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const glw = webGLResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        if (glw.isWebGL2) {\r\n            MToonSingleMaterialNode.usableBlendEquationModeAlpha = gl.MAX;\r\n        }\r\n        else if (glw.webgl1ExtBM) {\r\n            MToonSingleMaterialNode.usableBlendEquationModeAlpha = glw.webgl1ExtBM.MAX_EXT;\r\n        }\r\n        else {\r\n            MToonSingleMaterialNode.usableBlendEquationModeAlpha = gl.FUNC_ADD;\r\n        }\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"].main);\r\n        }\r\n        if (args.setUniform) {\r\n            /// Matrices\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n            /// Skinning\r\n            const skeletalComponent = args.entity.getSkeletal();\r\n            this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n            // Lights\r\n            this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n            shaderProgram._gl.uniform3fv(shaderProgram.cameraUp, cameraComponent.upInner.v);\r\n            if (this.__OutlineWidthModeIsScreen) {\r\n                shaderProgram._gl.uniform1f(shaderProgram.aspect, cameraComponent.aspect);\r\n            }\r\n        }\r\n        else {\r\n            material.setParameter(MToonSingleMaterialNode.CameraUp, cameraComponent.upInner);\r\n            if (this.__OutlineWidthModeIsScreen) {\r\n                material.setParameter(MToonSingleMaterialNode.Aspect, cameraComponent.aspect);\r\n            }\r\n        }\r\n        // Morph\r\n        this.setMorphInfo(shaderProgram, args.entity.getComponent(_components_MeshComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"]), args.entity.getComponent(_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"]), args.primitive);\r\n    }\r\n    static unityBlendEnumCorrespondence(enumNumber) {\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const glw = webGLResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        let result;\r\n        switch (enumNumber) {\r\n            case 0:\r\n                result = gl.ZERO;\r\n                break;\r\n            case 1:\r\n                result = gl.ONE;\r\n                break;\r\n            case 2:\r\n                result = gl.DST_COLOR;\r\n                break;\r\n            case 3:\r\n                result = gl.SRC_COLOR;\r\n                break;\r\n            case 4:\r\n                result = gl.ONE_MINUS_DST_COLOR;\r\n                break;\r\n            case 5:\r\n                result = gl.SRC_ALPHA;\r\n                break;\r\n            case 6:\r\n                result = gl.ONE_MINUS_SRC_COLOR;\r\n                break;\r\n            case 7:\r\n                result = gl.DST_ALPHA;\r\n                break;\r\n            case 8:\r\n                result = gl.ONE_MINUS_DST_ALPHA;\r\n                break;\r\n            case 9:\r\n                result = gl.SRC_ALPHA_SATURATE;\r\n                break;\r\n            case 10:\r\n                result = gl.ONE_MINUS_SRC_ALPHA;\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n}\r\nMToonSingleMaterialNode._Cutoff = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'cutoff' });\r\nMToonSingleMaterialNode._Color = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'litColor' });\r\nMToonSingleMaterialNode._ShadeColor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadeColor' });\r\nMToonSingleMaterialNode._MainTex = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'litColorTexture' });\r\nMToonSingleMaterialNode._ShadeTexture = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadeColorTexture' });\r\nMToonSingleMaterialNode._BumpScale = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'normalScale' });\r\nMToonSingleMaterialNode._BumpMap = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'normalTexture' });\r\nMToonSingleMaterialNode._ReceiveShadowRate = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'receiveShadowRate' });\r\nMToonSingleMaterialNode._ReceiveShadowTexture = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'receiveShadowTexture' });\r\nMToonSingleMaterialNode._ShadingGradeRate = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadingGradeRate' });\r\nMToonSingleMaterialNode._ShadingGradeTexture = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadingGradeTexture' });\r\nMToonSingleMaterialNode._ShadeShift = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadeShift' });\r\nMToonSingleMaterialNode._ShadeToony = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'shadeToony' });\r\nMToonSingleMaterialNode._LightColorAttenuation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'lightColorAttenuation' });\r\nMToonSingleMaterialNode._AmbientColor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'ambientColor' });\r\n// static readonly _IndirectLightIntensity = new ShaderSemanticsClass({ str: 'indirectLightIntensity' });\r\nMToonSingleMaterialNode._RimTexture = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'rimTexture' });\r\nMToonSingleMaterialNode._RimColor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'rimColor' });\r\nMToonSingleMaterialNode._RimLightingMix = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'rimLightingMix' });\r\nMToonSingleMaterialNode._RimFresnelPower = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'rimFresnelPower' });\r\nMToonSingleMaterialNode._RimLift = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'rimLift' });\r\nMToonSingleMaterialNode._SphereAdd = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'matCapTexture' });\r\nMToonSingleMaterialNode._EmissionColor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'emissionColor' });\r\nMToonSingleMaterialNode._EmissionMap = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'emissionTexture' });\r\nMToonSingleMaterialNode._OutlineWidthTexture = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'outlineWidthTexture' });\r\nMToonSingleMaterialNode._OutlineWidth = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'outlineWidth' });\r\nMToonSingleMaterialNode._OutlineScaledMaxDistance = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'outlineScaledMaxDistance' });\r\nMToonSingleMaterialNode._OutlineColor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'outlineColor' });\r\nMToonSingleMaterialNode._OutlineLightingMix = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'outlineLightingMix' });\r\nMToonSingleMaterialNode.Aspect = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'aspect' });\r\nMToonSingleMaterialNode.CameraUp = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_12__[\"ShaderSemanticsClass\"]({ str: 'cameraUp' });\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/MToonSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/PbrShadingSingleMaterialNode.ts":
/*!**************************************************************************!*\
  !*** ./src/foundation/materials/singles/PbrShadingSingleMaterialNode.ts ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return PbrShadingSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _math_Vector2__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../math/Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../definitions/HdriFormat */ \"./src/foundation/definitions/HdriFormat.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _math_VectorN__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../math/VectorN */ \"./src/foundation/math/VectorN.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _webgl_shaderity_shaders_PbrSingleShader_PbrSingleShader_vert__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.vert */ \"./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.vert\");\n/* harmony import */ var _webgl_shaderity_shaders_PbrSingleShader_PbrSingleShader_frag__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.frag */ \"./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.frag\");\n/* harmony import */ var _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass PbrShadingSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor({ isMorphing, isSkinning, isLighting, alphaMode }) {\r\n        super(null, 'pbrShading'\r\n            + (isMorphing ? '+morphing' : '')\r\n            + (isSkinning ? '+skinning' : '')\r\n            + (isLighting ? '' : '-lighting')\r\n            + ' alpha_' + alphaMode.str.toLowerCase(), { isMorphing, isSkinning, isLighting }, _webgl_shaderity_shaders_PbrSingleShader_PbrSingleShader_vert__WEBPACK_IMPORTED_MODULE_18__[\"default\"], _webgl_shaderity_shaders_PbrSingleShader_PbrSingleShader_frag__WEBPACK_IMPORTED_MODULE_19__[\"default\"]);\r\n        const shaderSemanticsInfoArray = [\r\n            //  {semantic: ShaderSemantics.ViewMatrix, compositionType: CompositionType.Mat4, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, initialValue: MutableMatrix44.identity()},\r\n            //   {semantic: ShaderSemantics.ProjectionMatrix, compositionType: CompositionType.Mat4, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, initialValue: MutableMatrix44.identity()},\r\n            //   {semantic: ShaderSemantics.ViewPosition, compositionType: CompositionType.Vec3, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexAndPixelShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: tirue, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, initialValue: new Vector3(0, 0, 1), soloDatum: true},\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BaseColorFactor, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 2, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_6__[\"default\"](1, 1, 1, 1)\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].BaseColorTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_SAFE_INTEGER, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: [0, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MetallicRoughnessFactor, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec2, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 2, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"](1, 1)\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MetallicRoughnessTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_SAFE_INTEGER, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: [1, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].NormalTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_SAFE_INTEGER, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: [2, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlueTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].OcclusionTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_SAFE_INTEGER, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: [3, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].EmissiveTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_SAFE_INTEGER, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: [4, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].Wireframe, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 10, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0, 0, 1)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.IsOutputHDR, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Bool,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 1, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0)\r\n            },\r\n            // {\r\n            //   semantic: ShaderSemantics.ViewPosition,\r\n            //   compositionType: CompositionType.Vec3,\r\n            //   componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexAndPixelShader,\r\n            //   min: -Number.MAX_VALUE,\r\n            //   max: Number.MAX_VALUE,\r\n            //   isSystem: true,\r\n            //   updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n            //   initialValue: new Vector3(0, 0, 0),\r\n            //   soloDatum: true\r\n            // },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].IBLParameter,\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4,\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader,\r\n                min: -Number.MAX_VALUE,\r\n                max: Number.MAX_VALUE,\r\n                isSystem: true,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_6__[\"default\"](1, 1, 1, 1),\r\n                updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].HDRIFormat,\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec2,\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader,\r\n                min: 0,\r\n                max: 5,\r\n                isSystem: true,\r\n                updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly,\r\n                initialValue: new _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"](0, 0)\r\n            },\r\n            // {\r\n            //   semantic: ShaderSemantics.LightNumber,\r\n            //   compositionType: CompositionType.Scalar,\r\n            //   componentType: ComponentType.Int,\r\n            //   stage: ShaderType.VertexAndPixelShader,\r\n            //   min: 0,\r\n            //   max: Number.MAX_SAFE_INTEGER,\r\n            //   isSystem: true,\r\n            //   updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n            //   initialValue: new Scalar(0),\r\n            //   soloDatum: true\r\n            // },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseEnvTexture,\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].TextureCube,\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0,\r\n                max: Number.MAX_SAFE_INTEGER,\r\n                isSystem: true,\r\n                updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly,\r\n                initialValue: [5, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture]\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SpecularEnvTexture,\r\n                compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].TextureCube,\r\n                componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader,\r\n                min: 0,\r\n                max: Number.MAX_SAFE_INTEGER,\r\n                isSystem: true,\r\n                updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly,\r\n                initialValue: [6, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture]\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.baseColorTextureTransform, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -10, max: 10, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_6__[\"default\"](1, 1, 0, 0)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.baseColorTextureRotation, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -Math.PI, max: Math.PI, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.normalTextureTransform, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -10, max: 10, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_6__[\"default\"](1, 1, 0, 0)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.normalTextureRotation, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -Math.PI, max: Math.PI, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.metallicRoughnessTextureTransform, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -10, max: 10, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_6__[\"default\"](1, 1, 0, 0)\r\n            },\r\n            {\r\n                semantic: PbrShadingSingleMaterialNode.metallicRoughnessTextureRotation, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: -Math.PI, max: Math.PI, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0)\r\n            },\r\n        ];\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointSize, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](30.0), min: 0, max: 100,\r\n        }, {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointDistanceAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0.0, 0.1, 0.01), min: 0, max: 1,\r\n        });\r\n        if (isLighting) {\r\n            this.__definitions += '#define RN_IS_LIGHTING\\n';\r\n            /*\r\n            const lights: ShaderSemanticsInfo[] = [];\r\n            for (let i = 0; i < Config.maxLightNumberInShader; i++) {\r\n              (function(idx){\r\n              lights.push(\r\n                {\r\n                  semantic: ShaderSemantics.LightPosition,\r\n                  compositionType: CompositionType.Vec4,\r\n                  componentType: ComponentType.Float,\r\n                  stage: ShaderType.PixelShader,\r\n                  min: -Number.MAX_VALUE,\r\n                  max: Number.MAX_VALUE,\r\n                  index: idx,\r\n                  maxIndex: 4,\r\n                  isSystem: true,\r\n                  updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n                  initialValue: new Vector4(0, 0, 0, 1),\r\n                  soloDatum: true\r\n                });\r\n              lights.push(\r\n                {\r\n                semantic: ShaderSemantics.LightDirection,\r\n                compositionType: CompositionType.Vec4,\r\n                componentType: ComponentType.Float,\r\n                stage: ShaderType.PixelShader,\r\n                min: -1,\r\n                max: 1,\r\n                index: idx,\r\n                maxIndex: 4,\r\n                isSystem: true,\r\n                initialValue: new Vector4(0, 1, 0, 1),\r\n                updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n                soloDatum: true\r\n              });\r\n              lights.push(\r\n                {\r\n                  semantic: ShaderSemantics.LightIntensity,\r\n                  compositionType: CompositionType.Vec4,\r\n                  componentType: ComponentType.Float,\r\n                  stage: ShaderType.PixelShader,\r\n                  min: 0,\r\n                  max: 10,\r\n                  index: idx,\r\n                  maxIndex: 4,\r\n                  isSystem: true,\r\n                  initialValue: new Vector4(1, 1, 1, 1),\r\n                  updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly,\r\n                  soloDatum: true\r\n                });\r\n              })(i);\r\n            }\r\n            shaderSemanticsInfoArray = shaderSemanticsInfoArray.concat(lights);\r\n            */\r\n        }\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n            // shaderSemanticsInfoArray.push({semantic: ShaderSemantics.BoneQuaternion, compositionType: CompositionType.Vec4Array, maxIndex: 250, componentType: ComponentType.Float,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, soloDatum: true, initialValue: new VectorN(new Float32Array(0))});\r\n            // shaderSemanticsInfoArray.push({semantic: ShaderSemantics.BoneTranslateScale, compositionType: CompositionType.Vec4Array, maxIndex: 250, componentType: ComponentType.Float, soloDatum: true,\r\n            //   stage: ShaderType.VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, initialValue: new VectorN(new Float32Array(0))});\r\n            // shaderSemanticsInfoArray.push({semantic: ShaderSemantics.SkinningMode, compositionType: CompositionType.Scalar, componentType: ComponentType.Int,\r\n            //   stage: ShaderType.VertexShader, min: 0, max: 1, isSystem: true, updateInterval: ShaderVariableUpdateInterval.FirstTimeOnly, initialValue: new Scalar(-1) });\r\n        }\r\n        if (isMorphing) {\r\n            this.__definitions += '#define RN_IS_MORPHING\\n';\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MorphTargetNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0), min: 0, max: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DataTextureMorphOffsetPosition, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MorphWeights, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            });\r\n        }\r\n        this.__definitions += '#define RN_IS_ALPHAMODE_' + alphaMode.str + '\\n';\r\n        if (alphaMode === _definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_20__[\"AlphaMode\"].Mask) {\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].AlphaCutoff, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_4__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, min: 0, max: 1.0, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0.01)\r\n            });\r\n        }\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n            if (firstTime) {\r\n                /// Matrices\r\n                let cameraComponent = args.renderPass.cameraComponent;\r\n                if (cameraComponent == null) {\r\n                    cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_10__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__[\"default\"].main);\r\n                }\r\n                this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n                this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n                // Lights\r\n                this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n            }\r\n            /// Skinning\r\n            const skeletalComponent = args.entity.getSkeletal();\r\n            this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n        }\r\n        // Env map\r\n        if (args.diffuseCube && args.diffuseCube.isTextureReady) {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseEnvTexture.str, firstTime, [5, args.diffuseCube]);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseEnvTexture.str, firstTime, [5, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackCubeTexture]);\r\n        }\r\n        if (args.specularCube && args.specularCube.isTextureReady) {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SpecularEnvTexture.str, firstTime, [6, args.specularCube]);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].SpecularEnvTexture.str, firstTime, [6, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyBlackCubeTexture]);\r\n        }\r\n        if (args.setUniform) {\r\n            if (firstTime) {\r\n                const { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType } = this.setupHdriParameters(args);\r\n                this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].IBLParameter.str, firstTime, {\r\n                    x: mipmapLevelNumber,\r\n                    y: meshRenderComponent.diffuseCubeMapContribution,\r\n                    z: meshRenderComponent.specularCubeMapContribution, w: meshRenderComponent.rotationOfCubeMap\r\n                });\r\n                this.__webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].HDRIFormat.str, firstTime, { x: diffuseHdriType, y: specularHdriType });\r\n            }\r\n        }\r\n        else {\r\n            const { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType } = this.setupHdriParameters(args);\r\n            const tmp_vector4 = _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__tmp_vector4;\r\n            tmp_vector4.x = mipmapLevelNumber;\r\n            tmp_vector4.y = meshRenderComponent.diffuseCubeMapContribution;\r\n            tmp_vector4.z = meshRenderComponent.specularCubeMapContribution;\r\n            tmp_vector4.w = meshRenderComponent.rotationOfCubeMap;\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].IBLParameter, tmp_vector4);\r\n            const tmp_vector2 = _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__tmp_vector2;\r\n            tmp_vector2.x = diffuseHdriType;\r\n            tmp_vector2.y = specularHdriType;\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].HDRIFormat, tmp_vector2);\r\n        }\r\n        // Morph\r\n        this.setMorphInfo(shaderProgram, args.entity.getComponent(_components_MeshComponent__WEBPACK_IMPORTED_MODULE_16__[\"default\"]), args.entity.getComponent(_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_17__[\"default\"]), args.primitive);\r\n    }\r\n    setupHdriParameters(args) {\r\n        let mipmapLevelNumber = 1;\r\n        if (args.specularCube) {\r\n            mipmapLevelNumber = args.specularCube.mipmapLevelNumber;\r\n        }\r\n        const meshRenderComponent = args.entity.getMeshRenderer();\r\n        let diffuseHdriType = _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_12__[\"HdriFormat\"].LDR_SRGB.index;\r\n        let specularHdriType = _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_12__[\"HdriFormat\"].LDR_SRGB.index;\r\n        if (meshRenderComponent.diffuseCubeMap) {\r\n            diffuseHdriType = meshRenderComponent.diffuseCubeMap.hdriFormat.index;\r\n        }\r\n        if (meshRenderComponent.specularCubeMap) {\r\n            specularHdriType = meshRenderComponent.specularCubeMap.hdriFormat.index;\r\n        }\r\n        return { mipmapLevelNumber, meshRenderComponent, diffuseHdriType, specularHdriType };\r\n    }\r\n}\r\nPbrShadingSingleMaterialNode.__pbrCookTorranceBrdfLutDataUrlUid = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].InvalidCGAPIResourceUid;\r\nPbrShadingSingleMaterialNode.IsOutputHDR = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'isOutputHDR' });\r\nPbrShadingSingleMaterialNode.baseColorTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'baseColorTextureTransform' });\r\nPbrShadingSingleMaterialNode.baseColorTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'baseColorTextureRotation' });\r\nPbrShadingSingleMaterialNode.normalTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'normalTextureTransform' });\r\nPbrShadingSingleMaterialNode.normalTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'normalTextureRotation' });\r\nPbrShadingSingleMaterialNode.metallicRoughnessTextureTransform = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'metallicRoughnessTextureTransform' });\r\nPbrShadingSingleMaterialNode.metallicRoughnessTextureRotation = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'metallicRoughnessTextureRotation' });\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/PbrShadingSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode.ts":
/*!**************************************************************************************!*\
  !*** ./src/foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode.ts ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ShadowMapDecodeClassicSingleMaterialNode; });\n/* harmony import */ var _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../definitions/ShadingModel */ \"./src/foundation/definitions/ShadingModel.ts\");\n/* harmony import */ var _webgl_shaders_ShadowMapDecodeClassicShader__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../webgl/shaders/ShadowMapDecodeClassicShader */ \"./src/webgl/shaders/ShadowMapDecodeClassicShader.ts\");\n/* harmony import */ var _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _math_VectorN__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../math/VectorN */ \"./src/foundation/math/VectorN.ts\");\n/* harmony import */ var _math_Scalar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../components/SkeletalComponent */ \"./src/foundation/components/SkeletalComponent.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _components_MeshComponent__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ShadowMapDecodeClassicSingleMaterialNode extends _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    /**\r\n     * The constructor of the ShadowMapDecodeClassicSingleMaterialNode\r\n     * @param isMorphing True if the morphing is to be applied\r\n     * @param isSkinning True if the skeleton is to be applied\r\n     * @param isLighting True if the lighting is to be applied. When isLighting is false, the Shader draws the original color of the material, except for the shadow area.\r\n     * @param isDebugging True if the shader displays the DebugColorFactor color in areas outside of the depth map.\r\n     * @param colorAttachmentsNumber The index of colorAttachment in a framebuffer. The colorAttachment must have depth information drawn by the DepthEncodeSingleMaterialNode.\r\n     * @param encodedDepthRenderPass The render pass where the depth information from the DepthEncodeSingleMaterialNode is drawn to the frame buffer\r\n     */\r\n    constructor({ isMorphing, isSkinning, isLighting, isDebugging, colorAttachmentsNumber }, encodedDepthRenderPass) {\r\n        super(_webgl_shaders_ShadowMapDecodeClassicShader__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getInstance(), \"ShadowMapDecodeClassicShading\"\r\n            + (isSkinning ? '+skinning' : '')\r\n            + (isLighting ? '' : '-lighting'), { isMorphing, isSkinning, isLighting });\r\n        this.__encodedDepthRenderPass = encodedDepthRenderPass;\r\n        const encodedDepthFramebuffer = encodedDepthRenderPass.getFramebuffer();\r\n        if (encodedDepthFramebuffer == null) {\r\n            console.error('encodedDepthRenderPass does not have framebuffer');\r\n            return;\r\n        }\r\n        const encodedDepthTexture = encodedDepthFramebuffer.colorAttachments[colorAttachmentsNumber];\r\n        const viewport = encodedDepthRenderPass.getViewport();\r\n        viewport.setComponents(1, 1, viewport.z - 1, viewport.w - 1);\r\n        encodedDepthRenderPass.setViewport(viewport);\r\n        const shaderSemanticsInfoArray = [\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightViewProjectionMatrix, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Mat4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_17__[\"default\"].zero(), min: -Number.MAX_VALUE, max: Number.MAX_VALUE,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].ShadingModel, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](_definitions_ShadingModel__WEBPACK_IMPORTED_MODULE_6__[\"ShadingModel\"].Constant.index), min: 0, max: 3,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].Shininess, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](5), min: 0, max: Number.MAX_VALUE,\r\n            },\r\n            {\r\n                semantic: ShadowMapDecodeClassicSingleMaterialNode.AllowableDepthError, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0.0001), min: 0, max: 1,\r\n            },\r\n            {\r\n                semantic: ShadowMapDecodeClassicSingleMaterialNode.ShadowColorCoefficient, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0.5, 0.5, 0.5, 1), min: 0, max: 1,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseColorFactor, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 1, 1, 1), min: 0, max: 2,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DepthTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [0, encodedDepthTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n            {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DiffuseColorTexture, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Texture2D, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime,\r\n                initialValue: [1, _core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_1__[\"default\"].__dummyWhiteTexture], min: 0, max: Number.MAX_SAFE_INTEGER,\r\n            },\r\n            {\r\n                semantic: ShadowMapDecodeClassicSingleMaterialNode.zNearInner, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0.1), min: 0.0001, max: Number.MAX_SAFE_INTEGER\r\n            },\r\n            {\r\n                semantic: ShadowMapDecodeClassicSingleMaterialNode.zFarInner, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].EveryTime, soloDatum: false,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](10000.0), min: 0.0001, max: Number.MAX_SAFE_INTEGER\r\n            }\r\n        ];\r\n        shaderSemanticsInfoArray.push({\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointSize, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](30.0), min: 0, max: 100,\r\n        }, {\r\n            semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].PointDistanceAttenuation, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec3,\r\n            stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: true,\r\n            initialValue: new _math_Vector3__WEBPACK_IMPORTED_MODULE_5__[\"default\"](0.0, 0.1, 0.01), min: 0, max: 1,\r\n        });\r\n        if (isSkinning) {\r\n            this.__definitions += '#define RN_IS_SKINNING\\n';\r\n        }\r\n        if (isLighting) {\r\n            this.__definitions += '#define RN_IS_LIGHTING\\n';\r\n        }\r\n        if (isMorphing) {\r\n            this.__definitions += '#define RN_IS_MORPHING\\n';\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MorphTargetNumber, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Scalar,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0), min: 0, max: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].DataTextureMorphOffsetPosition, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_12__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            }, {\r\n                semantic: _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].MorphWeights, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].ScalarArray, maxIndex: _core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].VertexShader, isSystem: true, soloDatum: true,\r\n                initialValue: new _math_VectorN__WEBPACK_IMPORTED_MODULE_12__[\"default\"](new Float32Array(_core_Config__WEBPACK_IMPORTED_MODULE_14__[\"default\"].maxVertexMorphNumberInShader)), min: -Number.MAX_VALUE, max: Number.MAX_VALUE, needUniformInFastest: true\r\n            });\r\n        }\r\n        if (isDebugging) {\r\n            this.__definitions += '#define RN_IS_DEBUGGING\\n';\r\n            shaderSemanticsInfoArray.push({\r\n                semantic: ShadowMapDecodeClassicSingleMaterialNode.DebugColorFactor, compositionType: _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_2__[\"CompositionType\"].Vec4, componentType: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                stage: _definitions_ShaderType__WEBPACK_IMPORTED_MODULE_8__[\"ShaderType\"].PixelShader, isSystem: false, updateInterval: _definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_9__[\"ShaderVariableUpdateInterval\"].FirstTimeOnly, soloDatum: false,\r\n                initialValue: new _math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](1, 0, 0, 1), min: 0, max: 2,\r\n            });\r\n        }\r\n        this.setShaderSemanticsInfoArray(shaderSemanticsInfoArray);\r\n    }\r\n    setParametersForGPU({ material, shaderProgram, firstTime, args }) {\r\n        let cameraComponent = args.renderPass.cameraComponent;\r\n        if (cameraComponent == null) {\r\n            cameraComponent = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_10__[\"default\"].getInstance().getComponent(_components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_11__[\"default\"].main);\r\n        }\r\n        const encodedDepthCameraComponent = this.__encodedDepthRenderPass.cameraComponent;\r\n        if (args.setUniform) {\r\n            this.setWorldMatrix(shaderProgram, args.worldMatrix);\r\n            this.setNormalMatrix(shaderProgram, args.normalMatrix);\r\n            this.setViewInfo(shaderProgram, cameraComponent, material, args.setUniform);\r\n            this.setProjection(shaderProgram, cameraComponent, material, args.setUniform);\r\n            if (ShadowMapDecodeClassicSingleMaterialNode.__lastZNear !== encodedDepthCameraComponent.zNearInner) {\r\n                shaderProgram._gl.uniform1f(shaderProgram.zNearInner, encodedDepthCameraComponent.zNearInner);\r\n                ShadowMapDecodeClassicSingleMaterialNode.__lastZNear = encodedDepthCameraComponent.zNearInner;\r\n            }\r\n            if (ShadowMapDecodeClassicSingleMaterialNode.__lastZFar !== encodedDepthCameraComponent.zFarInner) {\r\n                shaderProgram._gl.uniform1f(shaderProgram.zFarInner, encodedDepthCameraComponent.zFarInner);\r\n                ShadowMapDecodeClassicSingleMaterialNode.__lastZFar = encodedDepthCameraComponent.zFarInner;\r\n            }\r\n            const __webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_16__[\"default\"].getWebGLResourceRepository();\r\n            __webglResourceRepository.setUniformValue(shaderProgram, _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightViewProjectionMatrix.str, true, this.__encodedDepthRenderPass.cameraComponent.viewProjectionMatrix);\r\n        }\r\n        else {\r\n            material.setParameter(ShadowMapDecodeClassicSingleMaterialNode.zNearInner, encodedDepthCameraComponent.zNearInner);\r\n            material.setParameter(ShadowMapDecodeClassicSingleMaterialNode.zFarInner, encodedDepthCameraComponent.zFarInner);\r\n            material.setParameter(_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemantics\"].LightViewProjectionMatrix, this.__encodedDepthRenderPass.cameraComponent.viewProjectionMatrix);\r\n        }\r\n        /// Skinning\r\n        const skeletalComponent = args.entity.getComponent(_components_SkeletalComponent__WEBPACK_IMPORTED_MODULE_15__[\"default\"]);\r\n        this.setSkinning(shaderProgram, skeletalComponent, args.setUniform);\r\n        // Lights\r\n        this.setLightsInfo(shaderProgram, args.lightComponents, material, args.setUniform);\r\n        // Morph\r\n        this.setMorphInfo(shaderProgram, args.entity.getComponent(_components_MeshComponent__WEBPACK_IMPORTED_MODULE_18__[\"default\"]), args.entity.getComponent(_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_19__[\"default\"]), args.primitive);\r\n    }\r\n}\r\nShadowMapDecodeClassicSingleMaterialNode.ShadowColorCoefficient = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'shadowColorCoefficient' });\r\nShadowMapDecodeClassicSingleMaterialNode.ShadowAlpha = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'shadowAlpha' });\r\nShadowMapDecodeClassicSingleMaterialNode.NonShadowAlpha = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'nonShadowAlpha' });\r\nShadowMapDecodeClassicSingleMaterialNode.AllowableDepthError = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'allowableDepthError' });\r\nShadowMapDecodeClassicSingleMaterialNode.zNearInner = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'zNearInner' });\r\nShadowMapDecodeClassicSingleMaterialNode.zFarInner = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'zFarInner' });\r\nShadowMapDecodeClassicSingleMaterialNode.DebugColorFactor = new _definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_0__[\"ShaderSemanticsClass\"]({ str: 'debugColorFactor' });\r\nShadowMapDecodeClassicSingleMaterialNode.__lastZNear = 0.0;\r\nShadowMapDecodeClassicSingleMaterialNode.__lastZFar = 0.0;\r\n\n\n//# sourceURL=webpack:///./src/foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode.ts?");

/***/ }),

/***/ "./src/foundation/math/AABB.ts":
/*!*************************************!*\
  !*** ./src/foundation/math/AABB.ts ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AABB; });\n/* harmony import */ var _Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _MutableVector3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n\r\n\r\nclass AABB {\r\n    constructor() {\r\n        this.__min = new _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE);\r\n        this.__max = new _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE);\r\n        this.__centerPoint = _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n        this.__lengthCenterToCorner = 0;\r\n        this.__isCenterPointDirty = false;\r\n        this.__isLengthCenterToCornerDirty = false;\r\n    }\r\n    clone() {\r\n        let instance = new AABB();\r\n        instance.__max = this.__max.clone();\r\n        instance.__min = this.__min.clone();\r\n        instance.__centerPoint = this.__centerPoint.clone();\r\n        instance.__lengthCenterToCorner = this.__lengthCenterToCorner;\r\n        instance.__isCenterPointDirty = this.__isCenterPointDirty;\r\n        instance.__isLengthCenterToCornerDirty = this.__isLengthCenterToCornerDirty;\r\n        return instance;\r\n    }\r\n    initialize() {\r\n        this.__min.setComponents(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE);\r\n        this.__max.setComponents(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE);\r\n        this.__centerPoint.zero();\r\n        this.__lengthCenterToCorner = 0;\r\n        this.__isCenterPointDirty = false;\r\n        this.__isLengthCenterToCornerDirty = false;\r\n    }\r\n    set minPoint(val) {\r\n        this.__min = new _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](val);\r\n        this.__isCenterPointDirty = true;\r\n        this.__isLengthCenterToCornerDirty = true;\r\n    }\r\n    get minPoint() {\r\n        return this.__min;\r\n    }\r\n    set maxPoint(val) {\r\n        this.__max = new _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](val);\r\n        this.__isCenterPointDirty = true;\r\n        this.__isLengthCenterToCornerDirty = true;\r\n    }\r\n    get maxPoint() {\r\n        return this.__max;\r\n    }\r\n    isVanilla() {\r\n        if (this.__min.x >= Number.MAX_VALUE && this.__min.y >= Number.MAX_VALUE && this.__min.z >= Number.MAX_VALUE\r\n            && this.__max.x <= -Number.MAX_VALUE && this.__max.y <= -Number.MAX_VALUE && this.__max.z <= -Number.MAX_VALUE) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    addPosition(positionVector) {\r\n        this.__min.x = (positionVector.x < this.__min.x) ? positionVector.x : this.__min.x;\r\n        this.__min.y = (positionVector.y < this.__min.y) ? positionVector.y : this.__min.y;\r\n        this.__min.z = (positionVector.z < this.__min.z) ? positionVector.z : this.__min.z;\r\n        this.__max.x = (this.__max.x < positionVector.x) ? positionVector.x : this.__max.x;\r\n        this.__max.y = (this.__max.y < positionVector.y) ? positionVector.y : this.__max.y;\r\n        this.__max.z = (this.__max.z < positionVector.z) ? positionVector.z : this.__max.z;\r\n        this.__isCenterPointDirty = true;\r\n        this.__isLengthCenterToCornerDirty = true;\r\n        return positionVector;\r\n    }\r\n    addPositionWithArray(array, index) {\r\n        this.__min.x = (array[index + 0] < this.__min.x) ? array[index + 0] : this.__min.x;\r\n        this.__min.y = (array[index + 1] < this.__min.y) ? array[index + 1] : this.__min.y;\r\n        this.__min.z = (array[index + 2] < this.__min.z) ? array[index + 2] : this.__min.z;\r\n        this.__max.x = (this.__max.x < array[index + 0]) ? array[index + 0] : this.__max.x;\r\n        this.__max.y = (this.__max.y < array[index + 1]) ? array[index + 1] : this.__max.y;\r\n        this.__max.z = (this.__max.z < array[index + 2]) ? array[index + 2] : this.__max.z;\r\n        this.__isCenterPointDirty = true;\r\n        this.__isLengthCenterToCornerDirty = true;\r\n        return array;\r\n    }\r\n    mergeAABB(aabb) {\r\n        var isUpdated = false;\r\n        if (aabb.isVanilla()) {\r\n            return isUpdated;\r\n        }\r\n        this.__isCenterPointDirty = true;\r\n        this.__isLengthCenterToCornerDirty = true;\r\n        if (this.isVanilla()) {\r\n            this.__min.x = aabb.minPoint.x;\r\n            this.__min.y = aabb.minPoint.y;\r\n            this.__min.z = aabb.minPoint.z;\r\n            this.__max.x = aabb.maxPoint.x;\r\n            this.__max.y = aabb.maxPoint.y;\r\n            this.__max.z = aabb.maxPoint.z;\r\n            isUpdated = true;\r\n            return isUpdated;\r\n        }\r\n        if (aabb.minPoint.x < this.__min.x) {\r\n            this.__min.x = aabb.minPoint.x;\r\n            isUpdated = true;\r\n        }\r\n        if (aabb.minPoint.y < this.__min.y) {\r\n            this.__min.y = aabb.minPoint.y;\r\n            isUpdated = true;\r\n        }\r\n        if (aabb.minPoint.z < this.__min.z) {\r\n            this.__min.z = aabb.minPoint.z;\r\n            isUpdated = true;\r\n        }\r\n        if (this.__max.x < aabb.maxPoint.x) {\r\n            this.__max.x = aabb.maxPoint.x;\r\n            isUpdated = true;\r\n        }\r\n        if (this.__max.y < aabb.maxPoint.y) {\r\n            this.__max.y = aabb.maxPoint.y;\r\n            isUpdated = true;\r\n        }\r\n        if (this.__max.z < aabb.maxPoint.z) {\r\n            this.__max.z = aabb.maxPoint.z;\r\n            isUpdated = true;\r\n        }\r\n        return isUpdated;\r\n    }\r\n    get centerPoint() {\r\n        if (this.__isCenterPointDirty) {\r\n            _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addTo(this.__min, this.__max, this.__centerPoint).divide(2);\r\n            this.__isCenterPointDirty = false;\r\n        }\r\n        return this.__centerPoint;\r\n    }\r\n    get lengthCenterToCorner() {\r\n        if (this.__isLengthCenterToCornerDirty) {\r\n            this.__lengthCenterToCorner = _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].lengthBtw(this.centerPoint, this.maxPoint);\r\n            this.__isLengthCenterToCornerDirty = false;\r\n        }\r\n        return this.__lengthCenterToCorner;\r\n    }\r\n    get sizeX() {\r\n        return (this.__max.x - this.__min.x);\r\n    }\r\n    get sizeY() {\r\n        return (this.__max.y - this.__min.y);\r\n    }\r\n    get sizeZ() {\r\n        return (this.__max.z - this.__min.z);\r\n    }\r\n    static multiplyMatrix(matrix, aabb) {\r\n        if (aabb.isVanilla()) {\r\n            return aabb.clone();\r\n        }\r\n        var newAabb = new AABB();\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        newAabb.addPosition(AABB.__tmpVector3);\r\n        return newAabb;\r\n    }\r\n    static multiplyMatrixTo(matrix, aabb, outAabb) {\r\n        if (aabb.isVanilla()) {\r\n            return aabb.clone();\r\n        }\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__min.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__min.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__min.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        AABB.__tmpVector3.x = aabb.__max.x;\r\n        AABB.__tmpVector3.y = aabb.__max.y;\r\n        AABB.__tmpVector3.z = aabb.__max.z;\r\n        matrix.multiplyVector3To(AABB.__tmpVector3, AABB.__tmpVector3);\r\n        outAabb.addPosition(AABB.__tmpVector3);\r\n        return outAabb;\r\n    }\r\n    toString() {\r\n        return 'AABB_min: ' + this.__min + '\\n' + 'AABB_max: ' + this.__max + '\\n'\r\n            + 'centerPoint: ' + this.__centerPoint + '\\n' + 'lengthCenterToCorner: ' + this.__lengthCenterToCorner;\r\n    }\r\n}\r\nAABB.__tmpVector3 = _MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/AABB.ts?");

/***/ }),

/***/ "./src/foundation/math/LogQuaternion.ts":
/*!**********************************************!*\
  !*** ./src/foundation/math/LogQuaternion.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return LogQuaternion; });\n/* harmony import */ var _Quaternion__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n\r\nclass LogQuaternion {\r\n    constructor(x, y, z) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new Float32Array(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new Float32Array(3);\r\n        }\r\n        if (x instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            // for IQuaternion\r\n            const theta = Math.acos(x.w);\r\n            const sin = Math.sin(theta);\r\n            this.v[0] = x.x * (theta / sin);\r\n            this.v[1] = x.y * (theta / sin);\r\n            this.v[2] = x.z * (theta / sin);\r\n        }\r\n        else if (Array.isArray(x)) {\r\n            this.v[0] = x[0];\r\n            this.v[1] = x[1];\r\n            this.v[2] = x[2];\r\n        }\r\n        else if (typeof x === 'number') {\r\n            this.v[0] = x;\r\n            this.v[1] = y;\r\n            this.v[2] = z;\r\n        }\r\n        else {\r\n            this.v[0] = x.v[0];\r\n            this.v[1] = x.v[1];\r\n            this.v[2] = x.v[2];\r\n        }\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    get w() {\r\n        return 1;\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/LogQuaternion.ts?");

/***/ }),

/***/ "./src/foundation/math/MathClassUtil.ts":
/*!**********************************************!*\
  !*** ./src/foundation/math/MathClassUtil.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MathClassUtil; });\n/* harmony import */ var _Vector2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _Vector3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _Vector4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _Quaternion__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n/* harmony import */ var _Matrix33__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Matrix33 */ \"./src/foundation/math/Matrix33.ts\");\n/* harmony import */ var _Matrix44__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _MutableVector4__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _MutableVector3__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _MutableVector2__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./MutableVector2 */ \"./src/foundation/math/MutableVector2.ts\");\n/* harmony import */ var _Scalar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _MutableQuaternion__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./MutableQuaternion */ \"./src/foundation/math/MutableQuaternion.ts\");\n/* harmony import */ var _MutableScalar__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./MutableScalar */ \"./src/foundation/math/MutableScalar.ts\");\n/* harmony import */ var _VectorN__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./VectorN */ \"./src/foundation/math/VectorN.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MathClassUtil {\r\n    constructor() {\r\n    }\r\n    static arrayToVector(element) {\r\n        if (Array.isArray(element)) {\r\n            if (typeof (element[3]) !== 'undefined') {\r\n                return new _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](element[0], element[1], element[2], element[3]);\r\n            }\r\n            else if (typeof (element[2]) !== 'undefined') {\r\n                return new _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](element[0], element[1], element[2]);\r\n            }\r\n            else {\r\n                return new _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"](element[0], element[1]);\r\n            }\r\n        }\r\n        else {\r\n            return element;\r\n        }\r\n    }\r\n    static arrayToVectorOrMatrix(element) {\r\n        if (Array.isArray(element)) {\r\n            if (typeof (element[15]) !== 'undefined') {\r\n                return new _Matrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"](element);\r\n            }\r\n            else if (typeof (element[8]) !== 'undefined') {\r\n                return new _Matrix33__WEBPACK_IMPORTED_MODULE_4__[\"default\"](element);\r\n            }\r\n            else if (typeof (element[3]) !== 'undefined') {\r\n                return new _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](element[0], element[1], element[2], element[3]);\r\n            }\r\n            else if (typeof (element[2]) !== 'undefined') {\r\n                return new _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](element[0], element[1], element[2]);\r\n            }\r\n            else {\r\n                return new _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"](element[0], element[1]);\r\n            }\r\n        }\r\n        else {\r\n            return element;\r\n        }\r\n    }\r\n    static getImmutableValueClass(compositionType) {\r\n        if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec2) {\r\n            return _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec3) {\r\n            return _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec4) {\r\n            return _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Mat3) {\r\n            return _Matrix33__WEBPACK_IMPORTED_MODULE_4__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Mat4) {\r\n            return _Matrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"];\r\n        }\r\n        return void 0;\r\n    }\r\n    static getMutableValueClass(compositionType) {\r\n        if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec2) {\r\n            return _MutableVector2__WEBPACK_IMPORTED_MODULE_11__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec3) {\r\n            return _MutableVector3__WEBPACK_IMPORTED_MODULE_10__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Vec4) {\r\n            return _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Mat3) {\r\n            return _MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"];\r\n        }\r\n        else if (compositionType === _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_6__[\"CompositionType\"].Mat4) {\r\n            return _MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"];\r\n        }\r\n        else {\r\n            return void 0;\r\n        }\r\n    }\r\n    static cloneOfMathObjects(element) {\r\n        if (element instanceof _Matrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\r\n            return element.clone();\r\n        }\r\n        else if (element instanceof _Matrix33__WEBPACK_IMPORTED_MODULE_4__[\"default\"]) {\r\n            return element.clone();\r\n        }\r\n        else if (element instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return element.clone();\r\n        }\r\n        else if (element instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return element.clone();\r\n        }\r\n        else if (element instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return element.clone();\r\n        }\r\n        else {\r\n            return element;\r\n        }\r\n    }\r\n    static isAcceptableArrayForQuaternion(element) {\r\n        if (Array.isArray(element)) {\r\n            if (typeof (element[3]) !== 'undefined') {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    static arrayToQuaternion(element) {\r\n        return new _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"](element[0], element[1], element[2], element[3]);\r\n    }\r\n    static makeSubArray(array, componentN) {\r\n        if (componentN === 4) {\r\n            return [array[0], array[1], array[2], array[3]];\r\n        }\r\n        else if (componentN === 3) {\r\n            return [array[0], array[1], array[2]];\r\n        }\r\n        else if (componentN === 2) {\r\n            return [array[0], array[1]];\r\n        }\r\n        else {\r\n            return array[0];\r\n        }\r\n    }\r\n    static vectorToArray(element) {\r\n        if (element instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return [element.x, element.v];\r\n        }\r\n        else if (element instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return [element.x, element.v, element.z];\r\n        }\r\n        else if (element instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || element instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return [element.x, element.v, element.z, element.w];\r\n        }\r\n        else {\r\n            return element;\r\n        }\r\n    }\r\n    /**\r\n     * discriminate which Vector instance\r\n     * @param element any Vector instance\r\n     * @return number of Vector instance\r\n     */\r\n    static componentNumberOfVector(element) {\r\n        if (element instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return 2;\r\n        }\r\n        else if (element instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return 3;\r\n        }\r\n        else if (element instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || element instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return 4;\r\n        }\r\n        else if (Array.isArray(element)) {\r\n            return element.length;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    // values range must be [-1, 1]\r\n    static packNormalizedVec4ToVec2(x, y, z, w, criteria) {\r\n        let v0 = 0.0;\r\n        let v1 = 0.0;\r\n        x = (x + 1) / 2.0;\r\n        y = (y + 1) / 2.0;\r\n        z = (z + 1) / 2.0;\r\n        w = (w + 1) / 2.0;\r\n        let ir = Math.floor(x * (criteria - 1.0));\r\n        let ig = Math.floor(y * (criteria - 1.0));\r\n        let irg = ir * criteria + ig;\r\n        v0 = irg / criteria;\r\n        let ib = Math.floor(z * (criteria - 1.0));\r\n        let ia = Math.floor(w * (criteria - 1.0));\r\n        let iba = ib * criteria + ia;\r\n        v1 = iba / criteria;\r\n        return [v0, v1];\r\n    }\r\n    static unProjectTo(windowPosX, windowPosY, windowPosZ, inversePVMat44, viewportVec4, out) {\r\n        const input = this.__tmpVector4_0.setComponents((windowPosX - viewportVec4.x) / viewportVec4.z * 2 - 1.0, (windowPosY - viewportVec4.y) / viewportVec4.w * 2 - 1.0, 2 * windowPosZ - 1.0, 1.0);\r\n        const outNonNormalized = inversePVMat44.multiplyVectorTo(input, this.__tmpVector4_1);\r\n        if (outNonNormalized.w === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        return _MutableVector3__WEBPACK_IMPORTED_MODULE_10__[\"default\"].multiplyTo(outNonNormalized, 1.0 / outNonNormalized.w, out);\r\n    }\r\n    static add(lhs, rhs) {\r\n        if (isFinite(lhs)) { // number?\r\n            return lhs + rhs;\r\n        }\r\n        else if (lhs instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].add(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].add(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"].add(lhs, rhs);\r\n        }\r\n        else if (Array.isArray(lhs)) {\r\n            const arr = [];\r\n            for (let i = 0; i < lhs.length; i++) {\r\n                arr[i] = lhs[i] + rhs[i];\r\n            }\r\n            return arr;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return;\r\n        }\r\n    }\r\n    static subtract(lhs, rhs) {\r\n        if (isFinite(lhs)) { // number?\r\n            return lhs - rhs;\r\n        }\r\n        else if (lhs instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].subtract(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].subtract(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"].subtract(lhs, rhs);\r\n        }\r\n        else if (Array.isArray(lhs)) {\r\n            const arr = [];\r\n            for (let i = 0; i < lhs.length; i++) {\r\n                arr[i] = lhs[i] - rhs[i];\r\n            }\r\n            return arr;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return;\r\n        }\r\n    }\r\n    static multiplyNumber(lhs, rhs) {\r\n        if (isFinite(lhs)) { // number?\r\n            return lhs * rhs;\r\n        }\r\n        else if (lhs instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].multiply(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiply(lhs, rhs);\r\n        }\r\n        else if (lhs instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"].multiplyNumber(lhs, rhs);\r\n        }\r\n        else if (Array.isArray(lhs)) {\r\n            const arr = [];\r\n            for (let i = 0; i < lhs.length; i++) {\r\n                arr[i] = lhs[i] * rhs;\r\n            }\r\n            return arr;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return;\r\n        }\r\n    }\r\n    static divideNumber(lhs, rhs) {\r\n        if (isFinite(lhs)) { // number?\r\n            return lhs / rhs;\r\n        }\r\n        else if (lhs instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(lhs, 1 / rhs);\r\n        }\r\n        else if (lhs instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].multiply(lhs, 1 / rhs);\r\n        }\r\n        else if (lhs instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiply(lhs, 1 / rhs);\r\n        }\r\n        else if (lhs instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"].multiplyNumber(lhs, 1 / rhs);\r\n        }\r\n        else if (Array.isArray(lhs)) {\r\n            const arr = [];\r\n            for (let i = 0; i < lhs.length; i++) {\r\n                arr[i] = lhs[i] / rhs;\r\n            }\r\n            return arr;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return;\r\n        }\r\n    }\r\n    static initWithScalar(objForDetectType, val) {\r\n        if (isFinite(objForDetectType)) { // number?\r\n            return val;\r\n        }\r\n        else if (objForDetectType instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) {\r\n            return new _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"](val, val);\r\n        }\r\n        else if (objForDetectType instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            return new _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](val, val, val);\r\n        }\r\n        else if (objForDetectType instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            return new _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](val, val, val, val);\r\n        }\r\n        else if (objForDetectType instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\r\n            return new _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"](0, 0, 0, 1);\r\n        }\r\n        else if (Array.isArray(objForDetectType)) {\r\n            const arr = [];\r\n            for (let i = 0; i < objForDetectType.length; i++) {\r\n                arr[i] = val;\r\n            }\r\n            return arr;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return void 0;\r\n        }\r\n    }\r\n    static initWithFloat32Array(objForDetectType, val, floatArray, compositionType) {\r\n        let obj;\r\n        if (isFinite(objForDetectType)) { // number?\r\n            const array = new Float32Array(floatArray);\r\n            floatArray.v = void 0;\r\n            array[0] = val;\r\n            return new _Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"](array);\r\n        }\r\n        else if (objForDetectType instanceof _Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"] || objForDetectType instanceof _MutableScalar__WEBPACK_IMPORTED_MODULE_14__[\"default\"]) {\r\n            floatArray[0] = val.x;\r\n            obj = new _MutableScalar__WEBPACK_IMPORTED_MODULE_14__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"] || objForDetectType instanceof _MutableVector2__WEBPACK_IMPORTED_MODULE_11__[\"default\"]) {\r\n            floatArray[0] = val.x;\r\n            floatArray[1] = val.y;\r\n            obj = new _MutableVector2__WEBPACK_IMPORTED_MODULE_11__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"] || objForDetectType instanceof _MutableVector3__WEBPACK_IMPORTED_MODULE_10__[\"default\"]) {\r\n            floatArray[0] = val.x;\r\n            floatArray[1] = val.y;\r\n            floatArray[2] = val.z;\r\n            obj = new _MutableVector3__WEBPACK_IMPORTED_MODULE_10__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || objForDetectType instanceof _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"]) {\r\n            floatArray[0] = val.x;\r\n            floatArray[1] = val.y;\r\n            floatArray[2] = val.z;\r\n            floatArray[3] = val.w;\r\n            obj = new _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"] || objForDetectType instanceof _MutableQuaternion__WEBPACK_IMPORTED_MODULE_13__[\"default\"]) {\r\n            floatArray[0] = val.x;\r\n            floatArray[1] = val.y;\r\n            floatArray[2] = val.z;\r\n            floatArray[3] = val.w;\r\n            obj = new _MutableQuaternion__WEBPACK_IMPORTED_MODULE_13__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType instanceof _Matrix33__WEBPACK_IMPORTED_MODULE_4__[\"default\"] || objForDetectType instanceof _MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"]) {\r\n            obj = (obj == null) ? new _MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"](floatArray, false, true) : obj;\r\n            obj.m00 = val.m00;\r\n            obj.m01 = val.m01;\r\n            obj.m02 = val.m02;\r\n            obj.m10 = val.m10;\r\n            obj.m11 = val.m11;\r\n            obj.m12 = val.m12;\r\n            obj.m20 = val.m20;\r\n            obj.m21 = val.m21;\r\n            obj.m22 = val.m22;\r\n        }\r\n        else if (objForDetectType instanceof _Matrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"] || objForDetectType instanceof _MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"]) {\r\n            obj = new _MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"](floatArray, false, true);\r\n            obj.m00 = val.m00;\r\n            obj.m01 = val.m01;\r\n            obj.m02 = val.m02;\r\n            obj.m03 = val.m03;\r\n            obj.m10 = val.m10;\r\n            obj.m11 = val.m11;\r\n            obj.m12 = val.m12;\r\n            obj.m13 = val.m13;\r\n            obj.m20 = val.m20;\r\n            obj.m21 = val.m21;\r\n            obj.m22 = val.m22;\r\n            obj.m23 = val.m23;\r\n            obj.m30 = val.m30;\r\n            obj.m31 = val.m31;\r\n            obj.m32 = val.m32;\r\n            obj.m33 = val.m33;\r\n        }\r\n        else if (objForDetectType instanceof _VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"]) {\r\n            obj = new _VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"](floatArray);\r\n        }\r\n        else if (objForDetectType == null) {\r\n            let vec;\r\n            switch (floatArray.length) {\r\n                case 4:\r\n                    vec = new _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](floatArray);\r\n                    break;\r\n                case 3:\r\n                    vec = new _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](floatArray);\r\n                    break;\r\n                case 2:\r\n                    vec = new _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"](floatArray);\r\n                    break;\r\n                case 1:\r\n                    vec = new _Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"](floatArray);\r\n                    break;\r\n            }\r\n            floatArray.v = void 0;\r\n            return vec;\r\n        }\r\n        else if (Array.isArray(objForDetectType) || ArrayBuffer.isView(objForDetectType) || ArrayBuffer.isView(objForDetectType.v)) {\r\n            return objForDetectType;\r\n        }\r\n        else {\r\n            console.error('Non supported type!');\r\n            return void 0;\r\n        }\r\n        floatArray.v = void 0;\r\n        return obj;\r\n    }\r\n    static _setForce(objForDetectType, val) {\r\n        let obj = objForDetectType;\r\n        if (objForDetectType instanceof _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || objForDetectType instanceof _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n            objForDetectType.v[2] = val.v[2];\r\n            objForDetectType.v[3] = val.v[3];\r\n        }\r\n        else if (objForDetectType instanceof _Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"] || objForDetectType instanceof _MutableVector3__WEBPACK_IMPORTED_MODULE_10__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n            objForDetectType.v[2] = val.v[2];\r\n        }\r\n        else if (objForDetectType instanceof _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"default\"] || objForDetectType instanceof _MutableVector2__WEBPACK_IMPORTED_MODULE_11__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n        }\r\n        else if (objForDetectType instanceof _Scalar__WEBPACK_IMPORTED_MODULE_12__[\"default\"] || objForDetectType instanceof _MutableScalar__WEBPACK_IMPORTED_MODULE_14__[\"default\"]) {\r\n            if (typeof val.v === 'undefined') {\r\n                objForDetectType.v[0] = val;\r\n            }\r\n            else {\r\n                objForDetectType.v[0] = val.v[0];\r\n            }\r\n        }\r\n        else if (objForDetectType instanceof _Matrix33__WEBPACK_IMPORTED_MODULE_4__[\"default\"] || objForDetectType instanceof _MutableMatrix33__WEBPACK_IMPORTED_MODULE_8__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n            objForDetectType.v[2] = val.v[2];\r\n            objForDetectType.v[3] = val.v[3];\r\n            objForDetectType.v[4] = val.v[4];\r\n            objForDetectType.v[5] = val.v[5];\r\n            objForDetectType.v[6] = val.v[6];\r\n            objForDetectType.v[7] = val.v[7];\r\n            objForDetectType.v[8] = val.v[8];\r\n        }\r\n        else if (objForDetectType instanceof _Matrix44__WEBPACK_IMPORTED_MODULE_5__[\"default\"] || objForDetectType instanceof _MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n            objForDetectType.v[2] = val.v[2];\r\n            objForDetectType.v[3] = val.v[3];\r\n            objForDetectType.v[4] = val.v[4];\r\n            objForDetectType.v[5] = val.v[5];\r\n            objForDetectType.v[6] = val.v[6];\r\n            objForDetectType.v[7] = val.v[7];\r\n            objForDetectType.v[8] = val.v[8];\r\n            objForDetectType.v[9] = val.v[9];\r\n            objForDetectType.v[10] = val.v[10];\r\n            objForDetectType.v[11] = val.v[11];\r\n            objForDetectType.v[12] = val.v[12];\r\n            objForDetectType.v[13] = val.v[13];\r\n            objForDetectType.v[14] = val.v[14];\r\n            objForDetectType.v[15] = val.v[15];\r\n        }\r\n        else if (objForDetectType instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_3__[\"default\"] || objForDetectType instanceof _MutableQuaternion__WEBPACK_IMPORTED_MODULE_13__[\"default\"]) {\r\n            objForDetectType.v[0] = val.v[0];\r\n            objForDetectType.v[1] = val.v[1];\r\n            objForDetectType.v[2] = val.v[2];\r\n            objForDetectType.v[3] = val.v[3];\r\n        }\r\n        else if (objForDetectType instanceof _VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"]) {\r\n            let valArray;\r\n            if (val instanceof _VectorN__WEBPACK_IMPORTED_MODULE_15__[\"default\"]) {\r\n                valArray = val.v;\r\n            }\r\n            else {\r\n                valArray = val;\r\n            }\r\n            for (let i = 0; i < valArray.length; i++) {\r\n                objForDetectType.v[i] = valArray[i];\r\n            }\r\n        }\r\n        else if (Array.isArray(objForDetectType)) {\r\n            for (let i = 0; i < objForDetectType.length; i++) {\r\n                objForDetectType[i] = val.v[i];\r\n            }\r\n        }\r\n        else if (!isNaN(objForDetectType.v.length)) {\r\n            for (let i = 0; i < objForDetectType.v.length; i++) {\r\n                if (Array.isArray(val)) {\r\n                    objForDetectType.v[i] = val[i];\r\n                }\r\n                else {\r\n                    objForDetectType.v[i] = val.v[i];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            console.warn('Unknown type _setForce');\r\n        }\r\n        // maybe objForDetectType is number\r\n    }\r\n}\r\nMathClassUtil.__tmpVector4_0 = _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"].zero();\r\nMathClassUtil.__tmpVector4_1 = _MutableVector4__WEBPACK_IMPORTED_MODULE_9__[\"default\"].zero();\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MathClassUtil.ts?");

/***/ }),

/***/ "./src/foundation/math/MathUtil.ts":
/*!*****************************************!*\
  !*** ./src/foundation/math/MathUtil.ts ***!
  \*****************************************/
/*! exports provided: MathUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MathUtil\", function() { return MathUtil; });\n//import GLBoost from '../../globals';\r\nfunction radianToDegree(rad) {\r\n    return rad * 180 / Math.PI;\r\n}\r\nfunction degreeToRadian(deg) {\r\n    return deg * Math.PI / 180;\r\n}\r\n// https://gamedev.stackexchange.com/questions/17326/conversion-of-a-number-from-single-precision-floating-point-representation-to-a/17410#17410\r\nconst toHalfFloat = (function () {\r\n    var floatView = new Float32Array(1);\r\n    var int32View = new Int32Array(floatView.buffer);\r\n    /* This method is faster than the OpenEXR implementation (very often\r\n      * used, eg. in Ogre), with the additional benefit of rounding, inspired\r\n      * by James Tursa?s half-precision code. */\r\n    return function toHalf(val) {\r\n        floatView[0] = val;\r\n        var x = int32View[0];\r\n        var bits = (x >> 16) & 0x8000; /* Get the sign */\r\n        var m = (x >> 12) & 0x07ff; /* Keep one extra bit for rounding */\r\n        var e = (x >> 23) & 0xff; /* Using int is faster here */\r\n        /* If zero, or denormal, or exponent underflows too much for a denormal\r\n          * half, return signed zero. */\r\n        if (e < 103) {\r\n            return bits;\r\n        }\r\n        /* If NaN, return NaN. If Inf or exponent overflow, return Inf. */\r\n        if (e > 142) {\r\n            bits |= 0x7c00;\r\n            /* If exponent was 0xff and one mantissa bit was set, it means NaN,\r\n                  * not Inf, so make sure we set one mantissa bit too. */\r\n            bits |= ((e == 255) ? 0 : 1) && (x & 0x007fffff);\r\n            return bits;\r\n        }\r\n        /* If exponent underflows but not too much, return a denormal */\r\n        if (e < 113) {\r\n            m |= 0x0800;\r\n            /* Extra rounding may overflow and set mantissa to 0 and exponent\r\n              * to 1, which is OK. */\r\n            bits |= (m >> (114 - e)) + ((m >> (113 - e)) & 1);\r\n            return bits;\r\n        }\r\n        bits |= ((e - 112) << 10) | (m >> 1);\r\n        /* Extra rounding. An overflow will set mantissa to 0 and increment\r\n          * the exponent, which is OK. */\r\n        bits += m & 1;\r\n        return bits;\r\n    };\r\n}());\r\n/**\r\n * check whether or not this texture size is power of two.\r\n *\r\n * @param x texture size.\r\n * @returns check whether or not the size x is power of two.\r\n */\r\nfunction isPowerOfTwo(x) {\r\n    return (x & (x - 1)) == 0;\r\n}\r\nfunction isPowerOfTwoTexture(width, height) {\r\n    return isPowerOfTwo(width) && isPowerOfTwo(height);\r\n}\r\n// values range must be [-1, 1]\r\nfunction packNormalizedVec4ToVec2(x, y, z, w, criteria) {\r\n    // range to [0, s1]\r\n    x = (x + 1) / 2.0;\r\n    y = (y + 1) / 2.0;\r\n    z = (z + 1) / 2.0;\r\n    w = (w + 1) / 2.0;\r\n    const ir = Math.floor(x * (criteria - 1.0));\r\n    const ig = Math.floor(y * (criteria - 1.0));\r\n    const irg = ir * criteria + ig;\r\n    const v0 = irg / criteria;\r\n    const ib = Math.floor(z * (criteria - 1.0));\r\n    const ia = Math.floor(w * (criteria - 1.0));\r\n    const iba = ib * criteria + ia;\r\n    const v1 = iba / criteria;\r\n    return [v0, v1];\r\n}\r\nfunction convertToStringAsGLSLFloat(value) {\r\n    if (Number.isInteger(value)) {\r\n        return `${value}.0`;\r\n    }\r\n    else {\r\n        return '' + value;\r\n    }\r\n}\r\nfunction nearZeroToZero(value) {\r\n    if (Math.abs(value) < 0.00001) {\r\n        value = 0;\r\n    }\r\n    else if (0.99999 < value && value < 1.00001) {\r\n        value = 1;\r\n    }\r\n    else if (-1.00001 < value && value < -0.99999) {\r\n        value = -1;\r\n    }\r\n    return value;\r\n}\r\nconst MathUtil = Object.freeze({\r\n    radianToDegree, degreeToRadian, toHalfFloat, isPowerOfTwo, isPowerOfTwoTexture,\r\n    packNormalizedVec4ToVec2, convertToStringAsGLSLFloat, nearZeroToZero\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MathUtil.ts?");

/***/ }),

/***/ "./src/foundation/math/Matrix22.ts":
/*!*****************************************!*\
  !*** ./src/foundation/math/Matrix22.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Matrix22; });\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _Vector2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n\r\n\r\n\r\nclass Matrix22 {\r\n    constructor(m0, m1, m2, m3, isColumnMajor = false, notCopyFloatArray = false) {\r\n        const _isColumnMajor = (arguments.length === 5) ? isColumnMajor : m1;\r\n        const _notCopyFloatArray = (arguments.length === 3) ? notCopyFloatArray : m2;\r\n        const m = m0;\r\n        if (m == null) {\r\n            this.v = new Float32Array(0);\r\n            return;\r\n        }\r\n        if (4 <= arguments.length && arguments.length <= 5 && m3 != null) {\r\n            this.v = new Float32Array(4);\r\n            if (_isColumnMajor === true) {\r\n                let m = arguments;\r\n                this.v[0] = m[0];\r\n                this.v[2] = m[2];\r\n                this.v[1] = m[1];\r\n                this.v[3] = m[3];\r\n            }\r\n            else {\r\n                let m = arguments;\r\n                // arguments[0-3] must be row major values if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[2] = m[1];\r\n                this.v[1] = m[2];\r\n                this.v[3] = m[3];\r\n            }\r\n        }\r\n        else if (Array.isArray(m)) {\r\n            this.v = new Float32Array(4);\r\n            if (_isColumnMajor === true) {\r\n                this.v[0] = m[0];\r\n                this.v[2] = m[2];\r\n                this.v[1] = m[1];\r\n                this.v[3] = m[3];\r\n            }\r\n            else {\r\n                // 'm' must be row major array if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[2] = m[1];\r\n                this.v[1] = m[2];\r\n                this.v[3] = m[3];\r\n            }\r\n        }\r\n        else if (m instanceof Float32Array) {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m;\r\n            }\r\n            else {\r\n                this.v = new Float32Array(4);\r\n                if (_isColumnMajor === true) {\r\n                    this.v[0] = m[0];\r\n                    this.v[2] = m[2];\r\n                    this.v[1] = m[1];\r\n                    this.v[3] = m[3];\r\n                }\r\n                else {\r\n                    // 'm' must be row major array if isColumnMajor is false\r\n                    this.v[0] = m[0];\r\n                    this.v[2] = m[1];\r\n                    this.v[1] = m[2];\r\n                    this.v[3] = m[3];\r\n                }\r\n            }\r\n        }\r\n        else if (!!m && m.v != null && m.v[3] !== null) {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m.v;\r\n            }\r\n            else {\r\n                this.v = new Float32Array(4);\r\n                if (_isColumnMajor === true) {\r\n                    const v = m.v;\r\n                    this.v[0] = m[0];\r\n                    this.v[2] = m[2];\r\n                    this.v[1] = m[1];\r\n                    this.v[3] = m[3];\r\n                }\r\n                else {\r\n                    const v = m.v;\r\n                    // 'm' must be row major array if isColumnMajor is false\r\n                    this.v[0] = m[0];\r\n                    this.v[2] = m[1];\r\n                    this.v[1] = m[2];\r\n                    this.v[3] = m[3];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.v = new Float32Array(4);\r\n            this.v[0] = 1;\r\n            this.v[2] = 0;\r\n            this.v[1] = 0;\r\n            this.v[3] = 1;\r\n        }\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    get m01() {\r\n        return this.v[2];\r\n    }\r\n    get m11() {\r\n        return this.v[3];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_0__[\"CompositionType\"].Mat2;\r\n    }\r\n    /**\r\n     * Create zero matrix\r\n     */\r\n    static zero() {\r\n        return new this(0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return new this(1, 0, 0, 1);\r\n    }\r\n    static dummy() {\r\n        return new this(null);\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return new this(mat.v[0], mat.v[1], mat.v[2], mat.v[3]);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        const det = mat.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = mat.v[3] / det;\r\n        const m01 = mat.v[2] / det * (-1.0);\r\n        const m10 = mat.v[1] / det * (-1.0);\r\n        const m11 = mat.v[0] / det;\r\n        return new this(m00, m01, m10, m11);\r\n    }\r\n    static invertTo(mat, outMat) {\r\n        const det = mat.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = mat.v[3] / det;\r\n        const m01 = mat.v[2] / det * (-1.0);\r\n        const m10 = mat.v[1] / det * (-1.0);\r\n        const m11 = mat.v[0] / det;\r\n        return outMat.setComponents(m00, m01, m10, m11);\r\n    }\r\n    /**\r\n     * Create Rotation Matrix\r\n     */\r\n    static rotate(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(cos, -sin, sin, cos);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return new this(vec.v[0], 0, 0, vec.v[1]);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[2] * r_mat.v[1];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[3] * r_mat.v[1];\r\n        const m01 = l_mat.v[0] * r_mat.v[2] + l_mat.v[2] * r_mat.v[3];\r\n        const m11 = l_mat.v[1] * r_mat.v[2] + l_mat.v[3] * r_mat.v[3];\r\n        return new this(m00, m01, m10, m11);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiplyTo(l_mat, r_mat, outMat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[2] * r_mat.v[1];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[3] * r_mat.v[1];\r\n        const m01 = l_mat.v[0] * r_mat.v[2] + l_mat.v[2] * r_mat.v[3];\r\n        const m11 = l_mat.v[1] * r_mat.v[2] + l_mat.v[3] * r_mat.v[3];\r\n        return outMat.setComponents(m00, m01, m10, m11);\r\n    }\r\n    toString() {\r\n        return this.v[0] + ' ' + this.v[2] + '\\n' +\r\n            this.v[1] + ' ' + this.v[3] + ' \\n';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[2]) + '\\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[1]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[3]) + ' \\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1],\r\n            this.v[2], this.v[3]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(mat, delta = Number.EPSILON) {\r\n        if (Math.abs(mat.v[0] - this.v[0]) < delta &&\r\n            Math.abs(mat.v[1] - this.v[1]) < delta &&\r\n            Math.abs(mat.v[2] - this.v[2]) < delta &&\r\n            Math.abs(mat.v[3] - this.v[3]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(mat) {\r\n        if (mat.v[0] === this.v[0] && mat.v[1] === this.v[1] &&\r\n            mat.v[2] === this.v[2] && mat.v[3] === this.v[3]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(row_i, column_i) {\r\n        return this.v[row_i + column_i * 2];\r\n    }\r\n    determinant() {\r\n        return this.v[0] * this.v[3] - this.v[1] * this.v[2];\r\n    }\r\n    multiplyVector(vec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[2] * vec.v[1];\r\n        const y = this.v[1] * vec.v[0] + this.v[3] * vec.v[1];\r\n        return new vec.constructor(x, y);\r\n    }\r\n    multiplyVectorTo(vec, outVec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[2] * vec.v[1];\r\n        const y = this.v[1] * vec.v[0] + this.v[3] * vec.v[1];\r\n        outVec.v[0] = x;\r\n        outVec.v[1] = y;\r\n        return outVec;\r\n    }\r\n    getScale() {\r\n        return new _Vector2__WEBPACK_IMPORTED_MODULE_1__[\"default\"](Math.hypot(this.m00, this.m01), Math.hypot(this.m10, this.m11));\r\n    }\r\n    getScaleTo(outVec) {\r\n        outVec.v[0] = Math.hypot(this.v[0], this.v[2]);\r\n        outVec.v[1] = Math.hypot(this.v[1], this.v[3]);\r\n        return outVec;\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[2], this.v[1], this.v[3]);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Matrix22.ts?");

/***/ }),

/***/ "./src/foundation/math/Matrix33.ts":
/*!*****************************************!*\
  !*** ./src/foundation/math/Matrix33.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Matrix33; });\n/* harmony import */ var _Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n\r\n\r\n\r\nclass Matrix33 {\r\n    constructor(m0, m1, m2, m3, m4, m5, m6, m7, m8, isColumnMajor = false, notCopyFloatArray = false) {\r\n        const _isColumnMajor = (arguments.length === 10) ? isColumnMajor : m1;\r\n        const _notCopyFloatArray = (arguments.length === 3) ? notCopyFloatArray : m2;\r\n        const m = m0;\r\n        if (m == null) {\r\n            this.v = new Float32Array(0);\r\n            return;\r\n        }\r\n        if (9 <= arguments.length && arguments.length <= 10 && m8 != null) {\r\n            this.v = new Float32Array(9);\r\n            if (_isColumnMajor === true) {\r\n                let m = arguments;\r\n                this.v[0] = m[0];\r\n                this.v[3] = m[3];\r\n                this.v[6] = m[6];\r\n                this.v[1] = m[1];\r\n                this.v[4] = m[4];\r\n                this.v[7] = m[7];\r\n                this.v[2] = m[2];\r\n                this.v[5] = m[5];\r\n                this.v[8] = m[8];\r\n            }\r\n            else {\r\n                let m = arguments;\r\n                // arguments[0-8] must be row major values if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[3] = m[1];\r\n                this.v[6] = m[2];\r\n                this.v[1] = m[3];\r\n                this.v[4] = m[4];\r\n                this.v[7] = m[5];\r\n                this.v[2] = m[6];\r\n                this.v[5] = m[7];\r\n                this.v[8] = m[8];\r\n            }\r\n        }\r\n        else if (Array.isArray(m)) {\r\n            this.v = new Float32Array(9);\r\n            if (_isColumnMajor === true) {\r\n                this.v[0] = m[0];\r\n                this.v[3] = m[3];\r\n                this.v[6] = m[6];\r\n                this.v[1] = m[1];\r\n                this.v[4] = m[4];\r\n                this.v[7] = m[7];\r\n                this.v[2] = m[2];\r\n                this.v[5] = m[5];\r\n                this.v[8] = m[8];\r\n            }\r\n            else {\r\n                // 'm' must be row major array if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[3] = m[1];\r\n                this.v[6] = m[2];\r\n                this.v[1] = m[3];\r\n                this.v[4] = m[4];\r\n                this.v[7] = m[5];\r\n                this.v[2] = m[6];\r\n                this.v[5] = m[7];\r\n                this.v[8] = m[8];\r\n            }\r\n        }\r\n        else if (m instanceof Float32Array) {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m;\r\n            }\r\n            else {\r\n                this.v = new Float32Array(9);\r\n                if (_isColumnMajor === true) {\r\n                    this.v[0] = m[0];\r\n                    this.v[3] = m[3];\r\n                    this.v[6] = m[6];\r\n                    this.v[1] = m[1];\r\n                    this.v[4] = m[4];\r\n                    this.v[7] = m[7];\r\n                    this.v[2] = m[2];\r\n                    this.v[5] = m[5];\r\n                    this.v[8] = m[8];\r\n                }\r\n                else {\r\n                    // 'm' must be row major array if isColumnMajor is false\r\n                    this.v[0] = m[0];\r\n                    this.v[3] = m[1];\r\n                    this.v[6] = m[2];\r\n                    this.v[1] = m[3];\r\n                    this.v[4] = m[4];\r\n                    this.v[7] = m[5];\r\n                    this.v[2] = m[6];\r\n                    this.v[5] = m[7];\r\n                    this.v[8] = m[8];\r\n                }\r\n            }\r\n        }\r\n        else if (!!m && m.v != null && m.v[8] !== null) {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m.v;\r\n            }\r\n            else {\r\n                this.v = new Float32Array(9);\r\n                const v = m.v;\r\n                this.v[0] = v[0];\r\n                this.v[3] = v[3];\r\n                this.v[6] = v[6];\r\n                this.v[1] = v[1];\r\n                this.v[4] = v[4];\r\n                this.v[7] = v[7];\r\n                this.v[2] = v[2];\r\n                this.v[5] = v[5];\r\n                this.v[8] = v[8];\r\n            }\r\n        }\r\n        else if (!!m && typeof m.className !== 'undefined' && m.className === 'Quaternion') {\r\n            this.v = new Float32Array(9);\r\n            const q = m;\r\n            const sx = q.v[0] * q.v[0];\r\n            const sy = q.v[1] * q.v[1];\r\n            const sz = q.v[2] * q.v[2];\r\n            const cx = q.v[1] * q.v[2];\r\n            const cy = q.v[0] * q.v[2];\r\n            const cz = q.v[0] * q.v[1];\r\n            const wx = q.v[3] * q.v[0];\r\n            const wy = q.v[3] * q.v[1];\r\n            const wz = q.v[3] * q.v[2];\r\n            this.v[0] = 1.0 - 2.0 * (sy + sz);\r\n            this.v[3] = 2.0 * (cz - wz);\r\n            this.v[6] = 2.0 * (cy + wy);\r\n            this.v[1] = 2.0 * (cz + wz);\r\n            this.v[4] = 1.0 - 2.0 * (sx + sz);\r\n            this.v[7] = 2.0 * (cx - wx);\r\n            this.v[2] = 2.0 * (cy - wy);\r\n            this.v[5] = 2.0 * (cx + wx);\r\n            this.v[8] = 1.0 - 2.0 * (sx + sy);\r\n        }\r\n        else {\r\n            this.v = new Float32Array(9);\r\n            this.v[0] = 1;\r\n            this.v[3] = 0;\r\n            this.v[6] = 0;\r\n            this.v[1] = 0;\r\n            this.v[4] = 1;\r\n            this.v[7] = 0;\r\n            this.v[2] = 0;\r\n            this.v[5] = 0;\r\n            this.v[8] = 1;\r\n        }\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    get m20() {\r\n        return this.v[2];\r\n    }\r\n    get m01() {\r\n        return this.v[3];\r\n    }\r\n    get m11() {\r\n        return this.v[4];\r\n    }\r\n    get m21() {\r\n        return this.v[5];\r\n    }\r\n    get m02() {\r\n        return this.v[6];\r\n    }\r\n    get m12() {\r\n        return this.v[7];\r\n    }\r\n    get m22() {\r\n        return this.v[8];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Mat3;\r\n    }\r\n    /**\r\n     * zero matrix(static version)\r\n     */\r\n    static zero() {\r\n        return new this(0, 0, 0, 0, 0, 0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return new this(1, 0, 0, 0, 1, 0, 0, 0, 1);\r\n    }\r\n    static dummy() {\r\n        return new this(null);\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return new this(mat.v[0], mat.v[1], mat.v[2], mat.v[3], mat.v[4], mat.v[5], mat.v[6], mat.v[7], mat.v[8]);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        const det = mat.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = (mat.v[4] * mat.v[8] - mat.v[7] * mat.v[5]) / det;\r\n        const m01 = (mat.v[6] * mat.v[5] - mat.v[3] * mat.v[8]) / det;\r\n        const m02 = (mat.v[3] * mat.v[7] - mat.v[6] * mat.v[4]) / det;\r\n        const m10 = (mat.v[7] * mat.v[2] - mat.v[1] * mat.v[8]) / det;\r\n        const m11 = (mat.v[0] * mat.v[8] - mat.v[6] * mat.v[2]) / det;\r\n        const m12 = (mat.v[6] * mat.v[1] - mat.v[0] * mat.v[7]) / det;\r\n        const m20 = (mat.v[1] * mat.v[5] - mat.v[4] * mat.v[2]) / det;\r\n        const m21 = (mat.v[3] * mat.v[2] - mat.v[0] * mat.v[5]) / det;\r\n        const m22 = (mat.v[0] * mat.v[4] - mat.v[3] * mat.v[1]) / det;\r\n        return new this(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    static invertTo(mat, outMat) {\r\n        const det = mat.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = (mat.v[4] * mat.v[8] - mat.v[7] * mat.v[5]) / det;\r\n        const m01 = (mat.v[6] * mat.v[5] - mat.v[3] * mat.v[8]) / det;\r\n        const m02 = (mat.v[3] * mat.v[7] - mat.v[6] * mat.v[4]) / det;\r\n        const m10 = (mat.v[7] * mat.v[2] - mat.v[1] * mat.v[8]) / det;\r\n        const m11 = (mat.v[0] * mat.v[8] - mat.v[6] * mat.v[2]) / det;\r\n        const m12 = (mat.v[6] * mat.v[1] - mat.v[0] * mat.v[7]) / det;\r\n        const m20 = (mat.v[1] * mat.v[5] - mat.v[4] * mat.v[2]) / det;\r\n        const m21 = (mat.v[3] * mat.v[2] - mat.v[0] * mat.v[5]) / det;\r\n        const m22 = (mat.v[0] * mat.v[4] - mat.v[3] * mat.v[1]) / det;\r\n        return outMat.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    /**\r\n   * Create X oriented Rotation Matrix\r\n   */\r\n    static rotateX(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(1, 0, 0, 0, cos, -sin, 0, sin, cos);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    static rotateY(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(cos, 0, sin, 0, 1, 0, -sin, 0, cos);\r\n    }\r\n    /**\r\n     * Create Z oriented Rotation Matrix\r\n     */\r\n    static rotateZ(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(cos, -sin, 0, sin, cos, 0, 0, 0, 1);\r\n    }\r\n    static rotateXYZ(x, y, z) {\r\n        const cosX = Math.cos(x);\r\n        const sinX = Math.sin(x);\r\n        const cosY = Math.cos(y);\r\n        const sinY = Math.sin(y);\r\n        const cosZ = Math.cos(z);\r\n        const sinZ = Math.sin(z);\r\n        // const x00 = 1;\r\n        // const x01 = 0;\r\n        // const x02 = 0;\r\n        // const x10 = 0;\r\n        const x11 = cosX;\r\n        const x12 = -sinX;\r\n        // const x20 = 0;\r\n        const x21 = sinX;\r\n        const x22 = cosX;\r\n        const y00 = cosY;\r\n        // const y01 = 0;\r\n        const y02 = sinY;\r\n        // const y10 = 0;\r\n        // const y11 = 1;\r\n        // const y12 = 0;\r\n        const y20 = -sinY;\r\n        // const y21 = 0;\r\n        const y22 = cosY;\r\n        const z00 = cosZ;\r\n        const z01 = -sinZ;\r\n        // const z02 = 0;\r\n        const z10 = sinZ;\r\n        const z11 = cosZ;\r\n        // const z12 = 0;\r\n        // const z20 = 0;\r\n        // const z21 = 0;\r\n        // const z22 = 1;\r\n        // calculate this.multiply(this.rotateY(y), this.rotateX(x))\r\n        const yx00 = y00;\r\n        const yx01 = y02 * x21;\r\n        const yx02 = y02 * x22;\r\n        //const yx10 = 0;\r\n        const yx11 = x11;\r\n        const yx12 = x12;\r\n        const yx20 = y20;\r\n        const yx21 = y22 * x21;\r\n        const yx22 = y22 * x22;\r\n        // calculate this.multiply(this.rotateZ(z), this.multiply(this.rotateY(y), this.rotateX(x)))\r\n        const m00 = z00 * yx00;\r\n        const m01 = z00 * yx01 + z01 * yx11;\r\n        const m02 = z00 * yx02 + z01 * yx12;\r\n        const m10 = z10 * yx00;\r\n        const m11 = z10 * yx01 + z11 * yx11;\r\n        const m12 = z10 * yx02 + z11 * yx12;\r\n        const m20 = yx20;\r\n        const m21 = yx21;\r\n        const m22 = yx22;\r\n        return new this(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    static rotate(vec) {\r\n        return this.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return new this(vec.v[0], 0, 0, 0, vec.v[1], 0, 0, 0, vec.v[2]);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[3] * r_mat.v[1] + l_mat.v[6] * r_mat.v[2];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[4] * r_mat.v[1] + l_mat.v[7] * r_mat.v[2];\r\n        const m20 = l_mat.v[2] * r_mat.v[0] + l_mat.v[5] * r_mat.v[1] + l_mat.v[8] * r_mat.v[2];\r\n        const m01 = l_mat.v[0] * r_mat.v[3] + l_mat.v[3] * r_mat.v[4] + l_mat.v[6] * r_mat.v[5];\r\n        const m11 = l_mat.v[1] * r_mat.v[3] + l_mat.v[4] * r_mat.v[4] + l_mat.v[7] * r_mat.v[5];\r\n        const m21 = l_mat.v[2] * r_mat.v[3] + l_mat.v[5] * r_mat.v[4] + l_mat.v[8] * r_mat.v[5];\r\n        const m02 = l_mat.v[0] * r_mat.v[6] + l_mat.v[3] * r_mat.v[7] + l_mat.v[6] * r_mat.v[8];\r\n        const m12 = l_mat.v[1] * r_mat.v[6] + l_mat.v[4] * r_mat.v[7] + l_mat.v[7] * r_mat.v[8];\r\n        const m22 = l_mat.v[2] * r_mat.v[6] + l_mat.v[5] * r_mat.v[7] + l_mat.v[8] * r_mat.v[8];\r\n        return new this(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiplyTo(l_mat, r_mat, outMat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[3] * r_mat.v[1] + l_mat.v[6] * r_mat.v[2];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[4] * r_mat.v[1] + l_mat.v[7] * r_mat.v[2];\r\n        const m20 = l_mat.v[2] * r_mat.v[0] + l_mat.v[5] * r_mat.v[1] + l_mat.v[8] * r_mat.v[2];\r\n        const m01 = l_mat.v[0] * r_mat.v[3] + l_mat.v[3] * r_mat.v[4] + l_mat.v[6] * r_mat.v[5];\r\n        const m11 = l_mat.v[1] * r_mat.v[3] + l_mat.v[4] * r_mat.v[4] + l_mat.v[7] * r_mat.v[5];\r\n        const m21 = l_mat.v[2] * r_mat.v[3] + l_mat.v[5] * r_mat.v[4] + l_mat.v[8] * r_mat.v[5];\r\n        const m02 = l_mat.v[0] * r_mat.v[6] + l_mat.v[3] * r_mat.v[7] + l_mat.v[6] * r_mat.v[8];\r\n        const m12 = l_mat.v[1] * r_mat.v[6] + l_mat.v[4] * r_mat.v[7] + l_mat.v[7] * r_mat.v[8];\r\n        const m22 = l_mat.v[2] * r_mat.v[6] + l_mat.v[5] * r_mat.v[7] + l_mat.v[8] * r_mat.v[8];\r\n        return outMat.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    toString() {\r\n        return this.v[0] + ' ' + this.v[3] + ' ' + this.v[6] + '\\n' +\r\n            this.v[1] + ' ' + this.v[4] + ' ' + this.v[7] + '\\n' +\r\n            this.v[2] + ' ' + this.v[5] + ' ' + this.v[8] + '\\n';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[3]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[6]) + '\\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[1]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[4]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[7]) + ' \\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[2]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[5]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_2__[\"MathUtil\"].nearZeroToZero(this.v[8]) + '\\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1], this.v[2],\r\n            this.v[3], this.v[4], this.v[5],\r\n            this.v[6], this.v[7], this.v[8]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(mat, delta = Number.EPSILON) {\r\n        if (Math.abs(mat.v[0] - this.v[0]) < delta &&\r\n            Math.abs(mat.v[1] - this.v[1]) < delta &&\r\n            Math.abs(mat.v[2] - this.v[2]) < delta &&\r\n            Math.abs(mat.v[3] - this.v[3]) < delta &&\r\n            Math.abs(mat.v[4] - this.v[4]) < delta &&\r\n            Math.abs(mat.v[5] - this.v[5]) < delta &&\r\n            Math.abs(mat.v[6] - this.v[6]) < delta &&\r\n            Math.abs(mat.v[7] - this.v[7]) < delta &&\r\n            Math.abs(mat.v[8] - this.v[8]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(mat) {\r\n        if (mat.v[0] === this.v[0] && mat.v[1] === this.v[1] && mat.v[2] === this.v[2] &&\r\n            mat.v[3] === this.v[3] && mat.v[4] === this.v[4] && mat.v[5] === this.v[5] &&\r\n            mat.v[6] === this.v[6] && mat.v[7] === this.v[7] && mat.v[8] === this.v[8]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(row_i, column_i) {\r\n        return this.v[row_i + column_i * 3];\r\n    }\r\n    determinant() {\r\n        return this.v[0] * this.v[4] * this.v[8] + this.v[1] * this.v[5] * this.v[6] + this.v[2] * this.v[3] * this.v[7]\r\n            - this.v[0] * this.v[5] * this.v[7] - this.v[2] * this.v[4] * this.v[6] - this.v[1] * this.v[3] * this.v[8];\r\n    }\r\n    multiplyVector(vec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[3] * vec.v[1] + this.v[6] * vec.v[2];\r\n        const y = this.v[1] * vec.v[0] + this.v[4] * vec.v[1] + this.v[7] * vec.v[2];\r\n        const z = this.v[2] * vec.v[0] + this.v[5] * vec.v[1] + this.v[8] * vec.v[2];\r\n        return new vec.constructor(x, y, z);\r\n    }\r\n    multiplyVectorTo(vec, outVec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[3] * vec.v[1] + this.v[6] * vec.v[2];\r\n        const y = this.v[1] * vec.v[0] + this.v[4] * vec.v[1] + this.v[7] * vec.v[2];\r\n        const z = this.v[2] * vec.v[0] + this.v[5] * vec.v[1] + this.v[8] * vec.v[2];\r\n        outVec.v[0] = x;\r\n        outVec.v[1] = y;\r\n        outVec.v[2] = z;\r\n        return outVec;\r\n    }\r\n    getScale() {\r\n        return new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](Math.hypot(this.v[0], this.v[3], this.v[6]), Math.hypot(this.v[1], this.v[4], this.v[7]), Math.hypot(this.v[2], this.v[5], this.v[8]));\r\n    }\r\n    getScaleTo(outVec) {\r\n        outVec.v[0] = Math.hypot(this.v[0], this.v[3], this.v[6]);\r\n        outVec.v[1] = Math.hypot(this.v[1], this.v[4], this.v[7]);\r\n        outVec.v[2] = Math.hypot(this.v[2], this.v[5], this.v[8]);\r\n        return outVec;\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[3], this.v[6], this.v[1], this.v[4], this.v[7], this.v[2], this.v[5], this.v[8]);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Matrix33.ts?");

/***/ }),

/***/ "./src/foundation/math/Matrix44.ts":
/*!*****************************************!*\
  !*** ./src/foundation/math/Matrix44.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Matrix44; });\n/* harmony import */ var _Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _Quaternion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n/* harmony import */ var _Vector4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n\r\n\r\n\r\n\r\n\r\nconst FloatArray = Float32Array;\r\nclass Matrix44 {\r\n    constructor(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, m13, m14, m15, isColumnMajor = false, notCopyFloatArray = false) {\r\n        const _isColumnMajor = (arguments.length >= 16) ? isColumnMajor : m1;\r\n        const _notCopyFloatArray = (arguments.length >= 16) ? notCopyFloatArray : m2;\r\n        const m = m0;\r\n        if (m == null) {\r\n            this.v = new FloatArray(0);\r\n            return;\r\n        }\r\n        if (arguments.length >= 16 && arguments[3] != null) {\r\n            this.v = new FloatArray(16); // Data order is column major\r\n            let m = arguments;\r\n            if (_isColumnMajor === true) {\r\n                this.v[0] = m[0];\r\n                this.v[4] = m[4];\r\n                this.v[8] = m[8];\r\n                this.v[12] = m[12];\r\n                this.v[1] = m[1];\r\n                this.v[5] = m[5];\r\n                this.v[9] = m[9];\r\n                this.v[13] = m[13];\r\n                this.v[2] = m[2];\r\n                this.v[6] = m[6];\r\n                this.v[10] = m[10];\r\n                this.v[14] = m[14];\r\n                this.v[3] = m[3];\r\n                this.v[7] = m[7];\r\n                this.v[11] = m[11];\r\n                this.v[15] = m[15];\r\n            }\r\n            else {\r\n                // arguments[0-15] must be row major values if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[4] = m[1];\r\n                this.v[8] = m[2];\r\n                this.v[12] = m[3];\r\n                this.v[1] = m[4];\r\n                this.v[5] = m[5];\r\n                this.v[9] = m[6];\r\n                this.v[13] = m[7];\r\n                this.v[2] = m[8];\r\n                this.v[6] = m[9];\r\n                this.v[10] = m[10];\r\n                this.v[14] = m[11];\r\n                this.v[3] = m[12];\r\n                this.v[7] = m[13];\r\n                this.v[11] = m[14];\r\n                this.v[15] = m[15];\r\n            }\r\n        }\r\n        else if (Array.isArray(m)) {\r\n            this.v = new FloatArray(16);\r\n            if (_isColumnMajor === true) {\r\n                this.v[0] = m[0];\r\n                this.v[4] = m[4];\r\n                this.v[8] = m[8];\r\n                this.v[12] = m[12];\r\n                this.v[1] = m[1];\r\n                this.v[5] = m[5];\r\n                this.v[9] = m[9];\r\n                this.v[13] = m[13];\r\n                this.v[2] = m[2];\r\n                this.v[6] = m[6];\r\n                this.v[10] = m[10];\r\n                this.v[14] = m[14];\r\n                this.v[3] = m[3];\r\n                this.v[7] = m[7];\r\n                this.v[11] = m[11];\r\n                this.v[15] = m[15];\r\n            }\r\n            else {\r\n                // 'm' must be row major values if isColumnMajor is false\r\n                this.v[0] = m[0];\r\n                this.v[4] = m[1];\r\n                this.v[8] = m[2];\r\n                this.v[12] = m[3];\r\n                this.v[1] = m[4];\r\n                this.v[5] = m[5];\r\n                this.v[9] = m[6];\r\n                this.v[13] = m[7];\r\n                this.v[2] = m[8];\r\n                this.v[6] = m[9];\r\n                this.v[10] = m[10];\r\n                this.v[14] = m[11];\r\n                this.v[3] = m[12];\r\n                this.v[7] = m[13];\r\n                this.v[11] = m[14];\r\n                this.v[15] = m[15];\r\n            }\r\n        }\r\n        else if (m instanceof FloatArray) {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m;\r\n            }\r\n            else {\r\n                this.v = new FloatArray(16);\r\n                if (_isColumnMajor === true) {\r\n                    this.v[0] = m[0];\r\n                    this.v[4] = m[4];\r\n                    this.v[8] = m[8];\r\n                    this.v[12] = m[12];\r\n                    this.v[1] = m[1];\r\n                    this.v[5] = m[5];\r\n                    this.v[9] = m[9];\r\n                    this.v[13] = m[13];\r\n                    this.v[2] = m[2];\r\n                    this.v[6] = m[6];\r\n                    this.v[10] = m[10];\r\n                    this.v[14] = m[14];\r\n                    this.v[3] = m[3];\r\n                    this.v[7] = m[7];\r\n                    this.v[11] = m[11];\r\n                    this.v[15] = m[15];\r\n                }\r\n                else {\r\n                    // 'm' must be row major values if isColumnMajor is false\r\n                    this.v[0] = m[0];\r\n                    this.v[4] = m[1];\r\n                    this.v[8] = m[2];\r\n                    this.v[12] = m[3];\r\n                    this.v[1] = m[4];\r\n                    this.v[5] = m[5];\r\n                    this.v[9] = m[6];\r\n                    this.v[13] = m[7];\r\n                    this.v[2] = m[8];\r\n                    this.v[6] = m[9];\r\n                    this.v[10] = m[10];\r\n                    this.v[14] = m[11];\r\n                    this.v[3] = m[12];\r\n                    this.v[7] = m[13];\r\n                    this.v[11] = m[14];\r\n                    this.v[15] = m[15];\r\n                }\r\n            }\r\n        }\r\n        else if (!!m && typeof m.v[15] !== 'undefined' && typeof m.v[10] !== 'undefined') {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m.v;\r\n            }\r\n            else {\r\n                this.v = new FloatArray(16);\r\n                const v = m.v;\r\n                this.v[0] = v[0];\r\n                this.v[4] = v[4];\r\n                this.v[8] = v[8];\r\n                this.v[12] = v[12];\r\n                this.v[1] = v[1];\r\n                this.v[5] = v[5];\r\n                this.v[9] = v[9];\r\n                this.v[13] = v[13];\r\n                this.v[2] = v[2];\r\n                this.v[6] = v[6];\r\n                this.v[10] = v[10];\r\n                this.v[14] = v[14];\r\n                this.v[3] = v[3];\r\n                this.v[7] = v[7];\r\n                this.v[11] = v[11];\r\n                this.v[15] = v[15];\r\n            }\r\n        }\r\n        else if (!!m && typeof m.v[15] === 'undefined' && typeof m.v[10] !== 'undefined') {\r\n            if (_notCopyFloatArray) {\r\n                this.v = m.v;\r\n            }\r\n            else {\r\n                this.v = new FloatArray(16);\r\n                const v = m.v;\r\n                this.v[0] = v[0];\r\n                this.v[4] = v[3];\r\n                this.v[8] = v[6];\r\n                this.v[12] = 0;\r\n                this.v[1] = v[1];\r\n                this.v[5] = v[4];\r\n                this.v[9] = v[7];\r\n                this.v[13] = 0;\r\n                this.v[2] = v[2];\r\n                this.v[6] = v[5];\r\n                this.v[10] = v[8];\r\n                this.v[14] = 0;\r\n                this.v[3] = 0;\r\n                this.v[7] = 0;\r\n                this.v[11] = 0;\r\n                this.v[15] = 1;\r\n            }\r\n        }\r\n        else if (!!m && typeof m.className !== 'undefined' && m instanceof _Quaternion__WEBPACK_IMPORTED_MODULE_1__[\"default\"]) {\r\n            this.v = new FloatArray(16);\r\n            const sx = m.v[0] * m.v[0];\r\n            const sy = m.v[1] * m.v[1];\r\n            const sz = m.v[2] * m.v[2];\r\n            const cx = m.v[1] * m.v[2];\r\n            const cy = m.v[0] * m.v[2];\r\n            const cz = m.v[0] * m.v[1];\r\n            const wx = m.v[3] * m.v[0];\r\n            const wy = m.v[3] * m.v[1];\r\n            const wz = m.v[3] * m.v[2];\r\n            this.v[0] = 1.0 - 2.0 * (sy + sz);\r\n            this.v[4] = 2.0 * (cz - wz);\r\n            this.v[8] = 2.0 * (cy + wy);\r\n            this.v[12] = 0;\r\n            this.v[1] = 2.0 * (cz + wz);\r\n            this.v[5] = 1.0 - 2.0 * (sx + sz);\r\n            this.v[9] = 2.0 * (cx - wx);\r\n            this.v[13] = 0;\r\n            this.v[2] = 2.0 * (cy - wy);\r\n            this.v[6] = 2.0 * (cx + wx);\r\n            this.v[10] = 1.0 - 2.0 * (sx + sy);\r\n            this.v[14] = 0;\r\n            this.v[3] = 0;\r\n            this.v[7] = 0;\r\n            this.v[11] = 0;\r\n            this.v[15] = 1;\r\n        }\r\n        else {\r\n            this.v = new FloatArray(16);\r\n            this.v[0] = 1;\r\n            this.v[4] = 0;\r\n            this.v[8] = 0;\r\n            this.v[12] = 0;\r\n            this.v[1] = 0;\r\n            this.v[5] = 1;\r\n            this.v[9] = 0;\r\n            this.v[13] = 0;\r\n            this.v[2] = 0;\r\n            this.v[6] = 0;\r\n            this.v[10] = 1;\r\n            this.v[14] = 0;\r\n            this.v[3] = 0;\r\n            this.v[7] = 0;\r\n            this.v[11] = 0;\r\n            this.v[15] = 1;\r\n        }\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    get m20() {\r\n        return this.v[2];\r\n    }\r\n    get m30() {\r\n        return this.v[3];\r\n    }\r\n    get m01() {\r\n        return this.v[4];\r\n    }\r\n    get m11() {\r\n        return this.v[5];\r\n    }\r\n    get m21() {\r\n        return this.v[6];\r\n    }\r\n    get m31() {\r\n        return this.v[7];\r\n    }\r\n    get m02() {\r\n        return this.v[8];\r\n    }\r\n    get m12() {\r\n        return this.v[9];\r\n    }\r\n    get m22() {\r\n        return this.v[10];\r\n    }\r\n    get m32() {\r\n        return this.v[11];\r\n    }\r\n    get m03() {\r\n        return this.v[12];\r\n    }\r\n    get m13() {\r\n        return this.v[13];\r\n    }\r\n    get m23() {\r\n        return this.v[14];\r\n    }\r\n    get m33() {\r\n        return this.v[15];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Mat4;\r\n    }\r\n    /**\r\n     * zero matrix(static version)\r\n     */\r\n    static zero() {\r\n        return new this(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return new this(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n    }\r\n    static dummy() {\r\n        return new this(null);\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return new this(mat.v[0], mat.v[1], mat.v[2], mat.v[3], mat.v[4], mat.v[5], mat.v[6], mat.v[7], mat.v[8], mat.v[9], mat.v[10], mat.v[11], mat.v[12], mat.v[13], mat.v[14], mat.v[15]);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        const n00 = mat.v[0] * mat.v[5] - mat.v[4] * mat.v[1];\r\n        const n01 = mat.v[0] * mat.v[9] - mat.v[8] * mat.v[1];\r\n        const n02 = mat.v[0] * mat.v[13] - mat.v[12] * mat.v[1];\r\n        const n03 = mat.v[4] * mat.v[9] - mat.v[8] * mat.v[5];\r\n        const n04 = mat.v[4] * mat.v[13] - mat.v[12] * mat.v[5];\r\n        const n05 = mat.v[8] * mat.v[13] - mat.v[12] * mat.v[9];\r\n        const n06 = mat.v[2] * mat.v[7] - mat.v[6] * mat.v[3];\r\n        const n07 = mat.v[2] * mat.v[11] - mat.v[10] * mat.v[3];\r\n        const n08 = mat.v[2] * mat.v[15] - mat.v[14] * mat.v[3];\r\n        const n09 = mat.v[6] * mat.v[11] - mat.v[10] * mat.v[7];\r\n        const n10 = mat.v[6] * mat.v[15] - mat.v[14] * mat.v[7];\r\n        const n11 = mat.v[10] * mat.v[15] - mat.v[14] * mat.v[11];\r\n        const det = n00 * n11 - n01 * n10 + n02 * n09 + n03 * n08 - n04 * n07 + n05 * n06;\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = (mat.v[5] * n11 - mat.v[9] * n10 + mat.v[13] * n09) / det;\r\n        const m01 = (mat.v[8] * n10 - mat.v[4] * n11 - mat.v[12] * n09) / det;\r\n        const m02 = (mat.v[7] * n05 - mat.v[11] * n04 + mat.v[15] * n03) / det;\r\n        const m03 = (mat.v[10] * n04 - mat.v[6] * n05 - mat.v[14] * n03) / det;\r\n        const m10 = (mat.v[9] * n08 - mat.v[1] * n11 - mat.v[13] * n07) / det;\r\n        const m11 = (mat.v[0] * n11 - mat.v[8] * n08 + mat.v[12] * n07) / det;\r\n        const m12 = (mat.v[11] * n02 - mat.v[3] * n05 - mat.v[15] * n01) / det;\r\n        const m13 = (mat.v[2] * n05 - mat.v[10] * n02 + mat.v[14] * n01) / det;\r\n        const m20 = (mat.v[1] * n10 - mat.v[5] * n08 + mat.v[13] * n06) / det;\r\n        const m21 = (mat.v[4] * n08 - mat.v[0] * n10 - mat.v[12] * n06) / det;\r\n        const m22 = (mat.v[3] * n04 - mat.v[7] * n02 + mat.v[15] * n00) / det;\r\n        const m23 = (mat.v[6] * n02 - mat.v[2] * n04 - mat.v[14] * n00) / det;\r\n        const m30 = (mat.v[5] * n07 - mat.v[1] * n09 - mat.v[9] * n06) / det;\r\n        const m31 = (mat.v[0] * n09 - mat.v[4] * n07 + mat.v[8] * n06) / det;\r\n        const m32 = (mat.v[7] * n01 - mat.v[3] * n03 - mat.v[11] * n00) / det;\r\n        const m33 = (mat.v[2] * n03 - mat.v[6] * n01 + mat.v[10] * n00) / det;\r\n        return new this(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    static invertTo(mat, outMat) {\r\n        const n00 = mat.v[0] * mat.v[5] - mat.v[4] * mat.v[1];\r\n        const n01 = mat.v[0] * mat.v[9] - mat.v[8] * mat.v[1];\r\n        const n02 = mat.v[0] * mat.v[13] - mat.v[12] * mat.v[1];\r\n        const n03 = mat.v[4] * mat.v[9] - mat.v[8] * mat.v[5];\r\n        const n04 = mat.v[4] * mat.v[13] - mat.v[12] * mat.v[5];\r\n        const n05 = mat.v[8] * mat.v[13] - mat.v[12] * mat.v[9];\r\n        const n06 = mat.v[2] * mat.v[7] - mat.v[6] * mat.v[3];\r\n        const n07 = mat.v[2] * mat.v[11] - mat.v[10] * mat.v[3];\r\n        const n08 = mat.v[2] * mat.v[15] - mat.v[14] * mat.v[3];\r\n        const n09 = mat.v[6] * mat.v[11] - mat.v[10] * mat.v[7];\r\n        const n10 = mat.v[6] * mat.v[15] - mat.v[14] * mat.v[7];\r\n        const n11 = mat.v[10] * mat.v[15] - mat.v[14] * mat.v[11];\r\n        const det = n00 * n11 - n01 * n10 + n02 * n09 + n03 * n08 - n04 * n07 + n05 * n06;\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = (mat.v[5] * n11 - mat.v[9] * n10 + mat.v[13] * n09) / det;\r\n        const m01 = (mat.v[8] * n10 - mat.v[4] * n11 - mat.v[12] * n09) / det;\r\n        const m02 = (mat.v[7] * n05 - mat.v[11] * n04 + mat.v[15] * n03) / det;\r\n        const m03 = (mat.v[10] * n04 - mat.v[6] * n05 - mat.v[14] * n03) / det;\r\n        const m10 = (mat.v[9] * n08 - mat.v[1] * n11 - mat.v[13] * n07) / det;\r\n        const m11 = (mat.v[0] * n11 - mat.v[8] * n08 + mat.v[12] * n07) / det;\r\n        const m12 = (mat.v[11] * n02 - mat.v[3] * n05 - mat.v[15] * n01) / det;\r\n        const m13 = (mat.v[2] * n05 - mat.v[10] * n02 + mat.v[14] * n01) / det;\r\n        const m20 = (mat.v[1] * n10 - mat.v[5] * n08 + mat.v[13] * n06) / det;\r\n        const m21 = (mat.v[4] * n08 - mat.v[0] * n10 - mat.v[12] * n06) / det;\r\n        const m22 = (mat.v[3] * n04 - mat.v[7] * n02 + mat.v[15] * n00) / det;\r\n        const m23 = (mat.v[6] * n02 - mat.v[2] * n04 - mat.v[14] * n00) / det;\r\n        const m30 = (mat.v[5] * n07 - mat.v[1] * n09 - mat.v[9] * n06) / det;\r\n        const m31 = (mat.v[0] * n09 - mat.v[4] * n07 + mat.v[8] * n06) / det;\r\n        const m32 = (mat.v[7] * n01 - mat.v[3] * n03 - mat.v[11] * n00) / det;\r\n        const m33 = (mat.v[2] * n03 - mat.v[6] * n01 + mat.v[10] * n00) / det;\r\n        return outMat.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    /**\r\n     * Create translation Matrix\r\n     */\r\n    static translate(vec) {\r\n        return new this(1, 0, 0, vec.v[0], 0, 1, 0, vec.v[1], 0, 0, 1, vec.v[2], 0, 0, 0, 1);\r\n    }\r\n    /**\r\n     * Create X oriented Rotation Matrix\r\n     */\r\n    static rotateX(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(1, 0, 0, 0, 0, cos, -sin, 0, 0, sin, cos, 0, 0, 0, 0, 1);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    static rotateY(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(cos, 0, sin, 0, 0, 1, 0, 0, -sin, 0, cos, 0, 0, 0, 0, 1);\r\n    }\r\n    /**\r\n     * Create Z oriented Rotation Matrix\r\n     */\r\n    static rotateZ(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return new this(cos, -sin, 0, 0, sin, cos, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n    }\r\n    static rotateXYZ(x, y, z) {\r\n        const cosX = Math.cos(x);\r\n        const sinX = Math.sin(x);\r\n        const cosY = Math.cos(y);\r\n        const sinY = Math.sin(y);\r\n        const cosZ = Math.cos(z);\r\n        const sinZ = Math.sin(z);\r\n        // const x00 = 1;\r\n        // const x01 = 0;\r\n        // const x02 = 0;\r\n        // const x10 = 0;\r\n        const x11 = cosX;\r\n        const x12 = -sinX;\r\n        // const x20 = 0;\r\n        const x21 = sinX;\r\n        const x22 = cosX;\r\n        const y00 = cosY;\r\n        // const y01 = 0;\r\n        const y02 = sinY;\r\n        // const y10 = 0;\r\n        // const y11 = 1;\r\n        // const y12 = 0;\r\n        const y20 = -sinY;\r\n        // const y21 = 0;\r\n        const y22 = cosY;\r\n        const z00 = cosZ;\r\n        const z01 = -sinZ;\r\n        // const z02 = 0;\r\n        const z10 = sinZ;\r\n        const z11 = cosZ;\r\n        // const z12 = 0;\r\n        // const z20 = 0;\r\n        // const z21 = 0;\r\n        // const z22 = 1;\r\n        // Y * X\r\n        const yx00 = y00;\r\n        const yx01 = y02 * x21;\r\n        const yx02 = y02 * x22;\r\n        //const yx10 = 0;\r\n        const yx11 = x11;\r\n        const yx12 = x12;\r\n        const yx20 = y20;\r\n        const yx21 = y22 * x21;\r\n        const yx22 = y22 * x22;\r\n        // Z * Y * X\r\n        const m00 = z00 * yx00;\r\n        const m01 = z00 * yx01 + z01 * yx11;\r\n        const m02 = z00 * yx02 + z01 * yx12;\r\n        const m10 = z10 * yx00;\r\n        const m11 = z10 * yx01 + z11 * yx11;\r\n        const m12 = z10 * yx02 + z11 * yx12;\r\n        const m20 = yx20;\r\n        const m21 = yx21;\r\n        const m22 = yx22;\r\n        const m03 = 0;\r\n        const m13 = 0;\r\n        const m23 = 0;\r\n        const m30 = 0;\r\n        const m31 = 0;\r\n        const m32 = 0;\r\n        const m33 = 1;\r\n        return new this(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    static rotate(vec) {\r\n        return this.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return new this(vec.v[0], 0, 0, 0, 0, vec.v[1], 0, 0, 0, 0, vec.v[2], 0, 0, 0, 0, 1);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[4] * r_mat.v[1] + l_mat.v[8] * r_mat.v[2] + l_mat.v[12] * r_mat.v[3];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[5] * r_mat.v[1] + l_mat.v[9] * r_mat.v[2] + l_mat.v[13] * r_mat.v[3];\r\n        const m20 = l_mat.v[2] * r_mat.v[0] + l_mat.v[6] * r_mat.v[1] + l_mat.v[10] * r_mat.v[2] + l_mat.v[14] * r_mat.v[3];\r\n        const m30 = l_mat.v[3] * r_mat.v[0] + l_mat.v[7] * r_mat.v[1] + l_mat.v[11] * r_mat.v[2] + l_mat.v[15] * r_mat.v[3];\r\n        const m01 = l_mat.v[0] * r_mat.v[4] + l_mat.v[4] * r_mat.v[5] + l_mat.v[8] * r_mat.v[6] + l_mat.v[12] * r_mat.v[7];\r\n        const m11 = l_mat.v[1] * r_mat.v[4] + l_mat.v[5] * r_mat.v[5] + l_mat.v[9] * r_mat.v[6] + l_mat.v[13] * r_mat.v[7];\r\n        const m21 = l_mat.v[2] * r_mat.v[4] + l_mat.v[6] * r_mat.v[5] + l_mat.v[10] * r_mat.v[6] + l_mat.v[14] * r_mat.v[7];\r\n        const m31 = l_mat.v[3] * r_mat.v[4] + l_mat.v[7] * r_mat.v[5] + l_mat.v[11] * r_mat.v[6] + l_mat.v[15] * r_mat.v[7];\r\n        const m02 = l_mat.v[0] * r_mat.v[8] + l_mat.v[4] * r_mat.v[9] + l_mat.v[8] * r_mat.v[10] + l_mat.v[12] * r_mat.v[11];\r\n        const m12 = l_mat.v[1] * r_mat.v[8] + l_mat.v[5] * r_mat.v[9] + l_mat.v[9] * r_mat.v[10] + l_mat.v[13] * r_mat.v[11];\r\n        const m22 = l_mat.v[2] * r_mat.v[8] + l_mat.v[6] * r_mat.v[9] + l_mat.v[10] * r_mat.v[10] + l_mat.v[14] * r_mat.v[11];\r\n        const m32 = l_mat.v[3] * r_mat.v[8] + l_mat.v[7] * r_mat.v[9] + l_mat.v[11] * r_mat.v[10] + l_mat.v[15] * r_mat.v[11];\r\n        const m03 = l_mat.v[0] * r_mat.v[12] + l_mat.v[4] * r_mat.v[13] + l_mat.v[8] * r_mat.v[14] + l_mat.v[12] * r_mat.v[15];\r\n        const m13 = l_mat.v[1] * r_mat.v[12] + l_mat.v[5] * r_mat.v[13] + l_mat.v[9] * r_mat.v[14] + l_mat.v[13] * r_mat.v[15];\r\n        const m23 = l_mat.v[2] * r_mat.v[12] + l_mat.v[6] * r_mat.v[13] + l_mat.v[10] * r_mat.v[14] + l_mat.v[14] * r_mat.v[15];\r\n        const m33 = l_mat.v[3] * r_mat.v[12] + l_mat.v[7] * r_mat.v[13] + l_mat.v[11] * r_mat.v[14] + l_mat.v[15] * r_mat.v[15];\r\n        return new this(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiplyTo(l_mat, r_mat, outMat) {\r\n        const m00 = l_mat.v[0] * r_mat.v[0] + l_mat.v[4] * r_mat.v[1] + l_mat.v[8] * r_mat.v[2] + l_mat.v[12] * r_mat.v[3];\r\n        const m10 = l_mat.v[1] * r_mat.v[0] + l_mat.v[5] * r_mat.v[1] + l_mat.v[9] * r_mat.v[2] + l_mat.v[13] * r_mat.v[3];\r\n        const m20 = l_mat.v[2] * r_mat.v[0] + l_mat.v[6] * r_mat.v[1] + l_mat.v[10] * r_mat.v[2] + l_mat.v[14] * r_mat.v[3];\r\n        const m30 = l_mat.v[3] * r_mat.v[0] + l_mat.v[7] * r_mat.v[1] + l_mat.v[11] * r_mat.v[2] + l_mat.v[15] * r_mat.v[3];\r\n        const m01 = l_mat.v[0] * r_mat.v[4] + l_mat.v[4] * r_mat.v[5] + l_mat.v[8] * r_mat.v[6] + l_mat.v[12] * r_mat.v[7];\r\n        const m11 = l_mat.v[1] * r_mat.v[4] + l_mat.v[5] * r_mat.v[5] + l_mat.v[9] * r_mat.v[6] + l_mat.v[13] * r_mat.v[7];\r\n        const m21 = l_mat.v[2] * r_mat.v[4] + l_mat.v[6] * r_mat.v[5] + l_mat.v[10] * r_mat.v[6] + l_mat.v[14] * r_mat.v[7];\r\n        const m31 = l_mat.v[3] * r_mat.v[4] + l_mat.v[7] * r_mat.v[5] + l_mat.v[11] * r_mat.v[6] + l_mat.v[15] * r_mat.v[7];\r\n        const m02 = l_mat.v[0] * r_mat.v[8] + l_mat.v[4] * r_mat.v[9] + l_mat.v[8] * r_mat.v[10] + l_mat.v[12] * r_mat.v[11];\r\n        const m12 = l_mat.v[1] * r_mat.v[8] + l_mat.v[5] * r_mat.v[9] + l_mat.v[9] * r_mat.v[10] + l_mat.v[13] * r_mat.v[11];\r\n        const m22 = l_mat.v[2] * r_mat.v[8] + l_mat.v[6] * r_mat.v[9] + l_mat.v[10] * r_mat.v[10] + l_mat.v[14] * r_mat.v[11];\r\n        const m32 = l_mat.v[3] * r_mat.v[8] + l_mat.v[7] * r_mat.v[9] + l_mat.v[11] * r_mat.v[10] + l_mat.v[15] * r_mat.v[11];\r\n        const m03 = l_mat.v[0] * r_mat.v[12] + l_mat.v[4] * r_mat.v[13] + l_mat.v[8] * r_mat.v[14] + l_mat.v[12] * r_mat.v[15];\r\n        const m13 = l_mat.v[1] * r_mat.v[12] + l_mat.v[5] * r_mat.v[13] + l_mat.v[9] * r_mat.v[14] + l_mat.v[13] * r_mat.v[15];\r\n        const m23 = l_mat.v[2] * r_mat.v[12] + l_mat.v[6] * r_mat.v[13] + l_mat.v[10] * r_mat.v[14] + l_mat.v[14] * r_mat.v[15];\r\n        const m33 = l_mat.v[3] * r_mat.v[12] + l_mat.v[7] * r_mat.v[13] + l_mat.v[11] * r_mat.v[14] + l_mat.v[15] * r_mat.v[15];\r\n        return outMat.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    static fromQuaternionTo(quat, outMat) {\r\n        const sx = quat.v[0] * quat.v[0];\r\n        const sy = quat.v[1] * quat.v[1];\r\n        const sz = quat.v[2] * quat.v[2];\r\n        const cx = quat.v[1] * quat.v[2];\r\n        const cy = quat.v[0] * quat.v[2];\r\n        const cz = quat.v[0] * quat.v[1];\r\n        const wx = quat.v[3] * quat.v[0];\r\n        const wy = quat.v[3] * quat.v[1];\r\n        const wz = quat.v[3] * quat.v[2];\r\n        const m00 = 1.0 - 2.0 * (sy + sz);\r\n        const m01 = 2.0 * (cz - wz);\r\n        const m02 = 2.0 * (cy + wy);\r\n        const m03 = 0;\r\n        const m10 = 2.0 * (cz + wz);\r\n        const m11 = 1.0 - 2.0 * (sx + sz);\r\n        const m12 = 2.0 * (cx - wx);\r\n        const m13 = 0;\r\n        const m20 = 2.0 * (cy - wy);\r\n        const m21 = 2.0 * (cx + wx);\r\n        const m22 = 1.0 - 2.0 * (sx + sy);\r\n        const m23 = 0;\r\n        const m30 = 0;\r\n        const m31 = 0;\r\n        const m32 = 0;\r\n        const m33 = 1;\r\n        return outMat.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    toString() {\r\n        return this.v[0] + ' ' + this.v[4] + ' ' + this.v[8] + ' ' + this.v[12] + ' \\n' +\r\n            this.v[1] + ' ' + this.v[5] + ' ' + this.v[9] + ' ' + this.v[13] + ' \\n' +\r\n            this.v[2] + ' ' + this.v[6] + ' ' + this.v[10] + ' ' + this.v[14] + ' \\n' +\r\n            this.v[3] + ' ' + this.v[7] + ' ' + this.v[11] + ' ' + this.v[15] + ' \\n';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[4]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[8]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[12]) + ' \\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[1]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[5]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[9]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[13]) + ' \\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[2]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[6]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[10]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[14]) + ' \\n' +\r\n            _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[3]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[7]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[11]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_4__[\"MathUtil\"].nearZeroToZero(this.v[15]) + ' \\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1], this.v[2], this.v[3],\r\n            this.v[4], this.v[5], this.v[6], this.v[7],\r\n            this.v[8], this.v[9], this.v[10], this.v[11],\r\n            this.v[12], this.v[13], this.v[14], this.v[15]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(mat, delta = Number.EPSILON) {\r\n        if (Math.abs(mat.v[0] - this.v[0]) < delta &&\r\n            Math.abs(mat.v[1] - this.v[1]) < delta &&\r\n            Math.abs(mat.v[2] - this.v[2]) < delta &&\r\n            Math.abs(mat.v[3] - this.v[3]) < delta &&\r\n            Math.abs(mat.v[4] - this.v[4]) < delta &&\r\n            Math.abs(mat.v[5] - this.v[5]) < delta &&\r\n            Math.abs(mat.v[6] - this.v[6]) < delta &&\r\n            Math.abs(mat.v[7] - this.v[7]) < delta &&\r\n            Math.abs(mat.v[8] - this.v[8]) < delta &&\r\n            Math.abs(mat.v[9] - this.v[9]) < delta &&\r\n            Math.abs(mat.v[10] - this.v[10]) < delta &&\r\n            Math.abs(mat.v[11] - this.v[11]) < delta &&\r\n            Math.abs(mat.v[12] - this.v[12]) < delta &&\r\n            Math.abs(mat.v[13] - this.v[13]) < delta &&\r\n            Math.abs(mat.v[14] - this.v[14]) < delta &&\r\n            Math.abs(mat.v[15] - this.v[15]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(mat) {\r\n        if (mat.v[0] === this.v[0] && mat.v[1] === this.v[1] && mat.v[2] === this.v[2] && mat.v[3] === this.v[3] &&\r\n            mat.v[4] === this.v[4] && mat.v[5] === this.v[5] && mat.v[6] === this.v[6] && mat.v[7] === this.v[7] &&\r\n            mat.v[8] === this.v[8] && mat.v[9] === this.v[9] && mat.v[10] === this.v[10] && mat.v[11] === this.v[11] &&\r\n            mat.v[12] === this.v[12] && mat.v[13] === this.v[13] && mat.v[14] === this.v[14] && mat.v[15] === this.v[15]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(row_i, column_i) {\r\n        return this.v[row_i + column_i * 4];\r\n    }\r\n    determinant() {\r\n        return this.v[0] * this.v[5] * this.v[10] * this.v[15] + this.v[0] * this.v[9] * this.v[14] * this.v[7] + this.v[0] * this.v[13] * this.v[6] * this.v[11] +\r\n            this.v[4] * this.v[1] * this.v[14] * this.v[11] + this.v[4] * this.v[9] * this.v[2] * this.v[15] + this.v[4] * this.v[13] * this.v[10] * this.v[3] +\r\n            this.v[8] * this.v[1] * this.v[6] * this.v[15] + this.v[8] * this.v[5] * this.v[14] * this.v[3] + this.v[8] * this.v[13] * this.v[2] * this.v[7] +\r\n            this.v[12] * this.v[1] * this.v[10] * this.v[7] + this.v[12] * this.v[5] * this.v[2] * this.v[11] + this.v[12] * this.v[9] * this.v[6] * this.v[3] -\r\n            this.v[0] * this.v[5] * this.v[14] * this.v[11] - this.v[0] * this.v[9] * this.v[6] * this.v[15] - this.v[0] * this.v[13] * this.v[10] * this.v[7] -\r\n            this.v[4] * this.v[1] * this.v[10] * this.v[15] - this.v[4] * this.v[9] * this.v[14] * this.v[3] - this.v[4] * this.v[13] * this.v[2] * this.v[11] -\r\n            this.v[8] * this.v[1] * this.v[14] * this.v[7] - this.v[8] * this.v[5] * this.v[2] * this.v[15] - this.v[8] * this.v[13] * this.v[6] * this.v[3] -\r\n            this.v[12] * this.v[1] * this.v[6] * this.v[11] - this.v[12] * this.v[5] * this.v[10] * this.v[3] - this.v[12] * this.v[9] * this.v[2] * this.v[7];\r\n    }\r\n    multiplyVector(vec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[4] * vec.v[1] + this.v[8] * vec.v[2] + this.v[12] * vec.v[3];\r\n        const y = this.v[1] * vec.v[0] + this.v[5] * vec.v[1] + this.v[9] * vec.v[2] + this.v[13] * vec.v[3];\r\n        const z = this.v[2] * vec.v[0] + this.v[6] * vec.v[1] + this.v[10] * vec.v[2] + this.v[14] * vec.v[3];\r\n        const w = this.v[3] * vec.v[0] + this.v[7] * vec.v[1] + this.v[11] * vec.v[2] + this.v[15] * vec.v[3];\r\n        return new _Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](x, y, z, w);\r\n    }\r\n    multiplyVectorTo(vec, outVec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[4] * vec.v[1] + this.v[8] * vec.v[2] + this.v[12] * vec.v[3];\r\n        const y = this.v[1] * vec.v[0] + this.v[5] * vec.v[1] + this.v[9] * vec.v[2] + this.v[13] * vec.v[3];\r\n        const z = this.v[2] * vec.v[0] + this.v[6] * vec.v[1] + this.v[10] * vec.v[2] + this.v[14] * vec.v[3];\r\n        const w = this.v[3] * vec.v[0] + this.v[7] * vec.v[1] + this.v[11] * vec.v[2] + this.v[15] * vec.v[3];\r\n        outVec.v[0] = x;\r\n        outVec.v[1] = y;\r\n        outVec.v[2] = z;\r\n        outVec.v[3] = w;\r\n        return outVec;\r\n    }\r\n    multiplyVectorToVec3(vec, outVec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[4] * vec.v[1] + this.v[8] * vec.v[2] + this.v[12] * vec.v[3];\r\n        const y = this.v[1] * vec.v[0] + this.v[5] * vec.v[1] + this.v[9] * vec.v[2] + this.v[13] * vec.v[3];\r\n        const z = this.v[2] * vec.v[0] + this.v[6] * vec.v[1] + this.v[10] * vec.v[2] + this.v[14] * vec.v[3];\r\n        outVec.v[0] = x;\r\n        outVec.v[1] = y;\r\n        outVec.v[2] = z;\r\n        return outVec;\r\n    }\r\n    multiplyVector3(vec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[4] * vec.v[1] + this.v[8] * vec.v[2] + this.v[12]; // regards vec.w(vec.v[3]) as 1\r\n        const y = this.v[1] * vec.v[0] + this.v[5] * vec.v[1] + this.v[9] * vec.v[2] + this.v[13];\r\n        const z = this.v[2] * vec.v[0] + this.v[6] * vec.v[1] + this.v[10] * vec.v[2] + this.v[14];\r\n        return new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](x, y, z);\r\n    }\r\n    multiplyVector3To(vec, outVec) {\r\n        const x = this.v[0] * vec.v[0] + this.v[4] * vec.v[1] + this.v[8] * vec.v[2] + this.v[12]; // regards vec.w(vec.v[3]) as 1\r\n        const y = this.v[1] * vec.v[0] + this.v[5] * vec.v[1] + this.v[9] * vec.v[2] + this.v[13];\r\n        const z = this.v[2] * vec.v[0] + this.v[6] * vec.v[1] + this.v[10] * vec.v[2] + this.v[14];\r\n        outVec.v[0] = x;\r\n        outVec.v[1] = y;\r\n        outVec.v[2] = z;\r\n        return outVec;\r\n    }\r\n    getTranslate() {\r\n        return new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.v[12], this.v[13], this.v[14]);\r\n    }\r\n    /**\r\n     * get translate vector from this matrix\r\n     */\r\n    getTranslateTo(outVec) {\r\n        outVec.v[0] = this.v[12];\r\n        outVec.v[1] = this.v[13];\r\n        outVec.v[2] = this.v[14];\r\n        return outVec;\r\n    }\r\n    getScale() {\r\n        return new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](Math.hypot(this.v[0], this.v[4], this.v[8]), Math.hypot(this.v[1], this.v[5], this.v[9]), Math.hypot(this.v[2], this.v[6], this.v[10]));\r\n    }\r\n    /**\r\n     * get scale vector from this matrix\r\n     */\r\n    getScaleTo(outVec) {\r\n        outVec.v[0] = Math.hypot(this.v[0], this.v[4], this.v[8]);\r\n        outVec.v[1] = Math.hypot(this.v[1], this.v[5], this.v[9]);\r\n        outVec.v[2] = Math.hypot(this.v[2], this.v[6], this.v[10]);\r\n        return outVec;\r\n    }\r\n    /**\r\n     * @return Euler Angles Rotation (x, y, z)\r\n     */\r\n    toEulerAngles() {\r\n        let rotate = null;\r\n        if (Math.abs(this.v[2]) != 1.0) {\r\n            let y = -Math.asin(this.v[2]);\r\n            let x = Math.atan2(this.v[6] / Math.cos(y), this.v[10] / Math.cos(y));\r\n            let z = Math.atan2(this.v[1] / Math.cos(y), this.v[0] / Math.cos(y));\r\n            rotate = new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](x, y, z);\r\n        }\r\n        else if (this.v[2] === -1.0) {\r\n            rotate = new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](Math.atan2(this.v[4], this.v[8]), Math.PI / 2.0, 0.0);\r\n        }\r\n        else {\r\n            rotate = new _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](Math.atan2(-this.v[4], -this.v[8]), -Math.PI / 2.0, 0.0);\r\n        }\r\n        return rotate;\r\n    }\r\n    toEulerAnglesTo(outVec3) {\r\n        if (Math.abs(this.v[2]) != 1.0) {\r\n            let y = -Math.asin(this.v[2]);\r\n            let x = Math.atan2(this.v[6] / Math.cos(y), this.v[10] / Math.cos(y));\r\n            let z = Math.atan2(this.v[1] / Math.cos(y), this.v[0] / Math.cos(y));\r\n            outVec3.v[0] = x;\r\n            outVec3.v[1] = y;\r\n            outVec3.v[2] = z;\r\n        }\r\n        else if (this.v[2] === -1.0) {\r\n            outVec3.v[0] = Math.atan2(this.v[4], this.v[8]);\r\n            outVec3.v[1] = Math.PI / 2.0;\r\n            outVec3.v[2] = 0.0;\r\n        }\r\n        else {\r\n            outVec3.v[0] = Math.atan2(-this.v[4], -this.v[8]);\r\n            outVec3.v[1] = -Math.PI / 2.0;\r\n            outVec3.v[2] = 0.0;\r\n        }\r\n        return outVec3;\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[4], this.v[8], this.v[12], this.v[1], this.v[5], this.v[9], this.v[13], this.v[2], this.v[6], this.v[10], this.v[14], this.v[3], this.v[7], this.v[11], this.v[15]);\r\n    }\r\n    getRotate() {\r\n        const quat = _Quaternion__WEBPACK_IMPORTED_MODULE_1__[\"default\"].fromMatrix(this);\r\n        const rotateMat = new this.constructor(quat);\r\n        return rotateMat;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Matrix44.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableMatrix22.ts":
/*!************************************************!*\
  !*** ./src/foundation/math/MutableMatrix22.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableMatrix22; });\n/* harmony import */ var _Matrix22__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matrix22 */ \"./src/foundation/math/Matrix22.ts\");\n\r\nclass MutableMatrix22 extends _Matrix22__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(m0, m1, m2, m3, isColumnMajor = false, notCopyFloatArray = false) {\r\n        super(m0, m1, m2, m3, isColumnMajor);\r\n    }\r\n    set m00(val) {\r\n        this.v[0] = val;\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    set m10(val) {\r\n        this.v[1] = val;\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    set m01(val) {\r\n        this.v[2] = val;\r\n    }\r\n    get m01() {\r\n        return this.v[2];\r\n    }\r\n    set m11(val) {\r\n        this.v[3] = val;\r\n    }\r\n    get m11() {\r\n        return this.v[3];\r\n    }\r\n    /**\r\n     * Create zero matrix\r\n     */\r\n    static zero() {\r\n        return super.zero();\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return super.identity();\r\n    }\r\n    static dummy() {\r\n        return super.dummy();\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return super.transpose(mat);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        return super.invert(mat);\r\n    }\r\n    /**\r\n     * Create Rotation Matrix\r\n     */\r\n    static rotate(radian) {\r\n        return super.rotate(radian);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return super.scale(vec);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        return super.multiply(l_mat, r_mat);\r\n    }\r\n    clone() {\r\n        const result = super.clone();\r\n        return result;\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(row_i, column_i, value) {\r\n        this.v[row_i + column_i * 2] = value;\r\n        return this;\r\n    }\r\n    setComponents(m00, m01, m10, m11) {\r\n        this.v[0] = m00;\r\n        this.v[2] = m01;\r\n        this.v[1] = m10;\r\n        this.v[3] = m11;\r\n        return this;\r\n    }\r\n    copyComponents(mat) {\r\n        this.v[0] = mat.m00;\r\n        this.v[2] = mat.m01; // mat.m01 is mat.v[2 or 3 or 4]\r\n        this.v[1] = mat.m10;\r\n        this.v[3] = mat.m11;\r\n        return this;\r\n    }\r\n    /**\r\n     * zero matrix\r\n     */\r\n    zero() {\r\n        return this.setComponents(0, 0, 0, 0);\r\n    }\r\n    identity() {\r\n        return this.setComponents(1, 0, 0, 1);\r\n    }\r\n    _swap(l, r) {\r\n        this.v[r] = [this.v[l], this.v[l] = this.v[r]][0];\r\n    }\r\n    /**\r\n     * transpose\r\n     */\r\n    transpose() {\r\n        this._swap(1, 2);\r\n        return this;\r\n    }\r\n    invert() {\r\n        const det = this.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = this.v[3] / det;\r\n        const m01 = this.v[2] / det * (-1.0);\r\n        const m10 = this.v[1] / det * (-1.0);\r\n        const m11 = this.v[0] / det;\r\n        return this.setComponents(m00, m01, m10, m11);\r\n    }\r\n    /**\r\n     * Create Rotation Matrix\r\n     */\r\n    rotate(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(cos, -sin, sin, cos);\r\n    }\r\n    scale(vec) {\r\n        return this.setComponents(vec.v[0], 0, 0, vec.v[1]);\r\n    }\r\n    putScale(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[2] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        this.v[3] *= vec.v[1];\r\n        return this;\r\n    }\r\n    /**\r\n      * multiply the input matrix from right side\r\n      */\r\n    multiply(mat) {\r\n        const m00 = this.v[0] * mat.v[0] + this.v[2] * mat.v[1];\r\n        const m01 = this.v[0] * mat.v[2] + this.v[2] * mat.v[3];\r\n        const m10 = this.v[1] * mat.v[0] + this.v[3] * mat.v[1];\r\n        const m11 = this.v[1] * mat.v[2] + this.v[3] * mat.v[3];\r\n        return this.setComponents(m00, m01, m10, m11);\r\n    }\r\n    multiplyByLeft(mat) {\r\n        const m00 = mat.v[0] * this.v[0] + mat.v[2] * this.v[1];\r\n        const m01 = mat.v[0] * this.v[2] + mat.v[2] * this.v[3];\r\n        const m10 = mat.v[1] * this.v[0] + mat.v[3] * this.v[1];\r\n        const m11 = mat.v[1] * this.v[2] + mat.v[3] * this.v[3];\r\n        return this.setComponents(m00, m01, m10, m11);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableMatrix22.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableMatrix33.ts":
/*!************************************************!*\
  !*** ./src/foundation/math/MutableMatrix33.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableMatrix33; });\n/* harmony import */ var _Matrix33__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matrix33 */ \"./src/foundation/math/Matrix33.ts\");\n\r\nclass MutableMatrix33 extends _Matrix33__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(m0, m1, m2, m3, m4, m5, m6, m7, m8, isColumnMajor = false, notCopyFloatArray = false) {\r\n        super(m0, m1, m2, m3, m4, m5, m6, m7, m8, isColumnMajor);\r\n    }\r\n    set m00(val) {\r\n        this.v[0] = val;\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    set m10(val) {\r\n        this.v[1] = val;\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    set m20(val) {\r\n        this.v[2] = val;\r\n    }\r\n    get m20() {\r\n        return this.v[2];\r\n    }\r\n    set m01(val) {\r\n        this.v[3] = val;\r\n    }\r\n    get m01() {\r\n        return this.v[3];\r\n    }\r\n    set m11(val) {\r\n        this.v[4] = val;\r\n    }\r\n    get m11() {\r\n        return this.v[4];\r\n    }\r\n    set m21(val) {\r\n        this.v[5] = val;\r\n    }\r\n    get m21() {\r\n        return this.v[5];\r\n    }\r\n    set m02(val) {\r\n        this.v[6] = val;\r\n    }\r\n    get m02() {\r\n        return this.v[6];\r\n    }\r\n    set m12(val) {\r\n        this.v[7] = val;\r\n    }\r\n    get m12() {\r\n        return this.v[7];\r\n    }\r\n    set m22(val) {\r\n        this.v[8] = val;\r\n    }\r\n    get m22() {\r\n        return this.v[8];\r\n    }\r\n    /**\r\n     * zero matrix(static version)\r\n     */\r\n    static zero() {\r\n        return super.zero();\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return super.identity();\r\n    }\r\n    static dummy() {\r\n        return super.dummy();\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return super.transpose(mat);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        return super.invert(mat);\r\n    }\r\n    /**\r\n   * Create X oriented Rotation Matrix\r\n   */\r\n    static rotateX(radian) {\r\n        return super.rotateX(radian);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    static rotateY(radian) {\r\n        return super.rotateY(radian);\r\n    }\r\n    /**\r\n     * Create Z oriented Rotation Matrix\r\n     */\r\n    static rotateZ(radian) {\r\n        return super.rotateZ(radian);\r\n    }\r\n    static rotateXYZ(x, y, z) {\r\n        return super.rotateXYZ(x, y, z);\r\n    }\r\n    static rotate(vec) {\r\n        return super.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return super.scale(vec);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        return super.multiply(l_mat, r_mat);\r\n    }\r\n    clone() {\r\n        const result = super.clone();\r\n        return result;\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(row_i, column_i, value) {\r\n        this.v[row_i + column_i * 3] = value;\r\n        return this;\r\n    }\r\n    setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n        this.v[0] = m00;\r\n        this.v[3] = m01;\r\n        this.v[6] = m02;\r\n        this.v[1] = m10;\r\n        this.v[4] = m11;\r\n        this.v[7] = m12;\r\n        this.v[2] = m20;\r\n        this.v[5] = m21;\r\n        this.v[8] = m22;\r\n        return this;\r\n    }\r\n    copyComponents(mat) {\r\n        this.v[0] = mat.m00;\r\n        this.v[3] = mat.m01;\r\n        this.v[6] = mat.m02; // mat.m01 is mat.v[3 or 4]\r\n        this.v[1] = mat.m10;\r\n        this.v[4] = mat.m11;\r\n        this.v[7] = mat.m12;\r\n        this.v[2] = mat.m20;\r\n        this.v[5] = mat.m21;\r\n        this.v[8] = mat.m22;\r\n        return this;\r\n    }\r\n    /**\r\n     * zero matrix\r\n     */\r\n    zero() {\r\n        return this.setComponents(0, 0, 0, 0, 0, 0, 0, 0, 0);\r\n    }\r\n    identity() {\r\n        return this.setComponents(1, 0, 0, 0, 1, 0, 0, 0, 1);\r\n    }\r\n    _swap(l, r) {\r\n        this.v[r] = [this.v[l], this.v[l] = this.v[r]][0];\r\n    }\r\n    /**\r\n     * transpose\r\n     */\r\n    transpose() {\r\n        this._swap(1, 3);\r\n        this._swap(2, 6);\r\n        this._swap(5, 8);\r\n        return this;\r\n    }\r\n    invert() {\r\n        var det = this.determinant();\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        var m00 = (this.v[4] * this.v[8] - this.v[7] * this.v[5]) / det;\r\n        var m01 = (this.v[6] * this.v[5] - this.v[3] * this.v[8]) / det;\r\n        var m02 = (this.v[3] * this.v[7] - this.v[6] * this.v[4]) / det;\r\n        var m10 = (this.v[7] * this.v[2] - this.v[1] * this.v[8]) / det;\r\n        var m11 = (this.v[0] * this.v[8] - this.v[6] * this.v[2]) / det;\r\n        var m12 = (this.v[6] * this.v[1] - this.v[0] * this.v[7]) / det;\r\n        var m20 = (this.v[1] * this.v[5] - this.v[4] * this.v[2]) / det;\r\n        var m21 = (this.v[3] * this.v[2] - this.v[0] * this.v[5]) / det;\r\n        var m22 = (this.v[0] * this.v[4] - this.v[3] * this.v[1]) / det;\r\n        return this.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    /**\r\n     * Create X oriented Rotation Matrix\r\n     */\r\n    rotateX(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(1, 0, 0, 0, cos, -sin, 0, sin, cos);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    rotateY(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(cos, 0, sin, 0, 1, 0, -sin, 0, cos);\r\n    }\r\n    /**\r\n     * Create Z oriented Rotation Matrix\r\n     */\r\n    rotateZ(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(cos, -sin, 0, sin, cos, 0, 0, 0, 1);\r\n    }\r\n    rotateXYZ(x, y, z) {\r\n        const cosX = Math.cos(x);\r\n        const sinX = Math.sin(x);\r\n        const cosY = Math.cos(y);\r\n        const sinY = Math.sin(y);\r\n        const cosZ = Math.cos(z);\r\n        const sinZ = Math.sin(z);\r\n        // const x00 = 1;\r\n        // const x01 = 0;\r\n        // const x02 = 0;\r\n        // const x10 = 0;\r\n        const x11 = cosX;\r\n        const x12 = -sinX;\r\n        // const x20 = 0;\r\n        const x21 = sinX;\r\n        const x22 = cosX;\r\n        const y00 = cosY;\r\n        // const y01 = 0;\r\n        const y02 = sinY;\r\n        // const y10 = 0;\r\n        // const y11 = 1;\r\n        // const y12 = 0;\r\n        const y20 = -sinY;\r\n        // const y21 = 0;\r\n        const y22 = cosY;\r\n        const z00 = cosZ;\r\n        const z01 = -sinZ;\r\n        // const z02 = 0;\r\n        const z10 = sinZ;\r\n        const z11 = cosZ;\r\n        // const z12 = 0;\r\n        // const z20 = 0;\r\n        // const z21 = 0;\r\n        // const z22 = 1;\r\n        // calculate this.multiply(this.rotateY(y), this.rotateX(x))\r\n        const yx00 = y00;\r\n        const yx01 = y02 * x21;\r\n        const yx02 = y02 * x22;\r\n        //const yx10 = 0;\r\n        const yx11 = x11;\r\n        const yx12 = x12;\r\n        const yx20 = y20;\r\n        const yx21 = y22 * x21;\r\n        const yx22 = y22 * x22;\r\n        // calculate this.multiply(this.rotateZ(z), this.multiply(this.rotateY(y), this.rotateX(x)))\r\n        const m00 = z00 * yx00;\r\n        const m01 = z00 * yx01 + z01 * yx11;\r\n        const m02 = z00 * yx02 + z01 * yx12;\r\n        const m10 = z10 * yx00;\r\n        const m11 = z10 * yx01 + z11 * yx11;\r\n        const m12 = z10 * yx02 + z11 * yx12;\r\n        const m20 = yx20;\r\n        const m21 = yx21;\r\n        const m22 = yx22;\r\n        return this.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    rotate(vec) {\r\n        return this.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    scale(vec) {\r\n        return this.setComponents(vec.v[0], 0, 0, 0, vec.v[1], 0, 0, 0, vec.v[2]);\r\n    }\r\n    putScale(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[3] *= vec.v[0];\r\n        this.v[6] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        this.v[4] *= vec.v[1];\r\n        this.v[7] *= vec.v[1];\r\n        this.v[2] *= vec.v[2];\r\n        this.v[5] *= vec.v[2];\r\n        this.v[8] *= vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply the input matrix from right side\r\n     */\r\n    multiply(mat) {\r\n        const m00 = this.v[0] * mat.v[0] + this.v[3] * mat.v[1] + this.v[6] * mat.v[2];\r\n        const m01 = this.v[0] * mat.v[3] + this.v[3] * mat.v[4] + this.v[6] * mat.v[5];\r\n        const m02 = this.v[0] * mat.v[6] + this.v[3] * mat.v[7] + this.v[6] * mat.v[8];\r\n        const m10 = this.v[1] * mat.v[0] + this.v[4] * mat.v[1] + this.v[7] * mat.v[2];\r\n        const m11 = this.v[1] * mat.v[3] + this.v[4] * mat.v[4] + this.v[7] * mat.v[5];\r\n        const m12 = this.v[1] * mat.v[6] + this.v[4] * mat.v[7] + this.v[7] * mat.v[8];\r\n        const m20 = this.v[2] * mat.v[0] + this.v[5] * mat.v[1] + this.v[8] * mat.v[2];\r\n        const m21 = this.v[2] * mat.v[3] + this.v[5] * mat.v[4] + this.v[8] * mat.v[5];\r\n        const m22 = this.v[2] * mat.v[6] + this.v[5] * mat.v[7] + this.v[8] * mat.v[8];\r\n        return this.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n    multiplyByLeft(mat) {\r\n        const m00 = mat.v[0] * this.v[0] + mat.v[3] * this.v[1] + mat.v[6] * this.v[2];\r\n        const m01 = mat.v[0] * this.v[3] + mat.v[3] * this.v[4] + mat.v[6] * this.v[5];\r\n        const m02 = mat.v[0] * this.v[6] + mat.v[3] * this.v[7] + mat.v[6] * this.v[8];\r\n        const m10 = mat.v[1] * this.v[0] + mat.v[4] * this.v[1] + mat.v[7] * this.v[2];\r\n        const m11 = mat.v[1] * this.v[3] + mat.v[4] * this.v[4] + mat.v[7] * this.v[5];\r\n        const m12 = mat.v[1] * this.v[6] + mat.v[4] * this.v[7] + mat.v[7] * this.v[8];\r\n        const m20 = mat.v[2] * this.v[0] + mat.v[5] * this.v[1] + mat.v[8] * this.v[2];\r\n        const m21 = mat.v[2] * this.v[3] + mat.v[5] * this.v[4] + mat.v[8] * this.v[5];\r\n        const m22 = mat.v[2] * this.v[6] + mat.v[5] * this.v[7] + mat.v[8] * this.v[8];\r\n        return this.setComponents(m00, m01, m02, m10, m11, m12, m20, m21, m22);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableMatrix33.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableMatrix44.ts":
/*!************************************************!*\
  !*** ./src/foundation/math/MutableMatrix44.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableMatrix44; });\n/* harmony import */ var _Matrix44__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n\r\nconst FloatArray = Float32Array;\r\nclass MutableMatrix44 extends _Matrix44__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, m13, m14, m15, isColumnMajor = false, notCopyFloatArray = false) {\r\n        const _isColumnMajor = (arguments.length >= 16) ? isColumnMajor : m1;\r\n        const _notCopyFloatArray = (arguments.length >= 16) ? notCopyFloatArray : m2;\r\n        if (arguments.length >= 16) {\r\n            super(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, m13, m14, m15, _isColumnMajor, _notCopyFloatArray);\r\n        }\r\n        else {\r\n            super(m0, _isColumnMajor, _notCopyFloatArray);\r\n        }\r\n    }\r\n    set m00(val) {\r\n        this.v[0] = val;\r\n    }\r\n    get m00() {\r\n        return this.v[0];\r\n    }\r\n    set m10(val) {\r\n        this.v[1] = val;\r\n    }\r\n    get m10() {\r\n        return this.v[1];\r\n    }\r\n    set m20(val) {\r\n        this.v[2] = val;\r\n    }\r\n    get m20() {\r\n        return this.v[2];\r\n    }\r\n    set m30(val) {\r\n        this.v[3] = val;\r\n    }\r\n    get m30() {\r\n        return this.v[3];\r\n    }\r\n    set m01(val) {\r\n        this.v[4] = val;\r\n    }\r\n    get m01() {\r\n        return this.v[4];\r\n    }\r\n    set m11(val) {\r\n        this.v[5] = val;\r\n    }\r\n    get m11() {\r\n        return this.v[5];\r\n    }\r\n    set m21(val) {\r\n        this.v[6] = val;\r\n    }\r\n    get m21() {\r\n        return this.v[6];\r\n    }\r\n    set m31(val) {\r\n        this.v[7] = val;\r\n    }\r\n    get m31() {\r\n        return this.v[7];\r\n    }\r\n    set m02(val) {\r\n        this.v[8] = val;\r\n    }\r\n    get m02() {\r\n        return this.v[8];\r\n    }\r\n    set m12(val) {\r\n        this.v[9] = val;\r\n    }\r\n    get m12() {\r\n        return this.v[9];\r\n    }\r\n    set m22(val) {\r\n        this.v[10] = val;\r\n    }\r\n    get m22() {\r\n        return this.v[10];\r\n    }\r\n    set m32(val) {\r\n        this.v[11] = val;\r\n    }\r\n    get m32() {\r\n        return this.v[11];\r\n    }\r\n    set m03(val) {\r\n        this.v[12] = val;\r\n    }\r\n    get m03() {\r\n        return this.v[12];\r\n    }\r\n    set m13(val) {\r\n        this.v[13] = val;\r\n    }\r\n    get m13() {\r\n        return this.v[13];\r\n    }\r\n    set m23(val) {\r\n        this.v[14] = val;\r\n    }\r\n    get m23() {\r\n        return this.v[14];\r\n    }\r\n    set m33(val) {\r\n        this.v[15] = val;\r\n    }\r\n    get m33() {\r\n        return this.v[15];\r\n    }\r\n    /**\r\n     * zero matrix(static version)\r\n     */\r\n    static zero() {\r\n        return super.zero();\r\n    }\r\n    /**\r\n     * Create identity matrix\r\n     */\r\n    static identity() {\r\n        return super.identity();\r\n    }\r\n    static dummy() {\r\n        return super.dummy();\r\n    }\r\n    /**\r\n     * Create transpose matrix\r\n     */\r\n    static transpose(mat) {\r\n        return super.transpose(mat);\r\n    }\r\n    /**\r\n     * Create invert matrix\r\n     */\r\n    static invert(mat) {\r\n        return super.invert(mat);\r\n    }\r\n    /**\r\n     * Create translation Matrix\r\n     */\r\n    static translate(vec) {\r\n        return super.translate(vec);\r\n    }\r\n    /**\r\n     * Create X oriented Rotation Matrix\r\n     */\r\n    static rotateX(radian) {\r\n        return super.rotateX(radian);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    static rotateY(radian) {\r\n        return super.rotateY(radian);\r\n    }\r\n    /**\r\n     * Create Z oriented Rotation Matrix\r\n     */\r\n    static rotateZ(radian) {\r\n        return super.rotateZ(radian);\r\n    }\r\n    static rotateXYZ(x, y, z) {\r\n        return super.rotateXYZ(x, y, z);\r\n    }\r\n    static rotate(vec) {\r\n        return super.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    /**\r\n     * Create Scale Matrix\r\n     */\r\n    static scale(vec) {\r\n        return super.scale(vec);\r\n    }\r\n    /**\r\n     * multiply matrixes\r\n     */\r\n    static multiply(l_mat, r_mat) {\r\n        return super.multiply(l_mat, r_mat);\r\n    }\r\n    clone() {\r\n        const result = super.clone();\r\n        return result;\r\n    }\r\n    getRotate() {\r\n        const rotateMat = super.getRotate();\r\n        return rotateMat;\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(row_i, column_i, value) {\r\n        this.v[row_i + column_i * 4] = value;\r\n        return this;\r\n    }\r\n    setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\r\n        this.v[0] = m00;\r\n        this.v[4] = m01;\r\n        this.v[8] = m02;\r\n        this.v[12] = m03;\r\n        this.v[1] = m10;\r\n        this.v[5] = m11;\r\n        this.v[9] = m12;\r\n        this.v[13] = m13;\r\n        this.v[2] = m20;\r\n        this.v[6] = m21;\r\n        this.v[10] = m22;\r\n        this.v[14] = m23;\r\n        this.v[3] = m30;\r\n        this.v[7] = m31;\r\n        this.v[11] = m32;\r\n        this.v[15] = m33;\r\n        return this;\r\n    }\r\n    copyComponents(mat) {\r\n        this.v[0] = mat.v[0];\r\n        this.v[4] = mat.v[4];\r\n        this.v[8] = mat.v[8];\r\n        this.v[12] = mat.v[12];\r\n        this.v[1] = mat.v[1];\r\n        this.v[5] = mat.v[5];\r\n        this.v[9] = mat.v[9];\r\n        this.v[13] = mat.v[13];\r\n        this.v[2] = mat.v[2];\r\n        this.v[6] = mat.v[6];\r\n        this.v[10] = mat.v[10];\r\n        this.v[14] = mat.v[14];\r\n        this.v[3] = mat.v[3];\r\n        this.v[7] = mat.v[7];\r\n        this.v[11] = mat.v[11];\r\n        this.v[15] = mat.v[15];\r\n        return this;\r\n    }\r\n    /**\r\n     * zero matrix\r\n     */\r\n    zero() {\r\n        return this.setComponents(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * to the identity matrix\r\n     */\r\n    identity() {\r\n        return this.setComponents(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n    }\r\n    _swap(l, r) {\r\n        this.v[r] = [this.v[l], this.v[l] = this.v[r]][0];\r\n    }\r\n    /**\r\n     * transpose\r\n     */\r\n    transpose() {\r\n        this._swap(1, 4);\r\n        this._swap(2, 8);\r\n        this._swap(3, 12);\r\n        this._swap(6, 9);\r\n        this._swap(7, 13);\r\n        this._swap(11, 14);\r\n        return this;\r\n    }\r\n    invert() {\r\n        const n00 = this.v[0] * this.v[5] - this.v[4] * this.v[1];\r\n        const n01 = this.v[0] * this.v[9] - this.v[8] * this.v[1];\r\n        const n02 = this.v[0] * this.v[13] - this.v[12] * this.v[1];\r\n        const n03 = this.v[4] * this.v[9] - this.v[8] * this.v[5];\r\n        const n04 = this.v[4] * this.v[13] - this.v[12] * this.v[5];\r\n        const n05 = this.v[8] * this.v[13] - this.v[12] * this.v[9];\r\n        const n06 = this.v[2] * this.v[7] - this.v[6] * this.v[3];\r\n        const n07 = this.v[2] * this.v[11] - this.v[10] * this.v[3];\r\n        const n08 = this.v[2] * this.v[15] - this.v[14] * this.v[3];\r\n        const n09 = this.v[6] * this.v[11] - this.v[10] * this.v[7];\r\n        const n10 = this.v[6] * this.v[15] - this.v[14] * this.v[7];\r\n        const n11 = this.v[10] * this.v[15] - this.v[14] * this.v[11];\r\n        const det = n00 * n11 - n01 * n10 + n02 * n09 + n03 * n08 - n04 * n07 + n05 * n06;\r\n        if (det === 0) {\r\n            console.error(\"the determinant is 0!\");\r\n        }\r\n        const m00 = (this.v[5] * n11 - this.v[9] * n10 + this.v[13] * n09) / det;\r\n        const m01 = (this.v[8] * n10 - this.v[4] * n11 - this.v[12] * n09) / det;\r\n        const m02 = (this.v[7] * n05 - this.v[11] * n04 + this.v[15] * n03) / det;\r\n        const m03 = (this.v[10] * n04 - this.v[6] * n05 - this.v[14] * n03) / det;\r\n        const m10 = (this.v[9] * n08 - this.v[1] * n11 - this.v[13] * n07) / det;\r\n        const m11 = (this.v[0] * n11 - this.v[8] * n08 + this.v[12] * n07) / det;\r\n        const m12 = (this.v[11] * n02 - this.v[3] * n05 - this.v[15] * n01) / det;\r\n        const m13 = (this.v[2] * n05 - this.v[10] * n02 + this.v[14] * n01) / det;\r\n        const m20 = (this.v[1] * n10 - this.v[5] * n08 + this.v[13] * n06) / det;\r\n        const m21 = (this.v[4] * n08 - this.v[0] * n10 - this.v[12] * n06) / det;\r\n        const m22 = (this.v[3] * n04 - this.v[7] * n02 + this.v[15] * n00) / det;\r\n        const m23 = (this.v[6] * n02 - this.v[2] * n04 - this.v[14] * n00) / det;\r\n        const m30 = (this.v[5] * n07 - this.v[1] * n09 - this.v[9] * n06) / det;\r\n        const m31 = (this.v[0] * n09 - this.v[4] * n07 + this.v[8] * n06) / det;\r\n        const m32 = (this.v[7] * n01 - this.v[3] * n03 - this.v[11] * n00) / det;\r\n        const m33 = (this.v[2] * n03 - this.v[6] * n01 + this.v[10] * n00) / det;\r\n        return this.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    translate(vec) {\r\n        return this.setComponents(1, 0, 0, vec.v[0], 0, 1, 0, vec.v[1], 0, 0, 1, vec.v[2], 0, 0, 0, 1);\r\n    }\r\n    putTranslate(vec) {\r\n        this.v[12] = vec.v[0];\r\n        this.v[13] = vec.v[1];\r\n        this.v[14] = vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n     * Create X oriented Rotation Matrix\r\n     */\r\n    rotateX(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(1, 0, 0, 0, 0, cos, -sin, 0, 0, sin, cos, 0, 0, 0, 0, 1);\r\n    }\r\n    /**\r\n     * Create Y oriented Rotation Matrix\r\n     */\r\n    rotateY(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(cos, 0, sin, 0, 0, 1, 0, 0, -sin, 0, cos, 0, 0, 0, 0, 1);\r\n    }\r\n    /**\r\n   * Create Z oriented Rotation Matrix\r\n   */\r\n    rotateZ(radian) {\r\n        const cos = Math.cos(radian);\r\n        const sin = Math.sin(radian);\r\n        return this.setComponents(cos, -sin, 0, 0, sin, cos, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n    }\r\n    rotateXYZ(x, y, z) {\r\n        const cosX = Math.cos(x);\r\n        const sinX = Math.sin(x);\r\n        const cosY = Math.cos(y);\r\n        const sinY = Math.sin(y);\r\n        const cosZ = Math.cos(z);\r\n        const sinZ = Math.sin(z);\r\n        // const x00 = 1;\r\n        // const x01 = 0;\r\n        // const x02 = 0;\r\n        // const x10 = 0;\r\n        const x11 = cosX;\r\n        const x12 = -sinX;\r\n        // const x20 = 0;\r\n        const x21 = sinX;\r\n        const x22 = cosX;\r\n        const y00 = cosY;\r\n        // const y01 = 0;\r\n        const y02 = sinY;\r\n        // const y10 = 0;\r\n        // const y11 = 1;\r\n        // const y12 = 0;\r\n        const y20 = -sinY;\r\n        // const y21 = 0;\r\n        const y22 = cosY;\r\n        const z00 = cosZ;\r\n        const z01 = -sinZ;\r\n        // const z02 = 0;\r\n        const z10 = sinZ;\r\n        const z11 = cosZ;\r\n        // const z12 = 0;\r\n        // const z20 = 0;\r\n        // const z21 = 0;\r\n        // const z22 = 1;\r\n        // Y * X\r\n        const yx00 = y00;\r\n        const yx01 = y02 * x21;\r\n        const yx02 = y02 * x22;\r\n        //const yx10 = 0;\r\n        const yx11 = x11;\r\n        const yx12 = x12;\r\n        const yx20 = y20;\r\n        const yx21 = y22 * x21;\r\n        const yx22 = y22 * x22;\r\n        // Z * Y * X\r\n        const m00 = z00 * yx00;\r\n        const m01 = z00 * yx01 + z01 * yx11;\r\n        const m02 = z00 * yx02 + z01 * yx12;\r\n        const m10 = z10 * yx00;\r\n        const m11 = z10 * yx01 + z11 * yx11;\r\n        const m12 = z10 * yx02 + z11 * yx12;\r\n        const m20 = yx20;\r\n        const m21 = yx21;\r\n        const m22 = yx22;\r\n        const m03 = 0;\r\n        const m13 = 0;\r\n        const m23 = 0;\r\n        const m30 = 0;\r\n        const m31 = 0;\r\n        const m32 = 0;\r\n        const m33 = 1;\r\n        return this.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    rotate(vec) {\r\n        return this.rotateXYZ(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    scale(vec) {\r\n        return this.setComponents(vec.v[0], 0, 0, 0, 0, vec.v[1], 0, 0, 0, 0, vec.v[2], 0, 0, 0, 0, 1);\r\n    }\r\n    putScale(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[4] *= vec.v[0];\r\n        this.v[8] *= vec.v[0];\r\n        this.v[12] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        this.v[5] *= vec.v[1];\r\n        this.v[9] *= vec.v[1];\r\n        this.v[13] *= vec.v[1];\r\n        this.v[2] *= vec.v[2];\r\n        this.v[6] *= vec.v[2];\r\n        this.v[10] *= vec.v[2];\r\n        this.v[14] *= vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply the input matrix from right side\r\n     */\r\n    multiply(mat) {\r\n        const m00 = this.v[0] * mat.v[0] + this.v[4] * mat.v[1] + this.v[8] * mat.v[2] + this.v[12] * mat.v[3];\r\n        const m01 = this.v[0] * mat.v[4] + this.v[4] * mat.v[5] + this.v[8] * mat.v[6] + this.v[12] * mat.v[7];\r\n        const m02 = this.v[0] * mat.v[8] + this.v[4] * mat.v[9] + this.v[8] * mat.v[10] + this.v[12] * mat.v[11];\r\n        const m03 = this.v[0] * mat.v[12] + this.v[4] * mat.v[13] + this.v[8] * mat.v[14] + this.v[12] * mat.v[15];\r\n        const m10 = this.v[1] * mat.v[0] + this.v[5] * mat.v[1] + this.v[9] * mat.v[2] + this.v[13] * mat.v[3];\r\n        const m11 = this.v[1] * mat.v[4] + this.v[5] * mat.v[5] + this.v[9] * mat.v[6] + this.v[13] * mat.v[7];\r\n        const m12 = this.v[1] * mat.v[8] + this.v[5] * mat.v[9] + this.v[9] * mat.v[10] + this.v[13] * mat.v[11];\r\n        const m13 = this.v[1] * mat.v[12] + this.v[5] * mat.v[13] + this.v[9] * mat.v[14] + this.v[13] * mat.v[15];\r\n        const m20 = this.v[2] * mat.v[0] + this.v[6] * mat.v[1] + this.v[10] * mat.v[2] + this.v[14] * mat.v[3];\r\n        const m21 = this.v[2] * mat.v[4] + this.v[6] * mat.v[5] + this.v[10] * mat.v[6] + this.v[14] * mat.v[7];\r\n        const m22 = this.v[2] * mat.v[8] + this.v[6] * mat.v[9] + this.v[10] * mat.v[10] + this.v[14] * mat.v[11];\r\n        const m23 = this.v[2] * mat.v[12] + this.v[6] * mat.v[13] + this.v[10] * mat.v[14] + this.v[14] * mat.v[15];\r\n        const m30 = this.v[3] * mat.v[0] + this.v[7] * mat.v[1] + this.v[11] * mat.v[2] + this.v[15] * mat.v[3];\r\n        const m31 = this.v[3] * mat.v[4] + this.v[7] * mat.v[5] + this.v[11] * mat.v[6] + this.v[15] * mat.v[7];\r\n        const m32 = this.v[3] * mat.v[8] + this.v[7] * mat.v[9] + this.v[11] * mat.v[10] + this.v[15] * mat.v[11];\r\n        const m33 = this.v[3] * mat.v[12] + this.v[7] * mat.v[13] + this.v[11] * mat.v[14] + this.v[15] * mat.v[15];\r\n        return this.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    multiplyByLeft(mat) {\r\n        const m00 = mat.v[0] * this.v[0] + mat.v[4] * this.v[1] + mat.v[8] * this.v[2] + mat.v[12] * this.v[3];\r\n        const m01 = mat.v[0] * this.v[4] + mat.v[4] * this.v[5] + mat.v[8] * this.v[6] + mat.v[12] * this.v[7];\r\n        const m02 = mat.v[0] * this.v[8] + mat.v[4] * this.v[9] + mat.v[8] * this.v[10] + mat.v[12] * this.v[11];\r\n        const m03 = mat.v[0] * this.v[12] + mat.v[4] * this.v[13] + mat.v[8] * this.v[14] + mat.v[12] * this.v[15];\r\n        const m10 = mat.v[1] * this.v[0] + mat.v[5] * this.v[1] + mat.v[9] * this.v[2] + mat.v[13] * this.v[3];\r\n        const m11 = mat.v[1] * this.v[4] + mat.v[5] * this.v[5] + mat.v[9] * this.v[6] + mat.v[13] * this.v[7];\r\n        const m12 = mat.v[1] * this.v[8] + mat.v[5] * this.v[9] + mat.v[9] * this.v[10] + mat.v[13] * this.v[11];\r\n        const m13 = mat.v[1] * this.v[12] + mat.v[5] * this.v[13] + mat.v[9] * this.v[14] + mat.v[13] * this.v[15];\r\n        const m20 = mat.v[2] * this.v[0] + mat.v[6] * this.v[1] + mat.v[10] * this.v[2] + mat.v[14] * this.v[3];\r\n        const m21 = mat.v[2] * this.v[4] + mat.v[6] * this.v[5] + mat.v[10] * this.v[6] + mat.v[14] * this.v[7];\r\n        const m22 = mat.v[2] * this.v[8] + mat.v[6] * this.v[9] + mat.v[10] * this.v[10] + mat.v[14] * this.v[11];\r\n        const m23 = mat.v[2] * this.v[12] + mat.v[6] * this.v[13] + mat.v[10] * this.v[14] + mat.v[14] * this.v[15];\r\n        const m30 = mat.v[3] * this.v[0] + mat.v[7] * this.v[1] + mat.v[11] * this.v[2] + mat.v[15] * this.v[3];\r\n        const m31 = mat.v[3] * this.v[4] + mat.v[7] * this.v[5] + mat.v[11] * this.v[6] + mat.v[15] * this.v[7];\r\n        const m32 = mat.v[3] * this.v[8] + mat.v[7] * this.v[9] + mat.v[11] * this.v[10] + mat.v[15] * this.v[11];\r\n        const m33 = mat.v[3] * this.v[12] + mat.v[7] * this.v[13] + mat.v[11] * this.v[14] + mat.v[15] * this.v[15];\r\n        return this.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n    fromQuaternion(quat) {\r\n        const sx = quat.v[0] * quat.v[0];\r\n        const sy = quat.v[1] * quat.v[1];\r\n        const sz = quat.v[2] * quat.v[2];\r\n        const cx = quat.v[1] * quat.v[2];\r\n        const cy = quat.v[0] * quat.v[2];\r\n        const cz = quat.v[0] * quat.v[1];\r\n        const wx = quat.v[3] * quat.v[0];\r\n        const wy = quat.v[3] * quat.v[1];\r\n        const wz = quat.v[3] * quat.v[2];\r\n        const m00 = 1.0 - 2.0 * (sy + sz);\r\n        const m01 = 2.0 * (cz - wz);\r\n        const m02 = 2.0 * (cy + wy);\r\n        const m03 = 0;\r\n        const m10 = 2.0 * (cz + wz);\r\n        const m11 = 1.0 - 2.0 * (sx + sz);\r\n        const m12 = 2.0 * (cx - wx);\r\n        const m13 = 0;\r\n        const m20 = 2.0 * (cy - wy);\r\n        const m21 = 2.0 * (cx + wx);\r\n        const m22 = 1.0 - 2.0 * (sx + sy);\r\n        const m23 = 0;\r\n        const m30 = 0;\r\n        const m31 = 0;\r\n        const m32 = 0;\r\n        const m33 = 1;\r\n        return this.setComponents(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableMatrix44.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableQuaternion.ts":
/*!**************************************************!*\
  !*** ./src/foundation/math/MutableQuaternion.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableQuaternion; });\n/* harmony import */ var _Quaternion__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n\r\nclass MutableQuaternion extends _Quaternion__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(x, y, z, w) {\r\n        super(x, y, z, w);\r\n    }\r\n    set x(x) {\r\n        this.v[0] = x;\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    set y(y) {\r\n        this.v[1] = y;\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    set z(z) {\r\n        this.v[2] = z;\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    set w(w) {\r\n        this.v[3] = w;\r\n    }\r\n    get w() {\r\n        return this.v[3];\r\n    }\r\n    static identity() {\r\n        return super.identity();\r\n    }\r\n    static dummy() {\r\n        return super.dummy();\r\n    }\r\n    static invert(quat) {\r\n        return super.invert(quat);\r\n    }\r\n    static qlerp(l_quat, r_quat, ratio) {\r\n        return super.qlerp(l_quat, r_quat, ratio);\r\n    }\r\n    static lerp(l_quat, r_quat, ratio) {\r\n        return super.lerp(l_quat, r_quat, ratio);\r\n    }\r\n    static axisAngle(vec, radian) {\r\n        return super.axisAngle(vec, radian);\r\n    }\r\n    static fromMatrix(mat) {\r\n        return super.fromMatrix(mat);\r\n    }\r\n    static fromPosition(vec) {\r\n        return super.fromPosition(vec);\r\n    }\r\n    static add(l_quat, r_quat) {\r\n        return super.add(l_quat, r_quat);\r\n    }\r\n    static subtract(l_quat, r_quat) {\r\n        return super.subtract(l_quat, r_quat);\r\n    }\r\n    static multiply(l_quat, r_quat) {\r\n        return super.multiply(l_quat, r_quat);\r\n    }\r\n    static multiplyNumber(quat, value) {\r\n        return super.multiplyNumber(quat, value);\r\n    }\r\n    static divideNumber(quat, value) {\r\n        return super.divideNumber(quat, value);\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(i, value) {\r\n        this.v[i] = value;\r\n        return this;\r\n    }\r\n    setComponents(x, y, z, w) {\r\n        this.v[0] = x;\r\n        this.v[1] = y;\r\n        this.v[2] = z;\r\n        this.v[3] = w;\r\n        return this;\r\n    }\r\n    copyComponents(quat) {\r\n        return this.setComponents(quat.v[0], quat.v[1], quat.v[2], quat.v[3]);\r\n    }\r\n    identity() {\r\n        return this.setComponents(0, 0, 0, 1);\r\n    }\r\n    normalize() {\r\n        const norm = this.length();\r\n        return this.divideNumber(norm);\r\n    }\r\n    invert() {\r\n        const norm = this.length();\r\n        if (norm === 0.0) {\r\n            return this; // [0, 0, 0, 0]\r\n        }\r\n        this.v[0] = -this.v[0] / norm;\r\n        this.v[1] = -this.v[1] / norm;\r\n        this.v[2] = -this.v[2] / norm;\r\n        this.v[3] = this.v[3] / norm;\r\n        return this;\r\n    }\r\n    qlerp(l_quat, r_quat, ratio) {\r\n        let qr = l_quat.v[3] * r_quat.v[3] + l_quat.v[0] * r_quat.v[0] + l_quat.v[1] * r_quat.v[1] + l_quat.v[2] * r_quat.v[2];\r\n        const ss = 1.0 - qr * qr;\r\n        if (ss === 0.0) {\r\n            return this.copyComponents(l_quat);\r\n        }\r\n        else {\r\n            if (qr > 1) {\r\n                qr = 0.999;\r\n            }\r\n            else if (qr < -1) {\r\n                qr = -0.999;\r\n            }\r\n            let ph = Math.acos(qr);\r\n            let s2;\r\n            if (qr < 0.0 && ph > Math.PI / 2.0) {\r\n                qr = -l_quat.v[3] * r_quat.v[3] - l_quat.v[0] * r_quat.v[0] - l_quat.v[1] * r_quat.v[1] - l_quat.v[2] * r_quat.v[2];\r\n                ph = Math.acos(qr);\r\n                s2 = -1 * Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            else {\r\n                s2 = Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            const s1 = Math.sin(ph * (1.0 - ratio)) / Math.sin(ph);\r\n            this.v[0] = l_quat.v[0] * s1 + r_quat.v[0] * s2;\r\n            this.v[1] = l_quat.v[1] * s1 + r_quat.v[1] * s2;\r\n            this.v[2] = l_quat.v[2] * s1 + r_quat.v[2] * s2;\r\n            this.v[3] = l_quat.v[3] * s1 + r_quat.v[3] * s2;\r\n        }\r\n        return this;\r\n    }\r\n    lerp(l_quat, r_quat, ratio) {\r\n        this.v[0] = l_quat.v[0] * (1 - ratio) + r_quat.v[0] * ratio;\r\n        this.v[1] = l_quat.v[1] * (1 - ratio) + r_quat.v[1] * ratio;\r\n        this.v[2] = l_quat.v[2] * (1 - ratio) + r_quat.v[2] * ratio;\r\n        this.v[3] = l_quat.v[3] * (1 - ratio) + r_quat.v[3] * ratio;\r\n        return this;\r\n    }\r\n    axisAngle(vec, radian) {\r\n        const halfAngle = 0.5 * radian;\r\n        const sin = Math.sin(halfAngle);\r\n        const length = vec.length();\r\n        if (length === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        this.v[3] = Math.cos(halfAngle);\r\n        this.v[0] = sin * vec.v[0] / length;\r\n        this.v[1] = sin * vec.v[1] / length;\r\n        this.v[2] = sin * vec.v[2] / length;\r\n        return this;\r\n    }\r\n    fromMatrix(mat) {\r\n        const tr = mat.m00 + mat.m11 + mat.m22;\r\n        if (tr > 0) {\r\n            const S = 0.5 / Math.sqrt(tr + 1.0);\r\n            this.v[0] = (mat.m21 - mat.m12) * S;\r\n            this.v[1] = (mat.m02 - mat.m20) * S;\r\n            this.v[2] = (mat.m10 - mat.m01) * S;\r\n            this.v[3] = 0.25 / S;\r\n        }\r\n        else if ((mat.m00 > mat.m11) && (mat.m00 > mat.m22)) {\r\n            const S = Math.sqrt(1.0 + mat.m00 - mat.m11 - mat.m22) * 2;\r\n            this.v[0] = 0.25 * S;\r\n            this.v[1] = (mat.m01 + mat.m10) / S;\r\n            this.v[2] = (mat.m02 + mat.m20) / S;\r\n            this.v[3] = (mat.m21 - mat.m12) / S;\r\n        }\r\n        else if (mat.m11 > mat.m22) {\r\n            const S = Math.sqrt(1.0 + mat.m11 - mat.m00 - mat.m22) * 2;\r\n            this.v[0] = (mat.m01 + mat.m10) / S;\r\n            this.v[1] = 0.25 * S;\r\n            this.v[2] = (mat.m12 + mat.m21) / S;\r\n            this.v[3] = (mat.m02 - mat.m20) / S;\r\n        }\r\n        else {\r\n            const S = Math.sqrt(1.0 + mat.m22 - mat.m00 - mat.m11) * 2;\r\n            this.v[0] = (mat.m02 + mat.m20) / S;\r\n            this.v[1] = (mat.m12 + mat.m21) / S;\r\n            this.v[2] = 0.25 * S;\r\n            this.v[3] = (mat.m10 - mat.m01) / S;\r\n        }\r\n        return this;\r\n    }\r\n    fromPosition(vec) {\r\n        return this.setComponents(vec.v[0], vec.v[1], vec.v[2], 0);\r\n    }\r\n    add(quat) {\r\n        this.v[0] += quat.v[0];\r\n        this.v[1] += quat.v[1];\r\n        this.v[2] += quat.v[2];\r\n        this.v[3] += quat.v[3];\r\n        return this;\r\n    }\r\n    subtract(quat) {\r\n        this.v[0] -= quat.v[0];\r\n        this.v[1] -= quat.v[1];\r\n        this.v[2] -= quat.v[2];\r\n        this.v[3] -= quat.v[3];\r\n        return this;\r\n    }\r\n    multiply(quat) {\r\n        const x = quat.v[3] * this.v[0] + quat.v[2] * this.v[1] + quat.v[1] * this.v[2] - quat.v[0] * this.v[3];\r\n        const y = -quat.v[2] * this.v[0] + quat.v[3] * this.v[1] + quat.v[0] * this.v[2] - quat.v[1] * this.v[3];\r\n        const z = quat.v[1] * this.v[0] + quat.v[0] * this.v[1] + quat.v[3] * this.v[2] - quat.v[2] * this.v[3];\r\n        const w = -quat.v[0] * this.v[0] - quat.v[1] * this.v[1] - quat.v[2] * this.v[2] - quat.v[3] * this.v[3];\r\n        return this.setComponents(x, y, z, w);\r\n    }\r\n    multiplyNumber(value) {\r\n        this.v[0] *= value;\r\n        this.v[1] *= value;\r\n        this.v[2] *= value;\r\n        this.v[3] *= value;\r\n        return this;\r\n    }\r\n    divideNumber(value) {\r\n        if (value !== 0) {\r\n            this.v[0] /= value;\r\n            this.v[1] /= value;\r\n            this.v[2] /= value;\r\n            this.v[3] /= value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = Infinity;\r\n            this.v[1] = Infinity;\r\n            this.v[2] = Infinity;\r\n            this.v[3] = Infinity;\r\n        }\r\n        return this;\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableQuaternion.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableScalar.ts":
/*!**********************************************!*\
  !*** ./src/foundation/math/MutableScalar.ts ***!
  \**********************************************/
/*! exports provided: MutableScalar_, default, MutableScalard */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableScalar_\", function() { return MutableScalar_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableScalar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableScalard\", function() { return MutableScalard; });\n/* harmony import */ var _Scalar__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Scalar */ \"./src/foundation/math/Scalar.ts\");\n\r\nclass MutableScalar_ extends _Scalar__WEBPACK_IMPORTED_MODULE_0__[\"Scalar_\"] {\r\n    constructor(x, { type }) {\r\n        super(x, { type });\r\n    }\r\n    copyComponents(vec) {\r\n        this.v[0] = vec.v[0];\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    set x(x) {\r\n        this.v[0] = x;\r\n    }\r\n    setValue(value) {\r\n        this.x = value;\r\n        return this;\r\n    }\r\n}\r\nclass MutableScalar extends MutableScalar_ {\r\n    constructor(x) {\r\n        super(x, { type: Float32Array });\r\n    }\r\n    clone() {\r\n        return new MutableScalar(this.x);\r\n    }\r\n    static one() {\r\n        return new MutableScalar(1);\r\n    }\r\n    static dummy() {\r\n        return new MutableScalar(null);\r\n    }\r\n    static zero() {\r\n        return new MutableScalar(0);\r\n    }\r\n}\r\nclass MutableScalard extends MutableScalar_ {\r\n    constructor(x) {\r\n        super(x, { type: Float64Array });\r\n    }\r\n    clone() {\r\n        return new MutableScalard(this.x);\r\n    }\r\n    static one() {\r\n        return new MutableScalard(1);\r\n    }\r\n    static dummy() {\r\n        return new MutableScalard(null);\r\n    }\r\n    static zero() {\r\n        return new MutableScalard(0);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableScalar.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableVector2.ts":
/*!***********************************************!*\
  !*** ./src/foundation/math/MutableVector2.ts ***!
  \***********************************************/
/*! exports provided: MutableVector2_, default, MutableVector2d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector2_\", function() { return MutableVector2_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableVector2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector2d\", function() { return MutableVector2d; });\n/* harmony import */ var _Vector2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector2 */ \"./src/foundation/math/Vector2.ts\");\n\r\nclass MutableVector2_ extends _Vector2__WEBPACK_IMPORTED_MODULE_0__[\"Vector2_\"] {\r\n    constructor(x, y, { type }) {\r\n        super(x, y, { type });\r\n    }\r\n    set x(x) {\r\n        this.v[0] = x;\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    set y(y) {\r\n        this.v[1] = y;\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(i, value) {\r\n        this.v[i] = value;\r\n        return this;\r\n    }\r\n    setComponents(x, y) {\r\n        this.v[0] = x;\r\n        this.v[1] = y;\r\n        return this;\r\n    }\r\n    copyComponents(vec) {\r\n        return this.setComponents(vec.v[0], vec.v[1]);\r\n    }\r\n    zero() {\r\n        return this.setComponents(0, 0);\r\n    }\r\n    one() {\r\n        return this.setComponents(1, 1);\r\n    }\r\n    normalize() {\r\n        const length = this.length();\r\n        this.divide(length);\r\n        return this;\r\n    }\r\n    /**\r\n     * add value\r\n     */\r\n    add(vec) {\r\n        this.v[0] += vec.v[0];\r\n        this.v[1] += vec.v[1];\r\n        return this;\r\n    }\r\n    /**\r\n      * subtract\r\n      */\r\n    subtract(vec) {\r\n        this.v[0] -= vec.v[0];\r\n        this.v[1] -= vec.v[1];\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply\r\n     */\r\n    multiply(value) {\r\n        this.v[0] *= value;\r\n        this.v[1] *= value;\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply vector\r\n     */\r\n    multiplyVector(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        return this;\r\n    }\r\n    /**\r\n     * divide\r\n     */\r\n    divide(value) {\r\n        if (value !== 0) {\r\n            this.v[0] /= value;\r\n            this.v[1] /= value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = Infinity;\r\n            this.v[1] = Infinity;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n      * divide vector\r\n      */\r\n    divideVector(vec) {\r\n        if (vec.v[0] !== 0 && vec.v[1] !== 0) {\r\n            this.v[0] /= vec.v[0];\r\n            this.v[1] /= vec.v[1];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = vec.v[0] === 0 ? Infinity : this.v[0] / vec.v[0];\r\n            this.v[1] = vec.v[1] === 0 ? Infinity : this.v[1] / vec.v[1];\r\n        }\r\n        return this;\r\n    }\r\n}\r\nclass MutableVector2 extends MutableVector2_ {\r\n    constructor(x, y) {\r\n        super(x, y, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass MutableVector2d extends MutableVector2_ {\r\n    constructor(x, y) {\r\n        super(x, y, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableVector2.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableVector3.ts":
/*!***********************************************!*\
  !*** ./src/foundation/math/MutableVector3.ts ***!
  \***********************************************/
/*! exports provided: MutableVector3_, default, MutableVector3d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector3_\", function() { return MutableVector3_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableVector3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector3d\", function() { return MutableVector3d; });\n/* harmony import */ var _Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector3 */ \"./src/foundation/math/Vector3.ts\");\n\r\nclass MutableVector3_ extends _Vector3__WEBPACK_IMPORTED_MODULE_0__[\"Vector3_\"] {\r\n    constructor(x, y, z, { type }) {\r\n        super(x, y, z, { type });\r\n    }\r\n    set x(x) {\r\n        this.v[0] = x;\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    set y(y) {\r\n        this.v[1] = y;\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    set z(z) {\r\n        this.v[2] = z;\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(i, value) {\r\n        this.v[i] = value;\r\n        return this;\r\n    }\r\n    setComponents(x, y, z) {\r\n        this.v[0] = x;\r\n        this.v[1] = y;\r\n        this.v[2] = z;\r\n        return this;\r\n    }\r\n    copyComponents(vec) {\r\n        return this.setComponents(vec.v[0], vec.v[1], vec.v[2]);\r\n    }\r\n    zero() {\r\n        return this.setComponents(0, 0, 0);\r\n    }\r\n    one() {\r\n        return this.setComponents(1, 1, 1);\r\n    }\r\n    /**\r\n   * normalize\r\n   */\r\n    normalize() {\r\n        const length = this.length();\r\n        this.divide(length);\r\n        return this;\r\n    }\r\n    /**\r\n   * add value\r\n   */\r\n    add(vec) {\r\n        this.v[0] += vec.v[0];\r\n        this.v[1] += vec.v[1];\r\n        this.v[2] += vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n   * subtract\r\n   */\r\n    subtract(vec) {\r\n        this.v[0] -= vec.v[0];\r\n        this.v[1] -= vec.v[1];\r\n        this.v[2] -= vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply\r\n     */\r\n    multiply(value) {\r\n        this.v[0] *= value;\r\n        this.v[1] *= value;\r\n        this.v[2] *= value;\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply vector\r\n     */\r\n    multiplyVector(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        this.v[2] *= vec.v[2];\r\n        return this;\r\n    }\r\n    /**\r\n     * divide\r\n     */\r\n    divide(value) {\r\n        if (value !== 0) {\r\n            this.v[0] /= value;\r\n            this.v[1] /= value;\r\n            this.v[2] /= value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = Infinity;\r\n            this.v[1] = Infinity;\r\n            this.v[2] = Infinity;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n   * divide vector\r\n   */\r\n    divideVector(vec) {\r\n        if (vec.v[0] !== 0 && vec.v[1] !== 0 && vec.v[2] !== 0) {\r\n            this.v[0] /= vec.v[0];\r\n            this.v[1] /= vec.v[1];\r\n            this.v[2] /= vec.v[2];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = vec.v[0] === 0 ? Infinity : this.v[0] / vec.v[0];\r\n            this.v[1] = vec.v[1] === 0 ? Infinity : this.v[1] / vec.v[1];\r\n            this.v[2] = vec.v[2] === 0 ? Infinity : this.v[2] / vec.v[2];\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * cross product\r\n     */\r\n    cross(vec) {\r\n        const x = this.v[1] * vec.v[2] - this.v[2] * vec.v[1];\r\n        const y = this.v[2] * vec.v[0] - this.v[0] * vec.v[2];\r\n        const z = this.v[0] * vec.v[1] - this.v[1] * vec.v[0];\r\n        return this.setComponents(x, y, z);\r\n    }\r\n    /**\r\n     * quaternion * vector3\r\n     */\r\n    multiplyQuaternion(quat) {\r\n        const num = quat.v[0] * 2;\r\n        const num2 = quat.v[1] * 2;\r\n        const num3 = quat.v[2] * 2;\r\n        const num4 = quat.v[0] * num;\r\n        const num5 = quat.v[1] * num2;\r\n        const num6 = quat.v[2] * num3;\r\n        const num7 = quat.v[0] * num2;\r\n        const num8 = quat.v[0] * num3;\r\n        const num9 = quat.v[1] * num3;\r\n        const num10 = quat.v[3] * num;\r\n        const num11 = quat.v[3] * num2;\r\n        const num12 = quat.v[3] * num3;\r\n        const x = (1 - (num5 + num6)) * this.v[0] + (num7 - num12) * this.v[1] + (num8 + num11) * this.v[2];\r\n        const y = (num7 + num12) * this.v[0] + (1 - (num4 + num6)) * this.v[1] + (num9 - num10) * this.v[2];\r\n        const z = (num8 - num11) * this.v[0] + (num9 + num10) * this.v[1] + (1 - (num4 + num5)) * this.v[2];\r\n        return this.setComponents(x, y, z);\r\n    }\r\n}\r\nclass MutableVector3 extends MutableVector3_ {\r\n    constructor(x, y, z) {\r\n        super(x, y, z, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static cross(l_vec, r_vec) {\r\n        return super._cross(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiplyQuaternion(quat, vec) {\r\n        return super._multiplyQuaternion(quat, vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass MutableVector3d extends MutableVector3_ {\r\n    constructor(x, y, z) {\r\n        super(x, y, z, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static cross(l_vec, r_vec) {\r\n        return super._cross(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiplyQuaternion(quat, vec) {\r\n        return super._multiplyQuaternion(quat, vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableVector3.ts?");

/***/ }),

/***/ "./src/foundation/math/MutableVector4.ts":
/*!***********************************************!*\
  !*** ./src/foundation/math/MutableVector4.ts ***!
  \***********************************************/
/*! exports provided: MutableVector4_, default, MutableVector4d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector4_\", function() { return MutableVector4_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MutableVector4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableVector4d\", function() { return MutableVector4d; });\n/* harmony import */ var _Vector4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector4 */ \"./src/foundation/math/Vector4.ts\");\n\r\nclass MutableVector4_ extends _Vector4__WEBPACK_IMPORTED_MODULE_0__[\"Vector4_\"] {\r\n    constructor(x, y, z, w, { type }) {\r\n        super(x, y, z, w, { type });\r\n    }\r\n    set x(x) {\r\n        this.v[0] = x;\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    set y(y) {\r\n        this.v[1] = y;\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    set z(z) {\r\n        this.v[2] = z;\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    set w(w) {\r\n        this.v[3] = w;\r\n    }\r\n    get w() {\r\n        return this.v[3];\r\n    }\r\n    raw() {\r\n        return this.v;\r\n    }\r\n    setAt(i, value) {\r\n        this.v[i] = value;\r\n        return this;\r\n    }\r\n    setComponents(x, y, z, w) {\r\n        this.v[0] = x;\r\n        this.v[1] = y;\r\n        this.v[2] = z;\r\n        this.v[3] = w;\r\n        return this;\r\n    }\r\n    copyComponents(vec) {\r\n        return this.setComponents(vec.v[0], vec.v[1], vec.v[2], vec.v[3]);\r\n    }\r\n    zero() {\r\n        return this.setComponents(0, 0, 0, 0);\r\n    }\r\n    one() {\r\n        return this.setComponents(1, 1, 1, 1);\r\n    }\r\n    /**\r\n     * normalize\r\n     */\r\n    normalize() {\r\n        const length = this.length();\r\n        this.divide(length);\r\n        return this;\r\n    }\r\n    normalize3() {\r\n        const length = Math.hypot(this.v[0], this.v[1], this.v[2]);\r\n        this.divide(length);\r\n        return this;\r\n    }\r\n    /**\r\n     * add value\r\n     */\r\n    add(vec) {\r\n        this.v[0] += vec.v[0];\r\n        this.v[1] += vec.v[1];\r\n        this.v[2] += vec.v[2];\r\n        this.v[3] += vec.v[3];\r\n        return this;\r\n    }\r\n    /**\r\n     * subtract\r\n     */\r\n    subtract(vec) {\r\n        this.v[0] -= vec.v[0];\r\n        this.v[1] -= vec.v[1];\r\n        this.v[2] -= vec.v[2];\r\n        this.v[3] -= vec.v[3];\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply\r\n     */\r\n    multiply(value) {\r\n        this.v[0] *= value;\r\n        this.v[1] *= value;\r\n        this.v[2] *= value;\r\n        this.v[3] *= value;\r\n        return this;\r\n    }\r\n    /**\r\n     * multiply vector\r\n     */\r\n    multiplyVector(vec) {\r\n        this.v[0] *= vec.v[0];\r\n        this.v[1] *= vec.v[1];\r\n        this.v[2] *= vec.v[2];\r\n        this.v[3] *= vec.v[3];\r\n        return this;\r\n    }\r\n    /**\r\n     * divide\r\n     */\r\n    divide(value) {\r\n        if (value !== 0) {\r\n            this.v[0] /= value;\r\n            this.v[1] /= value;\r\n            this.v[2] /= value;\r\n            this.v[3] /= value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = Infinity;\r\n            this.v[1] = Infinity;\r\n            this.v[2] = Infinity;\r\n            this.v[3] = Infinity;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * divide vector\r\n     */\r\n    divideVector(vec) {\r\n        if (vec.v[0] !== 0 && vec.v[1] !== 0 && vec.v[2] !== 0 && vec.v[3] !== 0) {\r\n            this.v[0] /= vec.v[0];\r\n            this.v[1] /= vec.v[1];\r\n            this.v[2] /= vec.v[2];\r\n            this.v[3] /= vec.v[3];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            this.v[0] = vec.v[0] === 0 ? Infinity : this.v[0] / vec.v[0];\r\n            this.v[1] = vec.v[1] === 0 ? Infinity : this.v[1] / vec.v[1];\r\n            this.v[2] = vec.v[2] === 0 ? Infinity : this.v[2] / vec.v[2];\r\n            this.v[3] = vec.v[3] === 0 ? Infinity : this.v[3] / vec.v[3];\r\n        }\r\n        return this;\r\n    }\r\n}\r\nclass MutableVector4 extends MutableVector4_ {\r\n    constructor(x, y, z, w) {\r\n        super(x, y, z, w, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass MutableVector4d extends MutableVector4_ {\r\n    constructor(x, y, z, w) {\r\n        super(x, y, z, w, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/MutableVector4.ts?");

/***/ }),

/***/ "./src/foundation/math/Quaternion.ts":
/*!*******************************************!*\
  !*** ./src/foundation/math/Quaternion.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Quaternion; });\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _LogQuaternion__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LogQuaternion */ \"./src/foundation/math/LogQuaternion.ts\");\n\r\n\r\n\r\nclass Quaternion {\r\n    constructor(x, y, z, w) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new Float32Array(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new Float32Array(4);\r\n        }\r\n        if (Array.isArray(x)) {\r\n            this.v[0] = x[0];\r\n            this.v[1] = x[1];\r\n            this.v[2] = x[2];\r\n            this.v[3] = x[3];\r\n        }\r\n        else if (typeof x === 'number') {\r\n            this.v[0] = x;\r\n            this.v[1] = y;\r\n            this.v[2] = z;\r\n            this.v[3] = w;\r\n        }\r\n        else if (x instanceof _LogQuaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) {\r\n            const theta = x.v[0] * x.v[0] + x.v[1] * x.v[1] + x.v[2] * x.v[2];\r\n            const sin = Math.sin(theta);\r\n            this.v[0] = x.v[0] * (sin / theta);\r\n            this.v[1] = x.v[1] * (sin / theta);\r\n            this.v[2] = x.v[2] * (sin / theta);\r\n            this.v[3] = Math.cos(theta);\r\n        }\r\n        else {\r\n            if (typeof x.v[2] === 'undefined') {\r\n                // IVector2\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = 0;\r\n                this.v[3] = 1;\r\n            }\r\n            else if (typeof x.v[3] === 'undefined') {\r\n                // IVector3\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = x.v[2];\r\n                this.v[3] = 1;\r\n            }\r\n            else {\r\n                // IVector4 and IQuaternion\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = x.v[2];\r\n                this.v[3] = x.v[3];\r\n            }\r\n        }\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    get w() {\r\n        return this.v[3];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec4;\r\n    }\r\n    static identity() {\r\n        return new this(0, 0, 0, 1);\r\n    }\r\n    static dummy() {\r\n        return new this(null);\r\n    }\r\n    static invert(quat) {\r\n        const norm = quat.length();\r\n        if (norm === 0.0) {\r\n            return new this(0, 0, 0, 0);\r\n        }\r\n        const x = -quat.v[0] / norm;\r\n        const y = -quat.v[1] / norm;\r\n        const z = -quat.v[2] / norm;\r\n        const w = quat.v[3] / norm;\r\n        return new this(x, y, z, w);\r\n    }\r\n    static invertTo(quat, out) {\r\n        const norm = quat.length();\r\n        if (norm === 0.0) {\r\n            return out.setComponents(0, 0, 0, 0);\r\n        }\r\n        out.v[0] = -quat.v[0] / norm;\r\n        out.v[1] = -quat.v[1] / norm;\r\n        out.v[2] = -quat.v[2] / norm;\r\n        out.v[3] = quat.v[3] / norm;\r\n        return out;\r\n    }\r\n    static qlerp(l_quat, r_quat, ratio) {\r\n        let qr = l_quat.v[3] * r_quat.v[3] + l_quat.v[0] * r_quat.v[0] + l_quat.v[1] * r_quat.v[1] + l_quat.v[2] * r_quat.v[2];\r\n        const ss = 1.0 - qr * qr;\r\n        if (ss === 0.0) {\r\n            return l_quat.clone();\r\n        }\r\n        else {\r\n            if (qr > 1) {\r\n                qr = 0.999;\r\n            }\r\n            else if (qr < -1) {\r\n                qr = -0.999;\r\n            }\r\n            let ph = Math.acos(qr);\r\n            let s2;\r\n            if (qr < 0.0 && ph > Math.PI / 2.0) {\r\n                qr = -l_quat.v[3] * r_quat.v[3] - l_quat.v[0] * r_quat.v[0] - l_quat.v[1] * r_quat.v[1] - l_quat.v[2] * r_quat.v[2];\r\n                ph = Math.acos(qr);\r\n                s2 = -1 * Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            else {\r\n                s2 = Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            const s1 = Math.sin(ph * (1.0 - ratio)) / Math.sin(ph);\r\n            return new this(l_quat.v[0] * s1 + r_quat.v[0] * s2, l_quat.v[1] * s1 + r_quat.v[1] * s2, l_quat.v[2] * s1 + r_quat.v[2] * s2, l_quat.v[3] * s1 + r_quat.v[3] * s2);\r\n        }\r\n    }\r\n    static qlerpTo(l_quat, r_quat, ratio, out) {\r\n        let qr = l_quat.v[3] * r_quat.v[3] + l_quat.v[0] * r_quat.v[0] + l_quat.v[1] * r_quat.v[1] + l_quat.v[2] * r_quat.v[2];\r\n        const ss = 1.0 - qr * qr;\r\n        if (ss === 0.0) {\r\n            return out.copyComponents(l_quat);\r\n        }\r\n        else {\r\n            if (qr > 1) {\r\n                qr = 0.999;\r\n            }\r\n            else if (qr < -1) {\r\n                qr = -0.999;\r\n            }\r\n            let ph = Math.acos(qr);\r\n            let s2;\r\n            if (qr < 0.0 && ph > Math.PI / 2.0) {\r\n                qr = -l_quat.v[3] * r_quat.v[3] - l_quat.v[0] * r_quat.v[0] - l_quat.v[1] * r_quat.v[1] - l_quat.v[2] * r_quat.v[2];\r\n                ph = Math.acos(qr);\r\n                s2 = -1 * Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            else {\r\n                s2 = Math.sin(ph * ratio) / Math.sin(ph);\r\n            }\r\n            const s1 = Math.sin(ph * (1.0 - ratio)) / Math.sin(ph);\r\n            out.v[0] = l_quat.v[0] * s1 + r_quat.v[0] * s2;\r\n            out.v[1] = l_quat.v[1] * s1 + r_quat.v[1] * s2;\r\n            out.v[2] = l_quat.v[2] * s1 + r_quat.v[2] * s2;\r\n            out.v[3] = l_quat.v[3] * s1 + r_quat.v[3] * s2;\r\n        }\r\n        return out;\r\n    }\r\n    static lerp(l_quat, r_quat, ratio) {\r\n        const x = l_quat.v[0] * (1 - ratio) + r_quat.v[0] * ratio;\r\n        const y = l_quat.v[1] * (1 - ratio) + r_quat.v[1] * ratio;\r\n        const z = l_quat.v[2] * (1 - ratio) + r_quat.v[2] * ratio;\r\n        const w = l_quat.v[3] * (1 - ratio) + r_quat.v[3] * ratio;\r\n        return new this(x, y, z, w);\r\n    }\r\n    static lerpTo(l_quat, r_quat, ratio, out) {\r\n        out.v[0] = l_quat.v[0] * (1 - ratio) + r_quat.v[0] * ratio;\r\n        out.v[1] = l_quat.v[1] * (1 - ratio) + r_quat.v[1] * ratio;\r\n        out.v[2] = l_quat.v[2] * (1 - ratio) + r_quat.v[2] * ratio;\r\n        out.v[3] = l_quat.v[3] * (1 - ratio) + r_quat.v[3] * ratio;\r\n        return out;\r\n    }\r\n    static axisAngle(vec, radian) {\r\n        const halfAngle = 0.5 * radian;\r\n        const sin = Math.sin(halfAngle);\r\n        const length = vec.length();\r\n        if (length === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        return new this(sin * vec.v[0] / length, sin * vec.v[1] / length, sin * vec.v[2] / length, Math.cos(halfAngle));\r\n    }\r\n    static fromMatrix(mat) {\r\n        const quat = new this(0, 0, 0, 1);\r\n        const tr = mat.m00 + mat.m11 + mat.m22;\r\n        if (tr > 0) {\r\n            const S = 0.5 / Math.sqrt(tr + 1.0);\r\n            quat.v[3] = 0.25 / S;\r\n            quat.v[0] = (mat.m21 - mat.m12) * S;\r\n            quat.v[1] = (mat.m02 - mat.m20) * S;\r\n            quat.v[2] = (mat.m10 - mat.m01) * S;\r\n        }\r\n        else if ((mat.m00 > mat.m11) && (mat.m00 > mat.m22)) {\r\n            const S = Math.sqrt(1.0 + mat.m00 - mat.m11 - mat.m22) * 2;\r\n            quat.v[3] = (mat.m21 - mat.m12) / S;\r\n            quat.v[0] = 0.25 * S;\r\n            quat.v[1] = (mat.m01 + mat.m10) / S;\r\n            quat.v[2] = (mat.m02 + mat.m20) / S;\r\n        }\r\n        else if (mat.m11 > mat.m22) {\r\n            const S = Math.sqrt(1.0 + mat.m11 - mat.m00 - mat.m22) * 2;\r\n            quat.v[3] = (mat.m02 - mat.m20) / S;\r\n            quat.v[0] = (mat.m01 + mat.m10) / S;\r\n            quat.v[1] = 0.25 * S;\r\n            quat.v[2] = (mat.m12 + mat.m21) / S;\r\n        }\r\n        else {\r\n            const S = Math.sqrt(1.0 + mat.m22 - mat.m00 - mat.m11) * 2;\r\n            quat.v[3] = (mat.m10 - mat.m01) / S;\r\n            quat.v[0] = (mat.m02 + mat.m20) / S;\r\n            quat.v[1] = (mat.m12 + mat.m21) / S;\r\n            quat.v[2] = 0.25 * S;\r\n        }\r\n        return quat;\r\n    }\r\n    static fromMatrixTo(mat, out) {\r\n        const tr = mat.m00 + mat.m11 + mat.m22;\r\n        if (tr > 0) {\r\n            const S = 0.5 / Math.sqrt(tr + 1.0);\r\n            out.v[3] = 0.25 / S;\r\n            out.v[0] = (mat.m21 - mat.m12) * S;\r\n            out.v[1] = (mat.m02 - mat.m20) * S;\r\n            out.v[2] = (mat.m10 - mat.m01) * S;\r\n        }\r\n        else if ((mat.m00 > mat.m11) && (mat.m00 > mat.m22)) {\r\n            const S = Math.sqrt(1.0 + mat.m00 - mat.m11 - mat.m22) * 2;\r\n            out.v[3] = (mat.m21 - mat.m12) / S;\r\n            out.v[0] = 0.25 * S;\r\n            out.v[1] = (mat.m01 + mat.m10) / S;\r\n            out.v[2] = (mat.m02 + mat.m20) / S;\r\n        }\r\n        else if (mat.m11 > mat.m22) {\r\n            const S = Math.sqrt(1.0 + mat.m11 - mat.m00 - mat.m22) * 2;\r\n            out.v[3] = (mat.m02 - mat.m20) / S;\r\n            out.v[0] = (mat.m01 + mat.m10) / S;\r\n            out.v[1] = 0.25 * S;\r\n            out.v[2] = (mat.m12 + mat.m21) / S;\r\n        }\r\n        else {\r\n            const S = Math.sqrt(1.0 + mat.m22 - mat.m00 - mat.m11) * 2;\r\n            out.v[3] = (mat.m10 - mat.m01) / S;\r\n            out.v[0] = (mat.m02 + mat.m20) / S;\r\n            out.v[1] = (mat.m12 + mat.m21) / S;\r\n            out.v[2] = 0.25 * S;\r\n        }\r\n        return out;\r\n    }\r\n    static lookFromTo(fromDirection, toDirection) {\r\n        if (fromDirection.isEqual(toDirection)) {\r\n            return new this(0, 0, 0, 1);\r\n        }\r\n        return this.qlerp(this.lookForward(fromDirection), this.lookForward(toDirection), 1);\r\n    }\r\n    static lookForward(forward) {\r\n        if (Quaternion.__tmp_upVec == null) {\r\n            Quaternion.__tmp_upVec = new forward.constructor(0, 1, 0);\r\n        }\r\n        return this.lookForwardAccordingToThisUp(forward, Quaternion.__tmp_upVec);\r\n    }\r\n    static lookForwardAccordingToThisUp(forward, up) {\r\n        const forwardLength = forward.length();\r\n        if (forwardLength === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        const forwardX = forward.v[0] / forwardLength;\r\n        const forwardY = forward.v[1] / forwardLength;\r\n        const forwardZ = forward.v[2] / forwardLength;\r\n        const upLength = up.length();\r\n        if (upLength === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        const upX = up.v[0] / upLength;\r\n        const upY = up.v[1] / upLength;\r\n        const upZ = up.v[2] / upLength;\r\n        // Vector3.cross(up, forward)\r\n        let rightX = up.v[1] * forward.v[2] - up.v[2] * forward.v[1];\r\n        let rightY = up.v[2] * forward.v[0] - up.v[0] * forward.v[2];\r\n        let rightZ = up.v[0] * forward.v[1] - up.v[1] * forward.v[0];\r\n        const rightLength = Math.hypot(rightX, rightY, rightZ);\r\n        if (rightLength === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        rightX /= rightLength;\r\n        rightY /= rightLength;\r\n        rightZ /= rightLength;\r\n        const m00 = rightX;\r\n        const m01 = rightY;\r\n        const m02 = rightZ;\r\n        const m10 = upX;\r\n        const m11 = upY;\r\n        const m12 = upZ;\r\n        const m20 = forwardX;\r\n        const m21 = forwardY;\r\n        const m22 = forwardZ;\r\n        const num8 = (m00 + m11) + m22;\r\n        if (num8 > 0) {\r\n            const num = Math.sqrt(num8 + 1);\r\n            const num2 = 0.5 / num;\r\n            return new this((m12 - m21) * num2, (m20 - m02) * num2, (m01 - m10) * num2, num * 0.5);\r\n        }\r\n        else if ((m00 >= m11) && (m00 >= m22)) {\r\n            const num7 = Math.sqrt(((1 + m00) - m11) - m22);\r\n            const num4 = 0.5 / num7;\r\n            return new this(0.5 * num7, (m01 + m10) * num4, (m02 + m20) * num4, (m12 - m21) * num4);\r\n        }\r\n        else if (m11 > m22) {\r\n            const num6 = Math.sqrt(((1 + m11) - m00) - m22);\r\n            const num3 = 0.5 / num6;\r\n            return new this((m10 + m01) * num3, 0.5 * num6, (m21 + m12) * num3, (m20 - m02) * num3);\r\n        }\r\n        else {\r\n            const num5 = Math.sqrt(((1 + m22) - m00) - m11);\r\n            const num2 = 0.5 / num5;\r\n            return new this((m20 + m02) * num2, (m21 + m12) * num2, 0.5 * num5, (m01 - m10) * num2);\r\n        }\r\n    }\r\n    static fromPosition(vec) {\r\n        return new this(vec.v[0], vec.v[1], vec.v[2], 0);\r\n    }\r\n    static add(l_quat, r_quat) {\r\n        const x = l_quat.v[0] + r_quat.v[0];\r\n        const y = l_quat.v[1] + r_quat.v[1];\r\n        const z = l_quat.v[2] + r_quat.v[2];\r\n        const w = l_quat.v[3] + r_quat.v[3];\r\n        return new this(x, y, z, w);\r\n    }\r\n    static addTo(l_quat, r_quat, out) {\r\n        out.v[0] = l_quat.v[0] + r_quat.v[0];\r\n        out.v[1] = l_quat.v[1] + r_quat.v[1];\r\n        out.v[2] = l_quat.v[2] + r_quat.v[2];\r\n        out.v[3] = l_quat.v[3] + r_quat.v[3];\r\n        return out;\r\n    }\r\n    static subtract(l_quat, r_quat) {\r\n        const x = l_quat.v[0] - r_quat.v[0];\r\n        const y = l_quat.v[1] - r_quat.v[1];\r\n        const z = l_quat.v[2] - r_quat.v[2];\r\n        const w = l_quat.v[3] - r_quat.v[3];\r\n        return new this(x, y, z, w);\r\n    }\r\n    static subtractTo(l_quat, r_quat, out) {\r\n        out.v[0] = l_quat.v[0] - r_quat.v[0];\r\n        out.v[1] = l_quat.v[1] - r_quat.v[1];\r\n        out.v[2] = l_quat.v[2] - r_quat.v[2];\r\n        out.v[3] = l_quat.v[3] - r_quat.v[3];\r\n        return out;\r\n    }\r\n    static multiply(l_quat, r_quat) {\r\n        const x = r_quat.v[3] * l_quat.v[0] + r_quat.v[2] * l_quat.v[1] - r_quat.v[1] * l_quat.v[2] + r_quat.v[0] * l_quat.v[3];\r\n        const y = -r_quat.v[2] * l_quat.v[0] + r_quat.v[3] * l_quat.v[1] + r_quat.v[0] * l_quat.v[2] + r_quat.v[1] * l_quat.v[3];\r\n        const z = r_quat.v[1] * l_quat.v[0] - r_quat.v[0] * l_quat.v[1] + r_quat.v[3] * l_quat.v[2] + r_quat.v[2] * l_quat.v[3];\r\n        const w = -r_quat.v[0] * l_quat.v[0] - r_quat.v[1] * l_quat.v[1] - r_quat.v[2] * l_quat.v[2] + r_quat.v[3] * l_quat.v[3];\r\n        return new this(x, y, z, w);\r\n    }\r\n    static multiplyTo(l_quat, r_quat, out) {\r\n        const x = r_quat.v[3] * l_quat.v[0] + r_quat.v[2] * l_quat.v[1] - r_quat.v[1] * l_quat.v[2] + r_quat.v[0] * l_quat.v[3];\r\n        const y = -r_quat.v[2] * l_quat.v[0] + r_quat.v[3] * l_quat.v[1] + r_quat.v[0] * l_quat.v[2] + r_quat.v[1] * l_quat.v[3];\r\n        const z = r_quat.v[1] * l_quat.v[0] - r_quat.v[0] * l_quat.v[1] + r_quat.v[3] * l_quat.v[2] + r_quat.v[2] * l_quat.v[3];\r\n        const w = -r_quat.v[0] * l_quat.v[0] - r_quat.v[1] * l_quat.v[1] - r_quat.v[2] * l_quat.v[2] + r_quat.v[3] * l_quat.v[3];\r\n        return out.setComponents(x, y, z, w);\r\n    }\r\n    static multiplyNumber(quat, value) {\r\n        const x = quat.v[0] * value;\r\n        const y = quat.v[1] * value;\r\n        const z = quat.v[2] * value;\r\n        const w = quat.v[3] * value;\r\n        return new this(x, y, z, w);\r\n    }\r\n    static multiplyNumberTo(quat, value, out) {\r\n        out.v[0] = quat.v[0] * value;\r\n        out.v[1] = quat.v[1] * value;\r\n        out.v[2] = quat.v[2] * value;\r\n        out.v[3] = quat.v[3] * value;\r\n        return out;\r\n    }\r\n    static divideNumber(quat, value) {\r\n        if (value === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        const x = quat.v[0] / value;\r\n        const y = quat.v[1] / value;\r\n        const z = quat.v[2] / value;\r\n        const w = quat.v[3] / value;\r\n        return new this(x, y, z, w);\r\n    }\r\n    static divideNumberTo(quat, value, out) {\r\n        if (value === 0) {\r\n            console.error(\"0 division occurred!\");\r\n        }\r\n        out.v[0] = quat.v[0] / value;\r\n        out.v[1] = quat.v[1] / value;\r\n        out.v[2] = quat.v[2] / value;\r\n        out.v[3] = quat.v[3] / value;\r\n        return out;\r\n    }\r\n    toString() {\r\n        return '(' + this.v[0] + ', ' + this.v[1] + ', ' + this.v[2] + ', ' + this.v[3] + ')';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[1]) +\r\n            ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[2]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[3]) + '\\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1], this.v[2], this.v[3]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(quat, delta = Number.EPSILON) {\r\n        if (Math.abs(quat.v[0] - this.v[0]) < delta &&\r\n            Math.abs(quat.v[1] - this.v[1]) < delta &&\r\n            Math.abs(quat.v[2] - this.v[2]) < delta &&\r\n            Math.abs(quat.v[3] - this.v[3]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(quat) {\r\n        if (this.v[0] === quat.v[0] &&\r\n            this.v[1] === quat.v[1] &&\r\n            this.v[2] === quat.v[2] &&\r\n            this.v[3] === quat.v[3]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(i) {\r\n        return this.v[i];\r\n    }\r\n    length() {\r\n        return Math.hypot(this.v[0], this.v[1], this.v[2], this.v[3]);\r\n    }\r\n    lengthSquared() {\r\n        return this.v[0] ** 2 + this.v[1] ** 2 + this.v[2] ** 2 + this.v[3] ** 2;\r\n    }\r\n    /**\r\n     * dot product\r\n     */\r\n    dot(quat) {\r\n        return this.v[0] * quat.v[0] + this.v[1] * quat.v[1] + this.v[2] * quat.v[2] + this.v[3] * quat.v[3];\r\n    }\r\n    toEulerAnglesTo(out) {\r\n        // this is from https://en.v[3]ikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles#Source_Code_2\r\n        const sinr_cosp = 2.0 * (this.v[3] * this.v[0] + this.v[1] * this.v[2]);\r\n        const cosr_cosp = 1.0 - 2.0 * (this.v[0] * this.v[0] + this.v[1] * this.v[1]);\r\n        out.v[0] = Math.atan2(sinr_cosp, cosr_cosp);\r\n        const sinp = 2.0 * (this.v[3] * this.v[1] - this.v[2] * this.v[0]);\r\n        if (Math.abs(sinp) >= 1) {\r\n            out.v[1] = Math.PI / 2 * Math.sign(sinp); // use 90 degrees if out of range\r\n        }\r\n        else {\r\n            out.v[1] = Math.asin(sinp);\r\n        }\r\n        const siny_cosp = 2.0 * (this.v[3] * this.v[2] + this.v[0] * this.v[1]);\r\n        const cosy_cosp = 1.0 - 2.0 * (this.v[1] * this.v[1] + this.v[2] * this.v[2]);\r\n        out.v[2] = Math.atan2(siny_cosp, cosy_cosp);\r\n        return out;\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[1], this.v[2], this.v[3]);\r\n    }\r\n}\r\nQuaternion.__tmp_upVec = undefined;\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Quaternion.ts?");

/***/ }),

/***/ "./src/foundation/math/Scalar.ts":
/*!***************************************!*\
  !*** ./src/foundation/math/Scalar.ts ***!
  \***************************************/
/*! exports provided: Scalar_, default, Scalard */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Scalar_\", function() { return Scalar_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Scalar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Scalard\", function() { return Scalard; });\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n\r\nclass Scalar_ {\r\n    constructor(x, { type }) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new type(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new type(1);\r\n        }\r\n        this.v[0] = x;\r\n    }\r\n    getValue() {\r\n        return this.v[0];\r\n    }\r\n    getValueInArray() {\r\n        return [this.v[0]];\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get raw() {\r\n        return this.v;\r\n    }\r\n    isStrictEqual(scalar) {\r\n        if (this.x === scalar.x) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(scalar, delta = Number.EPSILON) {\r\n        if (Math.abs(scalar.x - this.x) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    get glslStrAsFloat() {\r\n        return `${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.x)}`;\r\n    }\r\n    get glslStrAsInt() {\r\n        return `${Math.floor(this.x)}`;\r\n    }\r\n}\r\nclass Scalar extends Scalar_ {\r\n    constructor(x) {\r\n        super(x, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return new Scalar(0);\r\n    }\r\n    static one() {\r\n        return new Scalar(1);\r\n    }\r\n    static dummy() {\r\n        return new Scalar(null);\r\n    }\r\n    clone() {\r\n        return new Scalar(this.x);\r\n    }\r\n}\r\nclass Scalard extends Scalar_ {\r\n    constructor(x) {\r\n        super(x, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return new Scalard(0);\r\n    }\r\n    static one() {\r\n        return new Scalard(1);\r\n    }\r\n    static dummy() {\r\n        return new Scalard(null);\r\n    }\r\n    clone() {\r\n        return new Scalard(this.x);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Scalar.ts?");

/***/ }),

/***/ "./src/foundation/math/Vector2.ts":
/*!****************************************!*\
  !*** ./src/foundation/math/Vector2.ts ***!
  \****************************************/
/*! exports provided: Vector2_, default, Vector2d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector2_\", function() { return Vector2_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Vector2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector2d\", function() { return Vector2d; });\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n\r\n\r\nclass Vector2_ {\r\n    constructor(x, y, { type }) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new type(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new type(2);\r\n        }\r\n        if (Array.isArray(x)) {\r\n            this.v[0] = x[0];\r\n            this.v[1] = x[1];\r\n        }\r\n        else if (typeof x === 'number') {\r\n            this.v[0] = x;\r\n            this.v[1] = y;\r\n        }\r\n        else {\r\n            this.v[0] = x.v[0];\r\n            this.v[1] = x.v[1];\r\n        }\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    get glslStrAsFloat() {\r\n        return `vec2(${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[0])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[1])})`;\r\n    }\r\n    get glslStrAsInt() {\r\n        return `ivec2(${Math.floor(this.v[0])}, ${Math.floor(this.v[1])})`;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec2;\r\n    }\r\n    /**\r\n      * to square length(static version)\r\n      */\r\n    static lengthSquared(vec) {\r\n        return vec.lengthSquared();\r\n    }\r\n    static lengthBtw(l_vec, r_vec) {\r\n        return l_vec.lengthTo(r_vec);\r\n    }\r\n    static angleOfVectors(l_vec, r_vec) {\r\n        const multipliedLength = l_vec.length() * r_vec.length();\r\n        if (multipliedLength === 0) {\r\n            console.error('length of a vector is 0!');\r\n        }\r\n        const cos_sita = l_vec.dot(r_vec) / multipliedLength;\r\n        const sita = Math.acos(cos_sita);\r\n        return sita;\r\n    }\r\n    static _zero(type) {\r\n        return new this(0, 0, { type });\r\n    }\r\n    static _one(type) {\r\n        return new this(1, 1, { type });\r\n    }\r\n    static _dummy(type) {\r\n        return new this(null, 0, { type });\r\n    }\r\n    /**\r\n     * normalize(static version)\r\n     */\r\n    static _normalize(vec, type) {\r\n        const length = vec.length();\r\n        return this._divide(vec, length, type);\r\n    }\r\n    /**\r\n     * add value（static version）\r\n     */\r\n    static _add(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] + r_vec.v[0];\r\n        const y = l_vec.v[1] + r_vec.v[1];\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n      * add value（static version）\r\n      */\r\n    static addTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] + r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] + r_vec.v[1];\r\n        return out;\r\n    }\r\n    /**\r\n      * subtract value(static version)\r\n      */\r\n    static _subtract(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] - r_vec.v[0];\r\n        const y = l_vec.v[1] - r_vec.v[1];\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n     * subtract value(static version)\r\n     */\r\n    static subtractTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] - r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] - r_vec.v[1];\r\n        return out;\r\n    }\r\n    /**\r\n     * multiply value(static version)\r\n     */\r\n    static _multiply(vec, value, type) {\r\n        const x = vec.v[0] * value;\r\n        const y = vec.v[1] * value;\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n     * multiply value(static version)\r\n     */\r\n    static multiplyTo(vec, value, out) {\r\n        out.v[0] = vec.v[0] * value;\r\n        out.v[1] = vec.v[1] * value;\r\n        return out;\r\n    }\r\n    /**\r\n      * multiply vector(static version)\r\n      */\r\n    static _multiplyVector(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] * r_vec.v[0];\r\n        const y = l_vec.v[1] * r_vec.v[1];\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n      * multiply vector(static version)\r\n      */\r\n    static multiplyVectorTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] * r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] * r_vec.v[1];\r\n        return out;\r\n    }\r\n    /**\r\n     * divide by value(static version)\r\n     */\r\n    static _divide(vec, value, type) {\r\n        let x;\r\n        let y;\r\n        if (value !== 0) {\r\n            x = vec.v[0] / value;\r\n            y = vec.v[1] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = Infinity;\r\n            y = Infinity;\r\n        }\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n     * divide by value(static version)\r\n     */\r\n    static divideTo(vec, value, out) {\r\n        if (value !== 0) {\r\n            out.v[0] = vec.v[0] / value;\r\n            out.v[1] = vec.v[1] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = Infinity;\r\n            out.v[1] = Infinity;\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * divide by vector(static version)\r\n     */\r\n    static _divideVector(l_vec, r_vec, type) {\r\n        let x;\r\n        let y;\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0) {\r\n            x = l_vec.v[0] / r_vec.v[0];\r\n            y = l_vec.v[1] / r_vec.v[1];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            y = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n        }\r\n        return new this(x, y, { type });\r\n    }\r\n    /**\r\n     * divide by vector(static version)\r\n     */\r\n    static divideVectorTo(l_vec, r_vec, out) {\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0) {\r\n            out.v[0] = l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = l_vec.v[1] / r_vec.v[1];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * dot product(static version)\r\n     */\r\n    static dot(l_vec, r_vec) {\r\n        return l_vec.dot(r_vec);\r\n    }\r\n    /**\r\n    * change to string\r\n    */\r\n    toString() {\r\n        return '(' + this.v[0] + ', ' + this.v[1] + ')';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[1]) + '\\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(vec, delta = Number.EPSILON) {\r\n        if (Math.abs(vec.v[0] - this.v[0]) < delta &&\r\n            Math.abs(vec.v[1] - this.v[1]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(vec) {\r\n        if (this.v[0] === vec.v[0] &&\r\n            this.v[1] === vec.v[1]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(i) {\r\n        return this.v[i];\r\n    }\r\n    length() {\r\n        return Math.hypot(this.v[0], this.v[1]);\r\n    }\r\n    lengthSquared() {\r\n        return this.v[0] ** 2 + this.v[1] ** 2;\r\n    }\r\n    lengthTo(vec) {\r\n        const deltaX = this.v[0] - vec.v[0];\r\n        const deltaY = this.v[1] - vec.v[1];\r\n        return Math.hypot(deltaX, deltaY);\r\n    }\r\n    /**\r\n     * dot product\r\n     */\r\n    dot(vec) {\r\n        return this.v[0] * vec.v[0] + this.v[1] * vec.v[1];\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[1]);\r\n    }\r\n}\r\nclass Vector2 extends Vector2_ {\r\n    constructor(x, y) {\r\n        super(x, y, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass Vector2d extends Vector2_ {\r\n    constructor(x, y) {\r\n        super(x, y, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Vector2.ts?");

/***/ }),

/***/ "./src/foundation/math/Vector3.ts":
/*!****************************************!*\
  !*** ./src/foundation/math/Vector3.ts ***!
  \****************************************/
/*! exports provided: Vector3_, default, Vector3d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector3_\", function() { return Vector3_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Vector3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector3d\", function() { return Vector3d; });\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n\r\n\r\nclass Vector3_ {\r\n    constructor(x, y, z, { type }) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new type(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new type(3);\r\n        }\r\n        if (Array.isArray(x)) {\r\n            this.v[0] = x[0];\r\n            this.v[1] = x[1];\r\n            this.v[2] = x[2];\r\n        }\r\n        else if (typeof x === 'number') {\r\n            this.v[0] = x;\r\n            this.v[1] = y;\r\n            this.v[2] = z;\r\n        }\r\n        else {\r\n            if (typeof x.v[2] === 'undefined') {\r\n                // IVector2\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = 0;\r\n            }\r\n            else {\r\n                // IVector3 or IVector4\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = x.v[2];\r\n            }\r\n        }\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    get w() {\r\n        return 1;\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    get glslStrAsFloat() {\r\n        return `vec3(${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[0])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[1])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[2])})`;\r\n    }\r\n    get glslStrAsInt() {\r\n        return `ivec3(${Math.floor(this.v[0])}, ${Math.floor(this.v[1])}, ${Math.floor(this.v[2])})`;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec3;\r\n    }\r\n    /**\r\n   * to square length(static version)\r\n   */\r\n    static lengthSquared(vec) {\r\n        return vec.lengthSquared();\r\n    }\r\n    static lengthBtw(l_vec, r_vec) {\r\n        return l_vec.lengthTo(r_vec);\r\n    }\r\n    static angleOfVectors(l_vec, r_vec) {\r\n        const multipliedLength = l_vec.length() * r_vec.length();\r\n        if (multipliedLength === 0) {\r\n            console.error('length of a vector is 0!');\r\n        }\r\n        const cos_sita = l_vec.dot(r_vec) / multipliedLength;\r\n        const sita = Math.acos(cos_sita);\r\n        return sita;\r\n    }\r\n    static _zero(type) {\r\n        return new this(0, 0, 0, { type });\r\n    }\r\n    static _one(type) {\r\n        return new this(1, 1, 1, { type });\r\n    }\r\n    static _dummy(type) {\r\n        return new this(null, 0, 0, { type });\r\n    }\r\n    /**\r\n     * normalize(static version)\r\n     */\r\n    static _normalize(vec, type) {\r\n        const length = vec.length();\r\n        return this._divide(vec, length, type);\r\n    }\r\n    /**\r\n     * add value（static version）\r\n     */\r\n    static _add(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] + r_vec.v[0];\r\n        const y = l_vec.v[1] + r_vec.v[1];\r\n        const z = l_vec.v[2] + r_vec.v[2];\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * add value（static version）\r\n     */\r\n    static addTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] + r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] + r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] + r_vec.v[2];\r\n        return out;\r\n    }\r\n    /**\r\n     * subtract(subtract)\r\n     */\r\n    static _subtract(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] - r_vec.v[0];\r\n        const y = l_vec.v[1] - r_vec.v[1];\r\n        const z = l_vec.v[2] - r_vec.v[2];\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * subtract(subtract)\r\n     */\r\n    static subtractTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] - r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] - r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] - r_vec.v[2];\r\n        return out;\r\n    }\r\n    /**\r\n     * multiply(static version)\r\n     */\r\n    static _multiply(vec, value, type) {\r\n        const x = vec.v[0] * value;\r\n        const y = vec.v[1] * value;\r\n        const z = vec.v[2] * value;\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * multiplyTo(static version)\r\n     */\r\n    static multiplyTo(vec, value, out) {\r\n        out.v[0] = vec.v[0] * value;\r\n        out.v[1] = vec.v[1] * value;\r\n        out.v[2] = vec.v[2] * value;\r\n        return out;\r\n    }\r\n    /**\r\n     * multiply vector(static version)\r\n     */\r\n    static _multiplyVector(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] * r_vec.v[0];\r\n        const y = l_vec.v[1] * r_vec.v[1];\r\n        const z = l_vec.v[2] * r_vec.v[2];\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n      * multiply vector(static version)\r\n      */\r\n    static multiplyVectorTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] * r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] * r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] * r_vec.v[2];\r\n        return out;\r\n    }\r\n    /**\r\n   * divide(static version)\r\n   */\r\n    static _divide(vec, value, type) {\r\n        let x;\r\n        let y;\r\n        let z;\r\n        if (value !== 0) {\r\n            x = vec.v[0] / value;\r\n            y = vec.v[1] / value;\r\n            z = vec.v[2] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = Infinity;\r\n            y = Infinity;\r\n            z = Infinity;\r\n        }\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * divide by value(static version)\r\n     */\r\n    static divideTo(vec, value, out) {\r\n        if (value !== 0) {\r\n            out.v[0] = vec.v[0] / value;\r\n            out.v[1] = vec.v[1] / value;\r\n            out.v[2] = vec.v[2] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = Infinity;\r\n            out.v[1] = Infinity;\r\n            out.v[2] = Infinity;\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * divide vector(static version)\r\n     */\r\n    static _divideVector(l_vec, r_vec, type) {\r\n        let x;\r\n        let y;\r\n        let z;\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0 && r_vec.v[2] !== 0) {\r\n            x = l_vec.v[0] / r_vec.v[0];\r\n            y = l_vec.v[1] / r_vec.v[1];\r\n            z = l_vec.v[2] / r_vec.v[2];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            y = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n            z = r_vec.v[2] === 0 ? Infinity : l_vec.v[2] / r_vec.v[2];\r\n        }\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * divide by vector(static version)\r\n     */\r\n    static divideVectorTo(l_vec, r_vec, out) {\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0 && r_vec.v[2] !== 0) {\r\n            out.v[0] = l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = l_vec.v[1] / r_vec.v[1];\r\n            out.v[2] = l_vec.v[2] / r_vec.v[2];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n            out.v[2] = r_vec.v[2] === 0 ? Infinity : l_vec.v[2] / r_vec.v[2];\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * dot product(static version)\r\n     */\r\n    static dot(l_vec, r_vec) {\r\n        return l_vec.dot(r_vec);\r\n    }\r\n    /**\r\n    * cross product(static version)\r\n    */\r\n    static _cross(l_vec, r_vec, type) {\r\n        const x = l_vec.v[1] * r_vec.v[2] - l_vec.v[2] * r_vec.v[1];\r\n        const y = l_vec.v[2] * r_vec.v[0] - l_vec.v[0] * r_vec.v[2];\r\n        const z = l_vec.v[0] * r_vec.v[1] - l_vec.v[1] * r_vec.v[0];\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n    * cross product(static version)\r\n    */\r\n    static crossTo(l_vec, r_vec, out) {\r\n        const x = l_vec.v[1] * r_vec.v[2] - l_vec.v[2] * r_vec.v[1];\r\n        const y = l_vec.v[2] * r_vec.v[0] - l_vec.v[0] * r_vec.v[2];\r\n        const z = l_vec.v[0] * r_vec.v[1] - l_vec.v[1] * r_vec.v[0];\r\n        return out.setComponents(x, y, z);\r\n    }\r\n    /**\r\n     * quaternion * vector3\r\n     */\r\n    static _multiplyQuaternion(quat, vec, type) {\r\n        const num = quat.v[0] * 2;\r\n        const num2 = quat.v[1] * 2;\r\n        const num3 = quat.v[2] * 2;\r\n        const num4 = quat.v[0] * num;\r\n        const num5 = quat.v[1] * num2;\r\n        const num6 = quat.v[2] * num3;\r\n        const num7 = quat.v[0] * num2;\r\n        const num8 = quat.v[0] * num3;\r\n        const num9 = quat.v[1] * num3;\r\n        const num10 = quat.v[3] * num;\r\n        const num11 = quat.v[3] * num2;\r\n        const num12 = quat.v[3] * num3;\r\n        const x = (1 - (num5 + num6)) * vec.v[0] + (num7 - num12) * vec.v[1] + (num8 + num11) * vec.v[2];\r\n        const y = (num7 + num12) * vec.v[0] + (1 - (num4 + num6)) * vec.v[1] + (num9 - num10) * vec.v[2];\r\n        const z = (num8 - num11) * vec.v[0] + (num9 + num10) * vec.v[1] + (1 - (num4 + num5)) * vec.v[2];\r\n        return new this(x, y, z, { type });\r\n    }\r\n    /**\r\n     * quaternion * vector3\r\n     */\r\n    static multiplyQuaternionTo(quat, vec, out) {\r\n        const num = quat.v[0] * 2;\r\n        const num2 = quat.v[1] * 2;\r\n        const num3 = quat.v[2] * 2;\r\n        const num4 = quat.v[0] * num;\r\n        const num5 = quat.v[1] * num2;\r\n        const num6 = quat.v[2] * num3;\r\n        const num7 = quat.v[0] * num2;\r\n        const num8 = quat.v[0] * num3;\r\n        const num9 = quat.v[1] * num3;\r\n        const num10 = quat.v[3] * num;\r\n        const num11 = quat.v[3] * num2;\r\n        const num12 = quat.v[3] * num3;\r\n        const x = (1 - (num5 + num6)) * vec.v[0] + (num7 - num12) * vec.v[1] + (num8 + num11) * vec.v[2];\r\n        const y = (num7 + num12) * vec.v[0] + (1 - (num4 + num6)) * vec.v[1] + (num9 - num10) * vec.v[2];\r\n        const z = (num8 - num11) * vec.v[0] + (num9 + num10) * vec.v[1] + (1 - (num4 + num5)) * vec.v[2];\r\n        return out.setComponents(x, y, z);\r\n    }\r\n    /**\r\n     * change to string\r\n     */\r\n    toString() {\r\n        return '(' + this.v[0] + ', ' + this.v[1] + ', ' + this.v[2] + ')';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[1]) +\r\n            ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[2]) + '\\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1], this.v[2]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(vec, delta = Number.EPSILON) {\r\n        if (Math.abs(vec.v[0] - this.v[0]) < delta &&\r\n            Math.abs(vec.v[1] - this.v[1]) < delta &&\r\n            Math.abs(vec.v[2] - this.v[2]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(vec) {\r\n        if (this.v[0] === vec.v[0] &&\r\n            this.v[1] === vec.v[1] &&\r\n            this.v[2] === vec.v[2]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(i) {\r\n        return this.v[i];\r\n    }\r\n    length() {\r\n        return Math.hypot(this.v[0], this.v[1], this.v[2]);\r\n    }\r\n    lengthSquared() {\r\n        return this.v[0] ** 2 + this.v[1] ** 2 + this.v[2] ** 2;\r\n    }\r\n    lengthTo(vec) {\r\n        const deltaX = this.v[0] - vec.v[0];\r\n        const deltaY = this.v[1] - vec.v[1];\r\n        const deltaZ = this.v[2] - vec.v[2];\r\n        return Math.hypot(deltaX, deltaY, deltaZ);\r\n    }\r\n    /**\r\n     * dot product\r\n     */\r\n    dot(vec) {\r\n        return this.v[0] * vec.v[0] + this.v[1] * vec.v[1] + this.v[2] * vec.v[2];\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[1], this.v[2]);\r\n    }\r\n}\r\nclass Vector3 extends Vector3_ {\r\n    constructor(x, y, z) {\r\n        super(x, y, z, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static cross(l_vec, r_vec) {\r\n        return super._cross(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiplyQuaternion(quat, vec) {\r\n        return super._multiplyQuaternion(quat, vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass Vector3d extends Vector3_ {\r\n    constructor(x, y, z) {\r\n        super(x, y, z, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static cross(l_vec, r_vec) {\r\n        return super._cross(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiplyQuaternion(quat, vec) {\r\n        return super._multiplyQuaternion(quat, vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Vector3.ts?");

/***/ }),

/***/ "./src/foundation/math/Vector4.ts":
/*!****************************************!*\
  !*** ./src/foundation/math/Vector4.ts ***!
  \****************************************/
/*! exports provided: Vector4_, default, Vector4d */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector4_\", function() { return Vector4_; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Vector4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector4d\", function() { return Vector4d; });\n/* harmony import */ var _MathUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n\r\n\r\nclass Vector4_ {\r\n    constructor(x, y, z, w, { type }) {\r\n        if (ArrayBuffer.isView(x)) {\r\n            this.v = x;\r\n            return;\r\n        }\r\n        else if (x == null) {\r\n            this.v = new type(0);\r\n            return;\r\n        }\r\n        else {\r\n            this.v = new type(4);\r\n        }\r\n        if (Array.isArray(x)) {\r\n            this.v[0] = x[0];\r\n            this.v[1] = x[1];\r\n            this.v[2] = x[2];\r\n            this.v[3] = x[3];\r\n        }\r\n        else if (typeof x === 'number') {\r\n            this.v[0] = x;\r\n            this.v[1] = y;\r\n            this.v[2] = z;\r\n            this.v[3] = w;\r\n        }\r\n        else {\r\n            if (typeof x.v[2] === 'undefined') {\r\n                // IVector2\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = 0;\r\n                this.v[3] = 1;\r\n            }\r\n            else if (typeof x.v[3] === 'undefined') {\r\n                // IVector3\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = x.v[2];\r\n                this.v[3] = 1;\r\n            }\r\n            else {\r\n                // IVector4\r\n                this.v[0] = x.v[0];\r\n                this.v[1] = x.v[1];\r\n                this.v[2] = x.v[2];\r\n                this.v[3] = x.v[3];\r\n            }\r\n        }\r\n    }\r\n    get x() {\r\n        return this.v[0];\r\n    }\r\n    get y() {\r\n        return this.v[1];\r\n    }\r\n    get z() {\r\n        return this.v[2];\r\n    }\r\n    get w() {\r\n        return this.v[3];\r\n    }\r\n    get className() {\r\n        return this.constructor.name;\r\n    }\r\n    get glslStrAsFloat() {\r\n        return `vec4(${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[0])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[1])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[2])}, ${_MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].convertToStringAsGLSLFloat(this.v[3])})`;\r\n    }\r\n    get glslStrAsInt() {\r\n        return `ivec4(${Math.floor(this.v[0])}, ${Math.floor(this.v[1])}, ${Math.floor(this.v[2])}, ${Math.floor(this.v[3])})`;\r\n    }\r\n    static get compositionType() {\r\n        return _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Vec4;\r\n    }\r\n    /**\r\n     * to square length(static version)\r\n     */\r\n    static lengthSquared(vec) {\r\n        return vec.lengthSquared();\r\n    }\r\n    static lengthBtw(l_vec, r_vec) {\r\n        return l_vec.lengthTo(r_vec);\r\n    }\r\n    /**\r\n     * Zero Vector\r\n     */\r\n    static _zero(type) {\r\n        return new this(0, 0, 0, 0, { type });\r\n    }\r\n    static _one(type) {\r\n        return new this(1, 1, 1, 1, { type });\r\n    }\r\n    static _dummy(type) {\r\n        return new this(null, 0, 0, 0, { type });\r\n    }\r\n    /**\r\n     * normalize(static version)\r\n     */\r\n    static _normalize(vec, type) {\r\n        const length = vec.length();\r\n        return this._divide(vec, length, type);\r\n    }\r\n    /**\r\n     * add value（static version）\r\n     */\r\n    static _add(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] + r_vec.v[0];\r\n        const y = l_vec.v[1] + r_vec.v[1];\r\n        const z = l_vec.v[2] + r_vec.v[2];\r\n        const w = l_vec.v[3] + r_vec.v[3];\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * add value（static version）\r\n     */\r\n    static addTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] + r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] + r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] + r_vec.v[2];\r\n        out.v[3] = l_vec.v[3] + r_vec.v[3];\r\n        return out;\r\n    }\r\n    /**\r\n     * subtract(static version)\r\n     */\r\n    static _subtract(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] - r_vec.v[0];\r\n        const y = l_vec.v[1] - r_vec.v[1];\r\n        const z = l_vec.v[2] - r_vec.v[2];\r\n        const w = l_vec.v[3] - r_vec.v[3];\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * subtract(static version)\r\n     */\r\n    static subtractTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] - r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] - r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] - r_vec.v[2];\r\n        out.v[3] = l_vec.v[3] - r_vec.v[3];\r\n        return out;\r\n    }\r\n    /**\r\n     * multiply(static version)\r\n     */\r\n    static _multiply(vec, value, type) {\r\n        const x = vec.v[0] * value;\r\n        const y = vec.v[1] * value;\r\n        const z = vec.v[2] * value;\r\n        const w = vec.v[3] * value;\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * multiplyTo(static version)\r\n     */\r\n    static multiplyTo(vec, value, out) {\r\n        out.v[0] = vec.v[0] * value;\r\n        out.v[1] = vec.v[1] * value;\r\n        out.v[2] = vec.v[2] * value;\r\n        out.v[3] = vec.v[3] * value;\r\n        return out;\r\n    }\r\n    /**\r\n     * multiply vector(static version)\r\n     */\r\n    static _multiplyVector(l_vec, r_vec, type) {\r\n        const x = l_vec.v[0] * r_vec.v[0];\r\n        const y = l_vec.v[1] * r_vec.v[1];\r\n        const z = l_vec.v[2] * r_vec.v[2];\r\n        const w = l_vec.v[3] * r_vec.v[3];\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * multiply vector(static version)\r\n     */\r\n    static multiplyVectorTo(l_vec, r_vec, out) {\r\n        out.v[0] = l_vec.v[0] * r_vec.v[0];\r\n        out.v[1] = l_vec.v[1] * r_vec.v[1];\r\n        out.v[2] = l_vec.v[2] * r_vec.v[2];\r\n        out.v[3] = l_vec.v[3] * r_vec.v[3];\r\n        return out;\r\n    }\r\n    /**\r\n     * divide(static version)\r\n     */\r\n    static _divide(vec, value, type) {\r\n        let x;\r\n        let y;\r\n        let z;\r\n        let w;\r\n        if (value !== 0) {\r\n            x = vec.v[0] / value;\r\n            y = vec.v[1] / value;\r\n            z = vec.v[2] / value;\r\n            w = vec.v[3] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = Infinity;\r\n            y = Infinity;\r\n            z = Infinity;\r\n            w = Infinity;\r\n        }\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * divide by value(static version)\r\n     */\r\n    static divideTo(vec, value, out) {\r\n        if (value !== 0) {\r\n            out.v[0] = vec.v[0] / value;\r\n            out.v[1] = vec.v[1] / value;\r\n            out.v[2] = vec.v[2] / value;\r\n            out.v[3] = vec.v[3] / value;\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = Infinity;\r\n            out.v[1] = Infinity;\r\n            out.v[2] = Infinity;\r\n            out.v[3] = Infinity;\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * divide vector(static version)\r\n     */\r\n    static _divideVector(l_vec, r_vec, type) {\r\n        let x;\r\n        let y;\r\n        let z;\r\n        let w;\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0 && r_vec.v[2] !== 0 && r_vec.v[3] !== 0) {\r\n            x = l_vec.v[0] / r_vec.v[0];\r\n            y = l_vec.v[1] / r_vec.v[1];\r\n            z = l_vec.v[2] / r_vec.v[2];\r\n            w = l_vec.v[3] / r_vec.v[3];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            x = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            y = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n            z = r_vec.v[2] === 0 ? Infinity : l_vec.v[2] / r_vec.v[2];\r\n            w = r_vec.v[3] === 0 ? Infinity : l_vec.v[3] / r_vec.v[3];\r\n        }\r\n        return new this(x, y, z, w, { type });\r\n    }\r\n    /**\r\n     * divide by vector(static version)\r\n     */\r\n    static divideVectorTo(l_vec, r_vec, out) {\r\n        if (r_vec.v[0] !== 0 && r_vec.v[1] !== 0 && r_vec.v[2] !== 0 && r_vec.v[3] !== 0) {\r\n            out.v[0] = l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = l_vec.v[1] / r_vec.v[1];\r\n            out.v[2] = l_vec.v[2] / r_vec.v[2];\r\n            out.v[3] = l_vec.v[3] / r_vec.v[3];\r\n        }\r\n        else {\r\n            console.error(\"0 division occurred!\");\r\n            out.v[0] = r_vec.v[0] === 0 ? Infinity : l_vec.v[0] / r_vec.v[0];\r\n            out.v[1] = r_vec.v[1] === 0 ? Infinity : l_vec.v[1] / r_vec.v[1];\r\n            out.v[2] = r_vec.v[2] === 0 ? Infinity : l_vec.v[2] / r_vec.v[2];\r\n            out.v[3] = r_vec.v[3] === 0 ? Infinity : l_vec.v[3] / r_vec.v[3];\r\n        }\r\n        return out;\r\n    }\r\n    /**\r\n     * dot product(static version)\r\n     */\r\n    static dot(l_vec, r_vec) {\r\n        return l_vec.dot(r_vec);\r\n    }\r\n    toString() {\r\n        return '(' + this.v[0] + ', ' + this.v[1] + ', ' + this.v[2] + ', ' + this.v[3] + ')';\r\n    }\r\n    toStringApproximately() {\r\n        return _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[0]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[1]) +\r\n            ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[2]) + ' ' + _MathUtil__WEBPACK_IMPORTED_MODULE_0__[\"MathUtil\"].nearZeroToZero(this.v[3]) + '\\n';\r\n    }\r\n    flattenAsArray() {\r\n        return [this.v[0], this.v[1], this.v[2], this.v[3]];\r\n    }\r\n    isDummy() {\r\n        if (this.v.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isEqual(vec, delta = Number.EPSILON) {\r\n        if (Math.abs(vec.v[0] - this.v[0]) < delta &&\r\n            Math.abs(vec.v[1] - this.v[1]) < delta &&\r\n            Math.abs(vec.v[2] - this.v[2]) < delta &&\r\n            Math.abs(vec.v[3] - this.v[3]) < delta) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isStrictEqual(vec) {\r\n        if (this.v[0] === vec.v[0] &&\r\n            this.v[1] === vec.v[1] &&\r\n            this.v[2] === vec.v[2] &&\r\n            this.v[3] === vec.v[3]) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    at(i) {\r\n        return this.v[i];\r\n    }\r\n    length() {\r\n        return Math.hypot(this.v[0], this.v[1], this.v[2], this.v[3]);\r\n    }\r\n    lengthSquared() {\r\n        return this.v[0] ** 2 + this.v[1] ** 2 + this.v[2] ** 2 + this.v[3] ** 2;\r\n    }\r\n    lengthTo(vec) {\r\n        const deltaX = this.v[0] - vec.v[0];\r\n        const deltaY = this.v[1] - vec.v[1];\r\n        const deltaZ = this.v[2] - vec.v[2];\r\n        const deltaW = this.v[3] - vec.v[3];\r\n        return Math.hypot(deltaX, deltaY, deltaZ, deltaW);\r\n    }\r\n    /**\r\n     * dot product\r\n     */\r\n    dot(vec) {\r\n        return this.v[0] * vec.v[0] + this.v[1] * vec.v[1] + this.v[2] * vec.v[2] + this.v[3] * vec.v[3];\r\n    }\r\n    clone() {\r\n        return new this.constructor(this.v[0], this.v[1], this.v[2], this.v[3]);\r\n    }\r\n}\r\nclass Vector4 extends Vector4_ {\r\n    constructor(x, y, z, w) {\r\n        super(x, y, z, w, { type: Float32Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float32Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float32Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float32Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float32Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float32Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float32Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float32Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float32Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float32Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\nclass Vector4d extends Vector4_ {\r\n    constructor(x, y, z, w) {\r\n        super(x, y, z, w, { type: Float64Array });\r\n    }\r\n    static zero() {\r\n        return super._zero(Float64Array);\r\n    }\r\n    static one() {\r\n        return super._one(Float64Array);\r\n    }\r\n    static dummy() {\r\n        return super._dummy(Float64Array);\r\n    }\r\n    static normalize(vec) {\r\n        return super._normalize(vec, Float64Array);\r\n    }\r\n    static add(l_vec, r_vec) {\r\n        return super._add(l_vec, r_vec, Float64Array);\r\n    }\r\n    static subtract(l_vec, r_vec) {\r\n        return super._subtract(l_vec, r_vec, Float64Array);\r\n    }\r\n    static multiply(vec, value) {\r\n        return super._multiply(vec, value, Float64Array);\r\n    }\r\n    static multiplyVector(l_vec, r_vec) {\r\n        return super._multiplyVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    static divide(vec, value) {\r\n        return super._divide(vec, value, Float64Array);\r\n    }\r\n    static divideVector(l_vec, r_vec) {\r\n        return super._divideVector(l_vec, r_vec, Float64Array);\r\n    }\r\n    clone() {\r\n        return super.clone();\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/Vector4.ts?");

/***/ }),

/***/ "./src/foundation/math/VectorN.ts":
/*!****************************************!*\
  !*** ./src/foundation/math/VectorN.ts ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VectorN; });\nclass VectorN {\r\n    constructor(float32Array) {\r\n        this.v = float32Array;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/math/VectorN.ts?");

/***/ }),

/***/ "./src/foundation/memory/Accessor.ts":
/*!*******************************************!*\
  !*** ./src/foundation/memory/Accessor.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Accessor; });\n/* harmony import */ var _AccessorBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AccessorBase */ \"./src/foundation/memory/AccessorBase.ts\");\n\r\nclass Accessor extends _AccessorBase__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ bufferView, byteOffset, compositionType, componentType, byteStride, count, raw, arrayLength, normalized }) {\r\n        super({ bufferView, byteOffset, compositionType, componentType, byteStride, count, raw, arrayLength, normalized });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/memory/Accessor.ts?");

/***/ }),

/***/ "./src/foundation/memory/AccessorBase.ts":
/*!***********************************************!*\
  !*** ./src/foundation/memory/AccessorBase.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AccessorBase; });\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _math_Vector2__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math/Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _math_Matrix33__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math/Matrix33 */ \"./src/foundation/math/Matrix33.ts\");\n/* harmony import */ var _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass AccessorBase extends _core_RnObject__WEBPACK_IMPORTED_MODULE_2__[\"default\"] {\r\n    constructor({ bufferView, byteOffset, compositionType, componentType, byteStride, count, raw, max, min, arrayLength, normalized }) {\r\n        super();\r\n        this.__compositionType = _definitions_CompositionType__WEBPACK_IMPORTED_MODULE_1__[\"CompositionType\"].Unknown;\r\n        this.__componentType = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Unknown;\r\n        this.__count = 0;\r\n        this.__takenCount = 0;\r\n        this.__byteStride = 0;\r\n        this.__arrayLength = 1;\r\n        this.__normalized = false;\r\n        this.__bufferView = bufferView;\r\n        this.__byteOffsetInRawArrayBufferOfBuffer = bufferView.byteOffsetInRawArrayBufferOfBuffer + byteOffset;\r\n        this.__compositionType = compositionType;\r\n        this.__componentType = componentType;\r\n        this.__count = count;\r\n        this.__arrayLength = arrayLength;\r\n        this.__raw = raw;\r\n        this.__normalized = normalized;\r\n        if (max != null) {\r\n            this.__max = max;\r\n        }\r\n        if (min != null) {\r\n            this.__min = min;\r\n        }\r\n        this.__byteStride = byteStride;\r\n        if (this.__byteStride === 0) {\r\n            this.__byteStride = this.__compositionType.getNumberOfComponents() * this.__componentType.getSizeInBytes() * this.__arrayLength;\r\n        }\r\n        this.prepare();\r\n    }\r\n    prepare() {\r\n        const typedArrayClass = this.getTypedArrayClass(this.__componentType);\r\n        this.__typedArrayClass = typedArrayClass;\r\n        if (this.__componentType.getSizeInBytes() === 8) {\r\n            if (this.__byteOffsetInRawArrayBufferOfBuffer % 8 !== 0) {\r\n                console.info('Padding added because of byteOffset of accessor is not 8 bytes aligned despite of Double precision.');\r\n                this.__byteOffsetInRawArrayBufferOfBuffer += (this.__byteOffsetInRawArrayBufferOfBuffer % 8 === 0) ? 0 : 8 - this.__byteOffsetInRawArrayBufferOfBuffer % 8;\r\n            }\r\n        }\r\n        //  else if (this.__componentType.getSizeInBytes() === 4) {\r\n        //   if (this.__byteOffsetInBuffer % 4 !== 0) {\r\n        //     console.info('Padding added because of byteOffset of accessor is not 4 bytes aligned despite of Double precision.');\r\n        //     this.__byteOffsetInBuffer += 4 - this.__byteOffsetInBuffer % 4;\r\n        //   }\r\n        // }\r\n        if (this.__bufferView.isSoA) {\r\n            if (this.__raw.byteLength - this.__byteOffsetInRawArrayBufferOfBuffer < this.__compositionType.getNumberOfComponents() * this.__componentType.getSizeInBytes() * this.__count) {\r\n                console.error(`Requesting a data size that exceeds the remaining capacity of the buffer: ${this.bufferView.buffer.name}.`);\r\n            }\r\n            this.__dataView = new DataView(this.__raw, this.__byteOffsetInRawArrayBufferOfBuffer, this.__compositionType.getNumberOfComponents() * this.__componentType.getSizeInBytes() * this.__count);\r\n        }\r\n        else {\r\n            this.__dataView = new DataView(this.__raw, this.__byteOffsetInRawArrayBufferOfBuffer);\r\n        }\r\n        if (this.__byteOffsetInRawArrayBufferOfBuffer % this.__componentType.getSizeInBytes() === 0) {\r\n            this.__typedArray = new typedArrayClass(this.__raw, this.__byteOffsetInRawArrayBufferOfBuffer, this.__compositionType.getNumberOfComponents() * this.__count);\r\n        }\r\n        this.__dataViewGetter = this.__dataView[this.getDataViewGetter(this.__componentType)].bind(this.__dataView);\r\n        this.__dataViewSetter = this.__dataView[this.getDataViewSetter(this.__componentType)].bind(this.__dataView);\r\n    }\r\n    getTypedArrayClass(componentType) {\r\n        switch (componentType) {\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Byte: return Int8Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedByte: return Uint8Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Short: return Int16Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedShort: return Uint16Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Int: return Int32Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedInt: return Uint32Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Float: return Float32Array;\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Double: return Float64Array;\r\n            default:\r\n                console.error('Unexpected ComponentType!');\r\n                return void 0;\r\n        }\r\n    }\r\n    getDataViewGetter(componentType) {\r\n        switch (componentType) {\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Byte: return 'getInt8';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedByte: return 'getUint8';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Short: return 'getInt16';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedShort: return 'getUint16';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Int: return 'getInt32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedInt: return 'getUint32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Float: return 'getFloat32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Double: return 'getFloat64';\r\n            default:\r\n                console.error('Unexpected ComponentType!');\r\n                return 'unknown';\r\n        }\r\n    }\r\n    getDataViewSetter(componentType) {\r\n        switch (componentType) {\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Byte: return 'setInt8';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedByte: return 'setUint8';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Short: return 'setInt16';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedShort: return 'setUint16';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Int: return 'setInt32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].UnsignedInt: return 'setUint32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Float: return 'setFloat32';\r\n            case _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_0__[\"ComponentType\"].Double: return 'setFloat64';\r\n            default: console.error('Unexpected ComponentType!');\r\n        }\r\n        return undefined;\r\n    }\r\n    takeOne() {\r\n        const arrayBufferOfBufferView = this.__raw;\r\n        // let stride = this.__compositionType.getNumberOfComponents() * this.__componentType.getSizeInBytes();\r\n        // if (this.__bufferView.isAoS) {\r\n        //   stride = this.__bufferView.byteStride;\r\n        // }\r\n        if (this.__takenCount >= this.__count) {\r\n            console.error('You are trying to allocate more than you have secured.');\r\n        }\r\n        const subTypedArray = new this.__typedArrayClass(arrayBufferOfBufferView, this.__byteOffsetInRawArrayBufferOfBuffer + this.__byteStride * this.__takenCount, this.__compositionType.getNumberOfComponents() * this.__arrayLength);\r\n        this.__takenCount += 1;\r\n        subTypedArray._accessor = this;\r\n        subTypedArray._idx_of_accessor = this.__takenCount;\r\n        return subTypedArray;\r\n    }\r\n    get takenCount() {\r\n        return this.takenCount;\r\n    }\r\n    get numberOfComponents() {\r\n        return this.__compositionType.getNumberOfComponents();\r\n    }\r\n    get componentSizeInBytes() {\r\n        return this.__componentType.getSizeInBytes();\r\n    }\r\n    get elementSizeInBytes() {\r\n        return this.numberOfComponents * this.componentSizeInBytes;\r\n    }\r\n    get elementCount() {\r\n        return this.__dataView.byteLength / (this.numberOfComponents * this.componentSizeInBytes);\r\n    }\r\n    get byteLength() {\r\n        return this.__byteStride * this.__count;\r\n    }\r\n    get componentType() {\r\n        return this.__componentType;\r\n    }\r\n    get compositionType() {\r\n        return this.__compositionType;\r\n    }\r\n    getTypedArray() {\r\n        if (this.__bufferView.isAoS) {\r\n            console.warn('Be careful. this reference bufferView is AoS(Array on Structure), it means Interleaved Data. So you can not access your data properly by this TypedArray.');\r\n        }\r\n        return this.__typedArray;\r\n    }\r\n    get isAoS() {\r\n        return this.__bufferView.isAoS;\r\n    }\r\n    get isSoA() {\r\n        return this.__bufferView.isSoA;\r\n    }\r\n    get byteStride() {\r\n        return this.__byteStride;\r\n    }\r\n    getScalar(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        return this.__dataViewGetter(this.__byteStride * index, endian);\r\n    }\r\n    getScalarAt(i, compositionOffset, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        return this.__dataViewGetter(this.__byteStride * index + compositionOffset, endian);\r\n    }\r\n    getVec2AsArray(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return [this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian)];\r\n    }\r\n    getVec3AsArray(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return [this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian)];\r\n    }\r\n    getVec4AsArray(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return [this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian)];\r\n    }\r\n    getMat3AsArray(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return [\r\n            this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian),\r\n            this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 4 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 5 * byteSize, endian),\r\n            this.__dataViewGetter(this.__byteStride * index + 6 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 7 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 8 * byteSize, endian),\r\n        ];\r\n    }\r\n    getMat4AsArray(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return [\r\n            this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian),\r\n            this.__dataViewGetter(this.__byteStride * index + 4 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 5 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 6 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 7 * byteSize, endian),\r\n            this.__dataViewGetter(this.__byteStride * index + 8 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 9 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 10 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 11 * byteSize, endian),\r\n            this.__dataViewGetter(this.__byteStride * index + 12 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 13 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 14 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 15 * byteSize, endian),\r\n        ];\r\n    }\r\n    getVec2(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return new _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian));\r\n    }\r\n    getVec3(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return new _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian));\r\n    }\r\n    getVec4(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return new _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian));\r\n    }\r\n    getMat3(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return new _math_Matrix33__WEBPACK_IMPORTED_MODULE_6__[\"default\"](this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 4 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 5 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 6 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 7 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 8 * byteSize, endian));\r\n    }\r\n    getMat4(i, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const byteSize = this.componentSizeInBytes;\r\n        return new _math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_7__[\"default\"](this.__dataViewGetter(this.__byteStride * index, endian), this.__dataViewGetter(this.__byteStride * index + 1 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 2 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 3 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 4 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 5 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 6 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 7 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 8 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 9 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 10 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 11 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 12 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 13 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 14 * byteSize, endian), this.__dataViewGetter(this.__byteStride * index + 15 * byteSize, endian));\r\n    }\r\n    setScalar(i, value, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        this.__dataViewSetter(this.__byteStride * index, value, endian);\r\n    }\r\n    setVec2(i, x, y, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, y, endian);\r\n    }\r\n    setVec3(i, x, y, z, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, y, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 2 * sizeInBytes, z, endian);\r\n    }\r\n    setVec4(i, x, y, z, w, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, y, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 2 * sizeInBytes, z, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 3 * sizeInBytes, w, endian);\r\n    }\r\n    setVec2AsVector(i, vec, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, vec.x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, vec.y, endian);\r\n    }\r\n    setVec3AsVector(i, vec, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, vec.x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, vec.y, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 2 * sizeInBytes, vec.z, endian);\r\n    }\r\n    setVec4AsVector(i, vec, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        const sizeInBytes = this.componentSizeInBytes;\r\n        this.__dataViewSetter(this.__byteStride * index, vec.x, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 1 * sizeInBytes, vec.y, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 2 * sizeInBytes, vec.z, endian);\r\n        this.__dataViewSetter(this.__byteStride * index + 3 * sizeInBytes, vec.w, endian);\r\n    }\r\n    copyFromTypedArray(typedArray) {\r\n        const componentN = this.numberOfComponents;\r\n        const setter = this['setVec' + componentN];\r\n        for (let j = 0; j < (typedArray.byteLength / this.componentSizeInBytes); j++) {\r\n            const idx = Math.floor(j / componentN);\r\n            const idxN = idx * componentN;\r\n            switch (componentN) {\r\n                case 1:\r\n                    setter.call(this, idx, typedArray[idxN + 0], {});\r\n                    break;\r\n                case 2:\r\n                    setter.call(this, idx, typedArray[idxN + 0], typedArray[idxN + 1], {});\r\n                    break;\r\n                case 3:\r\n                    setter.call(this, idx, typedArray[idxN + 0], typedArray[idxN + 1], typedArray[idxN + 2], {});\r\n                    break;\r\n                case 4:\r\n                    setter.call(this, idx, typedArray[idxN + 0], typedArray[idxN + 1], typedArray[idxN + 2], typedArray[idxN + 3], {});\r\n                    break;\r\n                default: throw new Error('Other than vectors are currently not supported.');\r\n            }\r\n        }\r\n    }\r\n    setScalarAt(i, compositionOffset, value, { indicesAccessor, endian = true }) {\r\n        let index = i;\r\n        if (indicesAccessor) {\r\n            index = indicesAccessor.getScalar(i, {});\r\n        }\r\n        this.__dataViewSetter(this.__byteStride * index + compositionOffset, value, endian);\r\n    }\r\n    setElementFromSameCompositionAccessor(i, accessor, secondIdx) {\r\n        const j = (secondIdx != null) ? secondIdx : i;\r\n        if (this.compositionType.getNumberOfComponents() === 1) {\r\n            this.setScalar(i, accessor.getScalar(j, {}), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 2) {\r\n            this.setVec2AsVector(i, accessor.getVec2(j, {}), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 3) {\r\n            this.setVec3AsVector(i, accessor.getVec3(j, {}), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 4) {\r\n            this.setVec4AsVector(i, accessor.getVec4(j, {}), {});\r\n        }\r\n    }\r\n    setElementFromAccessor(i, accessor, secondIdx) {\r\n        const j = (secondIdx != null) ? secondIdx : i;\r\n        if (this.compositionType.getNumberOfComponents() === 1) {\r\n            if (accessor.compositionType.getNumberOfComponents() === 1) {\r\n                this.setScalar(i, accessor.getScalar(j, {}), {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 2) {\r\n                this.setScalar(i, accessor.getVec2(j, {}).x, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 3) {\r\n                this.setScalar(i, accessor.getVec3(j, {}).x, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 4) {\r\n                this.setScalar(i, accessor.getVec4(j, {}).x, {});\r\n            }\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 2) {\r\n            if (accessor.compositionType.getNumberOfComponents() === 1) {\r\n                const scalar = accessor.getScalar(j, {});\r\n                this.setVec2(i, scalar, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 2) {\r\n                this.setVec2AsVector(i, accessor.getVec2(j, {}), {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 3) {\r\n                const vec = accessor.getVec3(j, {});\r\n                this.setVec2(i, vec.x, vec.y, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 4) {\r\n                const vec = accessor.getVec4(j, {});\r\n                this.setVec2(i, vec.x, vec.y, {});\r\n            }\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 3) {\r\n            if (accessor.compositionType.getNumberOfComponents() === 1) {\r\n                const scalar = accessor.getScalar(j, {});\r\n                this.setVec3(i, scalar, 0, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 2) {\r\n                const vec = accessor.getVec2(j, {});\r\n                this.setVec3(i, vec.x, vec.y, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 3) {\r\n                const vec = accessor.getVec3(j, {});\r\n                this.setVec3AsVector(i, vec, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 4) {\r\n                const vec = accessor.getVec4(j, {});\r\n                this.setVec3(i, vec.x, vec.y, vec.z, {});\r\n            }\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 4) {\r\n            if (accessor.compositionType.getNumberOfComponents() === 1) {\r\n                const scalar = accessor.getScalar(j, {});\r\n                this.setVec4(i, scalar, 0, 0, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 2) {\r\n                const vec = accessor.getVec2(j, {});\r\n                this.setVec4(i, vec.x, vec.y, 0, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 3) {\r\n                const vec = accessor.getVec3(j, {});\r\n                this.setVec4(i, vec.x, vec.y, vec.z, 0, {});\r\n            }\r\n            else if (accessor.compositionType.getNumberOfComponents() === 4) {\r\n                const vec = accessor.getVec4(j, {});\r\n                this.setVec4AsVector(i, vec, {});\r\n            }\r\n        }\r\n    }\r\n    addElementFromSameCompositionAccessor(i, accessor, coeff, secondIdx) {\r\n        const j = (secondIdx != null) ? secondIdx : i;\r\n        if (this.compositionType.getNumberOfComponents() === 1) {\r\n            this.setScalar(i, this.getScalar(i, {}) + coeff * accessor.getScalar(j, {}), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 2) {\r\n            this.setVec2AsVector(i, _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"].add(this.getVec2(i, {}), _math_Vector2__WEBPACK_IMPORTED_MODULE_3__[\"default\"].multiply(accessor.getVec2(j, {}), coeff)), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 3) {\r\n            this.setVec3AsVector(i, _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].add(this.getVec3(i, {}), _math_Vector3__WEBPACK_IMPORTED_MODULE_4__[\"default\"].multiply(accessor.getVec3(j, {}), coeff)), {});\r\n        }\r\n        else if (this.compositionType.getNumberOfComponents() === 4) {\r\n            this.setVec4AsVector(i, _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"].add(this.getVec4(i, {}), _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"].multiply(accessor.getVec4(j, {}), coeff)), {});\r\n        }\r\n    }\r\n    get arrayBufferOfBufferView() {\r\n        return this.__raw;\r\n    }\r\n    get dataViewOfBufferView() {\r\n        return this.__dataView;\r\n    }\r\n    get byteOffsetInBufferView() {\r\n        return this.__byteOffsetInRawArrayBufferOfBuffer - this.__bufferView.byteOffsetInRawArrayBufferOfBuffer;\r\n    }\r\n    get byteOffsetInBuffer() {\r\n        return this.__byteOffsetInRawArrayBufferOfBuffer - this.__bufferView.buffer.byteOffsetInRawArrayBuffer;\r\n    }\r\n    get byteOffsetInRawArrayBufferOfBuffer() {\r\n        return this.__byteOffsetInRawArrayBufferOfBuffer;\r\n    }\r\n    get bufferView() {\r\n        return this.__bufferView;\r\n    }\r\n    get min() {\r\n        return this.__min;\r\n    }\r\n    get max() {\r\n        return this.__max;\r\n    }\r\n    get normalized() {\r\n        return this.__normalized;\r\n    }\r\n    calcMinMax() {\r\n        const componentN = this.compositionType.getNumberOfComponents();\r\n        if (componentN === 4) {\r\n            const minVec4 = [Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE];\r\n            const maxVec4 = [-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE];\r\n            for (let i = 0; i < this.elementCount; i++) {\r\n                const vec4array = this.getVec4AsArray(i, {});\r\n                for (let j = 0; j < 4; j++) {\r\n                    if (vec4array[j] < minVec4[j]) {\r\n                        minVec4[j] = vec4array[j];\r\n                    }\r\n                    if (maxVec4[j] < vec4array[j]) {\r\n                        maxVec4[j] = vec4array[j];\r\n                    }\r\n                }\r\n            }\r\n            this.__min = minVec4;\r\n            this.__max = maxVec4;\r\n        }\r\n        else if (componentN === 3) {\r\n            const minVec3 = [Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE];\r\n            const maxVec3 = [-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE];\r\n            for (let i = 0; i < this.elementCount; i++) {\r\n                const vec3array = this.getVec3AsArray(i, {});\r\n                for (let j = 0; j < 3; j++) {\r\n                    if (vec3array[j] < minVec3[j]) {\r\n                        minVec3[j] = vec3array[j];\r\n                    }\r\n                    if (maxVec3[j] < vec3array[j]) {\r\n                        maxVec3[j] = vec3array[j];\r\n                    }\r\n                }\r\n            }\r\n            this.__min = minVec3;\r\n            this.__max = maxVec3;\r\n        }\r\n        else if (componentN === 2) {\r\n            const minVec2 = [Number.MAX_VALUE, Number.MAX_VALUE];\r\n            const maxVec2 = [-Number.MAX_VALUE, -Number.MAX_VALUE];\r\n            for (let i = 0; i < this.elementCount; i++) {\r\n                const vec2array = this.getVec2AsArray(i, {});\r\n                for (let j = 0; j < 2; j++) {\r\n                    if (vec2array[j] < minVec2[j]) {\r\n                        minVec2[j] = vec2array[j];\r\n                    }\r\n                    if (maxVec2[j] < vec2array[j]) {\r\n                        maxVec2[j] = vec2array[j];\r\n                    }\r\n                }\r\n            }\r\n            this.__min = minVec2;\r\n            this.__max = maxVec2;\r\n        }\r\n        else if (componentN === 1) {\r\n            let min = Number.MAX_VALUE;\r\n            let max = -Number.MAX_VALUE;\r\n            for (let i = 0; i < this.elementCount; i++) {\r\n                const scalar = this.getScalar(i, {});\r\n                if (scalar < min) {\r\n                    min = scalar;\r\n                }\r\n                if (max < scalar) {\r\n                    max = scalar;\r\n                }\r\n            }\r\n            this.__min = min;\r\n            this.__max = max;\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/memory/AccessorBase.ts?");

/***/ }),

/***/ "./src/foundation/memory/Buffer.ts":
/*!*****************************************!*\
  !*** ./src/foundation/memory/Buffer.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Buffer; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _BufferView__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BufferView */ \"./src/foundation/memory/BufferView.ts\");\n\r\n\r\nclass Buffer extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ byteLength, buffer, name }) {\r\n        super();\r\n        this.__byteLength = 0;\r\n        this.__byteOffset = 0;\r\n        this.__name = '';\r\n        this.__takenBytesIndex = 0;\r\n        this.__bufferViews = [];\r\n        this.__name = name;\r\n        this.__byteLength = byteLength;\r\n        if (buffer instanceof Uint8Array) {\r\n            this.__raw = buffer.buffer;\r\n            this.__byteOffset = buffer.byteOffset;\r\n            this.__takenBytesIndex = buffer.byteOffset;\r\n        }\r\n        else {\r\n            this.__raw = buffer;\r\n        }\r\n    }\r\n    set name(str) {\r\n        this.__name = str;\r\n    }\r\n    get name() {\r\n        return this.__name;\r\n    }\r\n    getArrayBuffer() {\r\n        return this.__raw;\r\n    }\r\n    takeBufferView({ byteLengthToNeed, byteStride, isAoS, byteAlign = 4 }) {\r\n        if (byteLengthToNeed % byteAlign !== 0) {\r\n            console.info(`Padding bytes added because byteLengthToNeed must be a multiple of ${byteAlign}.`);\r\n            byteLengthToNeed += byteAlign - (byteLengthToNeed % byteAlign);\r\n        }\r\n        // if (byteStride % 4 !== 0) {\r\n        //   console.info('Padding bytes added, byteStride must be a multiple of 4.');\r\n        //   byteStride += 4 - (byteStride % 4);\r\n        // }\r\n        const bufferView = new _BufferView__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({ buffer: this, byteOffset: this.__takenBytesIndex, byteLength: byteLengthToNeed, raw: this.__raw, isAoS: isAoS });\r\n        bufferView.byteStride = byteStride;\r\n        this.__takenBytesIndex += Uint8Array.BYTES_PER_ELEMENT * byteLengthToNeed;\r\n        this.__bufferViews.push(bufferView);\r\n        return bufferView;\r\n    }\r\n    takeBufferViewWithByteOffset({ byteLengthToNeed, byteStride, byteOffset, isAoS }) {\r\n        // if (byteLengthToNeed % 4 !== 0) {\r\n        //   console.info('Padding bytes added because byteLengthToNeed must be a multiple of 4.');\r\n        //   byteLengthToNeed += 4 - (byteLengthToNeed % 4);\r\n        // }\r\n        // if (byteStride % 4 !== 0) {\r\n        //   console.info('Padding bytes added, byteStride must be a multiple of 4.');\r\n        //   byteStride += 4 - (byteStride % 4);\r\n        // }\r\n        const bufferView = new _BufferView__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({ buffer: this, byteOffset: byteOffset + this.__byteOffset, byteLength: byteLengthToNeed, raw: this.__raw, isAoS: isAoS });\r\n        const takenBytesIndex = Uint8Array.BYTES_PER_ELEMENT * byteLengthToNeed + byteOffset + this.__byteOffset;\r\n        if (this.__takenBytesIndex < takenBytesIndex) {\r\n            this.__takenBytesIndex = takenBytesIndex;\r\n        }\r\n        bufferView.byteStride = byteStride;\r\n        this.__bufferViews.push(bufferView);\r\n        return bufferView;\r\n    }\r\n    _addTakenByteIndex(value) {\r\n        this.__takenBytesIndex += value;\r\n    }\r\n    get byteLength() {\r\n        return this.__byteLength;\r\n    }\r\n    get takenSizeInByte() {\r\n        return this.__takenBytesIndex;\r\n    }\r\n    get byteOffsetInRawArrayBuffer() {\r\n        return this.__byteOffset;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/memory/Buffer.ts?");

/***/ }),

/***/ "./src/foundation/memory/BufferView.ts":
/*!*********************************************!*\
  !*** ./src/foundation/memory/BufferView.ts ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BufferView; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _Accessor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Accessor */ \"./src/foundation/memory/Accessor.ts\");\n/* harmony import */ var _FlexibleAccessor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FlexibleAccessor */ \"./src/foundation/memory/FlexibleAccessor.ts\");\n\r\n\r\n\r\nclass BufferView extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ buffer, byteOffset, byteLength, raw, isAoS }) {\r\n        super();\r\n        this.__byteStride = 0;\r\n        this.__takenByteIndex = 0;\r\n        this.__accessors = [];\r\n        this.__buffer = buffer;\r\n        this.__byteOffsetInRawArrayBufferOfBuffer = byteOffset;\r\n        this.__byteLength = byteLength;\r\n        this.__raw = raw;\r\n        this.__isAoS = isAoS;\r\n    }\r\n    set byteStride(stride) {\r\n        this.__byteStride = stride;\r\n    }\r\n    get byteStride() {\r\n        return this.__byteStride;\r\n    }\r\n    get byteLength() {\r\n        return this.__byteLength;\r\n    }\r\n    /**\r\n     * byteOffset in Buffer (includes byteOffset of Buffer in it's inner arraybuffer)\r\n     */\r\n    get byteOffsetInBuffer() {\r\n        return this.__byteOffsetInRawArrayBufferOfBuffer - this.__buffer.byteOffsetInRawArrayBuffer;\r\n    }\r\n    /**\r\n     * byteOffset in Buffer (includes byteOffset of Buffer in it's inner arraybuffer)\r\n     */\r\n    get byteOffsetInRawArrayBufferOfBuffer() {\r\n        return this.__byteOffsetInRawArrayBufferOfBuffer;\r\n    }\r\n    get buffer() {\r\n        return this.__buffer;\r\n    }\r\n    get isSoA() {\r\n        return !this.__isAoS;\r\n    }\r\n    recheckIsSoA() {\r\n        if (this.__accessors.length <= 1) {\r\n            return true;\r\n        }\r\n        let firstStrideBytes = this.__accessors[0].byteStride;\r\n        let secondStrideBytes = this.__accessors[1].byteStride;\r\n        let firstElementSizeInBytes = this.__accessors[0].elementSizeInBytes;\r\n        let secondElementSizeInBytes = this.__accessors[1].elementSizeInBytes;\r\n        if (firstStrideBytes === secondStrideBytes &&\r\n            (firstElementSizeInBytes + secondElementSizeInBytes) < firstElementSizeInBytes) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    get isAoS() {\r\n        return this.__isAoS;\r\n    }\r\n    getUint8Array() {\r\n        return new Uint8Array(this.__raw, this.__byteOffsetInRawArrayBufferOfBuffer, this.__byteLength);\r\n    }\r\n    takeAccessor({ compositionType, componentType, count, max, min, byteAlign = 4, arrayLength, normalized = false }) {\r\n        const byteStride = this.byteStride;\r\n        const _arrayLength = (arrayLength != null) ? arrayLength : 1;\r\n        const accessor = this.__takeAccessorInner({\r\n            compositionType, componentType, count, byteStride, accessorClass: _Accessor__WEBPACK_IMPORTED_MODULE_1__[\"default\"],\r\n            max, min, byteAlign, arrayLength: _arrayLength, normalized\r\n        });\r\n        return accessor;\r\n    }\r\n    takeFlexibleAccessor({ compositionType, componentType, count, byteStride, max, min, byteAlign = 4, arrayLength, normalized = false }) {\r\n        const _arrayLength = (arrayLength != null) ? arrayLength : 1;\r\n        const accessor = this.__takeAccessorInner({\r\n            compositionType, componentType, count, byteStride, accessorClass: _FlexibleAccessor__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n            max, min, byteAlign, arrayLength: _arrayLength, normalized\r\n        });\r\n        return accessor;\r\n    }\r\n    takeAccessorWithByteOffset({ compositionType, componentType, count, byteOffset, max, min, normalized = false }) {\r\n        const byteStride = this.byteStride;\r\n        const accessor = this.__takeAccessorInnerWithByteOffset({\r\n            compositionType, componentType, count, byteStride, byteOffset, accessorClass: _Accessor__WEBPACK_IMPORTED_MODULE_1__[\"default\"], max, min, normalized\r\n        });\r\n        return accessor;\r\n    }\r\n    takeFlexibleAccessorWithByteOffset({ compositionType, componentType, count, byteStride, byteOffset, max, min, normalized = false }) {\r\n        const accessor = this.__takeAccessorInnerWithByteOffset({\r\n            compositionType, componentType, count, byteStride, byteOffset, accessorClass: _FlexibleAccessor__WEBPACK_IMPORTED_MODULE_2__[\"default\"], max, min, normalized\r\n        });\r\n        return accessor;\r\n    }\r\n    __takeAccessorInner({ compositionType, componentType, count, byteStride, accessorClass, max, min, byteAlign, arrayLength, normalized }) {\r\n        let byteOffset = 0;\r\n        if (this.isSoA) {\r\n            byteOffset = this.__takenByteIndex;\r\n            if (byteStride === 0) {\r\n                this.__takenByteIndex += compositionType.getNumberOfComponents() * componentType.getSizeInBytes() * arrayLength * count;\r\n            }\r\n            else {\r\n                this.__takenByteIndex += byteStride * count;\r\n            }\r\n        }\r\n        else {\r\n            byteOffset = this.__takenByteIndex;\r\n            // if (byteStride === 0) {\r\n            this.__takenByteIndex += compositionType.getNumberOfComponents() * componentType.getSizeInBytes() * arrayLength;\r\n            // } else {\r\n            //   this.__takenByteIndex += byteStride;\r\n            // }\r\n        }\r\n        if (byteOffset % byteAlign !== 0) {\r\n            console.info(`Padding bytes added because byteOffset is not ${byteAlign}byte aligned.`);\r\n            const paddingBytes = byteAlign - byteOffset % byteAlign;\r\n            byteOffset += paddingBytes;\r\n            this.__takenByteIndex += paddingBytes;\r\n        }\r\n        // if (this.__byteOffset % byteAlign !== 0) {\r\n        //   console.info(`Padding bytes added because byteOffsetFromBuffer is not ${byteAlign}byte aligned.`);\r\n        //   const paddingBytes = byteAlign - this.__byteOffset % byteAlign;\r\n        //   // this.__byteOffset += paddingBytes;\r\n        //   this.__takenByteIndex += paddingBytes;\r\n        //   // this.buffer._addTakenByteIndex(paddingBytes);\r\n        // }\r\n        const accessor = new accessorClass({\r\n            bufferView: this, byteOffset, compositionType, componentType, byteStride,\r\n            count, raw: this.__raw, max, min, arrayLength, normalized\r\n        });\r\n        this.__accessors.push(accessor);\r\n        return accessor;\r\n    }\r\n    __takeAccessorInnerWithByteOffset({ compositionType, componentType, count, byteStride, byteOffset, accessorClass, max, min, normalized }) {\r\n        // if (byteOffset % 4 !== 0) {\r\n        //   console.info('Padding bytes added because byteOffset is not 4byte aligned.');\r\n        //   byteOffset += 4 - byteOffset % 4;\r\n        // }\r\n        // if (this.__byteOffset % 4 !== 0) {\r\n        //   console.info('Padding bytes added because byteOffsetFromBuffer is not 4byte aligned.');\r\n        //   this.__byteOffset += 4 - this.__byteOffset % 4;\r\n        // this.buffer._addTakenByteIndex(4 - this.__byteOffset % 4);\r\n        // }\r\n        const accessor = new accessorClass({\r\n            bufferView: this, byteOffset, compositionType, componentType, byteStride,\r\n            count, raw: this.__raw, max, min, arrayLength: 1, normalized\r\n        });\r\n        this.__accessors.push(accessor);\r\n        return accessor;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/memory/BufferView.ts?");

/***/ }),

/***/ "./src/foundation/memory/FlexibleAccessor.ts":
/*!***************************************************!*\
  !*** ./src/foundation/memory/FlexibleAccessor.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FlexibleAccessor; });\n/* harmony import */ var _AccessorBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AccessorBase */ \"./src/foundation/memory/AccessorBase.ts\");\n\r\nclass FlexibleAccessor extends _AccessorBase__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor({ bufferView, byteOffset, compositionType, componentType, byteStride, count, raw, arrayLength, normalized }) {\r\n        super({ bufferView, byteOffset, compositionType, componentType, byteStride, count, raw, arrayLength, normalized });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/memory/FlexibleAccessor.ts?");

/***/ }),

/***/ "./src/foundation/misc/DataUtil.ts":
/*!*****************************************!*\
  !*** ./src/foundation/misc/DataUtil.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DataUtil; });\nclass DataUtil {\r\n    static isNode() {\r\n        let isNode = (window === void 0 && typeof process !== \"undefined\" && \"function\" !== \"undefined\");\r\n        return isNode;\r\n    }\r\n    static btoa(str) {\r\n        let isNode = DataUtil.isNode();\r\n        if (isNode) {\r\n            let buffer;\r\n            if (Buffer.isBuffer(str)) {\r\n                buffer = str;\r\n            }\r\n            else {\r\n                buffer = new Buffer(str.toString(), 'binary');\r\n            }\r\n            return buffer.toString('base64');\r\n        }\r\n        else {\r\n            return btoa(str);\r\n        }\r\n    }\r\n    static atob(str) {\r\n        let isNode = DataUtil.isNode();\r\n        if (isNode) {\r\n            return new Buffer(str, 'base64').toString('binary');\r\n        }\r\n        else {\r\n            return atob(str);\r\n        }\r\n    }\r\n    static dataUriToArrayBuffer(dataUri) {\r\n        let splittedDataUri = dataUri.split(',');\r\n        // let type = splittedDataUri[0].split(':')[1].split(';')[0];\r\n        let byteString = DataUtil.atob(splittedDataUri[1]);\r\n        let byteStringLength = byteString.length;\r\n        let arrayBuffer = new ArrayBuffer(byteStringLength);\r\n        let uint8Array = new Uint8Array(arrayBuffer);\r\n        for (let i = 0; i < byteStringLength; i++) {\r\n            uint8Array[i] = byteString.charCodeAt(i);\r\n        }\r\n        return arrayBuffer;\r\n    }\r\n    static arrayBufferToString(arrayBuffer) {\r\n        if (typeof TextDecoder !== 'undefined') {\r\n            const textDecoder = new TextDecoder();\r\n            return textDecoder.decode(arrayBuffer);\r\n        }\r\n        else {\r\n            const bytes = new Uint8Array(arrayBuffer);\r\n            const result = this.uint8ArrayToStringInner(bytes);\r\n            return result;\r\n        }\r\n    }\r\n    static uint8ArrayToString(uint8Array) {\r\n        if (typeof TextDecoder !== 'undefined') {\r\n            const textDecoder = new TextDecoder();\r\n            return textDecoder.decode(uint8Array);\r\n        }\r\n        else {\r\n            const result = this.uint8ArrayToStringInner(uint8Array);\r\n            return result;\r\n        }\r\n    }\r\n    static stringToBase64(str) {\r\n        let b64 = null;\r\n        b64 = DataUtil.btoa(str);\r\n        return b64;\r\n    }\r\n    static base64ToArrayBuffer(base64) {\r\n        var binary_string = window.atob(base64);\r\n        var len = binary_string.length;\r\n        var bytes = new Uint8Array(len);\r\n        for (var i = 0; i < len; i++) {\r\n            bytes[i] = binary_string.charCodeAt(i);\r\n        }\r\n        return bytes.buffer;\r\n    }\r\n    static UInt8ArrayToDataURL(uint8array, width, height) {\r\n        let canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        let ctx = canvas.getContext(\"2d\");\r\n        let imageData = ctx.createImageData(width, height);\r\n        for (let i = 0; i < imageData.data.length; i += 4) {\r\n            imageData.data[i + 0] = uint8array[(height - Math.floor(i / (4 * width))) * (4 * width) + i % (4 * width) + 0];\r\n            imageData.data[i + 1] = uint8array[(height - Math.floor(i / (4 * width))) * (4 * width) + i % (4 * width) + 1];\r\n            imageData.data[i + 2] = uint8array[(height - Math.floor(i / (4 * width))) * (4 * width) + i % (4 * width) + 2];\r\n            imageData.data[i + 3] = uint8array[(height - Math.floor(i / (4 * width))) * (4 * width) + i % (4 * width) + 3];\r\n        }\r\n        ctx.putImageData(imageData, 0, 0);\r\n        canvas.remove();\r\n        return canvas.toDataURL(\"image/png\");\r\n    }\r\n    static loadResourceAsync(resourceUri, isBinary, resolveCallback, rejectCallback) {\r\n        return new Promise((resolve, reject) => {\r\n            let isNode = DataUtil.isNode();\r\n            if (isNode) {\r\n                // let fs = require('fs');\r\n                // let args: any[] = [resourceUri];\r\n                // let func: Function = (err:any, response: any) => {\r\n                //   if (err) {\r\n                //     if (rejectCallback) {\r\n                //       rejectCallback(reject, err);\r\n                //     }\r\n                //     return;\r\n                //   }\r\n                //   if (isBinary) {\r\n                //     let buffer = new Buffer(response, 'binary');\r\n                //     let uint8Buffer = new Uint8Array(buffer);\r\n                //     response = uint8Buffer.buffer;\r\n                //   }\r\n                //   resolveCallback(resolve, response);\r\n                // };\r\n                // if (isBinary) {\r\n                //   args.push(func);\r\n                // } else {\r\n                //   args.push('utf8');\r\n                //   args.push(func);\r\n                // }\r\n                // fs.readFile.apply(fs, args);\r\n            }\r\n            else {\r\n                let xmlHttp = new XMLHttpRequest();\r\n                if (isBinary) {\r\n                    xmlHttp.onload = (oEvent) => {\r\n                        let response = null;\r\n                        if (isBinary) {\r\n                            response = xmlHttp.response;\r\n                        }\r\n                        else {\r\n                            response = xmlHttp.responseText;\r\n                        }\r\n                        resolveCallback(resolve, response);\r\n                    };\r\n                    xmlHttp.open(\"GET\", resourceUri, true);\r\n                    xmlHttp.responseType = \"arraybuffer\";\r\n                }\r\n                else {\r\n                    xmlHttp.onreadystatechange = () => {\r\n                        if (xmlHttp.readyState === 4 && (Math.floor(xmlHttp.status / 100) === 2 || xmlHttp.status === 0)) {\r\n                            let response = null;\r\n                            if (isBinary) {\r\n                                response = xmlHttp.response;\r\n                            }\r\n                            else {\r\n                                response = xmlHttp.responseText;\r\n                            }\r\n                            resolveCallback(resolve, response);\r\n                        }\r\n                        else {\r\n                            if (rejectCallback) {\r\n                                rejectCallback(reject, xmlHttp.status);\r\n                            }\r\n                        }\r\n                    };\r\n                    xmlHttp.open(\"GET\", resourceUri, true);\r\n                }\r\n                xmlHttp.send(null);\r\n            }\r\n        });\r\n    }\r\n    static toCRC32(str) {\r\n        var crc = 0, x = 0, y = 0;\r\n        var table = DataUtil.crc32table;\r\n        crc = crc ^ (-1);\r\n        for (var i = 0, iTop = str.length; i < iTop; ++i) {\r\n            y = (crc ^ str.charCodeAt(i)) & 0xff;\r\n            x = \"0x\" + table[y];\r\n            crc = (crc >>> 8) ^ x;\r\n        }\r\n        return (crc ^ (-1)) >>> 0;\r\n    }\r\n    static accessBinaryAsImage(bufferViewIndex, json, buffer, mimeType) {\r\n        const uint8BufferView = this.takeBufferViewAsUint8Array(json, bufferViewIndex, buffer);\r\n        return this.accessArrayBufferAsImage(uint8BufferView, mimeType);\r\n    }\r\n    static createBlobImageUriFromUint8Array(uint8Array, mimeType) {\r\n        const blob = new Blob([uint8Array], { type: mimeType });\r\n        const imageUrl = URL.createObjectURL(blob);\r\n        return imageUrl;\r\n    }\r\n    static takeBufferViewAsUint8Array(json, bufferViewIndex, buffer) {\r\n        const bufferViewJson = json.bufferViews[bufferViewIndex];\r\n        let byteOffset = (bufferViewJson.byteOffset != null) ? bufferViewJson.byteOffset : 0;\r\n        const byteLength = bufferViewJson.byteLength;\r\n        let arrayBuffer = buffer;\r\n        if (buffer instanceof Uint8Array) {\r\n            arrayBuffer = buffer.buffer;\r\n            byteOffset += buffer.byteOffset;\r\n        }\r\n        const uint8BufferView = new Uint8Array(arrayBuffer, byteOffset, byteLength);\r\n        return uint8BufferView;\r\n    }\r\n    static accessArrayBufferAsImage(arrayBuffer, imageType) {\r\n        const binaryData = this.uint8ArrayToStringInner(new Uint8Array(arrayBuffer));\r\n        const imgSrc = this.getImageType(imageType);\r\n        const dataUrl = imgSrc + DataUtil.btoa(binaryData);\r\n        return dataUrl;\r\n    }\r\n    static uint8ArrayToStringInner(uint8) {\r\n        const charCodeArray = new Array(uint8.byteLength);\r\n        for (let i = 0; i < uint8.byteLength; i++) {\r\n            charCodeArray[i] = uint8[i];\r\n        }\r\n        // the argument of String.fromCharCode has the limit of array length\r\n        const constant = 1024;\r\n        const divisionNumber = Math.ceil(charCodeArray.length / constant);\r\n        let binaryData = '';\r\n        for (let i = 0; i < divisionNumber; i++) {\r\n            binaryData += String.fromCharCode.apply(this, charCodeArray.slice(i * constant, (i + 1) * constant));\r\n        }\r\n        return binaryData;\r\n    }\r\n    static getImageType(imageType) {\r\n        let imgSrc = null;\r\n        if (imageType === 'image/jpeg' || imageType.toLowerCase() === 'jpg' || imageType.toLowerCase() === 'jpeg') {\r\n            imgSrc = \"data:image/jpeg;base64,\";\r\n        }\r\n        else if (imageType == 'image/png' || imageType.toLowerCase() === 'png') {\r\n            imgSrc = \"data:image/png;base64,\";\r\n        }\r\n        else if (imageType == 'image/gif' || imageType.toLowerCase() === 'gif') {\r\n            imgSrc = \"data:image/gif;base64,\";\r\n        }\r\n        else if (imageType == 'image/bmp' || imageType.toLowerCase() === 'bmp') {\r\n            imgSrc = \"data:image/bmp;base64,\";\r\n        }\r\n        else {\r\n            imgSrc = \"data:image/unknown;base64,\";\r\n        }\r\n        return imgSrc;\r\n    }\r\n    static getMimeTypeFromExtension(extension) {\r\n        let imgSrc = null;\r\n        if (extension.toLowerCase() === 'jpg' || extension.toLowerCase() === 'jpeg') {\r\n            imgSrc = \"image/jpeg\";\r\n        }\r\n        else if (extension.toLowerCase() === 'png') {\r\n            imgSrc = \"image/png\";\r\n        }\r\n        else if (extension.toLowerCase() === 'gif') {\r\n            imgSrc = \"image/gif\";\r\n        }\r\n        else if (extension.toLowerCase() === 'bmp') {\r\n            imgSrc = \"image/bmp\";\r\n        }\r\n        else {\r\n            imgSrc = \"image/unknown\";\r\n        }\r\n        return imgSrc;\r\n    }\r\n    static getExtension(fileName) {\r\n        const splitted = fileName.split('.');\r\n        const fileExtension = splitted[splitted.length - 1];\r\n        return fileExtension;\r\n    }\r\n    static createUint8ArrayFromBufferViewInfo(json, bufferViewIndex, buffer) {\r\n        const bufferViewJson = json.bufferViews[bufferViewIndex];\r\n        let byteOffset = (bufferViewJson.byteOffset != null) ? bufferViewJson.byteOffset : 0;\r\n        const byteLength = bufferViewJson.byteLength;\r\n        let arrayBuffer = buffer;\r\n        if (buffer instanceof Uint8Array) {\r\n            arrayBuffer = buffer.buffer;\r\n            byteOffset += buffer.byteOffset;\r\n        }\r\n        const uint8BufferView = new Uint8Array(arrayBuffer, byteOffset, byteLength);\r\n        return uint8BufferView;\r\n    }\r\n    static createImageFromUri(uri, mimeType) {\r\n        return new Promise(function (resolve) {\r\n            const img = new Image();\r\n            img.crossOrigin = 'Anonymous';\r\n            if (uri.match(/^blob:/) || uri.match(/^data:/)) {\r\n                img.onload = () => {\r\n                    resolve(img);\r\n                };\r\n                img.src = uri;\r\n            }\r\n            else {\r\n                const load = (img, response) => {\r\n                    const bytes = new Uint8Array(response);\r\n                    const imageUri = DataUtil.createBlobImageUriFromUint8Array(bytes, mimeType);\r\n                    img.onload = () => {\r\n                        resolve(img);\r\n                    };\r\n                    img.src = imageUri;\r\n                };\r\n                const loadBinaryImage = () => {\r\n                    var xhr = new XMLHttpRequest();\r\n                    xhr.onreadystatechange = (function (_img) {\r\n                        return function () {\r\n                            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                                load(_img, xhr.response);\r\n                            }\r\n                        };\r\n                    })(img);\r\n                    xhr.open('GET', uri);\r\n                    xhr.responseType = 'arraybuffer';\r\n                    xhr.send();\r\n                };\r\n                loadBinaryImage();\r\n            }\r\n        });\r\n    }\r\n    static createDefaultGltfOptions() {\r\n        const defaultOptions = {\r\n            files: {\r\n            //        \"foo.gltf\": content of file as ArrayBuffer,\r\n            //        \"foo.bin\": content of file as ArrayBuffer,\r\n            //        \"boo.png\": content of file as ArrayBuffer\r\n            },\r\n            loaderExtension: null,\r\n            defaultMaterialHelperName: null,\r\n            defaultMaterialHelperArgumentArray: [],\r\n            statesOfElements: [\r\n                {\r\n                    targets: [],\r\n                    states: {\r\n                        enable: [\r\n                        // 3042,  // BLEND\r\n                        ],\r\n                        functions: {\r\n                        //\"blendFuncSeparate\": [1, 0, 1, 0],\r\n                        }\r\n                    },\r\n                    isTransparent: true,\r\n                    opacity: 1.0,\r\n                    isTextureImageToLoadPreMultipliedAlpha: false,\r\n                }\r\n            ],\r\n            tangentCalculationMode: 1,\r\n            isPreComputeForRayCastPickingEnable: false,\r\n            extendedJson: void 0 //   URI string / JSON Object / ArrayBuffer\r\n        };\r\n        return defaultOptions;\r\n    }\r\n    static fetchArrayBuffer(uri) {\r\n        return new Promise((resolve) => {\r\n            fetch(uri).then((response) => {\r\n                response.arrayBuffer().then((arrayBuffer) => {\r\n                    resolve(arrayBuffer);\r\n                });\r\n            }).catch((err) => {\r\n                throw new Error('import error: ' + err);\r\n            });\r\n        });\r\n    }\r\n}\r\nDataUtil.crc32table = \"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D\".split(' ');\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/DataUtil.ts?");

/***/ }),

/***/ "./src/foundation/misc/EnumIO.ts":
/*!***************************************!*\
  !*** ./src/foundation/misc/EnumIO.ts ***!
  \***************************************/
/*! exports provided: EnumClass, _from, _fromString, _fromStringCaseSensitively */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EnumClass\", function() { return EnumClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_from\", function() { return _from; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_fromString\", function() { return _fromString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_fromStringCaseSensitively\", function() { return _fromStringCaseSensitively; });\n// This code idea is from https://qiita.com/junkjunctions/items/5a6d8bed8df8eb3acceb\r\nclass EnumClass {\r\n    constructor({ index, str, noCheckStrUnique }) {\r\n        if (EnumClass.__indices.get(this.constructor) == null) {\r\n            EnumClass.__indices.set(this.constructor, []);\r\n        }\r\n        if (EnumClass.__strings.get(this.constructor) == null) {\r\n            EnumClass.__strings.set(this.constructor, []);\r\n        }\r\n        if (EnumClass.__indices.get(this.constructor).indexOf(index) !== -1) {\r\n            throw new Error('Dont use duplicate index.');\r\n        }\r\n        if (noCheckStrUnique !== true) {\r\n            if (EnumClass.__strings.get(this.constructor).indexOf(str) !== -1) {\r\n                throw new Error('Dont use duplicate str.');\r\n            }\r\n        }\r\n        this.index = index;\r\n        this.str = str;\r\n        EnumClass.__indices.get(this.constructor).push(index);\r\n        EnumClass.__strings.get(this.constructor).push(str);\r\n    }\r\n    toString() {\r\n        return this.str;\r\n    }\r\n    toJSON() {\r\n        return this.index;\r\n    }\r\n}\r\nEnumClass.__indices = new Map();\r\nEnumClass.__strings = new Map();\r\nfunction _from({ typeList, index }) {\r\n    const match = typeList.find(type => type.index === index);\r\n    if (!match) {\r\n        return void 0;\r\n    }\r\n    return match;\r\n}\r\nfunction _fromString({ typeList, str }) {\r\n    const match = typeList.find(type => type.str.toLowerCase() === str.toLowerCase());\r\n    if (!match) {\r\n        return void 0;\r\n    }\r\n    return match;\r\n}\r\nfunction _fromStringCaseSensitively({ typeList, str }) {\r\n    const match = typeList.find(type => type.str === str);\r\n    if (!match) {\r\n        return void 0;\r\n    }\r\n    return match;\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/EnumIO.ts?");

/***/ }),

/***/ "./src/foundation/misc/IsUtil.ts":
/*!***************************************!*\
  !*** ./src/foundation/misc/IsUtil.ts ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nconst IsUtil = {\r\n    not: {},\r\n    all: {},\r\n    any: {},\r\n    _not(fn) {\r\n        return function () {\r\n            return !fn.apply(null, [...arguments]);\r\n        };\r\n    },\r\n    _all(fn) {\r\n        return function () {\r\n            if (Array.isArray(arguments[0])) {\r\n                return arguments[0].every(fn);\r\n            }\r\n            return [...arguments].every(fn);\r\n        };\r\n    },\r\n    _any(fn) {\r\n        return function () {\r\n            if (Array.isArray(arguments[0])) {\r\n                return arguments[0].some(fn);\r\n            }\r\n            return [...arguments].some(fn);\r\n        };\r\n    },\r\n    defined(val) {\r\n        return val !== void 0;\r\n    },\r\n    undefined(val) {\r\n        return val === void 0;\r\n    },\r\n    null(val) {\r\n        return val === null;\r\n    },\r\n    // is NOT null or undefined\r\n    exist(val) {\r\n        return val != null;\r\n    },\r\n    function(val) {\r\n        return typeof val === 'function';\r\n    }\r\n};\r\nfor (let fn in IsUtil) {\r\n    if (IsUtil.hasOwnProperty(fn)) {\r\n        const interfaces = ['not', 'all', 'any'];\r\n        if (fn.indexOf('_') === -1 && !interfaces.includes(fn)) {\r\n            interfaces.forEach((itf) => {\r\n                const op = '_' + itf;\r\n                IsUtil[itf][fn] = IsUtil[op](IsUtil[fn]);\r\n            });\r\n        }\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (IsUtil);\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/IsUtil.ts?");

/***/ }),

/***/ "./src/foundation/misc/MiscUtil.ts":
/*!*****************************************!*\
  !*** ./src/foundation/misc/MiscUtil.ts ***!
  \*****************************************/
/*! exports provided: MiscUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MiscUtil\", function() { return MiscUtil; });\nconst isMobile = function () {\r\n    const ua = [\r\n        'iPod',\r\n        'iPad',\r\n        'iPhone',\r\n        'Android'\r\n    ];\r\n    for (var i = 0; i < ua.length; i++) {\r\n        if (navigator.userAgent.indexOf(ua[i]) > 0) {\r\n            return true;\r\n        }\r\n    }\r\n    return isIPad();\r\n};\r\nconst isIOS = function () {\r\n    const ua = [\r\n        'iPod',\r\n        'iPad',\r\n        'iPhone'\r\n    ];\r\n    for (var i = 0; i < ua.length; i++) {\r\n        if (navigator.userAgent.indexOf(ua[i]) > 0) {\r\n            return true;\r\n        }\r\n    }\r\n    return isIPad();\r\n};\r\nconst isIPad = function () {\r\n    return navigator.userAgent.indexOf('Macintosh') > -1 && 'ontouchend' in document;\r\n};\r\nconst preventDefaultForDesktopOnly = function (e) {\r\n    if (!isMobile()) {\r\n        e.preventDefault();\r\n    }\r\n};\r\nconst isObject = function (o) {\r\n    return (o instanceof Object && !(o instanceof Array)) ? true : false;\r\n};\r\n// https://stackoverflow.com/questions/30003353/can-es6-template-literals-be-substituted-at-runtime-or-reused\r\nconst fillTemplate = function (templateString, templateVars) {\r\n    return new Function(\"return `\" + templateString + \"`;\").call(templateVars);\r\n};\r\nconst isNode = function () {\r\n    return (typeof process !== \"undefined\" && \"function\" !== \"undefined\");\r\n};\r\nconst concatArrayBuffers = function (segments, sizes, paddingSize) {\r\n    var sumLength = 0;\r\n    for (var i = 0; i < sizes.length; ++i) {\r\n        sumLength += sizes[i];\r\n    }\r\n    var whole = new Uint8Array(sumLength + paddingSize);\r\n    var pos = 0;\r\n    for (var i = 0; i < segments.length; ++i) {\r\n        whole.set(new Uint8Array(segments[i], 0, sizes[i]), pos);\r\n        pos += sizes[i];\r\n    }\r\n    return whole.buffer;\r\n};\r\nconst MiscUtil = Object.freeze({ isMobile, isIOS, preventDefaultForDesktopOnly, isObject, fillTemplate, isNode, concatArrayBuffers });\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/MiscUtil.ts?");

/***/ }),

/***/ "./src/foundation/misc/RnPromise.ts":
/*!******************************************!*\
  !*** ./src/foundation/misc/RnPromise.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return RnPromise; });\nclass RnPromise {\r\n    constructor(arg, callback) {\r\n        this.name = '';\r\n        this.__callbackObj = {\r\n            promiseAllNum: 0,\r\n            resolvedNum: 0,\r\n            rejectedNum: 0,\r\n            pendingNum: 0,\r\n            processedPromises: []\r\n        };\r\n        if (arg instanceof Promise) {\r\n            this.__promise = arg;\r\n        }\r\n        else {\r\n            this.__promise = new Promise(arg);\r\n        }\r\n        this.__callback = callback;\r\n    }\r\n    static resolve(arg) {\r\n        if (arg instanceof Promise) {\r\n            return new RnPromise(arg);\r\n        }\r\n        else if (arg instanceof RnPromise) {\r\n            return arg;\r\n        }\r\n        else if (arg.then != null) {\r\n            const rnPromise = new RnPromise((resolve, reject) => {\r\n                resolve(arg);\r\n            });\r\n            rnPromise.then = arg.then;\r\n            return rnPromise;\r\n        }\r\n        else {\r\n            return new RnPromise((resolve, reject) => {\r\n                resolve(arg);\r\n            });\r\n        }\r\n    }\r\n    static all(args) {\r\n        return new RnPromise(Promise.all(args));\r\n    }\r\n    static allWithProgressCallback(promises, callback) {\r\n        const rnPromises = [];\r\n        const callbackObj = {\r\n            promiseAllNum: promises.length,\r\n            resolvedNum: 0,\r\n            rejectedNum: 0,\r\n            pendingNum: promises.length,\r\n            processedPromises: []\r\n        };\r\n        for (let promise of promises) {\r\n            const rnPromise = RnPromise.resolve(promise);\r\n            rnPromise.__callback = callback;\r\n            rnPromise.__callbackObj = callbackObj;\r\n            rnPromises.push(rnPromise);\r\n        }\r\n        return new RnPromise(Promise.all(promises));\r\n    }\r\n    static race(args) {\r\n        return new RnPromise(Promise.race(args));\r\n    }\r\n    then(onFulfilled, onRejected) {\r\n        const onFulfilledWrapper = (value) => {\r\n            if (this.__callbackObj.promiseAllNum !== 0 && this.__callbackObj.processedPromises.indexOf(this) === -1) {\r\n                this.__callbackObj.pendingNum--;\r\n                this.__callbackObj.resolvedNum++;\r\n                this.__callbackObj.processedPromises.push(this);\r\n            }\r\n            if (this.__callback) {\r\n                this.__callback(this.__callbackObj);\r\n            }\r\n            if (onFulfilled) {\r\n                onFulfilled(value);\r\n            }\r\n        };\r\n        return new RnPromise(this.__promise.then(onFulfilledWrapper, onRejected));\r\n    }\r\n    catch(onRejected) {\r\n        return new RnPromise(this.__promise.catch(onRejected));\r\n    }\r\n    finally(onFinally) {\r\n        this.__promise.finally(onFinally);\r\n    }\r\n    static reject(e) {\r\n        return new RnPromise(Promise.reject(e));\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/RnPromise.ts?");

/***/ }),

/***/ "./src/foundation/misc/Time.ts":
/*!*************************************!*\
  !*** ./src/foundation/misc/Time.ts ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Time; });\nclass Time {\r\n    /**\r\n     * @private\r\n     */\r\n    static _processBegin() {\r\n        if (Time.__currentProcessBeginTime === 0) {\r\n            Time.__systemStartTime = performance.now();\r\n        }\r\n        Time.__currentProcessBeginTime = performance.now();\r\n    }\r\n    /**\r\n     * @private\r\n     */\r\n    static _processEnd() {\r\n        Time.__lastProcessEndTime = performance.now();\r\n        Time.__lastTickTimeInterval = Time.__lastProcessEndTime - Time.__currentProcessBeginTime;\r\n    }\r\n    static get timeFromSystemStart() {\r\n        return (Time.__systemStartTime - performance.now() / 1000);\r\n    }\r\n    static get lastTickTimeInterval() {\r\n        return (Time.__lastTickTimeInterval / 1000);\r\n    }\r\n}\r\nTime.__currentProcessBeginTime = 0;\r\nTime.__lastProcessEndTime = 0;\r\nTime.__lastTickTimeInterval = 0;\r\nTime.__systemStartTime = 0;\r\n\n\n//# sourceURL=webpack:///./src/foundation/misc/Time.ts?");

/***/ }),

/***/ "./src/foundation/physics/SphereCollider.ts":
/*!**************************************************!*\
  !*** ./src/foundation/physics/SphereCollider.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SphereCollider; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n\r\nclass SphereCollider {\r\n    constructor() {\r\n        this.position = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n        this.radius = 0;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/physics/SphereCollider.ts?");

/***/ }),

/***/ "./src/foundation/physics/VRMColliderGroup.ts":
/*!****************************************************!*\
  !*** ./src/foundation/physics/VRMColliderGroup.ts ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VRMColliderGroup; });\nclass VRMColliderGroup {\r\n    constructor() {\r\n        this.colliders = [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/physics/VRMColliderGroup.ts?");

/***/ }),

/***/ "./src/foundation/physics/VRMSpringBoneGroup.ts":
/*!******************************************************!*\
  !*** ./src/foundation/physics/VRMSpringBoneGroup.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VRMSpringBoneGroup; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n\r\n\r\nclass VRMSpringBoneGroup extends _core_RnObject__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.stiffnessForce = 0.5;\r\n        this.gravityPower = 0;\r\n        this.gravityDir = new _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, -1.0, 0);\r\n        this.dragForce = 0.05;\r\n        this.hitRadius = 0.02;\r\n        this.rootBones = [];\r\n        this.colliderGroupIndices = [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/physics/VRMSpringBoneGroup.ts?");

/***/ }),

/***/ "./src/foundation/physics/VRMSpringBonePhysicsStrategy.ts":
/*!****************************************************************!*\
  !*** ./src/foundation/physics/VRMSpringBonePhysicsStrategy.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VRMSpringBonePhysicsStrategy; });\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/Quaternion */ \"./src/foundation/math/Quaternion.ts\");\n/* harmony import */ var _math_Matrix44__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _misc_Time__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../misc/Time */ \"./src/foundation/misc/Time.ts\");\n/* harmony import */ var _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/MutableQuaternion */ \"./src/foundation/math/MutableQuaternion.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass VRMSpringBonePhysicsStrategy {\r\n    constructor() {\r\n        this.__boneAxis = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n        this.__length = 0;\r\n        this.__currentTail = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n        this.__prevTail = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n        this.__localDir = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n        this.__localRotation = new _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"](0, 0, 0, 1);\r\n        this.__initalized = false;\r\n        this.__localChildPosition = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].zero();\r\n    }\r\n    initialize(transform, localChildPosition, center) {\r\n        this.__transform = transform;\r\n        const worldChildPosition = transform.getWorldPositionOf(localChildPosition);\r\n        this.__currentTail = (center != null) ? center.getLocalPositionOf(worldChildPosition) : worldChildPosition;\r\n        this.__prevTail = this.__currentTail;\r\n        this.__localRotation = transform.entity.getTransform().quaternion;\r\n        this.__boneAxis = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].normalize(localChildPosition);\r\n        // this.__boneAxis = Vector3.normalize(Vector3.subtract(this.__currentTail, transform.worldPosition));\r\n        this.__length = localChildPosition.length();\r\n        this.__localChildPosition = localChildPosition;\r\n        this.__initalized = true;\r\n    }\r\n    get isInitialized() {\r\n        return this.__initalized;\r\n    }\r\n    get head() {\r\n        return this.__transform;\r\n    }\r\n    get tail() {\r\n        _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiplyTo(this.__boneAxis, this.__length, VRMSpringBonePhysicsStrategy.__tmp_vec3);\r\n        this.__transform.worldMatrixInner.multiplyVector3To(VRMSpringBonePhysicsStrategy.__tmp_vec3, VRMSpringBonePhysicsStrategy.__tmp_vec3_2);\r\n        return VRMSpringBonePhysicsStrategy.__tmp_vec3_2;\r\n    }\r\n    get parentRotation() {\r\n        // return (this.__transform!.parent != null) ? this.__transform!.parent!.entity.getTransform().quaternion : new Quaternion(0, 0, 0, 1);\r\n        return (this.__transform.parent != null) ? _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"].fromMatrix(this.__transform.parent.worldMatrixInner) : new _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"](0, 0, 0, 1);\r\n    }\r\n    static update() {\r\n        for (let boneGroup of this.__boneGroups) {\r\n            this.updateInner(boneGroup.rootBones, boneGroup);\r\n        }\r\n    }\r\n    static updateInner(sceneGraphs, boneGroup) {\r\n        const dragForce = boneGroup.dragForce;\r\n        const stiffnessForce = boneGroup.stiffnessForce * _misc_Time__WEBPACK_IMPORTED_MODULE_4__[\"default\"].lastTickTimeInterval * 1;\r\n        const external = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(boneGroup.gravityDir, boneGroup.gravityPower * _misc_Time__WEBPACK_IMPORTED_MODULE_4__[\"default\"].lastTickTimeInterval * 1);\r\n        let center = void 0;\r\n        const collisionGroups = VRMSpringBonePhysicsStrategy.getColliderGroups(boneGroup.colliderGroupIndices);\r\n        for (let sg of sceneGraphs) {\r\n            const physicsComponent = sg.entity.getPhysics();\r\n            if (physicsComponent) {\r\n                const strategy = physicsComponent.strategy;\r\n                strategy.update(stiffnessForce, dragForce, external, collisionGroups, boneGroup.hitRadius, center);\r\n                const children = sg.children;\r\n                if (children) {\r\n                    this.updateInner(children, boneGroup);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    static initialize(sceneGraph) {\r\n        const children = sceneGraph.children;\r\n        const physicsComponent = sceneGraph.entity.getPhysics();\r\n        const vrmSpringBone = physicsComponent.strategy;\r\n        if (children.length > 0) {\r\n            const transform = children[0].entity.getTransform();\r\n            vrmSpringBone.initialize(sceneGraph, \r\n            //   new Vector3(\r\n            //   transform.translate.x * transform.scale.x,\r\n            //   transform.translate.y * transform.scale.y,\r\n            //   transform.translate.z * transform.scale.z\r\n            // ),\r\n            _math_Matrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"].invert(sceneGraph.worldMatrixInner).multiplyVector3(children[0].worldPosition), void 0);\r\n        }\r\n        else {\r\n            const delta = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(sceneGraph.worldPosition, sceneGraph.parent.worldPosition);\r\n            let childPosition = new _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"](1, 1, 1);\r\n            if (delta.lengthSquared() > 0) {\r\n                childPosition = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(sceneGraph.worldPosition, _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].normalize(delta), 0.07));\r\n            }\r\n            vrmSpringBone.initialize(sceneGraph, _math_Matrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"].invert(sceneGraph.worldMatrixInner).multiplyVector3(childPosition), void 0);\r\n        }\r\n    }\r\n    calcParentDeltaRecursivle(sceneGraph) {\r\n        const delta = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(sceneGraph.worldPosition, sceneGraph.parent.worldPosition);\r\n    }\r\n    update(stiffnessForce, dragForce, external, collisionGroups, boneHitRadius, center) {\r\n        const currentTail = (center != null) ? center.getWorldPositionOf(this.__currentTail) : this.__currentTail;\r\n        const prevTail = (center != null) ? center.getWorldPositionOf(this.__prevTail) : this.__prevTail;\r\n        const delta = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].multiply(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(currentTail, prevTail), 1.0 - dragForce);\r\n        const tmpRotationQuat = VRMSpringBonePhysicsStrategy.__tmp_quat;\r\n        _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiplyTo(this.parentRotation, this.__localRotation, tmpRotationQuat);\r\n        const dist = VRMSpringBonePhysicsStrategy.__tmp_vec3;\r\n        dist.copyComponents(this.__boneAxis).multiplyQuaternion(tmpRotationQuat).multiply(stiffnessForce);\r\n        // const dist = Vector3.multiply((this.__localRotation).multiplyVector3(this.__boneAxis), stiffnessForce);\r\n        // const dist = Vector3.zero();\r\n        let nextTail = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(currentTail, delta), dist), external);\r\n        const tmp = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(nextTail, this.__transform.worldPosition);\r\n        nextTail = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.__transform.worldPosition, _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].normalize(tmp), this.__length));\r\n        nextTail = this.collision(collisionGroups, nextTail, boneHitRadius);\r\n        this.__prevTail = (center != null) ? center.getLocalPositionOf(currentTail) : currentTail;\r\n        this.__currentTail = (center != null) ? center.getLocalPositionOf(nextTail) : nextTail;\r\n        const resultRotation = this.applyRotation(nextTail);\r\n        // this.head.entity.getTransform().quaternion = resultRotation;\r\n        // this.head.entity.getTransform().translate = this.__transform!.getLocalPositionOf(currentTail);\r\n        if (this.head.children.length > 0) {\r\n            // this.head.children[0].entity.getTransform().matrix = Matrix44.identity();\r\n            this.head.children[0].entity.getTransform().translate = this.__transform.getLocalPositionOf(nextTail);\r\n            // this.head.children[0].entity.getTransform().translate = new Vector3(1, 0, 0);\r\n            // this.head.children[0].entity.getTransform().quaternion = resultRotation;\r\n        }\r\n        // VRMSpringBonePhysicsStrategy.initialize(this.__transform!);\r\n    }\r\n    applyRotation(nextTail) {\r\n        // const rotation = Quaternion.multiply(this.parentRotation, this.__localRotation);\r\n        const rotation = this.__localRotation;\r\n        // const result = Quaternion.multiply(Quaternion.lookFromTo(rotation.multiplyVector3(this.__boneAxis), Vector3.subtract(nextTail, this.__transform!.worldPosition)), rotation);\r\n        const result = _math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiply(_math_Quaternion__WEBPACK_IMPORTED_MODULE_2__[\"default\"].lookFromTo(this.__boneAxis, this.__transform.getLocalPositionOf(nextTail)), rotation);\r\n        // const result = Quaternion.lookFromTo(this.__boneAxis, Vector3.subtract(nextTail, this.__transform!.worldPosition));\r\n        // const result = Quaternion.lookFromTo(this.__boneAxis, this.__transform!.getLocalPositionOf(nextTail));\r\n        // const delta = Vector3.subtract(nextTail, this.__transform!.worldPosition);\r\n        const boneAxis = this.__boneAxis;\r\n        // const result = Quaternion.lookForward(Vector3.subtract(nextTail, this.__transform!.worldPosition));\r\n        // const result = Quaternion.multiply(Quaternion.lookFromTo(rotation.multiplyVector3(this.__boneAxis), Vector3.normalize(delta)), this.__localRotation);\r\n        // const result = new Quaternion(0,0,0,1);\r\n        return result;\r\n    }\r\n    collision(collisionGroups, nextTail, boneHitRadius) {\r\n        for (let collisionGroup of collisionGroups) {\r\n            for (let collider of collisionGroup.colliders) {\r\n                const worldColiderPos = collisionGroup.baseSceneGraph.getWorldPositionOf(collider.position);\r\n                const r = boneHitRadius + collider.radius;\r\n                const delta = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].subtract(nextTail, worldColiderPos);\r\n                const deltaScalar = r - delta.length();\r\n                if (deltaScalar >= 0) {\r\n                    var normal = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].normalize(delta);\r\n                    var resilienceVec = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].multiply(_math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(worldColiderPos, normal), deltaScalar);\r\n                    nextTail = _math_Vector3__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(nextTail, resilienceVec);\r\n                    return nextTail;\r\n                }\r\n            }\r\n        }\r\n        return nextTail;\r\n    }\r\n    static setBoneGroups(sgs) {\r\n        this.__boneGroups = sgs;\r\n    }\r\n    static addColliderGroup(index, group) {\r\n        this.__colliderGroups.set(index, group);\r\n    }\r\n    static getColliderGroups(indices) {\r\n        const colliderGroups = [];\r\n        for (let index of indices) {\r\n            colliderGroups.push(this.__colliderGroups.get(index));\r\n        }\r\n        return colliderGroups;\r\n    }\r\n}\r\nVRMSpringBonePhysicsStrategy.__tmp_vec3 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nVRMSpringBonePhysicsStrategy.__tmp_vec3_2 = _math_MutableVector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"].zero();\r\nVRMSpringBonePhysicsStrategy.__tmp_quat = _math_MutableQuaternion__WEBPACK_IMPORTED_MODULE_5__[\"default\"].identity();\r\nVRMSpringBonePhysicsStrategy.__boneGroups = [];\r\nVRMSpringBonePhysicsStrategy.__colliderGroups = new Map();\r\n\n\n//# sourceURL=webpack:///./src/foundation/physics/VRMSpringBonePhysicsStrategy.ts?");

/***/ }),

/***/ "./src/foundation/renderer/CGAPIResourceRepository.ts":
/*!************************************************************!*\
  !*** ./src/foundation/renderer/CGAPIResourceRepository.ts ***!
  \************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CGAPIResourceRepository; });\n/* harmony import */ var _system_ModuleManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n\r\nclass CGAPIResourceRepository {\r\n    static getWebGLResourceRepository() {\r\n        const moduleName = 'webgl';\r\n        const moduleManager = _system_ModuleManager__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        const webglModule = moduleManager.getModule(moduleName);\r\n        const webGLResourceRepository = webglModule.WebGLResourceRepository.getInstance();\r\n        return webGLResourceRepository;\r\n    }\r\n}\r\nCGAPIResourceRepository.InvalidCGAPIResourceUid = -1;\r\n\n\n//# sourceURL=webpack:///./src/foundation/renderer/CGAPIResourceRepository.ts?");

/***/ }),

/***/ "./src/foundation/renderer/Expression.ts":
/*!***********************************************!*\
  !*** ./src/foundation/renderer/Expression.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Expression; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n\r\n/**\r\n * Expression specifies the order of render passes on rendering process.\r\n */\r\nclass Expression extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__renderPasses = [];\r\n    }\r\n    /**\r\n     * Add render passes to the end of this expression.\r\n     */\r\n    addRenderPasses(renderPasses) {\r\n        for (let renderPass of renderPasses) {\r\n            this.__renderPasses.push(renderPass);\r\n        }\r\n    }\r\n    /**\r\n     * Clear render passes of this expression.\r\n     */\r\n    clearRenderPasses() {\r\n        this.__renderPasses.length = 0;\r\n    }\r\n    /**\r\n     * Gets the list of render passes of this expression.\r\n     */\r\n    get renderPasses() {\r\n        return this.__renderPasses;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/renderer/Expression.ts?");

/***/ }),

/***/ "./src/foundation/renderer/FrameBuffer.ts":
/*!************************************************!*\
  !*** ./src/foundation/renderer/FrameBuffer.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FrameBuffer; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_RenderBufferTarget__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/RenderBufferTarget */ \"./src/foundation/definitions/RenderBufferTarget.ts\");\n\r\n\r\n\r\nclass FrameBuffer extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__colorAttachments = [];\r\n        this.cgApiResourceUid = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.__colorAttachmentMap = new Map();\r\n    }\r\n    get colorAttachmentsRenderBufferTargets() {\r\n        return Array.from(this.__colorAttachmentMap.keys());\r\n    }\r\n    get colorAttachments() {\r\n        return this.__colorAttachments;\r\n    }\r\n    get depthAttachment() {\r\n        return this.__depthAttachment;\r\n    }\r\n    get stencilAttachment() {\r\n        return this.__stencilAttachment;\r\n    }\r\n    get depthStencilAttachment() {\r\n        return this.__depthStencilAttachment;\r\n    }\r\n    create(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        const webGLResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        this.cgApiResourceUid = webGLResourceRepository.createFrameBufferObject();\r\n        return this.cgApiResourceUid;\r\n    }\r\n    get framebufferUID() {\r\n        return this.cgApiResourceUid;\r\n    }\r\n    setColorAttachmentAt(index, renderable) {\r\n        if (renderable.width !== this.width || renderable.height !== this.height) {\r\n            return false;\r\n        }\r\n        this.__colorAttachments[index] = renderable;\r\n        const webglResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.attachColorBufferToFrameBufferObject(this, index, renderable);\r\n        this.__colorAttachmentMap.set(_definitions_RenderBufferTarget__WEBPACK_IMPORTED_MODULE_2__[\"RenderBufferTarget\"].from(index), renderable);\r\n        return true;\r\n    }\r\n    setDepthAttachment(renderable) {\r\n        if (renderable.width !== this.width || renderable.height !== this.height) {\r\n            return false;\r\n        }\r\n        this.__depthAttachment = renderable;\r\n        const webglResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.attachDepthBufferToFrameBufferObject(this, renderable);\r\n        return true;\r\n    }\r\n    setStencilAttachment(renderable) {\r\n        if (renderable.width !== this.width || renderable.height !== this.height) {\r\n            return false;\r\n        }\r\n        this.__stencilAttachment = renderable;\r\n        const webglResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.attachStencilBufferToFrameBufferObject(this, renderable);\r\n        return true;\r\n    }\r\n    setDepthStencilAttachment(renderable) {\r\n        if (renderable.width !== this.width || renderable.height !== this.height) {\r\n            return false;\r\n        }\r\n        this.__depthStencilAttachment = renderable;\r\n        const webglResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.attachDepthStencilBufferToFrameBufferObject(this, renderable);\r\n        return true;\r\n    }\r\n    resize(width, height) {\r\n        this.destroy3DAPIResources();\r\n        this.create(width, height);\r\n        if (this.depthAttachment) {\r\n            this.depthAttachment.resize(width, height);\r\n            this.setDepthAttachment(this.depthAttachment);\r\n        }\r\n        if (this.depthStencilAttachment) {\r\n            this.depthStencilAttachment.resize(width, height);\r\n            this.setDepthStencilAttachment(this.depthStencilAttachment);\r\n        }\r\n        if (this.stencilAttachment) {\r\n            this.stencilAttachment.resize(width, height);\r\n            this.setStencilAttachment(this.stencilAttachment);\r\n        }\r\n        for (let i = 0; i < this.colorAttachments.length; i++) {\r\n            this.colorAttachments[i].resize(width, height);\r\n            this.setColorAttachmentAt(i, this.colorAttachments[i]);\r\n        }\r\n    }\r\n    destroy3DAPIResources() {\r\n        const webGLResourceRepository = _CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webGLResourceRepository.deleteFrameBufferObject(this.cgApiResourceUid);\r\n        if (this.depthAttachment) {\r\n            this.depthAttachment.destroy3DAPIResources();\r\n        }\r\n        if (this.depthStencilAttachment) {\r\n            this.depthStencilAttachment.destroy3DAPIResources();\r\n        }\r\n        if (this.stencilAttachment) {\r\n            this.stencilAttachment.destroy3DAPIResources();\r\n        }\r\n        for (let colorAttachment of this.colorAttachments) {\r\n            colorAttachment.destroy3DAPIResources();\r\n        }\r\n    }\r\n    whichColorAttachment(renderable) {\r\n        return this.__colorAttachments.indexOf(renderable);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/renderer/FrameBuffer.ts?");

/***/ }),

/***/ "./src/foundation/renderer/RenderPass.ts":
/*!***********************************************!*\
  !*** ./src/foundation/renderer/RenderPass.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return RenderPass; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _system_System__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../system/System */ \"./src/foundation/system/System.ts\");\n/* harmony import */ var _system_ModuleManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n/* harmony import */ var _math_MutableVector4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A render pass is a collection of the resources which is used in rendering process.\r\n */\r\nclass RenderPass extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__entities = [];\r\n        this.__sceneGraphDirectlyAdded = [];\r\n        this.__topLevelSceneGraphComponents = [];\r\n        this.toClearColorBuffer = false;\r\n        this.toClearDepthBuffer = true;\r\n        this.toClearStencilBuffer = false;\r\n        this.clearColor = new _math_Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](1, 1, 1, 1);\r\n        this.clearDepth = 1;\r\n        this.clearStencil = 0;\r\n        this.cullFrontFaceCCW = true;\r\n        this.__primitiveMaterial = new Map();\r\n        this.isMainPass = false;\r\n    }\r\n    setPreRenderFunction(func) {\r\n        this.__preRenderFunc = func;\r\n    }\r\n    unsetPreRenderFunction() {\r\n        this.__preRenderFunc = void 0;\r\n    }\r\n    doPreRender() {\r\n        if (this.__preRenderFunc != null) {\r\n            this.__preRenderFunc();\r\n        }\r\n    }\r\n    /**\r\n     * Add entities to draw.\r\n     * @param entities An array of entities.\r\n     */\r\n    addEntities(entities) {\r\n        for (let entity of entities) {\r\n            const sceneGraphComponent = entity.getSceneGraph();\r\n            this.__sceneGraphDirectlyAdded.push(sceneGraphComponent);\r\n            const collectedSgComponents = _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flattenHierarchy(sceneGraphComponent, false);\r\n            const collectedEntities = collectedSgComponents.map((sg) => { return sg.entity; });\r\n            // Eliminate duplicates\r\n            const map = this.__entities.concat(collectedEntities).reduce((map, entity) => {\r\n                map.set(entity.entityUID, entity);\r\n                return map;\r\n            }, new Map());\r\n            this.__entities = Array.from(map.values());\r\n        }\r\n        this.__meshComponents = void 0;\r\n        this.__topLevelSceneGraphComponents = void 0;\r\n        this.__collectMeshComponents();\r\n        this.__collectTopLevelSceneGraphComponents();\r\n    }\r\n    /**\r\n     * Gets the list of entities on this render pass.\r\n     * @return An array of entities\r\n     */\r\n    get entities() {\r\n        return this.__entities;\r\n    }\r\n    /**\r\n     * Clear entities on this render pass.\r\n     */\r\n    clearEntities() {\r\n        this.__meshComponents = void 0;\r\n        this.__topLevelSceneGraphComponents = void 0;\r\n        this.__entities = [];\r\n    }\r\n    __collectTopLevelSceneGraphComponents() {\r\n        if (this.__topLevelSceneGraphComponents == null) {\r\n            const goToTopLevel = (sg) => {\r\n                if (sg.parent) {\r\n                    goToTopLevel(sg.parent);\r\n                }\r\n                return sg;\r\n            };\r\n            this.__topLevelSceneGraphComponents = this.__sceneGraphDirectlyAdded.map((sg) => {\r\n                return goToTopLevel(sg);\r\n            });\r\n            let set = new Set(this.__topLevelSceneGraphComponents);\r\n            this.__topLevelSceneGraphComponents = Array.from(set);\r\n        }\r\n    }\r\n    __collectMeshComponents() {\r\n        if (this.__meshComponents == null) {\r\n            this.__meshComponents = [];\r\n            this.__entities.filter((entity) => {\r\n                const meshComponent = entity.getMesh();\r\n                if (meshComponent) {\r\n                    this.__meshComponents.push(meshComponent);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Get all the MeshComponents list of the entities on this render pass.\r\n     * @return An array of MeshComponents\r\n     */\r\n    get meshComponents() {\r\n        this.__collectMeshComponents();\r\n        return this.__meshComponents;\r\n    }\r\n    /**\r\n     * Get all the highest level SceneGraphComponents list of the entities on this render pass.\r\n     * @return An array of SceneGraphComponents\r\n     */\r\n    get sceneTopLevelGraphComponents() {\r\n        this.__collectTopLevelSceneGraphComponents();\r\n        return this.__topLevelSceneGraphComponents;\r\n    }\r\n    /**\r\n     * Sets the target framebuffer of this render pass.\r\n     * If two or more render pass share a framebuffer, Rhodonite renders entities in render passes to same framebuffer.\r\n     * @param framebuffer A framebuffer\r\n     */\r\n    setFramebuffer(framebuffer) {\r\n        this.__frameBuffer = framebuffer;\r\n        if (framebuffer != null) {\r\n            this.setViewport(new _math_Vector4__WEBPACK_IMPORTED_MODULE_2__[\"default\"](0, 0, framebuffer.width, framebuffer.height));\r\n        }\r\n        else {\r\n            this.__viewport = undefined;\r\n        }\r\n    }\r\n    /**\r\n     * Gets the framebuffer if this render pass has the target framebuffer.\r\n     * @return A framebuffer\r\n     */\r\n    getFramebuffer() {\r\n        return this.__frameBuffer;\r\n    }\r\n    /**\r\n     * Sets the viewport of this render pass.\r\n     * @param vec A Vector4 (Origin of coordinatesX, origin of coordinatesY, width, height).\r\n     */\r\n    setViewport(vec) {\r\n        if (this.__viewport != null) {\r\n            this.__viewport.copyComponents(vec);\r\n        }\r\n        else {\r\n            this.__viewport = new _math_MutableVector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](vec);\r\n        }\r\n    }\r\n    /**\r\n     * Gets the viewport if this render pass has the viewport.\r\n     * @return A Vector4 (Origin of coordinatesX, origin of coordinatesY, width, height).\r\n     */\r\n    getViewport() {\r\n        let viewport = this.__viewport;\r\n        if (viewport != null) {\r\n            viewport = RenderPass.__tmp_Vector4_0.copyComponents(viewport);\r\n        }\r\n        return viewport;\r\n    }\r\n    __setupMaterial(material, isPointSprite = false) {\r\n        if (material.isEmptyMaterial())\r\n            return;\r\n        if (this.__webglRenderingStrategy == null) {\r\n            this.__setWebglRenderingStrategy();\r\n        }\r\n        this.__webglRenderingStrategy.setupDefaultShaderSemantics(material, isPointSprite);\r\n    }\r\n    /**\r\n     * Sets a material for the primitive on this render pass.\r\n     * If Rhodonite draw the primitive using this render pass, Rhodonite uses this material instead of the material on the primitive.\r\n     * @param material A material attaching to the primitive\r\n     * @param primitive A target primitive\r\n     * @param isPointSprite Set true, if the primitive is a point sprite\r\n     */\r\n    setMaterialForPrimitive(material, primitive, isPointSprite = false) {\r\n        this.__primitiveMaterial.set(primitive, material);\r\n        this.__setupMaterial(material, isPointSprite);\r\n    }\r\n    /**\r\n     * Sets a material for all the primitive on this render pass.\r\n     * For all the primitive, Rhodonite uses this material instead of the material on the primitive.\r\n     * Where if this render pass has a map between primitive and material by setMaterialForPrimitive, Rhodonite uses the material mapped by primitive.\r\n     * @param material A material attaching to the primitive\r\n     * @param isPointSprite Set true, if the primitive is a point sprite\r\n     */\r\n    setMaterial(material, isPointSprite = false) {\r\n        this.__material = material;\r\n        this.__setupMaterial(material, isPointSprite);\r\n    }\r\n    get material() {\r\n        return this.__material;\r\n    }\r\n    __setWebglRenderingStrategy() {\r\n        const system = _system_System__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\r\n        const processApproach = system.processApproach;\r\n        const moduleManager = _system_ModuleManager__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance();\r\n        const moduleName = 'webgl';\r\n        const webglModule = moduleManager.getModule(moduleName);\r\n        this.__webglRenderingStrategy = webglModule.getRenderingStrategy(processApproach);\r\n    }\r\n    __getMaterialOf(primitive) {\r\n        return this.__primitiveMaterial.get(primitive);\r\n    }\r\n    __hasMaterialOf(primitive) {\r\n        return this.__primitiveMaterial.has(primitive);\r\n    }\r\n    getAppropriateMaterial(primitive, defaultMaterial) {\r\n        let material;\r\n        if (this.__hasMaterialOf(primitive)) {\r\n            material = this.__getMaterialOf(primitive);\r\n        }\r\n        else if (this.material != null) {\r\n            material = this.material;\r\n        }\r\n        else {\r\n            material = defaultMaterial;\r\n        }\r\n        return material;\r\n    }\r\n}\r\nRenderPass.__tmp_Vector4_0 = _math_MutableVector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"].zero();\r\n\n\n//# sourceURL=webpack:///./src/foundation/renderer/RenderPass.ts?");

/***/ }),

/***/ "./src/foundation/system/ModuleManager.ts":
/*!************************************************!*\
  !*** ./src/foundation/system/ModuleManager.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ModuleManager; });\nclass ModuleManager {\r\n    constructor() {\r\n        this.__modules = new Map();\r\n    }\r\n    async loadModule(moduleName) {\r\n        let module;\r\n        if (moduleName.toLowerCase() === 'webgl') {\r\n            module = await Promise.resolve(/*! import() | webgl */).then(__webpack_require__.bind(null, /*! ../../webgl/main */ \"./src/webgl/main.ts\"));\r\n        }\r\n        else if (moduleName.toLowerCase() === 'effekseer') {\r\n            module = await Promise.resolve(/*! import() | effekseer */).then(__webpack_require__.bind(null, /*! ../../effekseer/main */ \"./src/effekseer/main.ts\"));\r\n        }\r\n        else if (moduleName.toLowerCase() === 'sparkgear') {\r\n            module = await Promise.resolve(/*! import() | sparkgear */).then(__webpack_require__.bind(null, /*! ../../sparkgear/main */ \"./src/sparkgear/main.ts\"));\r\n        }\r\n        else if (moduleName.toLowerCase() === 'pbr') {\r\n            module = await Promise.resolve(/*! import() | pbr */).then(__webpack_require__.bind(null, /*! ../../pbr/main */ \"./src/pbr/main.ts\"));\r\n        }\r\n        else if (moduleName.toLowerCase() === 'xr') {\r\n            module = await Promise.resolve(/*! import() | xr */).then(__webpack_require__.bind(null, /*! ../../rhodonite-xr */ \"./src/rhodonite-xr.ts\"));\r\n        }\r\n        this.__modules.set(moduleName, module);\r\n        console.log('Module Loaded:', module);\r\n        return module === null || module === void 0 ? void 0 : module.default;\r\n    }\r\n    getModule(moduleName) {\r\n        var _a;\r\n        return (_a = this.__modules.get(moduleName)) === null || _a === void 0 ? void 0 : _a.default;\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new ModuleManager();\r\n        }\r\n        return this.__instance;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/system/ModuleManager.ts?");

/***/ }),

/***/ "./src/foundation/system/System.ts":
/*!*****************************************!*\
  !*** ./src/foundation/system/System.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return System; });\n/* harmony import */ var _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _ModuleManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_Component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _renderer_Expression__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../renderer/Expression */ \"./src/foundation/renderer/Expression.ts\");\n/* harmony import */ var _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _core_EntityRepository__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _core_MemoryManager__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _components_TransformComponent__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _math_Vector3__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../definitions/CameraType */ \"./src/foundation/definitions/CameraType.ts\");\n/* harmony import */ var _misc_Time__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../misc/Time */ \"./src/foundation/misc/Time.ts\");\n/* harmony import */ var _SystemState__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SystemState */ \"./src/foundation/system/SystemState.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass System {\r\n    constructor() {\r\n        this.__componentRepository = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n        this.__entityRepository = _core_EntityRepository__WEBPACK_IMPORTED_MODULE_8__[\"default\"].getInstance();\r\n        this.__processApproach = _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].None;\r\n        this.__webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        this.__localExpression = new _renderer_Expression__WEBPACK_IMPORTED_MODULE_6__[\"default\"]();\r\n        this.__lastEntitiesNumber = -1;\r\n        this.__renderPassTickCount = 0;\r\n        this.__animationFrameId = -1;\r\n        this.__rnXRModule = _ModuleManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().getModule('xr');\r\n    }\r\n    doRenderLoop(renderLoopFunc, time, ...args) {\r\n        const animationFrameObject = this.__getAnimationFrameObject();\r\n        this.__animationFrameId = animationFrameObject.requestAnimationFrame((_time) => {\r\n            var _a, _b;\r\n            const webVRSystem = this.__rnXRModule.WebVRSystem.getInstance();\r\n            if ((webVRSystem === null || webVRSystem === void 0 ? void 0 : webVRSystem.isWebVRMode) && ((_a = webVRSystem.vrDisplay) === null || _a === void 0 ? void 0 : _a.isPresenting)) {\r\n                webVRSystem.getFrameData();\r\n            }\r\n            args.splice(0, 0, time);\r\n            renderLoopFunc.apply(renderLoopFunc, args);\r\n            if ((webVRSystem === null || webVRSystem === void 0 ? void 0 : webVRSystem.isWebVRMode) && ((_b = webVRSystem.vrDisplay) === null || _b === void 0 ? void 0 : _b.isPresenting)) {\r\n                webVRSystem.vrDisplay.submitFrame();\r\n            }\r\n            if (webVRSystem === null || webVRSystem === void 0 ? void 0 : webVRSystem.requestedToEnterWebVR) {\r\n                webVRSystem._setIsWebVRMode();\r\n            }\r\n            this.doRenderLoop(renderLoopFunc, _time, args);\r\n        });\r\n    }\r\n    __getAnimationFrameObject() {\r\n        let animationFrameObject = window;\r\n        const webVRSystem = this.__rnXRModule.WebVRSystem.getInstance();\r\n        if (webVRSystem === null || webVRSystem === void 0 ? void 0 : webVRSystem.isWebVRMode) {\r\n            animationFrameObject = webVRSystem.vrDisplay;\r\n        }\r\n        return animationFrameObject;\r\n    }\r\n    stopRenderLoop() {\r\n        const animationFrameObject = this.__getAnimationFrameObject();\r\n        animationFrameObject.cancelAnimationFrame(this.__animationFrameId);\r\n        this.__animationFrameId = -1;\r\n    }\r\n    process(expressions) {\r\n        if (this.__processApproach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].None) {\r\n            throw new Error('Choose a process approach first.');\r\n        }\r\n        _misc_Time__WEBPACK_IMPORTED_MODULE_16__[\"default\"]._processBegin();\r\n        if (_components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"].main === _core_Component__WEBPACK_IMPORTED_MODULE_5__[\"default\"].InvalidObjectUID) {\r\n            const cameraEntity = this.__entityRepository.createEntity([_components_TransformComponent__WEBPACK_IMPORTED_MODULE_12__[\"default\"], _components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_13__[\"default\"], _components_CameraComponent__WEBPACK_IMPORTED_MODULE_9__[\"default\"]]);\r\n            cameraEntity.getTransform().translate = new _math_Vector3__WEBPACK_IMPORTED_MODULE_14__[\"default\"](0, 0, 1);\r\n            cameraEntity.getCamera().type = _definitions_CameraType__WEBPACK_IMPORTED_MODULE_15__[\"CameraType\"].Orthographic;\r\n            cameraEntity.getCamera().zNear = 0.1;\r\n            cameraEntity.getCamera().zFar = 10000;\r\n            const wgl = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n            cameraEntity.getCamera().xMag = wgl.width / wgl.height;\r\n            cameraEntity.getCamera().yMag = 1;\r\n        }\r\n        for (let stage of _core_Component__WEBPACK_IMPORTED_MODULE_5__[\"default\"]._processStages) {\r\n            const methodName = stage.methodName;\r\n            const commonMethodName = 'common_' + methodName;\r\n            const componentTids = this.__componentRepository.getComponentTIDs();\r\n            for (let componentTid of componentTids) {\r\n                if (stage === _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_0__[\"ProcessStage\"].Render) {\r\n                    for (let exp of expressions) {\r\n                        let loopN = 1;\r\n                        if (componentTid === _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"].componentTID) {\r\n                            loopN = exp.renderPasses.length;\r\n                        }\r\n                        for (let i = 0; i < loopN; i++) {\r\n                            const renderPass = exp.renderPasses[i];\r\n                            renderPass.doPreRender();\r\n                            if (componentTid === _components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"].componentTID && (stage == _definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_0__[\"ProcessStage\"].Render)) {\r\n                                this.__webglResourceRepository.bindFramebuffer(renderPass.getFramebuffer());\r\n                                this.__webglResourceRepository.setViewport(renderPass.getViewport());\r\n                                this.__webglResourceRepository.setDrawTargets(renderPass.getFramebuffer());\r\n                                this.__webglResourceRepository.clearFrameBuffer(renderPass);\r\n                            }\r\n                            const componentClass = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getComponentClass(componentTid);\r\n                            componentClass.updateComponentsOfEachProcessStage(componentClass, stage, this.__componentRepository, renderPass);\r\n                            const componentClass_commonMethod = componentClass[commonMethodName];\r\n                            if (componentClass_commonMethod) {\r\n                                componentClass_commonMethod({ processApproach: this.__processApproach, renderPass: renderPass, processStage: stage, renderPassTickCount: this.__renderPassTickCount });\r\n                            }\r\n                            componentClass.process({\r\n                                componentType: componentClass,\r\n                                processStage: stage,\r\n                                processApproach: this.__processApproach,\r\n                                componentRepository: this.__componentRepository,\r\n                                strategy: this.__webglStrategy,\r\n                                renderPass: renderPass,\r\n                                renderPassTickCount: this.__renderPassTickCount\r\n                            });\r\n                            this.__renderPassTickCount++;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const componentClass = _core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getComponentClass(componentTid);\r\n                    componentClass.updateComponentsOfEachProcessStage(componentClass, stage, this.__componentRepository);\r\n                    const componentClass_commonMethod = componentClass[commonMethodName];\r\n                    if (componentClass_commonMethod) {\r\n                        componentClass_commonMethod({ processApproach: this.__processApproach, renderPass: void 0, processStage: stage, renderPassTickCount: this.__renderPassTickCount });\r\n                    }\r\n                    componentClass.process({\r\n                        componentType: componentClass,\r\n                        processStage: stage,\r\n                        processApproach: this.__processApproach,\r\n                        componentRepository: this.__componentRepository,\r\n                        strategy: this.__webglStrategy,\r\n                        renderPass: void 0,\r\n                        renderPassTickCount: this.__renderPassTickCount\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        _misc_Time__WEBPACK_IMPORTED_MODULE_16__[\"default\"]._processEnd();\r\n    }\r\n    setProcessApproachAndCanvas(approach, canvas, memoryUsageOrder = 1, webglOption = {}, rnWebGLDebug = true) {\r\n        const moduleManager = _ModuleManager__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\r\n        const moduleName = 'webgl';\r\n        const webglModule = moduleManager.getModule(moduleName);\r\n        this.__webglStrategy = webglModule.getRenderingStrategy(approach);\r\n        const repo = webglModule.WebGLResourceRepository.getInstance();\r\n        let gl;\r\n        if (approach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].DataTextureWebGL2 ||\r\n            approach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].UBOWebGL2 ||\r\n            approach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].TransformFeedbackWebGL2 ||\r\n            approach === _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_2__[\"ProcessApproach\"].UniformWebGL2) {\r\n            gl = canvas.getContext('webgl2', webglOption);\r\n        }\r\n        else {\r\n            gl = canvas.getContext('webgl', webglOption) ||\r\n                canvas.getContext('experimental-webgl', webglOption);\r\n        }\r\n        gl.enable(gl.DEPTH_TEST);\r\n        _core_MemoryManager__WEBPACK_IMPORTED_MODULE_10__[\"default\"].createInstanceIfNotCreated(0.125 * memoryUsageOrder, 0.0625 * memoryUsageOrder, 0.9375 * memoryUsageOrder);\r\n        const globalDataRepository = _core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getInstance();\r\n        globalDataRepository.initialize();\r\n        repo.addWebGLContext(gl, canvas, true, rnWebGLDebug);\r\n        this.__processApproach = approach;\r\n        _SystemState__WEBPACK_IMPORTED_MODULE_17__[\"default\"].currentProcessApproach = approach;\r\n        return gl;\r\n    }\r\n    get processApproach() {\r\n        return this.__processApproach;\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new System();\r\n        }\r\n        return this.__instance;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/system/System.ts?");

/***/ }),

/***/ "./src/foundation/system/SystemState.ts":
/*!**********************************************!*\
  !*** ./src/foundation/system/SystemState.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n\r\nlet currentProcessApproach = _definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__[\"ProcessApproach\"].None;\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    currentProcessApproach\r\n});\r\n\n\n//# sourceURL=webpack:///./src/foundation/system/SystemState.ts?");

/***/ }),

/***/ "./src/foundation/textures/AbstractTexture.ts":
/*!****************************************************!*\
  !*** ./src/foundation/textures/AbstractTexture.ts ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AbstractTexture; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _TextureDataFloat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TextureDataFloat */ \"./src/foundation/textures/TextureDataFloat.ts\");\n\r\n\r\n\r\n\r\n\r\nclass AbstractTexture extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__width = 0;\r\n        this.__height = 0;\r\n        this.__level = 0;\r\n        this.__internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_1__[\"PixelFormat\"].RGBA;\r\n        this.__format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_1__[\"PixelFormat\"].RGBA;\r\n        this.__type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_2__[\"ComponentType\"].UnsignedByte;\r\n        this.__magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].Linear;\r\n        this.__minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].Linear;\r\n        this.__wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].ClampToEdge;\r\n        this.__wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].ClampToEdge;\r\n        this.__hasTransparentPixels = false;\r\n        this.cgApiResourceUid = -1;\r\n        this.__isTextureReady = false;\r\n        this.__startedToLoad = false;\r\n        this.__name = 'untitled';\r\n        this.__textureUid = ++AbstractTexture.__textureUidCount;\r\n    }\r\n    get textureUID() {\r\n        return this.__textureUid;\r\n    }\r\n    get width() {\r\n        return this.__width;\r\n    }\r\n    get height() {\r\n        return this.__height;\r\n    }\r\n    get isTextureReady() {\r\n        return this.__isTextureReady;\r\n    }\r\n    get startedToLoad() {\r\n        return this.__startedToLoad;\r\n    }\r\n    /**\r\n     * get a value nearest power of two.\r\n     *\r\n     * @param x texture size.\r\n     * @returns a value nearest power of two.\r\n     */\r\n    __getNearestPowerOfTwo(x) {\r\n        return Math.pow(2, Math.round(Math.log(x) / Math.LN2));\r\n    }\r\n    get htmlImageElement() {\r\n        return this.__htmlImageElement;\r\n    }\r\n    get htmlCanvasElement() {\r\n        if (this.__htmlCanvasElement == null) {\r\n            var canvas = document.createElement(\"canvas\");\r\n            var ctx = canvas.getContext(\"2d\");\r\n            ctx.drawImage(this.__htmlImageElement, 0, 0, this.__htmlImageElement.width, this.__htmlImageElement.height);\r\n            this.__htmlCanvasElement = canvas;\r\n        }\r\n        return this.__htmlCanvasElement;\r\n    }\r\n    get uri() {\r\n        return this.__uri;\r\n    }\r\n    static getRhodoniteTexture(textureUid) {\r\n        return this.__textureMap.get(textureUid);\r\n    }\r\n    set name(name) {\r\n        this.__name = name;\r\n    }\r\n    get name() {\r\n        return this.__name;\r\n    }\r\n    getImageData(x, y, width, height) {\r\n        return this.__canvasContext.getImageData(x, y, width, height);\r\n    }\r\n    get isTransparent() {\r\n        return this.__hasTransparentPixels;\r\n    }\r\n    createInternalCanvasContext() {\r\n        let canvas;\r\n        if (this.__htmlCanvasElement != null) {\r\n            canvas = this.__htmlCanvasElement;\r\n        }\r\n        else {\r\n            canvas = document.createElement(\"canvas\");\r\n            canvas.width = this.width;\r\n            canvas.height = this.height;\r\n        }\r\n        this.__htmlCanvasElement = canvas;\r\n        this.__canvasContext = canvas.getContext(\"2d\");\r\n    }\r\n    getTextureDataFloat(channels) {\r\n        const pixel = this.getImageData(0, 0, this.width, this.height);\r\n        const textureDataFloat = new _TextureDataFloat__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this.width, this.height, channels);\r\n        const data = pixel.data;\r\n        for (let i = 0; i < this.height; i++) {\r\n            for (let j = 0; j < this.width; j++) {\r\n                for (let k = 0; k < channels; k++) {\r\n                    textureDataFloat.setPixelAtChannel(j, i, k, data[(i * this.width * 4) + (j * 4) + k] / 255);\r\n                }\r\n            }\r\n        }\r\n        return textureDataFloat;\r\n    }\r\n}\r\nAbstractTexture.InvalidTextureUid = -1;\r\nAbstractTexture.__textureUidCount = AbstractTexture.InvalidTextureUid;\r\nAbstractTexture.__textureMap = new Map();\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/AbstractTexture.ts?");

/***/ }),

/***/ "./src/foundation/textures/CubeTexture.ts":
/*!************************************************!*\
  !*** ./src/foundation/textures/CubeTexture.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CubeTexture; });\n/* harmony import */ var _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractTexture */ \"./src/foundation/textures/AbstractTexture.ts\");\n/* harmony import */ var _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/HdriFormat */ \"./src/foundation/definitions/HdriFormat.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n\r\n\r\n\r\n\r\nclass CubeTexture extends _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.mipmapLevelNumber = 1;\r\n        this.hdriFormat = _definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_1__[\"HdriFormat\"].LDR_SRGB;\r\n        this.isNamePosNeg = false;\r\n    }\r\n    async loadTextureImages() {\r\n        this.__startedToLoad = true;\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n        this.cgApiResourceUid = await webGLResourceRepository.createCubeTextureFromFiles(this.baseUriToLoad, this.mipmapLevelNumber, this.isNamePosNeg, this.hdriFormat);\r\n        this.__isTextureReady = true;\r\n    }\r\n    loadTextureImagesAsync() {\r\n        this.__startedToLoad = true;\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n        webGLResourceRepository.createCubeTextureFromFiles(this.baseUriToLoad, this.mipmapLevelNumber, this.isNamePosNeg, this.hdriFormat).then((cubeTextureUid) => {\r\n            this.cgApiResourceUid = cubeTextureUid;\r\n        }).then(() => {\r\n            this.__isTextureReady = true;\r\n        });\r\n    }\r\n    loadTextureImagesFromBasis(uint8Array, { magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].LinearMipmapLinear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].Repeat, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_3__[\"TextureParameter\"].Repeat, } = {}) {\r\n        this.__startedToLoad = true;\r\n        if (typeof BASIS === 'undefined') {\r\n            console.error('Failed to call BASIS() function. Please check to import basis_transcoder.js.');\r\n        }\r\n        BASIS().then((basisTransCoder) => {\r\n            const { initializeBasis } = basisTransCoder;\r\n            initializeBasis();\r\n            const BasisFile = basisTransCoder.BasisFile;\r\n            const basisFile = new BasisFile(uint8Array);\r\n            if (!basisFile.startTranscoding()) {\r\n                console.error(\"failed to start transcoding.\");\r\n                basisFile.close();\r\n                basisFile.delete();\r\n                return;\r\n            }\r\n            const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n            const texture = webGLResourceRepository.createCubeTextureFromBasis(basisFile, {\r\n                magFilter: magFilter, minFilter: minFilter,\r\n                wrapS: wrapS, wrapT: wrapT\r\n            });\r\n            this.cgApiResourceUid = texture;\r\n            this.__isTextureReady = true;\r\n            basisFile.close();\r\n            basisFile.delete();\r\n        });\r\n    }\r\n    load1x1Texture(rgbaStr = 'rgba(0,0,0,1)') {\r\n        var canvas = document.createElement(\"canvas\");\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.fillStyle = rgbaStr;\r\n        ctx.fillRect(0, 0, 1, 1);\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n        this.cgApiResourceUid = webGLResourceRepository.createCubeTexture(1, [{ posX: canvas, negX: canvas, posY: canvas, negY: canvas, posZ: canvas, negZ: canvas }], 1, 1);\r\n        this.__isTextureReady = true;\r\n    }\r\n    importWebGLTextureDirectly(webGLTexture, width = 0, height = 0) {\r\n        this.__width = width;\r\n        this.__height = height;\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getWebGLResourceRepository();\r\n        const texture = webGLResourceRepository.setWebGLTextureDirectly(webGLTexture);\r\n        this.cgApiResourceUid = texture;\r\n        this.__startedToLoad = true;\r\n        this.__isTextureReady = true;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__textureMap.set(texture, this);\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/CubeTexture.ts?");

/***/ }),

/***/ "./src/foundation/textures/RenderBuffer.ts":
/*!*************************************************!*\
  !*** ./src/foundation/textures/RenderBuffer.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return RenderBuffer; });\n/* harmony import */ var _core_RnObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n\r\n\r\n\r\nclass RenderBuffer extends _core_RnObject__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.__internalFormat = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Depth24;\r\n        this.cgApiResourceUid = -1;\r\n    }\r\n    set _fbo(fbo) {\r\n        this.__fbo = fbo;\r\n    }\r\n    get fbo() {\r\n        return this.__fbo;\r\n    }\r\n    create(width, height, internalFormat) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.__internalFormat = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Depth24;\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        this.cgApiResourceUid = webglResourceRepository.createRenderBuffer(width, height, internalFormat);\r\n    }\r\n    resize(width, height) {\r\n        this.destroy3DAPIResources();\r\n        this.create(width, height, this.__internalFormat);\r\n    }\r\n    destroy3DAPIResources() {\r\n        const webglResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.deleteRenderBuffer(this.cgApiResourceUid);\r\n        return true;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/RenderBuffer.ts?");

/***/ }),

/***/ "./src/foundation/textures/RenderTargetTexture.ts":
/*!********************************************************!*\
  !*** ./src/foundation/textures/RenderTargetTexture.ts ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return RenderTargetTexture; });\n/* harmony import */ var _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractTexture */ \"./src/foundation/textures/AbstractTexture.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _math_Vector4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass RenderTargetTexture extends _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n    }\r\n    create({ width, height, level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].UnsignedByte, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_1__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_1__[\"TextureParameter\"].Linear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_1__[\"TextureParameter\"].ClampToEdge, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_1__[\"TextureParameter\"].ClampToEdge }) {\r\n        this.__width = width;\r\n        this.__height = height;\r\n        this.__level = level;\r\n        this.__internalFormat = internalFormat;\r\n        this.__format = format;\r\n        this.__type = type;\r\n        this.__magFilter = magFilter;\r\n        this.__minFilter = minFilter;\r\n        this.__wrapS = wrapS;\r\n        this.__wrapT = wrapT;\r\n        this.__createRenderTargetTexture();\r\n    }\r\n    set _fbo(fbo) {\r\n        this.__fbo = fbo;\r\n    }\r\n    get fbo() {\r\n        return this.__fbo;\r\n    }\r\n    __createRenderTargetTexture() {\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const texture = webGLResourceRepository.createRenderTargetTexture({\r\n            width: this.__width,\r\n            height: this.__height,\r\n            level: this.__level,\r\n            internalFormat: this.__internalFormat,\r\n            format: this.__format,\r\n            type: this.__type,\r\n            magFilter: this.__magFilter,\r\n            minFilter: this.__minFilter,\r\n            wrapS: this.__wrapS,\r\n            wrapT: this.__wrapT\r\n        });\r\n        this.cgApiResourceUid = texture;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__textureMap.set(texture, this);\r\n    }\r\n    resize(width, height) {\r\n        this.destroy3DAPIResources();\r\n        this.__width = width;\r\n        this.__height = height;\r\n        this.__createRenderTargetTexture();\r\n    }\r\n    destroy3DAPIResources() {\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_0__[\"default\"].__textureMap.delete(this.cgApiResourceUid);\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        webGLResourceRepository.deleteTexture(this.cgApiResourceUid);\r\n        return true;\r\n    }\r\n    getTexturePixelData() {\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const glw = webGLResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        // Create a framebuffer backed by the texture\r\n        const fbo = webGLResourceRepository.getWebGLResource(this.__fbo.framebufferUID);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n        // const texture = webGLResourceRepository.getWebGLResource(this.cgApiResourceUid!) as WebGLTexture;\r\n        // gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n        // Read the contents of the framebuffer (data stores the pixel data)\r\n        let data = new Uint8Array(this.width * this.height * 4);\r\n        if (gl.readBuffer != null) {\r\n            gl.readBuffer(this.__fbo.whichColorAttachment(this));\r\n        }\r\n        gl.readPixels(0, 0, this.width, this.height, gl.RGBA, gl.UNSIGNED_BYTE, data);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        return data;\r\n    }\r\n    /**\r\n     * Origin is left bottom\r\n     *\r\n     * @param x horizontal pixel position (0 is left)\r\n     * @param y vertical pixel position (0 is bottom)\r\n     * @param argByteArray Pixel Data as Uint8Array\r\n     * @returns Pixel Value in Vector4\r\n     */\r\n    getPixelValueAt(x, y, argByteArray) {\r\n        let byteArray = argByteArray;\r\n        if (!byteArray) {\r\n            byteArray = this.getTexturePixelData();\r\n        }\r\n        let color = new _math_Vector4__WEBPACK_IMPORTED_MODULE_5__[\"default\"](byteArray[(y * this.width + x) * 4 + 0], byteArray[(y * this.width + x) * 4 + 1], byteArray[(y * this.width + x) * 4 + 2], byteArray[(y * this.width + x) * 4 + 3]);\r\n        return color;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/RenderTargetTexture.ts?");

/***/ }),

/***/ "./src/foundation/textures/Texture.ts":
/*!********************************************!*\
  !*** ./src/foundation/textures/Texture.ts ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Texture; });\n/* harmony import */ var _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AbstractTexture */ \"./src/foundation/textures/AbstractTexture.ts\");\n/* harmony import */ var _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _core_Config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../core/Config */ \"./src/foundation/core/Config.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass Texture extends _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.autoResize = true;\r\n        this.autoDetectTransparency = false;\r\n    }\r\n    __getResizedCanvas(image, maxSize) {\r\n        var canvas = document.createElement(\"canvas\");\r\n        const potWidth = this.__getNearestPowerOfTwo(image.width);\r\n        const potHeight = this.__getNearestPowerOfTwo(image.height);\r\n        const aspect = potHeight / potWidth;\r\n        let dstWidth = 0;\r\n        let dstHeight = 0;\r\n        if (potWidth > potHeight) {\r\n            dstWidth = Math.min(potWidth, maxSize);\r\n            dstHeight = dstWidth * aspect;\r\n        }\r\n        else {\r\n            dstHeight = Math.min(potHeight, maxSize);\r\n            dstWidth = dstHeight / aspect;\r\n        }\r\n        canvas.width = dstWidth;\r\n        canvas.height = dstHeight;\r\n        var ctx = canvas.getContext(\"2d\");\r\n        ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, dstWidth, dstHeight);\r\n        if (this.autoDetectTransparency) {\r\n            this.__imageData = ctx.getImageData(0, 0, dstWidth, dstHeight);\r\n            for (let y = 0; y < dstHeight; y++) {\r\n                for (let x = 0; x < dstWidth; x++) {\r\n                    const alpha = this.__imageData.data[(x + y * dstWidth) * 4 + 3];\r\n                    if (alpha < 1) {\r\n                        this.__hasTransparentPixels = true;\r\n                        return canvas;\r\n                    }\r\n                }\r\n            }\r\n            this.__hasTransparentPixels = false;\r\n        }\r\n        return canvas;\r\n    }\r\n    generateTextureFromBasis(uint8Array, options) {\r\n        var _a;\r\n        this.__startedToLoad = true;\r\n        if (typeof BASIS === 'undefined') {\r\n            console.error('Failed to call BASIS() function. Please check to import basis_transcoder.js.');\r\n        }\r\n        // download basis_transcoder.wasm once\r\n        if (!Texture.__loadedBasisFunc) {\r\n            Texture.__loadedBasisFunc = true;\r\n            Texture.__basisLoadPromise = new Promise((resolve) => {\r\n                BASIS().then((basisTransCoder) => {\r\n                    const { initializeBasis } = basisTransCoder;\r\n                    initializeBasis();\r\n                    Texture.__BasisFile = basisTransCoder.BasisFile;\r\n                    this.__setBasisTexture(uint8Array, options);\r\n                    resolve();\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            // already download basis_transcoder.wasm or not\r\n            if (Texture.__BasisFile) {\r\n                this.__setBasisTexture(uint8Array, options);\r\n            }\r\n            else {\r\n                (_a = Texture.__basisLoadPromise) === null || _a === void 0 ? void 0 : _a.then(() => {\r\n                    this.__setBasisTexture(uint8Array, options);\r\n                });\r\n            }\r\n        }\r\n    }\r\n    __setBasisTexture(uint8Array, { level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].UnsignedByte, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].LinearMipmapLinear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, generateMipmap = true, anisotropy = true, isPremultipliedAlpha = false } = {}) {\r\n        this.__startedToLoad = true;\r\n        const basisFile = new Texture.__BasisFile(uint8Array);\r\n        const width = basisFile.getImageWidth(0, 0);\r\n        const height = basisFile.getImageHeight(0, 0);\r\n        if (!basisFile.startTranscoding()) {\r\n            console.error(\"failed to start transcoding.\");\r\n            basisFile.close();\r\n            basisFile.delete();\r\n            return;\r\n        }\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const texture = webGLResourceRepository.createCompressedTextureFromBasis(basisFile, {\r\n            border: 0, format, type, magFilter, minFilter, wrapS, wrapT, anisotropy, isPremultipliedAlpha\r\n        });\r\n        this.cgApiResourceUid = texture;\r\n        this.__isTextureReady = true;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"].__textureMap.set(texture, this);\r\n        basisFile.close();\r\n        basisFile.delete();\r\n    }\r\n    generateTextureFromImage(image, { level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].UnsignedByte, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, generateMipmap = true, anisotropy = true, isPremultipliedAlpha = false } = {}) {\r\n        this.__startedToLoad = true;\r\n        this.__htmlImageElement = image;\r\n        let img;\r\n        if (this.autoResize || this.autoDetectTransparency) {\r\n            img = this.__getResizedCanvas(image, _core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxSizeLimitOfNonCompressedTexture);\r\n            this.__htmlCanvasElement = img;\r\n        }\r\n        else {\r\n            img = image;\r\n        }\r\n        this.__width = img.width;\r\n        this.__height = img.height;\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        let texture = webGLResourceRepository.createTexture(img, {\r\n            level, internalFormat,\r\n            width: this.__width, height: this.__height, border: 0,\r\n            format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha\r\n        });\r\n        this.cgApiResourceUid = texture;\r\n        this.__isTextureReady = true;\r\n        this.__uri = image.src;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"].__textureMap.set(texture, this);\r\n    }\r\n    generateTextureFromUri(imageUri, { level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].UnsignedByte, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, generateMipmap = true, anisotropy = true, isPremultipliedAlpha = false } = {}) {\r\n        this.__uri = imageUri;\r\n        this.__startedToLoad = true;\r\n        return new Promise((resolve, reject) => {\r\n            this.__img = new Image();\r\n            if (!imageUri.match(/^data:/)) {\r\n                this.__img.crossOrigin = 'Anonymous';\r\n            }\r\n            this.__img.onload = () => {\r\n                this.__htmlImageElement = this.__img;\r\n                let img;\r\n                if (this.autoResize || this.autoDetectTransparency) {\r\n                    img = this.__getResizedCanvas(this.__img, _core_Config__WEBPACK_IMPORTED_MODULE_5__[\"default\"].maxSizeLimitOfNonCompressedTexture);\r\n                    this.__htmlCanvasElement = img;\r\n                }\r\n                else {\r\n                    img = this.__img;\r\n                }\r\n                this.__width = img.width;\r\n                this.__height = img.height;\r\n                const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n                let texture = webGLResourceRepository.createTexture(img, {\r\n                    level, internalFormat,\r\n                    width: this.__width, height: this.__height, border: 0,\r\n                    format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha\r\n                });\r\n                this.cgApiResourceUid = texture;\r\n                this.__isTextureReady = true;\r\n                _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"].__textureMap.set(texture, this);\r\n                resolve();\r\n            };\r\n            this.__img.src = imageUri;\r\n        });\r\n    }\r\n    generate1x1TextureFrom(rgbaStr = \"rgba(255,255,255,1)\") {\r\n        var canvas = document.createElement(\"canvas\");\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.fillStyle = rgbaStr;\r\n        ctx.fillRect(0, 0, 1, 1);\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const texture = webGLResourceRepository.createTexture(canvas, {\r\n            level: 0, internalFormat: _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, width: 1, height: 1,\r\n            border: 0, format: _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, type: _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].UnsignedByte, magFilter: _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest, minFilter: _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest,\r\n            wrapS: _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, wrapT: _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: true\r\n        });\r\n        this.cgApiResourceUid = texture;\r\n        this.__isTextureReady = true;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"].__textureMap.set(texture, this);\r\n    }\r\n    generateTextureFromTypedArray(typedArray, { level = 0, internalFormat = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, format = _definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_0__[\"PixelFormat\"].RGBA, magFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].LinearMipmapLinear, wrapS = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, wrapT = _definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, generateMipmap = true, anisotropy = true, isPremultipliedAlpha = false } = {}) {\r\n        const type = _definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].fromTypedArray(typedArray);\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        let texture = webGLResourceRepository.createTexture(typedArray, {\r\n            level, internalFormat,\r\n            width: this.__width, height: this.__height, border: 0,\r\n            format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha\r\n        });\r\n        this.cgApiResourceUid = texture;\r\n        this.__isTextureReady = true;\r\n    }\r\n    importWebGLTextureDirectly(webGLTexture, width = 0, height = 0) {\r\n        this.__width = width;\r\n        this.__height = height;\r\n        const webGLResourceRepository = _renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getWebGLResourceRepository();\r\n        const texture = webGLResourceRepository.setWebGLTextureDirectly(webGLTexture);\r\n        this.cgApiResourceUid = texture;\r\n        this.__startedToLoad = true;\r\n        this.__isTextureReady = true;\r\n        _AbstractTexture__WEBPACK_IMPORTED_MODULE_3__[\"default\"].__textureMap.set(texture, this);\r\n    }\r\n}\r\nTexture.__loadedBasisFunc = false;\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/Texture.ts?");

/***/ }),

/***/ "./src/foundation/textures/TextureDataFloat.ts":
/*!*****************************************************!*\
  !*** ./src/foundation/textures/TextureDataFloat.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TextureDataFloat; });\nclass TextureDataFloat {\r\n    constructor(width, height, channels) {\r\n        this.__channels = channels;\r\n        this.__width = width;\r\n        this.__height = height;\r\n        this.__data = new Float32Array(width * height * channels);\r\n    }\r\n    resize(width, height, channels) {\r\n        this.__width = width;\r\n        this.__height = height;\r\n        this.__channels = channels;\r\n        this.__data = new Float32Array(TextureDataFloat.transfer(this.__data.buffer, width * height * channels * 4));\r\n    }\r\n    setPixelAtChannel(x, y, channelIdx, value) {\r\n        this.__data[y * this.__width * this.__channels + x * this.__channels + channelIdx] = value;\r\n    }\r\n    get width() {\r\n        return this.__width;\r\n    }\r\n    get height() {\r\n        return this.__height;\r\n    }\r\n    get data() {\r\n        return this.__data;\r\n    }\r\n    getPixel(x, y, channelIdx) {\r\n        return this.__data[y * this.__width * this.__channels + x * this.__channels + channelIdx];\r\n    }\r\n    getPixelAs(x, y, channels, typeClass) {\r\n        if (channels === 3) {\r\n            return new typeClass(this.__data[y * this.__width * this.__channels + x * this.__channels + 0], this.__data[y * this.__width * this.__channels + x * this.__channels + 1], this.__data[y * this.__width * this.__channels + x * this.__channels + 2]);\r\n        }\r\n        else if (channels === 4) {\r\n            return new typeClass(this.__data[y * this.__width * this.__channels + x * this.__channels + 0], this.__data[y * this.__width * this.__channels + x * this.__channels + 1], this.__data[y * this.__width * this.__channels + x * this.__channels + 2], this.__data[y * this.__width * this.__channels + x * this.__channels + 3]);\r\n        }\r\n    }\r\n    getPixelAsArray(x, y) {\r\n        const array = [];\r\n        for (let i = 0; i < this.__channels; i++) {\r\n            array.push(this.__data[y * this.__width * this.__channels + x * this.__channels + i]);\r\n        }\r\n        return array;\r\n    }\r\n    initialize(width, height, channels) {\r\n        this.__width = width;\r\n        this.__height = height;\r\n        this.__channels = channels;\r\n        this.__data = new Float32Array(width * height * channels);\r\n    }\r\n    static transfer(source, length) {\r\n        source = Object(source);\r\n        var dest = new ArrayBuffer(length);\r\n        if (!(source instanceof ArrayBuffer) || !(dest instanceof ArrayBuffer)) {\r\n            throw new TypeError('Source and destination must be ArrayBuffer instances');\r\n        }\r\n        if (dest.byteLength >= source.byteLength) {\r\n            var nextOffset = 0;\r\n            var leftBytes = source.byteLength;\r\n            var wordSizes = [8, 4, 2, 1];\r\n            wordSizes.forEach(function (_wordSize_) {\r\n                if (leftBytes >= _wordSize_) {\r\n                    var done = transferWith(_wordSize_, source, dest, nextOffset, leftBytes);\r\n                    nextOffset = done.nextOffset;\r\n                    leftBytes = done.leftBytes;\r\n                }\r\n            });\r\n        }\r\n        return dest;\r\n        function transferWith(wordSize, source, dest, nextOffset, leftBytes) {\r\n            var ViewClass = Uint8Array;\r\n            switch (wordSize) {\r\n                case 8:\r\n                    ViewClass = Float64Array;\r\n                    break;\r\n                case 4:\r\n                    ViewClass = Float32Array;\r\n                    break;\r\n                case 2:\r\n                    ViewClass = Uint16Array;\r\n                    break;\r\n                case 1:\r\n                    ViewClass = Uint8Array;\r\n                    break;\r\n                default:\r\n                    ViewClass = Uint8Array;\r\n                    break;\r\n            }\r\n            var view_source = new ViewClass(source, nextOffset, Math.trunc(leftBytes / wordSize));\r\n            var view_dest = new ViewClass(dest, nextOffset, Math.trunc(leftBytes / wordSize));\r\n            for (var i = 0; i < view_dest.length; i++) {\r\n                view_dest[i] = view_source[i];\r\n            }\r\n            return {\r\n                nextOffset: view_source.byteOffset + view_source.byteLength,\r\n                leftBytes: source.byteLength - (view_source.byteOffset + view_source.byteLength)\r\n            };\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/foundation/textures/TextureDataFloat.ts?");

/***/ }),

/***/ "./src/pbr/main.ts":
/*!*************************!*\
  !*** ./src/pbr/main.ts ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n// This is based from https://github.com/KhronosGroup/glTF-WebGL-PBR/blob/88eda8c5358efe03128b72b6c5f5f6e5b6d023e1/textures/brdfLUT.png\r\nconst pbrCookTorranceBrdfLutDataUrl = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAAA3NCSVQICAjb4U/gAAAgAElEQVR4nO19Xbfjqo7tJOV9zumHvn///tm7w32wAX0jsJNatbsZa7iEEJgkc0oCk1T5v38BQIW6VltvGwOojt7paFTr3HiqdwVr8FXBk/cM3F7V0TvyfbOPVj9hkNRkzI4CVMC4FtQ6NLS/3aWgVLcVmWq7o2c81UeCGnxDgCP398czTvbq70Onq2tDZCTM8k3PVk0NFg22S2bkAx6gyScBzyDHAeSr5fJ/ZqupNw1sgQ8uBD2gKQglHNk0XhihANWwD+RHmm5WdZnyIUOYPU1yPn4EODuEfj3JAaxUT9ZtgD4FYjK4aEJuBG2WkfNKLSNh9kjTzeqGgS7byM4MZRY3AsBS7nEA4chGlYxAW6GEvOcWg3s24hammdkllnfQT3I2MaDustF0s6rLI649Ux4kCbwIAFrli4FVDiAYOahymOYhngJxej1gjqCVq3LWuL2MP9HZi7LHh2exbvY1IgB49Q4H9FBIV6FW4VOsZ5z6JRTAyYVW3XYyCCAcxJXTcSAY7dnqJwweL/nxZQQAr+5x4CpWF6SrgL0vBB/rSwLCXOjTQcCTDYjn4oDs5VjerG4Y6GIabLv/m1w64KcrexxA2AWrZPD3hR4QClDZxDx7sxUrMu07HVz23Y0Dz1Y3DEyNLp8OCEE5Ctx0ZY8DCLvAt6RV8BFg7QttCFDjgwcZ1+y248fuOEjHgY9WNwySGrN8jRLXGgD5DGdmibALchEAfARYYWpDgNlKCBaZtbdsKQh4ffPyGIrHAWH50aqpmZZnsW6a3efJQXFwhwNiTl4XaoAcGa6qk7Kv+XvPzBrcHEQrYxlW33x3D5R6tHw1HllXtzW6JHt9zf1DLoJ3OYB0FyRdvmlWgDCSCAF8tNgM1t6o2cXuvgL3oGnSpYAGK205rd63/6jmkbI0rNoG3eKAHMTvgtlT3pgbJkyTAqatHF6PB4GlJjcOtGBlt86qWLF/UJMvn3P/HU60WA/C1jmAjPF5+9lT3jkZwiM9U8c/ac3lQoEBLJs7TQZA2wv4aCjY1pjlJqyXuptA94pzFGKRA/Yg1hUYz4kh9HkyKFc9dfx5d04PomUQP8W0xjcSvaZNQVX01dUNg6TGU+pyp++GsVeyx6FjDiB9YA6noDZesUgGcBZB2XiCaS+VimC6VzACLBuzKW8pwUq8nG6FtgcrX0b/I0jVxfP0we10l8lx6CQHkD402udHV7RZ0FuRBJab33H8XIlZLqRH0DKcprgaN40xOUvNvuZoWOyS1HjK7xePGGaJjkN/ggMgVSSeD5j6YdBYpJuEAD4glDz1659z/F5H776j42xBDH+0O5ql8tsDRVzCCPBhDgBrzwdgGmx9zQUJuad2rkF7Ez24r0I/rsYBBKHBtsYsPwe+XgmCgGg6Uvj+PAdADJCOAOBITTr+BRoQF/tgEBCtS1U5lPV4WNxLD5jU3DGL9U+VPNC9pgNJfD/KASgEm158GgGgboq048/SgMzNG0TLcJrM1qWqMRT5PE28wlLegXXS7HexopeYA+dM2hrgaQ6AO/UoAigvbhu0GbuCvyYW9lrpGYDPDc4g0p7ISFdF37UqZ6nXxbypaZZXfg3NXglQnulL1gAFFTPn/dzzAWgh/U1IVyiAtSYWZghlE6DTXCgYc1pNGuSr5gh5M9PSU3rltxPjLFN6qF2gaQKT4QmxhEMYmBAPn5GlBCubEmbYk/1ciI6vZfhVT7PDDfJR33T82tIz9kpgHDRt+/K4I/28dDnEKCkOJG24V/YigARoQQFw5wsAZXQHaQVcZVZu98g7/jyyPc3U0w9NOhFaUm7oHy9TbmwbHHbbdzlgCOEXAHQXYQNrTWxbzmRqD8gsyzVTTUE1r1kyMG08pdn9WX3cdL9kOABl4z4IE+P9Rg7oJg/HDMRqTexaEpkO6/XVjjYeLaje0dhunnxqH/Xx348JU3znbUDMskchXLN7HIDv3QHj2NxUAFU63jqIAHoQW2633A4C2xpxF0NTAHVEwuvo3SKw3y73R3uKAyCf5sJRCPd+NzgAJWgQZ367wUX5vV38CN+EXbGlWYW6I0IbT2lr+BEJbzQ9sftNny4bPj62ZL8KMeWAvprzuskBKZAuU2NoZfOI2iApu01q5LjjtLqhnGo8ZazX95r2+mklSYPxqxDbHAhixRc4ADNuiLcgXA8E8ryJPx/wOuoqnTZ8m1Xl0FjkjLt7s3qq9amSd/AZ47YGeJoDEybMOAAO69Pdml+GRDjCkNsdpd6R802rVc/AtBFKczRXqRKhbrzn3X+U7xcAmxqfRXcha4CCghDlN45LQBtzDiAD65WDn9ByuB4QstlkVxeDANXQOYOb5d22iUtPaY4QdEm2ZgwyZQPWeXuodx7el+IzE9zggOxIOEDHjgQFYo8zMOUiE4Nn3Hy4Mdo1UwcfeHetj+37xHr/2PGb41ODL6AfbRobmF7qQjsexv3idIhsTZqDTmMF+GgbHEC4N4pYzq0HvKowBp+VbnXtlYFQmpaxPUwgtrdr2/GbN8qPsFEece3JcvT+JspjDkRu/lEOQDh75/kAHFliut3Rs4dfjQzIsMEIj7v8uIlyPj9aN3gQ2V927ch19x+E7XJgvE7yirc5AEspHHkAd9e1z062Tau2AYlOwQimxlOad8z0QojgKbiT6H/c/YuyTQPanRYxVPgg7B4HqA3WOQBuYwg52pgy4K4HvKoYxzVQ39OlBqYmVmp9vnU0Eccwdfz4GPpXgwDtiBs00EP1csDa/GHmwW35vFwOgC2szRtRDoB8SB64LyGkzVSGtR7wqoGB1Chqxb2gPpXYqZtd5n3brKbQDwYXlhu+f5sDSLjzjcK+EUbvNEA83f10lsXeIKYBCAcglOTFG8SwaJOUYXUXlsw4r7kRBwK9bpr2je+obZKYvpP53OGAHoqWjWHH9wEQpDRpDrje3RoEyr4A4F+jAR/NJoaT0OtewsbsDoWVDO51LxCfkoS+5+ECqE1xD/5GmRjJDCLst9Hfb/QUB8SwusQ34ovgAMfTKW9tDcGypH49dv9DydE2yXx0lSQtnrGpiZXi6+raTEwvHlO3egbR4OpzXEJzPkGaFvEmf67EszW+EikmxeiBcHOT97WZQJC9xAEoe6kkIJ5nPro6e6AL/lYukwGsLPEh7rJtuYrm+45flw+FgnyR26CYJjzp1l4CjmlLUJQ3DjCladn6F+7IY6cuq63DNAKAQyEig7UYgEJSANklNGcs0TzFEpo/gf4+Hfw+GsgnwQPHYCkNKw5tPYZIA7jbo2L4AntZjIAP/oPeVNVK3GNn7+kLaTYXA9Q+cPkB7BZAvzKs2eVD6O/F9DJfKIfOSUS6QkWNYBPo0Zi9/QYHhAGEbMUNQELTc/DiUAP4Z79JBuUytl3+HujlsOnMY4MtN8s37wX9y3B0HpOEZ/aYzCUPuUeSA1DnQCeywxmEiQ0NI6iGgdkL6jOzEaw2mkVJ4n7V07t3nHHg+9D/LaWlQBwxDI7BO+U3XQyB/3iBZCyaeIa8cphZcAY+DTwDL2/xgJjig/V2PYV7/TlsY/d/CPTPQg7D8U2eXibOfnr4efoIrMjFxpQDkY0CXJAFTTQqFzLNhF63ijgARXhdkrjfTofoZPSA/2Do65emdoG8UJCLAzYTWkZh0KPfFMMGIaaFY45DAdS+ECzcuBDnuRB8aE7yDZX46ZJE813Qh2P+6dDfmP8hcEn9vRw9Xg/wbKdPKF4SMMsiOQBT5k40CAXoEQayC8iApmYo/dw9xmJEiTC26PIU6A3eKYb/8PL4VA9aCXw2TXjMaZnpEDNw0n3BPTgPv8T08vv9tAssME0zHPOBLnwy6FbP7FnQexF6Mk4Q239T+QIh+y3kz6JghnUsnh5lCnUvYXOHA0iEAlh7O5H7530NvWUPx4aZ8bcgyZ/s4H9m+cT8p2MeZn7SK+7xHgfo1NO76b5aY0AIeQ4gSoegq/yVwgGxDSyeekG9uY67sIt4DzfgnuyVKr87CDz1QjbGabtA5NEvRO4O490JgD76e+m+dfRaCjMOgNJgdo6NVZ2cPpXbOOcadC9RXOyGyPuHOXhd7r+iOyOcffmvQyvYIcY6rwerBenvLb4ZE/Q5IKYt8vsJDVrPBfc/azINAkvW5vzIwFcR/8UgcPN13Qc9LeMskJmisK48TaJATyJYDus/BaOTiRMbQV0kaeCsBzBFvEUes69ZdhiyONRS+SbHfgvu52uAbifSD6o3nTq7iWkfrC58vk05IIYasHaoa9IA1noAJuJ1EycPTBun2J+H732DAR/Hrvmg+rHBv9g3b1/6YbheN1MU2sNeFgc/FuQciBjV8PfeantBwYmJ/pq988yuRlHaYwLE2+pvByeLt2raHvCZwt/AB0f9dMekpZECwcnXuxTn/XJsKxR4QzG+Ob5HJPpTTGf2eQT9zJRGvFMGH5z3IelDjQ/si1l4sjxCg41BvoD7XsZhONtP87zCy4WmocBLhzyGiCTHW+xCwUb7dY8GULeG0FtdmI0F2Wd9529YHKsX9QOzl4xZ0oavAcxVqemZnJNzZCyr5mdK/UYmB8RwcZYPyOMSpg1TqjnTEqHwXhwwBn0OfA8OsjfCNx153kYYHEa7Rlhi+cvU/glQEVKkYOVR8j5mYqbn4p99sJWKM7oXLWI+mS6p8pVEaDK9J17Rg5jOmG0bjKMQ8DF6VuJHAWbSr0QgzPi1QcwBxKHAMYPDBBR5TjOYZhGVJ+JAHFUeL0uYftz4Eejfbx1HITxPzDANA+7RqSF/awgI/wM8a0wGZZOloRmonhtre9EqipebmRPeKQkOPLUSsMe58XI+kaisGgStTgpkZZ/2Lr6zJDC6Q4BRAT3+pXXra5DmTDby+2iZOwtQWAHNN8sdSjzls+/bbEN/b1j2jTAjt1bo8XY/Apc8CQXOkiAYM5NodeX5T4Xr2o1e2ynNExx4KhG6m7VvBYE7Bp+A/rRJnQWCQrwTHPSJ/KJwNgYPgO5FD373iAMYNur+5NUmnl49sLR9MA7k8rHMME8Zf8h5/8amw1hxaoftu3zT37sYdPBnBx/eqgcwc32pF6MRM5cnasLLeF7kQIQbf6gNPjySxG+78E/47/tdjqtFZ9A6DmBiJvSGzw6QwbsYmRhskniRpL9aj59xFiRmtVzuxQGTh1n7JyyDNGwDeXHr6oBPDTVSoLOmvX7qoZhFjAjrzv9upFfMbDQiRVMIP7AgvRFv0Dz6ZYof8TZGetbyE7nKdxz5BsRjvVwEI1wS8Oas0nPn9uTi38AKkyWEQYa5/BDW8o27586TJZkIZSD+iM1qEPiOw75j7KdAwiSTDiWXBFE+roZVlYADXinNIEZsN+tlgvA9DmxnUAkS3vHiGYNV4H7Ol38I+i0F0vs5CcTb5+H8tMfeAsqdnFPDXB0R5u7it849swXPeoMDQWNmgHiobRzHrcF9P+ShTf3NYadm8kvx3WS+EWSeh/P8+owbhomf7cxbyXDiLcjuWYVj5s1Xez3rlW92/KjrzejvjJk0O1iLXPOq3pns30t7EhyQOoVyTbYMB/TsTLMUShXDU2W9l20zy6k+BfTE/B9XfpoPLQWiKpHYmKzALjEc5RWC9LDOHU0OwBsgGFlNbA/NgVWy1/S+RVRmaduq3mv6dPqx1Hd7/FhzyA8m4/jXgwPLheBi3f22gPedNT4gfWHLW5k3cqEkczJfun0qIVnVf4cAH0X/nsZ6EPYZDgi9jXWTM1Y9bkXOAcvYdoMDZnvca83xU30ytfP1O8rZzH8vjjc0PAUSiDSTnwwHMDFjoSC9JEDPlFY4MB3Z+CB3ObCN5s1W5yemn8067vT9Mo63NYfUBaBXBici5/sqXtrjeLLoANzTHFi1yQQW25I0mNiddvwCuL+Zxvwu9Isq+z/CrvaE449ihdkrVBotAQoVB9j973GgJAexBlzw4onQEYymJ/kld9s+LHdKvua3oD9jn1gD5JIfedJ4iQNw9fbPAVnJzBIHYh+cGcQDtG2g9Zl8zNf/uSnH3pifI0P7PsCUA+Cb5TlWdM0cnWn94AAblyumLnYlF4pdu+jxIb1NgxmLfktSMTV4/I535kP+n2Af9PAMZnFAb/Cb2HUHPNXOzxCZXYph5BTfIDlIHATm4J6xNEUDFc0+6zutLOijfPj0aPw5gAV6+WhsShIYxHh8SRBwYDIZa5TIx0+DCbH0MisX3wnafD/B+I2A/uatz+rCGiCf/NhfG1jhgKHb44DfWjJ9HZjKQax7zSNAq2varIF+3SvfAeXNwfPVO/fN93XOAiUcfyWsSCGeayLsep5b6fc4EKDWNuA2QRzw2OJGgNBmAQFWKPsUTMOk60HUPsWceErq+wDVkEXi7q0ZjAUAteeD2Df19R7Wx5AJDrjYjVtPkziSqNHMJlsTsutB5/3bwfcDxzm07w+WBJnNouA4XZREwYJXjhtjAG8c3zdPW4Xzy2Y4cczRn0Ron2KFM7dHQPYF4P4uFl0RgCFbeG4f9LbfXddM0qEcB+CAL+61jO/gvutKcfel/ZzHsbXQ5NP1EXQ+zqigeoDk8bXydn9JQKvVcvyVkkR3wQrcm1I2rgDdHM1snZ+xCUcoykxbfsqh5u74PB9+XlNgKczkNqgLdB0WwEFWAHFEIhMHYCiNn69qlk9xIEK5796GJo4kjtn8A3Oo9VHoPOuVf8IISwMeYoEL8etu1JdzvFbSKnKY4fVh0MZbK8s55uODaezZZxBc7DXxsg0Msu158ewHzG/3fT58rsveCNNe/DQoxbq5LIYRJR5fEsTK6RcJYn1RTa7zxmxzxgGreaOFD+keB25CMDtUYpKfwOvjo6knwRYHuu/3PL3cKaLGYihzBFOjRu7KVQ64R9+mD6Fm/jvr4B2yfcSn+kFg446flpNNz0YMWj1GraVANgdaU18x9y5XLgRFg2CFABVJxDR4R1lyHNDOXpvPvfjU1S06+LhKCfMTAPpDyPAgl4RspUAU3ArocTqksyPm46EYBU4bfQtTA6CgwNbv5ELY34LMWqYfoD7Agef489OIsUGY2IylQHIn1MS9tfC9wgKvIkx+2CycdEjOOr8s9jgAf+Xqh4J5vhsCblSTZg9hdHvAbMf2tvwEkmxHkisFqn1zpqCauT5Fdkt4RjoUrAEKgDBQOJpbcHcII4BObftQGxBfQMMSaCziZWG6HgSejQZ30LmN5o1bOylQReW+v2csOkSccrAGEDFE5zlu5gNLuZv2FEu/4Oyn2J0Gig3HeYcDi8bfIYCHyN8VFg6GXcoBNBooj14JJUQ6FK8B9DGhye9w0SkFGk/Z9MXSu/s/YRwwN1imBnfkfWUuCDzIkG3j3ygfMjXnft1LgZgNHDMzDkBpNhCfDg4lrc/6ch9VU/5s8mTKOkv5aaybL/ZZkn9IFtWxCK4t+698SWCCm/4gCg0FgDoFbXn66MsG4qZcUywz+cpmlkXpTdi5OA56cWpFH/AidDbhnmHjF2mzbfwhGWMRbLn/azXcUGVwACwd0qtkgLWa1TGpxFGiOuUApMuklkWrF+OA9sqbJFFTij6wBI4XWPFol6lyyeCO7Ln5wP0X4/8JJk60Y47hW+E+8P1Jx29kVmImRFMFjhUHiqWEwnq/g3bYoskGStDkKzda49vF46x23Jhzdv43en1IxkUA7v5PuFfq/jPLAMv3244frCMNFHLYOxquLLESzKOLJu3LS6ap3Wvy2fsjuF22hMdbb3ZZMvioPE6D1srPe3Y+NGUVqb+QwWkQonzyheMZvqtOctoEBKyNtKcAsB7KKiwO2Up45k1Thjg2rn1mtC1ho/VmlyWDj8rH8N+FQZ8KHfoQqT+RIVIgQg8xFLuFV8UyK5JmhesFYeL9lgCXxTPYQu2zZg/OwVCm37SlwZcMhLzU5QABLuhGEHf/UPiOlwHgfUXTdf8l0JsGXEPdJNMgDXeCZqH3PH0eVa5BGEaYcgvKD3Lv8dZtg0Be6jIWwdWJA9L9OxwwlwEgZuOetBci0BtfwF3RBHAHZwt7X8iARRnbmFYInnacjhALSbOnmPOI2dRyqddT8jHSGAJ90/33tOfE98UBYgAwGpgrZrEyRlg9jQsMg0pfT4IVhStpXzMO2GGdw8hDuYe/KYa+AOUHcX9ntGcN7shsG3Q8AiNormSbSKQ6YslLwS2ALn+wZMoBMBrIUJBBvLgjMZNvhAkpD2eNGwZ2LZQvcCBHkqeEbRyvdtxTLhnckcc2KF0JaKGaLj+zDPCAqykB19jmALe3f7hKI56YFWJmZCCKA2hAdxOemAOhPg/ZzSCw10sJj5hNlUsGd+SDwdpaBNO1wfm5s5iAkQ4BUj9uZYUFONVitRocMLtDIp7aFOsusdJOzYnxAqzjpYKP0ZuQXaCWElYH3GhdMnieABAZTiHAJUJfEoxQEKZDtCMbrd/cT4cqBYHmAAadiu6uNKaN7d1N/JnEUGwslv19DriQdajyu4SnWp81yMjj16E7rPtKgAoA8fSzdMj29wHudRMIDUSr6Kurjkb68tnyV2M9C1bFAWFjKveqgcGSze/F/e8kwOW/O+Y6dLhQiafXz4MBgyT9ViMdUk1REt/uUvyqfEFBNqW7EA17T3lHQYwppCg3pk2ie3yv1SkFXZZ6fQH3v5MAoIDuEcBaCYALgNwdYtBP4p4At3cfE52C3gJ0sQxcBPguP4WePaBPObBV3TB4UHi8dapcNTab2lEIwoETcSP54SgHX/jqVa/7O7sW7g1kF1SQ5KQxrVit1XlKIF8lBa4GXwGgvGkbR1pquM/QPG0yDKZLhbB6U3iQABtdtvG9Jx8jpWlQo5s84A8HKkgEcFbDfexKZGiZ9wXPyCtHlQHrRFWj2TXgg3SyZVHIB9Q4DiA+JUmkfOKARkaYYFe9n8nB95R3jLW9HQHMbVCx/8M4ABUo2lBnEWGheDZgTfToPz0BWn1M21WuKf3VWzyZIMzD9EMcMCeToUdWv7UMWBU2WveU92U7AkCthu1FcOuCwP37WL8QQ2RwoCNOeKYcAAc0NzDxbcJUAjG3SI2vd8wm05sxIW+wLWy0bhtkjIMmIwKMdTDdD00sgmG6f2Ipjyf0m4JhUYQCefpfkAp+VRjzu1CDYlUjuJjMceikfXkAX6+jabBXDYQMapMoTxLgWYMNmUWAnuuLLIgui+EtghPuv0LqqVeOcN/MasNNna0QTEyLauHdXdiZLv8pDoSoTRqsVb+SBcWo/Rq+p/KIANTHjywIjAxQKwEmgGVNWlmoAQaLhl7k+k2+kn5IRrEXlF4WB7mQTQlikFcmAR1zA/E6QY3g2oTVjwp7yiUDIWf69urRjzd3sFaaBXFKiAWACX1786fhmEKzcL3p+xkHePfzFtXcS23Vwqu0VcBUvjUaeUsuX10DKGeuq017VVNImm2z4hGDTF9TJr8NCrIYUBzoORJdLlPo68OkDO4FQMOKj/sO2WqFi24WLAkKOEN8x8+oSGaiwb0E936jBRDH3EhvmD4O/U/A/aYykDNm2v5gDl7kP34WBIJ4LTDIFoZdnQ6x1J9s+9SGJCPvbwwcVZ8SgeOXSN3jgAl3R7kaBLJm608VpvptYaN1qvyQDHYYrp0GrUEWhGEDng6ZSb/mQ0/le69LwWXBATZ3E9wxB7xe0yrRROA24W4izOPACjdWDczb6WWD1ysW7phNlUsGQk6aHRTrMDkAaw1AyECFAProbMH4vEF3+qn75ynQsME1ve75TKAbkKIYFXiNwwKMJ529NcJZyApT6V53h4qVU/22sNE6Vd6UvaaDnXQw4wBYggRnHaxDAWDwocNauHzP/Qus20vhdP6zmRqBBaLiG0i0JbaJ5npVta/h+iRZnepjIa/8Gu4DDpzV8X+EiZUASARgywOx/FXbPvQpb8eZnfm0Qbo83L/y90Y6dIMDGnCsyQP0iX7PwO9iXpNmmcHzd0lWp3pP+RQZMnIS6DEHDp3q0DjQvbXOgtAFL+8nxKCBwoC+dv8FpS9zBaOmMr07kSmSepN2/KI6cJBZ/iZZMQsCRtPKNaNMVpPCRutUmZHzQPeq13+QMbw7ANhrAPYYuJGBkiReANBEX0I/5/49eRoWzA3Qws3yHAjAZzfNFrhB0zbc7zMh0AfGS61LBjdlr8r+p3gG+v4nkiJcwtmLLn9H8mNBv7d26OOEclOm3L+Fb/PQBL1111NQijVxv1XMgTklhMEqK4IgMN0pEjNXVzGamKdnHAsbZksGN+Vpk50CQW+GlsYQjAgAz/FzwYM+XdTWzgGM7trlZ/hAP9quL9xGVtMcEFWDEkQzwe4MgpnrnkGyui3sKR+U800Hgz54HFBLArYL1LBoOH4lUOijOXhwT5+B+7UwIQmVMBgv0YsJYJQoSQ60q10VlIDRkTZ5rWJWG3CfmiWrDwqe/AWsZ8yu7wRTDgTo18/COi4HzrigoX/huAxBrATcLH8Kd8ug0JnA6JvigEh1rMUAq7Y7ZmC9gObFYxGBgVfdMKDCVLlkEMhxNT/CoXObCiMLMvIfshMKvhg4hcJtOvTPT5EKhT8O02iu3ZIYBKm/TRI4lAg4wMEXZD5m6h/gUvBEGHi95gbOgDGm7yD+JgdWOz7eJE+DmnFAE4OBPkj9yTq4Ix4k16fr3ar4YKZD05jAcNCpeJqYNmRigQ1FeQx0E9yF3CUGd2wZdNxWetWsUN2mL8hxddqrrQE09DH+AIl+dh6uo9ASOtBxYroLGMQYCY/iwzVT/Qy4C1Mll2MOdOx2/Jmg790neVGIeJMn5pVVd79NH9tM9YFB3OtD8lI1GOTACe5wGQAeCjqgRzoEC4XE8aNhGhzcA/Hc6/cRos0fTxnm91SmHIg+eG5fgphgsYUh3qFECvppg0eqUz0V8q0b8keb5C5QvCUK/jgMxUj9teNHwzco0AsAK8/hOdI5ptgpGgLpMiFGwAFYSgVlF/QxmjOIbwMys8UsKCFjysgAACAASURBVKP0qtt6KuRbk/Ke2Wo1TIG8CECzf7oUthw/Gr67UKxQMIBuPhX2US6XBBzBcHBP5eIsANxkCXaOZFfJZIuDbA1c75pRmszxqtt6U9hTCnmvKUZ5YND+h5hwGYC+BUSq1OX3aulVDA3b8lehAM6S1xCafZtHRIwlDoBzQMsU2QYCeJPE9A3E29fcwc+l1rw+FqbKm3K+SVdNg2MsAEwOkDNCchFMUE5zFYpFc7ELuKHgcueNKlSgQDe9PoWFJobLgf6mkORey71jsDgegmoSBqDjkCl5QA9wHCin+i9D/3NYX8U91bSjEJQG0xRIPP11yMASfWJQRKpDVgUFDN8U6JN0yMr+S8gB2tqxrmUBXypHoFfnTCXirWvQhJWmqf6HQz8P7sAyoynjNCg4DSreFgfGFYvoF7ucFP16X0ghni6RPfd/zqFwpeYAjRKF2F/4I/L4/JTjp7LNByVkqhvXZHVbHwsbrUk537RaFZqD5T/BMoAIoKlOgH7qYs1jDrwJlgCRBQVCu5cQdNwYHGgtDNakwUyKkouEwOsXMo2hbN2pUpsBsvqboV/D1nXofwf3vaoI4C0D+LdkjEdgVrVwf29HAC34/r7OfLyn0b2Yht+lOIkQOJoDpSEIeiiztWsxkPdRxMfg3oN7Eut7yE5WLQIAb/EwmC8A4C+CL49O0C/NYK+Ae/ZC/T17GpBZAPgcuMAXaHD57EJb6acVOn4qx3wY1dzCILjG1ZtA3+bAVLkh6+rUYNr9VJJFMPAG3IwIAMgC4Cw++ntr6S4/3AM9u1zoV2sAKEvBKJMDhWvkMoBrxFvvBYTC/S4FtAF6wYfpfugjJ0Zn9KBC3HoH5Z+D/rPEGNugb+H7zb0gAGIB4ISConaKjGfATQDZHvWwrpMf49bKQEBZYHoSEDpGCY4puB8IAgEZtkBPiaotpdCmKprmHXPKB+VpdarRrWcxUqDOgS5EC4Cz1OtNZ6BvKBegL23AvtsDnvago5+m/iHWS2hQrKS/vy9FvFPKmNncDAIbuF8JC8mqKXjynS4b8s3qqsFRy+X7Rebz5nEABDluCtSUPdXprCiQCwMRAUD01xx7zKnKiztYL9TACwgEl9TAS4SK6q5b6YAx6ONzE8I4ec0ok0JeeQfij9Bgw8DUOItglQJBrYPjFEivB9gCoJHBQHmzpyvjKNvREO8BweKARryZCGk3X1RH2jrMLKUnQCstSthXx9Krar2Z/0zRmVcGcr5pWr2pOegCQMcBYwVcrcG8zZ/zTvqhWBkDnnqK8hEKAtBTvWNGIV6o/1bcmJKh9yvkldFWxhDwICBOUJN33yPDtElcY+VUn1E+YizkfNOegakRyuNNngS/+UbQm0C/nwi6ihkESNNJA82KvvND8/5zEHp2Oo/y1aqkRKGv6jIUQB/KDvc7QSB+QHbvmqzGgqc0bKqjX5FvVpMab6iRAnUmnGvfNwkCEO7fx71EakdgT4HOG3Nn3zkzTav2QB9VObgZJThb6LvGoM+DgAZ3IIB3gW8T5EWxcqo3BU8ZVL+A9Q0mTC3VF2IIB2giBOkoW5kFAaj1rlgYpOAOhf6QEjTnYeDm1fFm+BlRUWSIVwJDtk5PSGSb1YeeBnjVpJCU97rEg6xWTU1S2dYAbSUwFgP6LBBB29iXpKVv9iuv38kwZqCgLPZDTWR7ylKVCw+6t6q5SCjW263xTbEr8K3BHQhmNVCCzyRWetWksCFPW1ehvAH9JTK0bVCyGfruV5L/1DZAjwMVcvFKGkgKpJAdPEaAOmdqLIU5lEvh08ixhb0HVjUOAlLTunb6TdAvbFpVmCWvsXKqN4WpUsi6OjW42T2pmSpbCsQ3Q0UcgBUE0J9qnUXgHgPKA2M917e6ZJXtWvSygcK9Qa2ojAgqYhhV9X6N7lxzVdVmEVXGxDCrS9eMMilMlYGsqxnNI0DfpkfbBdIpEP8DCQKsVDlwAdn5aTY9XxIOfszMSfGrdvAN/aazH1B2DEx/b1bNIIBMECByXsBMKa4ZZUYfGGeUZjWj+Sisp/fq+isFepNtH5ERIV4En8Vx23TnR6Y0RFkprM0xvSsYJUyqoOOS08N2/9QS9tEgCghdPSVz458J3EYYILcOzii3hakSVTZNq55ygxvbQwnlUV+ob5IC8VNAtSc/mGOxNDNjx7Pn97iGY/s/Q+2AmF/FwqDQ0TgfGCvoG9DNOOilpaKE7MVtaBO0ksjgfeeIb33N1mQ1KUyVQp5WTU3SLNkxMwdTedSCWtouUOWhoABNRpPFQAPDZtYubk+UNhmsnEdomAeyvP6UDxT082WD9RBg9KXcMFlBZCGY1UAJrSSs8Cynek/5CPQfZMIn+uJcA7wL+l7Q6fLlUzCM6yV545FoANjnJjRkE9xRzRb6dRZUHD6gQYf9qbWyQQwOERfxsywoUw2uGeV9Qcisau0T5KumZsnyKeUVAfrTAHMdjI4EEgrsPVBuVmjVDyOm4zdR7skijFAs0tcslgF6tTBMNT1Ia/yYTLKCKHEP93nQP4L4jHyzGihN/VL3zAgjBTIiQHPhYwHg3aY/650FCr0kKJ55Zhkgcp4+ICeGMOhm7M/MkehoUCGCj0OrQh4CzfWtdfDGNVk1hakykOOm2NjTeMp890BvNo0UKI4AZ6EY9RhRWmu3o3s7zP2fNLCcMXvCQMeJYwIhmHbzWfff5+dlSiD6YAEQngsyq4ESjnID9Ek+BHK+SVdNjad8xDjQ49oFqm4EAA0CZzUYjrQVrpZJkcOlodSOX9xFoL+b+LgHN2Z/5g6pNoBNCXAD/WRACJlqcI2VUz0Vpkoh55t0NanxlIF+dRzaOo8AEP6R5utmMTMf0rfHhCW4D/cPif5iKWGlRh3NgkUS7pwV9PWLVqEEEaisj3wa6F85AxcrUwJfxZo0ENVtJmxrYv1eF9F61IL6wht4v50I0G01ssOFAb2Zke7T/EeMxLMaquzEKxYxRP5zyWBVKGcvuaeSIsYHDXHzEIRFCV3NYD3JAa8aCxsyIPeFEVjCKEnob+B+o+moPQKUVATogC4ctRQz9E6V9xIjyBK4f6vKVgUY4KauXeOevpbJn0qK+kulZuBMoJbB494A36X1hW+jm7wqHOUO9HNNuuop89APkH2n9Xj3NUAZJyDsCNCq3nCF2Ah9AH22CO5dLCYUMOb1qhkWBCWYk7bWwXINYPl7KIZQJR0fVSqHGWUFt4yvGWVS8JSeTSDr6oOaWB83ZQxKjwD9r/aD0G1NDKRSneD2xhr3rIrDP+a9VOfigR4D/ddK10+E9Ep38kKcUJA8CWc4eL8aXGOl1gc292VdfVCzp88bdJuj5z/jaQD5eiT8/Cczenf8AsZJ6BeKeKKxcyEMv97dMHgiRHctz5nZjn8aChJMAO/iNe1dtRAAPebDhqyrD2r29HkDYXPUgvfrOgU0fiGCn4TrhUI0zoV0zmPaX8qZ1xfCIEPz9CwCdMFcG3B3Lqbt/Zk2QkOrhuAcjti4etWk4Ml5uH+IDHv6TGtgdpzoH4kQJ8BZ3Ay+KIoApf/OoYoA+iqLl/DADgi6yQwFdG06aIDR6h0FpS9UBIQxAgV6vxcXBIgDfAdAj0GfRPwD0Pe3gLY1e/pM69TsSoHeVgoEjoep+z+x5aY9Pu7t0fRkRd4v6NHuytwtoQHNiMyDQ5oSdurfpmfQiTRpJaxqoKRvQqaaFDbkaTWpWVLeaUoaYCyCzzjwQn0bEaCXgVTLWdJtUOpPI8RbSU7hmoFyAn0KdMCIAGittEmeXcMgiVDSP1ooT0QkoVXwvh7QY9ybcE9hvc5tkvK0mtQsKe80JQ26zfF+4f0m+Q85EwFrBQzTYRcU5ft1xFjdTCqcHpQDUlaOv/RWFQpYcmLt8Qt6S0oU6fULN8NMgJUXBddkNRamyvtVU+MpN/TT1iS6qNn1JLhW1MaECrxfwJtgoADixDJvKmDoR//fAPrV3wyF/mDIHhHL+MEcvCdDJeKMGDQFajeNzv/oI3QC+p1aFrgN9FvV4BorbbM2Jf0OX7IKEUJerXrKDYhv43uKftOAR4AyNkDrayT0tLOZBdVWHf/pi0j91ZYLNBN4yDA4QPTnp3gBjsuDEtZ69OxceDToL3KaBWm9sDFBv41+kwNeNRYCOd/U+Y/AJlRu6OOmaWtscDDok4fBAq4shymsWWz7FIJk7eynWZD9VgoOYFTNaNApIR4LMNBzGgwQ05dBZmVQIn4Q1u/YX9c087HOw5nGXlW8gXdkU/PToD81mHY/6gsiCFSMPzkKhwVE6n9W27WfcRh8IOATDDM+htqgfCobBwzcw4gGY+3b5tmpK2gARYPx5+0CKU1HPAQNmrHQj2ubgNTztyVQGkK1WwN5tWpqPOWG/n5rxgDjSXB7FvbWj8B4Kj/GrkA3a0FAR4AKlnBPptt3ftD6g+dCaCjXuIeMBr3J3JKX7hzMxjAojZMa+pDDggtmdenqVWNhQ9bVbc2e/n5r3gY0Bao8AsDa1hyVJtD/6VE6fp5hB2tfUzNkuh4AcW8C92DJD0Cyf7CERD4S5txgr5EoNGHMqph8AGKTHoGNV2Xv1SINVqtJTazfbkoaJG1Os+PNU6BzDQAOAJn6E3yMPR+MbaJaJWEW4gCHe2m3KQT0Ju6LMmPVOuYjNoI0DTpPRDSgbxxV6tgiBLMaKDFTmsJUGcjTKsDcWWDmKadNN1vzNtRSLoLf5+9kkdymb33W9km/cGkKgX7f66RsqZ0MFP1ELuaMe76ubHQW1IEOjCVB4VGCUUWsgPk7onGvZ8v4wEOH5tsSGcTVqw6h+k2hnG/yNEvKadPN1ryNtjzqqxHgXAaAnIIGoJ9htXQf5P9O1cmPDgLQMtGZ/sakAQM0GBnoapLtC7WqWAEzuFsT63cxngY4J0ChhE+hPxQiudr6O5pYv92UNEjamJYHQ//r+mIkyNZ+UQvZ2uTadoFY8uNv9cQa6VxPJd+glL6WQByCD9bDKS3LLSAvHVJ4EojX4J6gvzC6imuyCjWrQCnkaTWpifVx07Q1Y5C08cyMNYCMAArQJzco9CtYBBjGhewoOS7Wm6uBOb6ZCIycZ1wtPhgpENTCV926M8RuIpohd0aRW9D5eIgP4B6APk8Dz8asmpol5bRp2poxSNrElgfd/+lbopVshTIcFABtx7PJdLfn6kf/N7F+f43+BCUmvtZ5cFtIHBjGBJ1sz14/GKatYNHAnJiWhWBWg6tXTQqBPK26mvQKONBnWjMGS2ax5fF+sS/F02NwHTRnCvTCyHwAtvytNPkpV+faT1JooJ+Q8uDLQd/HuDTcxdJXOK76ESzIwtTMgnIz0Uo9Dp0tvaMxzxX0m5heQv8G9JeUd5qSBo9bthSIPAroWB1PdgFUvIFXgz7aWpkiXl5x0UDGgWpvqMlibUEWAXoBdA07XNBn3ZXvH3MzBW4soC/SHighmqG6xkpTmCo3qqvKO01Jgz3jqSVZBLdlAFQa30fq0L+QTHz/Va1jiUwB1KEfzKk76QEs0SpkeuSB6As3YF3857jJv/OFiPVD4RMQAnn/djiQFJKyriY1e/q4aclm1TJpLLdBz+/EnL3HV9fp/k+DfkcDuk1DeSVwp9A35zSwpZoFmoUxO/RmOVomiNUw+FFQ/xyoODEqZmvuhEY4nuVCXjUWmOwfhJ5WV5WBPm5aslm1XLI/LujTcxBl+LnavOwLwAlC8ospl9cHcfw+9PWcitDUBlPRdCKmMGVnhcb9uNLnZWIHiSKeM8Hcs9Kz0lUqPLL/kxQ8pV1dfAjgKQN93PQ5s71yUPRfC4AX+QrLefO2nD01fYtI4J7JehOp/70l9AcQxSuvQ1+E8pQLQ4y8mu6ZhAKAZfbeSThBEpMJnmBWg6tXpcJUKeRpNamJ9ZnWvE3e7GYvdhTi3fMfsM1NkK2hsSpo0rXbUy9Zun+V+pfXRQNwJHWpNJ/NKEF3MLuZ8rLij97CSJmKzKwkE0T+46T+MG/nVIOrVzWFqTJTTWpifdy0ZJM3e6pX2wVqi+CO9dIWu2fy8wZekL7/FE6syxTI2ecZE32hvJmeefrBMxYHmAaAOBTUr2SfZ7SK5a/5PRhnzpRR4FWhp8Ln0O8hPs+EpObS+7t2U+TlobkH4u2OZy+WAp1PA87Gfvr/3Tgwtnraahho2RENEOA06PueAu5tCh2dDPFkB7OQew3P3SzHCPTKD0QIm2sEtSA2ZBP6Kh1iAs/+oef2A9C/AH1HHzclDTYsH++ovhLZ/DzdhaTwpk/KxH8cf4UCb8/nddFgfJAkCLA9e4L4QRLCCsoEqVGo9TBa1Nsn+xbGZ4MJStZU/A76A3xPob+knDYlDbaNH+lIy/G3iADn0C0CXE++Ghh6JKztn0qvxK5Q99/SfQDlNbJ/uu3TX43w/QUjBeo37tn8GNY7E0oFwpau7B7ddIqaTnQ0nVOxKRH74OpVk0IgT6umxlNOm5IG28Yf6nu8Cy4OvNo5Z7L/cz79pWvfTgOW+WDA3Shk1XtWS3vUUNr9xuZMv40SCogZBb04VlmITAWO+/Fm5L4EI/oK6AdpD1aUT6H/ccf/c6B/s7voe7BzEKd75tuRPe2pAv1oD4Y7P5TvZ+7/ReQTo6+2JUo+W+n7lUDNgNFd49uOA0T2fP9loQIFTe062eh6ANbd9ZvutT5Cg2nV1HjKQJ83uGl/v2NQjDVAad9l6fmP+LFoIwKIIEBz/RepKt9fyqiO9W53+VZYKN3l66POp6H1dExA/5LEysFc/lq4Bxk8EK5Jqrwog/4Y6NvoX4J+3JQ02DZ+pON0HLkLhLb7CeBd2tan+qa8WAMYyc9rbP6c0AeB/shSSJW5f3oKQ31JhWJX0ABkcH1OYcja9xf1EkiLTSErvJg4TqJ/1d8H4P6o1/8C6D+HeFFkBEBDwquRgaG/NNCfRTt+mgWdCU/Lcy6v/7o2Vq90iEKfy4IMNBSMZ2T8e17gSGIPAQSO4yPQzkpAski9yyYZHkS/B/EHvb6hr2FrfpyP9bozFI8AJP+53D/9hsBJibNfz/5hEOBK/fva9+SAYEK/im/ZNlleuzHIfgulAd0yClFVNETCtS+ossgU604E8KqxkJTzmlifad2zvNPlqQFZBEDfdClAOxjX8yJQX6Cff3HHL9L9yxmL6wn3Vr3uS72+igBjv4XkMGwTRkQG32dTf6+THxEKoEYAH40KSQ541aSgq9uO/58E/dUx2S5QxQWg10kAwgGa5Ne+AlYRoLzJUZ9Xq/acR/h+Dv0L3w0Uw6nT/Iesg7szRuveX3zfFzI5wN4gvfDl53/QBtRPf8GFKcRNgG6jP4b7lx3/D4H+xrAHzX/6OvVd8CrS/aMQ6MNAfz8wRHHfkx+UlgX1CCCyIO7+dSI0AgLtFSwDisEBkKokw8xAxxCtFFdzZG3zJfTXiVm+NW/zVK8PDcsiAF4XbtDR36/i3fPRT3F/en2ApTosAgjod/fvJULE8Xdnz/IfxQHAPclMhxJ/4p2V0C/jKYF49zW+vSt4l6QQdDerpsZTJlszBg/2+ujIx99iC6igdPf/GlnQuInn/sHQD+71T7gP3HcmkJsy9099P3+hctHclOgcwEiNClEWjNHoilm+kXV0TEYAWMIU/fkgICZ4lWrY3Ef/Hwf9m4Mf7Bxo+7tOxVElLU7qL64oLRSc+O75T3PkQhawHl5fJD/na+bRYPQi74gBKcWEbmBEAE4G8+1mNBPvk7Uzaw5iTzVsdauzLcvvQ/9Oxy8MTlKgF9CXvy/GgWspLBYAdPMHPDI0318a4kHkngUVzgEUAmvl43tAYPs/GMsAilcKPoFRkKpkNwk4SfeP0PHrshoEPOVqNVAG+rzB4x2/Nv5B90ABvF94ndB/8bDQytj/6ehXac/4Ek2HNYZMgU45cAGXR4DzVdrLAOVizfUAOIZ0PLPJQFvFTEiTEGjVuwozrxooN4bahn7S5qle37/F+FmUKz95obY/0NSolzrcfKnM8V/JDy5nPzIfkESIg/56JZQVaFRR+Q995aVJpTJcUpdv6ukIpvsvAvT6puLuRBMwwVMGYDXjQCCbo3nKQM8M1I7wtPwp0D/L0f9f1NPlvwgBTg6gf00MPP8hwrXvieH1L9wTMtAIAEEGup0v0h4iiB1Sdgq6jERI6Av8XaBeiv1Ja/vA/QfO3tNPR8vL5k09ZaDPGzzSZaM8e5eDbQGduP814kD//PvPXfXTzqXg/P/0rgm1r05eoOG4Z46fCFIvIgAGH+jzWuaMKX8sxw+uoSPEf+D2Wva8uGZCjNQvo/9/oU/L+HHcK//5hfrrWgOcMYHdtvI/tDM/uOSicFQIxKE+YwFcFgEgg0Dnw1XlK12xANCsMLd02F2UWnOGTj54OWYxXvLH0P81x//nQv8sx/m/w5+5/usX6i/gV4sDBaD5D8YzrzMOdN9/pv7oGzhFun+0bZ8oAlAnrVbDNoitzVD6lolYYab1U9//iPvPOGxRvoz+nwn9T99orAF6/nNyYLj/fv/u+MuV/Iz5tc2f0YNs8ohdIPYIjL5IGjEqaeA7MPYaQAtFpv59tKI0opg00HLs/s2Pber1p3HAHHB633iQaesd4zvlCzca/03qyH9+XcsAvDj60b7g0mX6gVUj/xlQshKhKAKAbAFR500QDPChCE/QGaVT/9JeThd0UXcBjJtqQTNhaKz44wmmWWAzbV2iUFy+g/6vcexKgU7/ffn+48qCIPZ/qPvHeKwLst059i5fRKabPyBdigUCsjU02uguUNOMhwnqgWu/0vElu/zvxNCiaaAnrJ+/3gRcEsdJlDyF/n8Y9M9ynP8vankB1P3/au6/Taef9ReOf8i10aAqNDWsX46wEJTo3SGxZUmQSu9ouF6LCcJYV83CmGCFESHIahlrFT0fbxBzWE/WVVPjKadN25Z3ypehf5bj+m8hC17d/R8tBQrcP/1c6+XyWd4P5v6Z4weJAIWN1qyGPY0Deg0gZ8KZABiMWiox68RNUY1ewYBT/f8Q9P8W3PdyjKdgv1AP1ONKgdgHTk890I//BCKHvun+Gdb5Clg/H7jsaYpipRlQZAhQopvcP3Uv+QmpmDBei6OZun9vnmb5Gvr/2dA/y7UGKL8uAuDkwGs81QKu5EfurFeW8OhnXtL9E+ifMsw1gMZcAxxFZ3GwBaUvRW4HTd93bdN9/B5kTcuABkIZ3+JPRP9PgP5ZjtoiADr6D7IAOD/yc5eT/qB5vRw/vUovjnFlW0BdaMP1gGD42sKyIOPgJ732UMANAClnyhSvJkm8FXlmGhvu/89C/8/BfS/HG6gvlKPlP3+RFTDGqYdCftRWop94/Y5iEQSAy9+P5IfSAE4AcX6poVCXTK8YAzJh6xEYrPsKwaya5RH3v3GjZNOSzUb5gdA/y3H90v8v4C/gr7YAaKcb+qPfsxSiHOh/8QP9VhAQiRD6RhDhAOL8xHoezNt51TeLIWLSILDXVdPxrw41tTdbfyD6fyz0z3K8Afwi7v8vlv+MzZ9WSk94iO8HF2jmcwpXtcmlV8EzIlLYYGUkQhSjGmo0FLAm9aDNLq371GEng8AqgvNDLQHrt6D/h0P/LEc917J/Af9qEUDkP+fv157oaQvfgXWS/Q9nT9a+hWQ+HgfAacDwVwZ2mfsvzjLAwejGh/EgEKddNtx/3v776P8joH+WowI4UP9q7r8vACpKJf+LUTv+QLOdnvywIHAW5ajZln9RApqNgK1zfGB016eGTEteivWni3iMoAfRVR2UgmnkbfYodPOmG+UPgv5ZjlpRjub+/2pPANAe/fYX1Ksv8pUAgv7CaXCJYhsUJOnvfKDE6BJfBA+9mZ+QtIc1FZYOed35bQ2llpNBIKaBN1o85uPlqRv9cdA/S4sA/0L911gA9IMPAPf9lSc8xYDdBW4eAcpo40/BhEFTaoQF7lYXLwtKusN8kvOsf/2++38EtX8o9M9yVKD8Czj/jv4f4pHnTVVu8rBsh+QQdLP/KqQqN4JgJ0Xuu0lXsSozYdfClgfUbFLChEfoVz/176Pkf9GfKUcF6r+Af7cV8AnTN/kfLir5az9xNXBc2BUYTBiJEAgNxP3FOjhRNiC458KX+GPwMDel1fwn7/4/Xf506J/lqC/gPy0CtOXvwCWH/vi9NxoHOIiN98VMgUgiNATCE/pHfTMz9h+72h8P6UIIe+uzTAJ9arydxuz1ugnffwb6ARz4BfwH+DfKX2OBO15eZb9xYp5oAHhSRAtPgewiFgCaQmILfyVR0TYe3E29Oc52FvSJ8iF6fLT7jypH/Qv4r7YLBPbct/9SEPvRK7ECFrgnfptBuft74vg1JUQcuGQL7rZn5YHiuoWzN2qWD320S8PuJWzbt1st/yT0Azjwr5YC/QLQUv9+zrn/zg/YlT3ihfLimVTk0XJt2KrvN/Kn2LLqjrN000ctY2PdZBr3b48Gt8DMZtrXLH8cPY76X8B/rg3Q8Suftf26rUiTc68vfo8Ci6pbKxOLJZvjlCZpDpwlqSyWXMgtaNW7er2E4N0O/IXD0XgvSjd5NrFxpsw/+h9WXvjvRoD+Rfh+FoikOoVmLDoUYLxnXpL9WLnzHnM69b+P3rw6VS1EshXcpvcSTfnJV/X3Ty0H/g/wL5Rf7SsvFPq8VCFVgH4wdfxrvHe1XSoZoI1DR65VjdCUhYxfcCn5dK5b0My/8Dkg8IX6cyZdKhfsYrUVb3Cr2DP/3/KxcuC/2/IXLeNXpfaPsKNcgK5yG8WAE8eXGWHOADGBvnn3biB6FXKlMzr/0eiHdYtpW8WVH3ZBdvFcN0lyMoUai456HHNkkTKJBp1B5SfmlT8u76elEaD9144eBz5RvPdUYCmzbPWwEkBElAy2knfPz8qc5yoH9OQDvTDAzCxT/twwVYAD/wYq8Ab+Bv5G/Rv4f5dQ/76UvTr+3qh/4/3G62+83yh/4/X3pSnqD38Dp/BmCEVL9QAAAI9JREFUwvXzcm/g3Rz8G7U1nXLpTRW14v3G6xTqJZR2PTXn9ayWphnfLGut4g90ySOU9YokBUN5aXrVvNZxBQFZX50bG2XVkTVGze82zL7wsAx08gL/qeWFf/NVL+wFQGH/qPLcm/Tg2/2TPzlzbj95wv/U8mJfgQfzVPLzuP35bAyQ7/IPQ88/7OX82PL/AWvoH5jBiy2hAAAAAElFTkSuQmCC';\r\nconst PBR = Object.freeze({\r\n    pbrCookTorranceBrdfLutDataUrl,\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (PBR);\r\n\n\n//# sourceURL=webpack:///./src/pbr/main.ts?");

/***/ }),

/***/ "./src/rhodonite-xr.ts":
/*!*****************************!*\
  !*** ./src/rhodonite-xr.ts ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _xr_WebVRSystem__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./xr/WebVRSystem */ \"./src/xr/WebVRSystem.ts\");\n\r\nconst XR = Object.freeze({\r\n    WebVRSystem: _xr_WebVRSystem__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (XR);\r\n(0, eval)('this').RnXR = XR;\r\n\n\n//# sourceURL=webpack:///./src/rhodonite-xr.ts?");

/***/ }),

/***/ "./src/rhodonite.ts":
/*!**************************!*\
  !*** ./src/rhodonite.ts ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./foundation/core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./foundation/core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./foundation/components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./foundation/components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./foundation/components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _foundation_geometry_Primitive__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./foundation/geometry/Primitive */ \"./src/foundation/geometry/Primitive.ts\");\n/* harmony import */ var _foundation_definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./foundation/definitions/PrimitiveMode */ \"./src/foundation/definitions/PrimitiveMode.ts\");\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./foundation/definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _foundation_definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./foundation/definitions/CameraControllerType */ \"./src/foundation/definitions/CameraControllerType.ts\");\n/* harmony import */ var _foundation_system_System__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./foundation/system/System */ \"./src/foundation/system/System.ts\");\n/* harmony import */ var _foundation_math_Scalar__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./foundation/math/Scalar */ \"./src/foundation/math/Scalar.ts\");\n/* harmony import */ var _foundation_math_Vector2__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./foundation/math/Vector2 */ \"./src/foundation/math/Vector2.ts\");\n/* harmony import */ var _foundation_math_Vector3__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./foundation/math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./foundation/math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _foundation_math_MutableVector2__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./foundation/math/MutableVector2 */ \"./src/foundation/math/MutableVector2.ts\");\n/* harmony import */ var _foundation_math_MutableVector3__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./foundation/math/MutableVector3 */ \"./src/foundation/math/MutableVector3.ts\");\n/* harmony import */ var _foundation_math_MutableVector4__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./foundation/math/MutableVector4 */ \"./src/foundation/math/MutableVector4.ts\");\n/* harmony import */ var _foundation_math_Matrix22__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./foundation/math/Matrix22 */ \"./src/foundation/math/Matrix22.ts\");\n/* harmony import */ var _foundation_math_Matrix33__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./foundation/math/Matrix33 */ \"./src/foundation/math/Matrix33.ts\");\n/* harmony import */ var _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./foundation/math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _foundation_math_MutableMatrix22__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./foundation/math/MutableMatrix22 */ \"./src/foundation/math/MutableMatrix22.ts\");\n/* harmony import */ var _foundation_math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./foundation/math/MutableMatrix33 */ \"./src/foundation/math/MutableMatrix33.ts\");\n/* harmony import */ var _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./foundation/math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./foundation/definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _foundation_importer_Gltf1Importer__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./foundation/importer/Gltf1Importer */ \"./src/foundation/importer/Gltf1Importer.ts\");\n/* harmony import */ var _foundation_importer_Gltf2Importer__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./foundation/importer/Gltf2Importer */ \"./src/foundation/importer/Gltf2Importer.ts\");\n/* harmony import */ var _foundation_importer_DrcPointCloudImporter__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./foundation/importer/DrcPointCloudImporter */ \"./src/foundation/importer/DrcPointCloudImporter.ts\");\n/* harmony import */ var _foundation_importer_GltfImporter__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./foundation/importer/GltfImporter */ \"./src/foundation/importer/GltfImporter.ts\");\n/* harmony import */ var _foundation_exporter_Gltf2Exporter__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./foundation/exporter/Gltf2Exporter */ \"./src/foundation/exporter/Gltf2Exporter.ts\");\n/* harmony import */ var _foundation_importer_ModelConverter__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./foundation/importer/ModelConverter */ \"./src/foundation/importer/ModelConverter.ts\");\n/* harmony import */ var _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./foundation/system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n/* harmony import */ var _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./foundation/core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./foundation/components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _foundation_definitions_CameraType__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./foundation/definitions/CameraType */ \"./src/foundation/definitions/CameraType.ts\");\n/* harmony import */ var _foundation_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./foundation/components/AnimationComponent */ \"./src/foundation/components/AnimationComponent.ts\");\n/* harmony import */ var _foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./foundation/components/LightComponent */ \"./src/foundation/components/LightComponent.ts\");\n/* harmony import */ var _foundation_definitions_LightType__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./foundation/definitions/LightType */ \"./src/foundation/definitions/LightType.ts\");\n/* harmony import */ var _foundation_definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./foundation/definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n/* harmony import */ var _foundation_textures_CubeTexture__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./foundation/textures/CubeTexture */ \"./src/foundation/textures/CubeTexture.ts\");\n/* harmony import */ var _foundation_components_CameraControllerComponent__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./foundation/components/CameraControllerComponent */ \"./src/foundation/components/CameraControllerComponent.ts\");\n/* harmony import */ var _foundation_importer_FormatDetector__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./foundation/importer/FormatDetector */ \"./src/foundation/importer/FormatDetector.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_geometry_Plane__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./foundation/geometry/Plane */ \"./src/foundation/geometry/Plane.ts\");\n/* harmony import */ var _foundation_geometry_Sphere__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./foundation/geometry/Sphere */ \"./src/foundation/geometry/Sphere.ts\");\n/* harmony import */ var _foundation_materials_core_Material__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./foundation/materials/core/Material */ \"./src/foundation/materials/core/Material.ts\");\n/* harmony import */ var _foundation_helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./foundation/helpers/MaterialHelper */ \"./src/foundation/helpers/MaterialHelper.ts\");\n/* harmony import */ var _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./foundation/definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _foundation_renderer_RenderPass__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./foundation/renderer/RenderPass */ \"./src/foundation/renderer/RenderPass.ts\");\n/* harmony import */ var _foundation_renderer_FrameBuffer__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./foundation/renderer/FrameBuffer */ \"./src/foundation/renderer/FrameBuffer.ts\");\n/* harmony import */ var _foundation_renderer_Expression__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./foundation/renderer/Expression */ \"./src/foundation/renderer/Expression.ts\");\n/* harmony import */ var _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./foundation/definitions/HdriFormat */ \"./src/foundation/definitions/HdriFormat.ts\");\n/* harmony import */ var _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./foundation/definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _foundation_textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./foundation/textures/RenderTargetTexture */ \"./src/foundation/textures/RenderTargetTexture.ts\");\n/* harmony import */ var _foundation_textures_RenderBuffer__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./foundation/textures/RenderBuffer */ \"./src/foundation/textures/RenderBuffer.ts\");\n/* harmony import */ var _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./foundation/definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _foundation_helpers_RenderableHelper__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ./foundation/helpers/RenderableHelper */ \"./src/foundation/helpers/RenderableHelper.ts\");\n/* harmony import */ var _foundation_textures_Texture__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ./foundation/textures/Texture */ \"./src/foundation/textures/Texture.ts\");\n/* harmony import */ var _foundation_helpers_EntityHelper__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ./foundation/helpers/EntityHelper */ \"./src/foundation/helpers/EntityHelper.ts\");\n/* harmony import */ var _foundation_math_MathClassUtil__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ./foundation/math/MathClassUtil */ \"./src/foundation/math/MathClassUtil.ts\");\n/* harmony import */ var _foundation_geometry_Mesh__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ./foundation/geometry/Mesh */ \"./src/foundation/geometry/Mesh.ts\");\n/* harmony import */ var _foundation_math_MathUtil__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ./foundation/math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _foundation_core_Component__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ./foundation/core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _foundation_materials_singles_EnvConstantSingleMaterialNode__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ./foundation/materials/singles/EnvConstantSingleMaterialNode */ \"./src/foundation/materials/singles/EnvConstantSingleMaterialNode.ts\");\n/* harmony import */ var _foundation_materials_singles_ShadowMapDecodeClassicSingleMaterialNode__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ./foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode */ \"./src/foundation/materials/singles/ShadowMapDecodeClassicSingleMaterialNode.ts\");\n/* harmony import */ var _foundation_core_RnObject__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ./foundation/core/RnObject */ \"./src/foundation/core/RnObject.ts\");\n/* harmony import */ var _foundation_importer_VRMImporter__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ./foundation/importer/VRMImporter */ \"./src/foundation/importer/VRMImporter.ts\");\n/* harmony import */ var _foundation_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ./foundation/components/BlendShapeComponent */ \"./src/foundation/components/BlendShapeComponent.ts\");\n/* harmony import */ var _foundation_importer_AnimationAssigner__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(/*! ./foundation/importer/AnimationAssigner */ \"./src/foundation/importer/AnimationAssigner.ts\");\n/* harmony import */ var _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(/*! ./foundation/misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n/* harmony import */ var _foundation_cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(/*! ./foundation/cameras/OrbitCameraController */ \"./src/foundation/cameras/OrbitCameraController.ts\");\n/* harmony import */ var _foundation_cameras_WalkThroughCameraController__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(/*! ./foundation/cameras/WalkThroughCameraController */ \"./src/foundation/cameras/WalkThroughCameraController.ts\");\n/* harmony import */ var _foundation_definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(/*! ./foundation/definitions/BoneDataType */ \"./src/foundation/definitions/BoneDataType.ts\");\n/* harmony import */ var _foundation_materials_core_ShaderityUtility__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(/*! ./foundation/materials/core/ShaderityUtility */ \"./src/foundation/materials/core/ShaderityUtility.ts\");\n/* harmony import */ var _foundation_materials_core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(/*! ./foundation/materials/core/AbstractMaterialNode */ \"./src/foundation/materials/core/AbstractMaterialNode.ts\");\n/* harmony import */ var _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(/*! ./foundation/definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _foundation_materials_nodes_ConstantVariableShaderNode__WEBPACK_IMPORTED_MODULE_78__ = __webpack_require__(/*! ./foundation/materials/nodes/ConstantVariableShaderNode */ \"./src/foundation/materials/nodes/ConstantVariableShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_AddShaderNode__WEBPACK_IMPORTED_MODULE_79__ = __webpack_require__(/*! ./foundation/materials/nodes/AddShaderNode */ \"./src/foundation/materials/nodes/AddShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_DotProductShaderNode__WEBPACK_IMPORTED_MODULE_80__ = __webpack_require__(/*! ./foundation/materials/nodes/DotProductShaderNode */ \"./src/foundation/materials/nodes/DotProductShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_MultiplyShaderNode__WEBPACK_IMPORTED_MODULE_81__ = __webpack_require__(/*! ./foundation/materials/nodes/MultiplyShaderNode */ \"./src/foundation/materials/nodes/MultiplyShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_OutPositionShaderNode__WEBPACK_IMPORTED_MODULE_82__ = __webpack_require__(/*! ./foundation/materials/nodes/OutPositionShaderNode */ \"./src/foundation/materials/nodes/OutPositionShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_OutColorShaderNode__WEBPACK_IMPORTED_MODULE_83__ = __webpack_require__(/*! ./foundation/materials/nodes/OutColorShaderNode */ \"./src/foundation/materials/nodes/OutColorShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_ScalarToVector4ShaderNode__WEBPACK_IMPORTED_MODULE_84__ = __webpack_require__(/*! ./foundation/materials/nodes/ScalarToVector4ShaderNode */ \"./src/foundation/materials/nodes/ScalarToVector4ShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_Vector3AndScalarToVector4ShaderNode__WEBPACK_IMPORTED_MODULE_85__ = __webpack_require__(/*! ./foundation/materials/nodes/Vector3AndScalarToVector4ShaderNode */ \"./src/foundation/materials/nodes/Vector3AndScalarToVector4ShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_AttributePositionShaderNode__WEBPACK_IMPORTED_MODULE_86__ = __webpack_require__(/*! ./foundation/materials/nodes/AttributePositionShaderNode */ \"./src/foundation/materials/nodes/AttributePositionShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_AttributeNormalShaderNode__WEBPACK_IMPORTED_MODULE_87__ = __webpack_require__(/*! ./foundation/materials/nodes/AttributeNormalShaderNode */ \"./src/foundation/materials/nodes/AttributeNormalShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_WorldMatrixShaderNode__WEBPACK_IMPORTED_MODULE_88__ = __webpack_require__(/*! ./foundation/materials/nodes/WorldMatrixShaderNode */ \"./src/foundation/materials/nodes/WorldMatrixShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_ViewMatrixShaderNode__WEBPACK_IMPORTED_MODULE_89__ = __webpack_require__(/*! ./foundation/materials/nodes/ViewMatrixShaderNode */ \"./src/foundation/materials/nodes/ViewMatrixShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_NormalMatrixShaderNode__WEBPACK_IMPORTED_MODULE_90__ = __webpack_require__(/*! ./foundation/materials/nodes/NormalMatrixShaderNode */ \"./src/foundation/materials/nodes/NormalMatrixShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_ProjectionMatrixShaderNode__WEBPACK_IMPORTED_MODULE_91__ = __webpack_require__(/*! ./foundation/materials/nodes/ProjectionMatrixShaderNode */ \"./src/foundation/materials/nodes/ProjectionMatrixShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_VaryingInVariableShaderNode__WEBPACK_IMPORTED_MODULE_92__ = __webpack_require__(/*! ./foundation/materials/nodes/VaryingInVariableShaderNode */ \"./src/foundation/materials/nodes/VaryingInVariableShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_VaryingOutVariableShaderNode__WEBPACK_IMPORTED_MODULE_93__ = __webpack_require__(/*! ./foundation/materials/nodes/VaryingOutVariableShaderNode */ \"./src/foundation/materials/nodes/VaryingOutVariableShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_UniformDataShaderNode__WEBPACK_IMPORTED_MODULE_94__ = __webpack_require__(/*! ./foundation/materials/nodes/UniformDataShaderNode */ \"./src/foundation/materials/nodes/UniformDataShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_NormalizeShaderNode__WEBPACK_IMPORTED_MODULE_95__ = __webpack_require__(/*! ./foundation/materials/nodes/NormalizeShaderNode */ \"./src/foundation/materials/nodes/NormalizeShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_IfStatementShaderNode__WEBPACK_IMPORTED_MODULE_96__ = __webpack_require__(/*! ./foundation/materials/nodes/IfStatementShaderNode */ \"./src/foundation/materials/nodes/IfStatementShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_BlockBeginShaderNode__WEBPACK_IMPORTED_MODULE_97__ = __webpack_require__(/*! ./foundation/materials/nodes/BlockBeginShaderNode */ \"./src/foundation/materials/nodes/BlockBeginShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_BlockEndShaderNode__WEBPACK_IMPORTED_MODULE_98__ = __webpack_require__(/*! ./foundation/materials/nodes/BlockEndShaderNode */ \"./src/foundation/materials/nodes/BlockEndShaderNode.ts\");\n/* harmony import */ var _foundation_materials_nodes_GreaterShaderNode__WEBPACK_IMPORTED_MODULE_99__ = __webpack_require__(/*! ./foundation/materials/nodes/GreaterShaderNode */ \"./src/foundation/materials/nodes/GreaterShaderNode.ts\");\n/* harmony import */ var _foundation_materials_core_ShaderGraphResolver__WEBPACK_IMPORTED_MODULE_100__ = __webpack_require__(/*! ./foundation/materials/core/ShaderGraphResolver */ \"./src/foundation/materials/core/ShaderGraphResolver.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet Rn = {\r\n    EntityRepository: _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n    ComponentRepository: _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"],\r\n    TransformComponent: _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n    SceneGraphComponent: _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n    MeshComponent: _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\r\n    MeshRendererComponent: _foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\r\n    Primitive: _foundation_geometry_Primitive__WEBPACK_IMPORTED_MODULE_6__[\"default\"],\r\n    CompositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_9__[\"CompositionType\"],\r\n    ComponentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_10__[\"ComponentType\"],\r\n    VertexAttribute: _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_8__[\"VertexAttribute\"],\r\n    PrimitiveMode: _foundation_definitions_PrimitiveMode__WEBPACK_IMPORTED_MODULE_7__[\"PrimitiveMode\"],\r\n    System: _foundation_system_System__WEBPACK_IMPORTED_MODULE_12__[\"default\"],\r\n    Scalar: _foundation_math_Scalar__WEBPACK_IMPORTED_MODULE_13__[\"default\"],\r\n    Vector2: _foundation_math_Vector2__WEBPACK_IMPORTED_MODULE_14__[\"default\"],\r\n    Vector3: _foundation_math_Vector3__WEBPACK_IMPORTED_MODULE_15__[\"default\"],\r\n    Vector4: _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_16__[\"default\"],\r\n    MutableVector2: _foundation_math_MutableVector2__WEBPACK_IMPORTED_MODULE_17__[\"default\"],\r\n    MutableVector3: _foundation_math_MutableVector3__WEBPACK_IMPORTED_MODULE_18__[\"default\"],\r\n    MutableVector4: _foundation_math_MutableVector4__WEBPACK_IMPORTED_MODULE_19__[\"default\"],\r\n    Matrix22: _foundation_math_Matrix22__WEBPACK_IMPORTED_MODULE_20__[\"default\"],\r\n    Matrix33: _foundation_math_Matrix33__WEBPACK_IMPORTED_MODULE_21__[\"default\"],\r\n    Matrix44: _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_22__[\"default\"],\r\n    MutableMatrix22: _foundation_math_MutableMatrix22__WEBPACK_IMPORTED_MODULE_23__[\"default\"],\r\n    MutableMatrix33: _foundation_math_MutableMatrix33__WEBPACK_IMPORTED_MODULE_24__[\"default\"],\r\n    MutableMatrix44: _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_25__[\"default\"],\r\n    ProcessApproach: _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_26__[\"ProcessApproach\"],\r\n    Gltf1Importer: _foundation_importer_Gltf1Importer__WEBPACK_IMPORTED_MODULE_27__[\"default\"],\r\n    Gltf2Importer: _foundation_importer_Gltf2Importer__WEBPACK_IMPORTED_MODULE_28__[\"default\"],\r\n    DrcPointCloudImporter: _foundation_importer_DrcPointCloudImporter__WEBPACK_IMPORTED_MODULE_29__[\"default\"],\r\n    GltfImporter: _foundation_importer_GltfImporter__WEBPACK_IMPORTED_MODULE_30__[\"default\"],\r\n    ModelConverter: _foundation_importer_ModelConverter__WEBPACK_IMPORTED_MODULE_32__[\"default\"],\r\n    ModuleManager: _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_33__[\"default\"],\r\n    MemoryManager: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_34__[\"default\"],\r\n    CameraComponent: _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_35__[\"default\"],\r\n    CameraType: _foundation_definitions_CameraType__WEBPACK_IMPORTED_MODULE_36__[\"CameraType\"],\r\n    AnimationComponent: _foundation_components_AnimationComponent__WEBPACK_IMPORTED_MODULE_37__[\"default\"],\r\n    LightComponent: _foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_38__[\"default\"],\r\n    LightType: _foundation_definitions_LightType__WEBPACK_IMPORTED_MODULE_39__[\"LightType\"],\r\n    CubeTexture: _foundation_textures_CubeTexture__WEBPACK_IMPORTED_MODULE_41__[\"default\"],\r\n    CameraControllerComponent: _foundation_components_CameraControllerComponent__WEBPACK_IMPORTED_MODULE_42__[\"default\"],\r\n    CameraControllerType: _foundation_definitions_CameraControllerType__WEBPACK_IMPORTED_MODULE_11__[\"CameraControllerType\"],\r\n    AlphaMode: _foundation_definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_40__[\"AlphaMode\"],\r\n    Gltf2Exporter: _foundation_exporter_Gltf2Exporter__WEBPACK_IMPORTED_MODULE_31__[\"default\"],\r\n    detectFormat: _foundation_importer_FormatDetector__WEBPACK_IMPORTED_MODULE_43__[\"default\"],\r\n    Config: _foundation_core_Config__WEBPACK_IMPORTED_MODULE_44__[\"default\"],\r\n    Plane: _foundation_geometry_Plane__WEBPACK_IMPORTED_MODULE_45__[\"default\"],\r\n    Sphere: _foundation_geometry_Sphere__WEBPACK_IMPORTED_MODULE_46__[\"default\"],\r\n    Material: _foundation_materials_core_Material__WEBPACK_IMPORTED_MODULE_47__[\"default\"],\r\n    MaterialHelper: _foundation_helpers_MaterialHelper__WEBPACK_IMPORTED_MODULE_48__[\"default\"],\r\n    ShaderSemantics: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_49__[\"ShaderSemantics\"],\r\n    RenderPass: _foundation_renderer_RenderPass__WEBPACK_IMPORTED_MODULE_50__[\"default\"],\r\n    FrameBuffer: _foundation_renderer_FrameBuffer__WEBPACK_IMPORTED_MODULE_51__[\"default\"],\r\n    Expression: _foundation_renderer_Expression__WEBPACK_IMPORTED_MODULE_52__[\"default\"],\r\n    HdriFormat: _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_53__[\"HdriFormat\"],\r\n    ShaderType: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_54__[\"ShaderType\"],\r\n    RenderTargetTexture: _foundation_textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_55__[\"default\"],\r\n    RenderBuffer: _foundation_textures_RenderBuffer__WEBPACK_IMPORTED_MODULE_56__[\"default\"],\r\n    TextureParameter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_57__[\"TextureParameter\"],\r\n    RenderableHelper: _foundation_helpers_RenderableHelper__WEBPACK_IMPORTED_MODULE_58__[\"default\"],\r\n    Texture: _foundation_textures_Texture__WEBPACK_IMPORTED_MODULE_59__[\"default\"],\r\n    EntityHelper: _foundation_helpers_EntityHelper__WEBPACK_IMPORTED_MODULE_60__[\"default\"],\r\n    MathClassUtil: _foundation_math_MathClassUtil__WEBPACK_IMPORTED_MODULE_61__[\"default\"],\r\n    Mesh: _foundation_geometry_Mesh__WEBPACK_IMPORTED_MODULE_62__[\"default\"],\r\n    MathUtil: _foundation_math_MathUtil__WEBPACK_IMPORTED_MODULE_63__[\"MathUtil\"],\r\n    Component: _foundation_core_Component__WEBPACK_IMPORTED_MODULE_64__[\"default\"],\r\n    EnvConstantSingleMaterialNode: _foundation_materials_singles_EnvConstantSingleMaterialNode__WEBPACK_IMPORTED_MODULE_65__[\"default\"],\r\n    ShadowMapDecodeClassicSingleMaterialNode: _foundation_materials_singles_ShadowMapDecodeClassicSingleMaterialNode__WEBPACK_IMPORTED_MODULE_66__[\"default\"],\r\n    RnObject: _foundation_core_RnObject__WEBPACK_IMPORTED_MODULE_67__[\"default\"],\r\n    VRMImporter: _foundation_importer_VRMImporter__WEBPACK_IMPORTED_MODULE_68__[\"default\"],\r\n    BlendShapeComponent: _foundation_components_BlendShapeComponent__WEBPACK_IMPORTED_MODULE_69__[\"default\"],\r\n    AnimationAssigner: _foundation_importer_AnimationAssigner__WEBPACK_IMPORTED_MODULE_70__[\"default\"],\r\n    MiscUtil: _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_71__[\"MiscUtil\"],\r\n    OrbitCameraController: _foundation_cameras_OrbitCameraController__WEBPACK_IMPORTED_MODULE_72__[\"default\"],\r\n    WalkThroughCameraController: _foundation_cameras_WalkThroughCameraController__WEBPACK_IMPORTED_MODULE_73__[\"default\"],\r\n    BoneDataType: _foundation_definitions_BoneDataType__WEBPACK_IMPORTED_MODULE_74__[\"BoneDataType\"],\r\n    ShaderityUtility: _foundation_materials_core_ShaderityUtility__WEBPACK_IMPORTED_MODULE_75__[\"default\"],\r\n    AbstractMaterialNode: _foundation_materials_core_AbstractMaterialNode__WEBPACK_IMPORTED_MODULE_76__[\"default\"],\r\n    PixelFormat: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_77__[\"PixelFormat\"],\r\n    ConstantVariableShaderNode: _foundation_materials_nodes_ConstantVariableShaderNode__WEBPACK_IMPORTED_MODULE_78__[\"default\"],\r\n    AddShaderNode: _foundation_materials_nodes_AddShaderNode__WEBPACK_IMPORTED_MODULE_79__[\"default\"],\r\n    DotProductShaderNode: _foundation_materials_nodes_DotProductShaderNode__WEBPACK_IMPORTED_MODULE_80__[\"default\"],\r\n    MultiplyShaderNode: _foundation_materials_nodes_MultiplyShaderNode__WEBPACK_IMPORTED_MODULE_81__[\"default\"],\r\n    OutPositionShaderNode: _foundation_materials_nodes_OutPositionShaderNode__WEBPACK_IMPORTED_MODULE_82__[\"default\"],\r\n    OutColorShaderNode: _foundation_materials_nodes_OutColorShaderNode__WEBPACK_IMPORTED_MODULE_83__[\"default\"],\r\n    ScalarToVector4ShaderNode: _foundation_materials_nodes_ScalarToVector4ShaderNode__WEBPACK_IMPORTED_MODULE_84__[\"default\"],\r\n    Vector3AndScalarToVector4ShaderNode: _foundation_materials_nodes_Vector3AndScalarToVector4ShaderNode__WEBPACK_IMPORTED_MODULE_85__[\"default\"],\r\n    AttributePositionShaderNode: _foundation_materials_nodes_AttributePositionShaderNode__WEBPACK_IMPORTED_MODULE_86__[\"default\"],\r\n    AttributeNormalShaderNode: _foundation_materials_nodes_AttributeNormalShaderNode__WEBPACK_IMPORTED_MODULE_87__[\"default\"],\r\n    WorldMatrixShaderNode: _foundation_materials_nodes_WorldMatrixShaderNode__WEBPACK_IMPORTED_MODULE_88__[\"default\"],\r\n    ViewMatrixShaderNode: _foundation_materials_nodes_ViewMatrixShaderNode__WEBPACK_IMPORTED_MODULE_89__[\"default\"],\r\n    ProjectionMatrixShaderNode: _foundation_materials_nodes_ProjectionMatrixShaderNode__WEBPACK_IMPORTED_MODULE_91__[\"default\"],\r\n    VaryingInVariableShaderNode: _foundation_materials_nodes_VaryingInVariableShaderNode__WEBPACK_IMPORTED_MODULE_92__[\"default\"],\r\n    VaryingOutVariableShaderNode: _foundation_materials_nodes_VaryingOutVariableShaderNode__WEBPACK_IMPORTED_MODULE_93__[\"default\"],\r\n    NormalMatrixShaderNode: _foundation_materials_nodes_NormalMatrixShaderNode__WEBPACK_IMPORTED_MODULE_90__[\"default\"],\r\n    UniformDataShaderNode: _foundation_materials_nodes_UniformDataShaderNode__WEBPACK_IMPORTED_MODULE_94__[\"default\"],\r\n    NormalizeShaderNode: _foundation_materials_nodes_NormalizeShaderNode__WEBPACK_IMPORTED_MODULE_95__[\"default\"],\r\n    IfStatementShaderNode: _foundation_materials_nodes_IfStatementShaderNode__WEBPACK_IMPORTED_MODULE_96__[\"default\"],\r\n    BlockBeginShaderNode: _foundation_materials_nodes_BlockBeginShaderNode__WEBPACK_IMPORTED_MODULE_97__[\"default\"],\r\n    BlockEndShaderNode: _foundation_materials_nodes_BlockEndShaderNode__WEBPACK_IMPORTED_MODULE_98__[\"default\"],\r\n    GreaterShaderNode: _foundation_materials_nodes_GreaterShaderNode__WEBPACK_IMPORTED_MODULE_99__[\"default\"],\r\n    ShaderGraphResolver: _foundation_materials_core_ShaderGraphResolver__WEBPACK_IMPORTED_MODULE_100__[\"default\"],\r\n};\r\nif (typeof exports !== 'undefined') {\r\n    Object.defineProperty(exports, \"__esModule\", {\r\n        value: true\r\n    });\r\n    exports.default = Rn;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Rn);\r\n(0, eval)('this').Rn = Rn;\r\n\n\n//# sourceURL=webpack:///./src/rhodonite.ts?");

/***/ }),

/***/ "./src/sparkgear/SparkGearComponent.ts":
/*!*********************************************!*\
  !*** ./src/sparkgear/SparkGearComponent.ts ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SparkGearComponent; });\n/* harmony import */ var _foundation_core_Component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/definitions/ProcessStage */ \"./src/foundation/definitions/ProcessStage.ts\");\n/* harmony import */ var _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass SparkGearComponent extends _foundation_core_Component__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(entityUid, componentSid, entityRepository) {\r\n        super(entityUid, componentSid, entityRepository);\r\n    }\r\n    static get componentTID() {\r\n        return _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_1__[\"WellKnownComponentTIDs\"].SparkGearComponentTID;\r\n    }\r\n    onBeforeRender() {\r\n    }\r\n    onAfterRender() {\r\n        const ThisClass = SparkGearComponent;\r\n        ThisClass.SPARK_BackupStatus();\r\n        _SPARK_Draw(this.__hSPFXInst);\r\n        ThisClass.SPARK_RestoreStatus();\r\n    }\r\n    // clone() {\r\n    //   return new this.constructor(this._LoadingManager, this._Url).copy(this);\r\n    // }\r\n    play() {\r\n        _SPARK_Instance_Play(this.__hSPFXInst, 1.0, false, 0);\r\n    }\r\n    stop() {\r\n        _SPARK_Instance_Stop(this.__hSPFXInst);\r\n    }\r\n    pause() {\r\n        _SPARK_Instance_Pause(this.__hSPFXInst);\r\n    }\r\n    isPlaying() {\r\n        return _SPARK_Instance_IsPlaying(this.__hSPFXInst);\r\n    }\r\n    kickTrigger(trigger) {\r\n        _SPARK_Instance_KickTrigger(this.__hSPFXInst, trigger);\r\n    }\r\n    static SPARK_BackupStatus() {\r\n        const ThisClass = SparkGearComponent;\r\n        const gl = ThisClass.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext();\r\n        ThisClass.SPFX_ArrayBuffer = gl.getParameter(gl.ARRAY_BUFFER_BINDING);\r\n        ThisClass.SPFX_ElementArrayBuffer = gl.getParameter(gl.ELEMENT_ARRAY_BUFFER_BINDING);\r\n        ThisClass.SPFX_CurrentProgram = gl.getParameter(gl.CURRENT_PROGRAM);\r\n        ThisClass.SPFX_FrontFace = gl.getParameter(gl.FRONT_FACE);\r\n        ThisClass.SPFX_DepthFunc = gl.getParameter(gl.DEPTH_FUNC);\r\n        ThisClass.SPFX_DepthWriteMask = gl.getParameter(gl.DEPTH_WRITEMASK);\r\n        ThisClass.SPFX_StencilTestEnabled = gl.isEnabled(gl.STENCIL_TEST);\r\n        ThisClass.SPFX_DepthTestEnabled = gl.isEnabled(gl.DEPTH_TEST);\r\n        ThisClass.SPFX_CullFaceEnabled = gl.isEnabled(gl.CULL_FACE);\r\n        ThisClass.SPFX_BlendEnabled = gl.isEnabled(gl.BLEND);\r\n        ThisClass.SPFX_BlendSrcRgb = gl.getParameter(gl.BLEND_SRC_RGB);\r\n        ThisClass.SPFX_BlendDstRgb = gl.getParameter(gl.BLEND_DST_RGB);\r\n        ThisClass.SPFX_BlendSrcAlpha = gl.getParameter(gl.BLEND_SRC_ALPHA);\r\n        ThisClass.SPFX_BlendDstAlpha = gl.getParameter(gl.BLEND_DST_ALPHA);\r\n        ThisClass.SPFX_ActiveTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\r\n        for (let i = 0; i < 8; i++) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            ThisClass.SPFX_Texture[i] = gl.getParameter(gl.TEXTURE_BINDING_2D);\r\n        }\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\r\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\r\n    }\r\n    static SPFX_Uninitialize() {\r\n        const ThisClass = SparkGearComponent;\r\n        ThisClass.SPARK_BackupStatus();\r\n        _SPARK_Uninitialize();\r\n        ThisClass.SPARK_RestoreStatus();\r\n    }\r\n    static SPARK_SetCameraMatrix(viewMatrix, projectionMatrix) {\r\n        _SPARK_SetMatrix(0, viewMatrix.v[0], viewMatrix.v[1], viewMatrix.v[2], viewMatrix.v[3], viewMatrix.v[4], viewMatrix.v[5], viewMatrix.v[6], viewMatrix.v[7], viewMatrix.v[8], viewMatrix.v[9], viewMatrix.v[10], viewMatrix.v[11], viewMatrix.v[12], viewMatrix.v[13], viewMatrix.v[14], viewMatrix.v[15]);\r\n        _SPARK_SetMatrix(1, projectionMatrix.v[0], projectionMatrix.v[1], projectionMatrix.v[2], projectionMatrix.v[3], projectionMatrix.v[4], projectionMatrix.v[5], projectionMatrix.v[6], projectionMatrix.v[7], projectionMatrix.v[8], projectionMatrix.v[9], projectionMatrix.v[10], projectionMatrix.v[11], projectionMatrix.v[12], projectionMatrix.v[13], projectionMatrix.v[14], projectionMatrix.v[15]);\r\n    }\r\n    static SPARK_Draw() {\r\n        const ThisClass = SparkGearComponent;\r\n        ThisClass.SPARK_BackupStatus();\r\n        _SPARK_DrawAll();\r\n        ThisClass.SPARK_RestoreStatus();\r\n    }\r\n    static SPARK_DrawDebugInfo(InfoType) {\r\n        const ThisClass = SparkGearComponent;\r\n        ThisClass.SPARK_BackupStatus();\r\n        _SPARK_DrawDebugInfo(InfoType);\r\n        ThisClass.SPARK_RestoreStatus();\r\n    }\r\n    $create() {\r\n        this.__sceneGraphComponent = this.__entityRepository.getComponentOfEntity(this.__entityUid, _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\r\n        this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Load);\r\n    }\r\n    static common_$load() {\r\n        if (SparkGearComponent.__isInitialized) {\r\n            return;\r\n        }\r\n        const moduleManager = _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_7__[\"default\"].getInstance();\r\n        const moduleName = 'webgl';\r\n        const webglModule = moduleManager.getModule(moduleName);\r\n        // Initialize SPARKGEAR\r\n        SparkGearComponent.SPFX_Initialize(webglModule.WebGLResourceRepository.getInstance());\r\n    }\r\n    $load() {\r\n        if (this.url == null) {\r\n            return;\r\n        }\r\n        const loadBytes = function (path, type, callback) {\r\n            var request = new XMLHttpRequest();\r\n            request.open('GET', path, true);\r\n            request.responseType = type;\r\n            request.onload = () => {\r\n                switch (request.status) {\r\n                    case 200:\r\n                        callback(request.response);\r\n                        break;\r\n                    default:\r\n                        console.error('Failed to load (' + request.status + ') : ' + path);\r\n                        break;\r\n                }\r\n            };\r\n            request.send(null);\r\n        };\r\n        const ThisClass = SparkGearComponent;\r\n        loadBytes(this.url, 'arraybuffer', (data) => {\r\n            var buffer = new Uint8Array(data);\r\n            ThisClass.SPARK_BackupStatus();\r\n            var SPFXData = window.Module.ccall(\"SPARK_Data_Create\", 'number', ['string', 'number', 'array', 'number'], [this.url, this.url.length, buffer, buffer.length]);\r\n            this.__hSPFXInst = _SPARK_Instance_Create(SPFXData);\r\n            _SPARK_Data_Delete(SPFXData);\r\n            ThisClass.SPARK_RestoreStatus();\r\n            this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Logic);\r\n        });\r\n    }\r\n    $logic() {\r\n        // Keep Playing\r\n        if (!this.isPlaying()) {\r\n            this.play();\r\n        }\r\n        const cameraComponent = _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance().getComponent(_foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"], _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_4__[\"default\"].main);\r\n        let viewMatrix = SparkGearComponent.__tmp_indentityMatrix;\r\n        let projectionMatrix = SparkGearComponent.__tmp_indentityMatrix;\r\n        if (cameraComponent) {\r\n            viewMatrix = cameraComponent.viewMatrix;\r\n            projectionMatrix = cameraComponent.projectionMatrix;\r\n        }\r\n        SparkGearComponent.SPARK_SetCameraMatrix(viewMatrix, projectionMatrix);\r\n        SparkGearComponent.SPFX_Update(1.0);\r\n        const m = this.__sceneGraphComponent.worldMatrixInner;\r\n        _SPARK_Instance_SetTransformFor3D(this.__hSPFXInst, m.v[0], m.v[4], m.v[8], m.v[12], m.v[1], m.v[5], m.v[9], m.v[13], m.v[2], m.v[6], m.v[10], m.v[14], m.v[3], m.v[7], m.v[11], m.v[15]);\r\n        this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Render);\r\n    }\r\n    $render() {\r\n        this.onAfterRender();\r\n        this.moveStageTo(_foundation_definitions_ProcessStage__WEBPACK_IMPORTED_MODULE_2__[\"ProcessStage\"].Logic);\r\n    }\r\n}\r\nSparkGearComponent.__isInitialized = false;\r\nSparkGearComponent.SPFX_Texture = [];\r\nSparkGearComponent.__tmp_indentityMatrix = _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\nSparkGearComponent.SPARK_RestoreStatus = function () {\r\n    const ThisClass = SparkGearComponent;\r\n    const gl = ThisClass.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext();\r\n    gl.useProgram(ThisClass.SPFX_CurrentProgram);\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, ThisClass.SPFX_ArrayBuffer);\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ThisClass.SPFX_ElementArrayBuffer);\r\n    gl.frontFace(ThisClass.SPFX_FrontFace);\r\n    gl.depthFunc(ThisClass.SPFX_DepthFunc);\r\n    gl.depthMask(ThisClass.SPFX_DepthWriteMask);\r\n    gl.blendFuncSeparate(ThisClass.SPFX_BlendSrcRgb, ThisClass.SPFX_BlendDstRgb, ThisClass.SPFX_BlendSrcAlpha, ThisClass.SPFX_BlendDstAlpha);\r\n    ThisClass.SPFX_StencilTestEnabled ? gl.enable(gl.STENCIL_TEST) : gl.disable(gl.STENCIL_TEST);\r\n    ThisClass.SPFX_DepthTestEnabled ? gl.enable(gl.DEPTH_TEST) : gl.disable(gl.DEPTH_TEST);\r\n    ThisClass.SPFX_CullFaceEnabled ? gl.enable(gl.CULL_FACE) : gl.disable(gl.CULL_FACE);\r\n    ThisClass.SPFX_BlendEnabled ? gl.enable(gl.BLEND) : gl.disable(gl.BLEND);\r\n    for (let i = 0; i < 8; i++) {\r\n        gl.activeTexture(gl.TEXTURE0 + i);\r\n        gl.bindTexture(gl.TEXTURE_2D, ThisClass.SPFX_Texture[i]);\r\n    }\r\n    gl.activeTexture(ThisClass.SPFX_ActiveTexture);\r\n};\r\nSparkGearComponent.SPFX_Initialize = function (repository) {\r\n    const ThisClass = SparkGearComponent;\r\n    if (repository.currentWebGLContextWrapper == null) {\r\n        return;\r\n    }\r\n    ThisClass.SPFX_WebGLResourceRepository = repository;\r\n    window.GLctx = ThisClass.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext();\r\n    ThisClass.SPARK_BackupStatus();\r\n    const glw = ThisClass.SPFX_WebGLResourceRepository.currentWebGLContextWrapper;\r\n    _SPARK_InitializeFor3D(glw.width, glw.height);\r\n    ThisClass.SPARK_RestoreStatus();\r\n    ThisClass.__isInitialized = true;\r\n};\r\nSparkGearComponent.SPFX_Update = function (DeltaTime) {\r\n    _SPARK_Update(DeltaTime);\r\n};\r\n_foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].registerComponentClass(SparkGearComponent);\r\n\n\n//# sourceURL=webpack:///./src/sparkgear/SparkGearComponent.ts?");

/***/ }),

/***/ "./src/sparkgear/main.ts":
/*!*******************************!*\
  !*** ./src/sparkgear/main.ts ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SparkGearComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SparkGearComponent */ \"./src/sparkgear/SparkGearComponent.ts\");\n/* harmony import */ var _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n\r\n\r\n\r\n\r\nconst createSparkGearEntity = function () {\r\n    const entityRepository = _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n    const entity = entityRepository.createEntity([_foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_3__[\"default\"], _SparkGearComponent__WEBPACK_IMPORTED_MODULE_0__[\"default\"]]);\r\n    return entity;\r\n};\r\nconst SparkGear = Object.freeze({\r\n    SparkGearComponent: _SparkGearComponent__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n    createSparkGearEntity\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SparkGear);\r\n\n\n//# sourceURL=webpack:///./src/sparkgear/main.ts?");

/***/ }),

/***/ "./src/webgl/WebGLContextWrapper.ts":
/*!******************************************!*\
  !*** ./src/webgl/WebGLContextWrapper.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WebGLContextWrapper; });\n/* harmony import */ var _WebGLExtension__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLExtension */ \"./src/webgl/WebGLExtension.ts\");\n/* harmony import */ var _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n\r\n\r\n\r\nclass WebGLContextWrapper {\r\n    constructor(gl, canvas, isDebug) {\r\n        this.__webglVersion = 1;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.__activeTextureBackup = -1;\r\n        this.__activeTextures2D = [];\r\n        this.__activeTexturesCube = [];\r\n        this.__isDebugMode = false;\r\n        this.__viewport_left = 0;\r\n        this.__viewport_top = 0;\r\n        this.__viewport_width = 0;\r\n        this.__viewport_height = 0;\r\n        this.__extensions = new Map();\r\n        this.__gl = gl;\r\n        this.width = canvas.width;\r\n        this.height = canvas.height;\r\n        this.canvas = canvas;\r\n        this.__viewport_width = this.width;\r\n        this.__viewport_height = this.height;\r\n        this.__isDebugMode = isDebug;\r\n        if (this.__gl.constructor.name === 'WebGL2RenderingContext') {\r\n            this.__webglVersion = 2;\r\n            this.webgl2ExtTFL = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureFloatLinear);\r\n        }\r\n        else {\r\n            this.webgl1ExtVAO = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].VertexArrayObject);\r\n            this.webgl1ExtIA = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].InstancedArrays);\r\n            this.webgl1ExtTF = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureFloat);\r\n            this.webgl1ExtTHF = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureHalfFloat);\r\n            this.webgl1ExtTFL = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureFloatLinear);\r\n            this.webgl1ExtTHFL = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureHalfFloatLinear);\r\n            this.webgl1ExtTFA = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].TextureFilterAnisotropic);\r\n            this.webgl1ExtEIUI = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].ElementIndexUint);\r\n            this.webgl1ExtSTL = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].ShaderTextureLod);\r\n            this.webgl1ExtDRV = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].ShaderDerivatives);\r\n            this.webgl1ExtDB = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].DrawBuffers);\r\n            this.webgl1ExtBM = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].BlendMinmax);\r\n            this.webgl1ExtCBF = this.__getExtension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_0__[\"WebGLExtension\"].ColorBufferFloat);\r\n        }\r\n    }\r\n    getRawContext() {\r\n        return this.__gl;\r\n    }\r\n    get viewport() {\r\n        return new _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.__viewport_left, this.__viewport_top, this.__viewport_width, this.__viewport_height);\r\n    }\r\n    isSupportWebGL1Extension(webGLExtension) {\r\n        if (this.__getExtension(webGLExtension)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    isNotSupportWebGL1Extension(webGLExtension) {\r\n        return !this.isSupportWebGL1Extension(webGLExtension);\r\n    }\r\n    get isDebugMode() {\r\n        return this.__isDebugMode;\r\n    }\r\n    get isWebGL2() {\r\n        if (this.__webglVersion === 2) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    createVertexArray() {\r\n        if (this.isWebGL2) {\r\n            return this.__gl.createVertexArray();\r\n        }\r\n        else {\r\n            if (this.webgl1ExtVAO != null) {\r\n                return this.webgl1ExtVAO.createVertexArrayOES();\r\n            }\r\n        }\r\n    }\r\n    deleteVertexArray(vertexArray) {\r\n        if (this.isWebGL2) {\r\n            this.__gl.createVertexArray(vertexArray);\r\n        }\r\n        else {\r\n            if (this.webgl1ExtVAO != null) {\r\n                this.webgl1ExtVAO.deleteVertexArrayOES(vertexArray);\r\n            }\r\n        }\r\n    }\r\n    bindVertexArray(vao) {\r\n        if (this.isWebGL2) {\r\n            this.__gl.bindVertexArray(vao);\r\n        }\r\n        else {\r\n            if (this.webgl1ExtVAO != null) {\r\n                this.webgl1ExtVAO.bindVertexArrayOES(vao);\r\n            }\r\n        }\r\n    }\r\n    vertexAttribDivisor(index, divisor) {\r\n        if (this.isWebGL2) {\r\n            this.__gl.vertexAttribDivisor(index, divisor);\r\n        }\r\n        else {\r\n            this.webgl1ExtIA.vertexAttribDivisorANGLE(index, divisor);\r\n        }\r\n    }\r\n    drawElementsInstanced(primitiveMode, indexCount, type, offset, instanceCount) {\r\n        if (this.isWebGL2) {\r\n            this.__gl.drawElementsInstanced(primitiveMode, indexCount, type, offset, instanceCount);\r\n        }\r\n        else {\r\n            this.webgl1ExtIA.drawElementsInstancedANGLE(primitiveMode, indexCount, type, offset, instanceCount);\r\n        }\r\n    }\r\n    drawArraysInstanced(primitiveMode, first, count, instanceCount) {\r\n        if (this.isWebGL2) {\r\n            this.__gl.drawArraysInstanced(primitiveMode, first, count, instanceCount);\r\n        }\r\n        else {\r\n            this.webgl1ExtIA.drawArraysInstancedANGLE(primitiveMode, first, count, instanceCount);\r\n        }\r\n    }\r\n    colorAttachment(index) {\r\n        return this.webgl1ExtDB ?\r\n            this.webgl1ExtDB[`COLOR_ATTACHMENT${index}_WEBGL`] :\r\n            this.__gl[`COLOR_ATTACHMENT${index}`];\r\n    }\r\n    drawBuffers(buffers) {\r\n        const gl = this.__gl;\r\n        if (buffers.length === 0) {\r\n            return;\r\n        }\r\n        let buffer = buffers;\r\n        if (this.isWebGL2) {\r\n            gl.drawBuffers(buffers.map((buf) => { return gl[buf.str]; }));\r\n            buffer = gl[buffer[0].str];\r\n        }\r\n        else if (this.webgl1ExtDB) {\r\n            this.webgl1ExtDB.drawBuffersWEBGL(buffers.map((buf) => { return gl[buf.str]; }));\r\n            buffer = gl[buffer[0].str];\r\n        }\r\n        if (buffer === gl.NONE) {\r\n            gl.colorMask(false, false, false, false);\r\n        }\r\n        else {\r\n            gl.colorMask(true, true, true, true);\r\n        }\r\n    }\r\n    __activeTexture(activeTextureIndex) {\r\n        if (this.__activeTextureBackup === activeTextureIndex) {\r\n            return;\r\n        }\r\n        switch (activeTextureIndex) {\r\n            case 0:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE0);\r\n                break;\r\n            case 1:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE1);\r\n                break;\r\n            case 2:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE2);\r\n                break;\r\n            case 3:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE3);\r\n                break;\r\n            case 4:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE4);\r\n                break;\r\n            case 5:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE5);\r\n                break;\r\n            case 6:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE6);\r\n                break;\r\n            case 7:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE7);\r\n                break;\r\n            case 8:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE8);\r\n                break;\r\n            case 9:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE9);\r\n                break;\r\n            case 10:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE10);\r\n                break;\r\n            case 11:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE11);\r\n                break;\r\n            case 12:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE12);\r\n                break;\r\n            case 13:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE13);\r\n                break;\r\n            case 14:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE14);\r\n                break;\r\n            case 15:\r\n                this.__gl.activeTexture(this.__gl.TEXTURE15);\r\n                break;\r\n        }\r\n        this.__activeTextureBackup = activeTextureIndex;\r\n    }\r\n    bindTexture2D(activeTextureIndex, texture) {\r\n        if (this.__isDebugMode) {\r\n            if (texture) {\r\n                if (texture._bound_as === 'CUBE_MAP') {\r\n                    debugger;\r\n                }\r\n                texture._bound_as = '2D';\r\n            }\r\n        }\r\n        if (!_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].noWebGLTex2DStateCache && this.__activeTextures2D[activeTextureIndex] === texture) {\r\n            return;\r\n        }\r\n        this.__activeTexture(activeTextureIndex);\r\n        this.__gl.bindTexture(this.__gl.TEXTURE_2D, texture);\r\n        this.__activeTextures2D[activeTextureIndex] = texture;\r\n    }\r\n    bindTextureCube(activeTextureIndex, texture) {\r\n        if (this.__isDebugMode) {\r\n            if (texture) {\r\n                if (texture._bound_as === '2D') {\r\n                    debugger;\r\n                }\r\n                texture._bound_as = 'CUBE_MAP';\r\n            }\r\n        }\r\n        if (this.__activeTexturesCube[activeTextureIndex] === texture) {\r\n            return;\r\n        }\r\n        this.__activeTexture(activeTextureIndex);\r\n        this.__gl.bindTexture(this.__gl.TEXTURE_CUBE_MAP, texture);\r\n        this.__activeTexturesCube[activeTextureIndex] = texture;\r\n    }\r\n    unbindTexture2D(activeTextureIndex) {\r\n        if (this.__isDebugMode) {\r\n            delete this.__activeTextures2D[activeTextureIndex];\r\n        }\r\n        this.__activeTexture(activeTextureIndex);\r\n        this.__gl.bindTexture(this.__gl.TEXTURE_2D, null);\r\n    }\r\n    unbindTextureCube(activeTextureIndex) {\r\n        if (this.__isDebugMode) {\r\n            delete this.__activeTexturesCube[activeTextureIndex];\r\n        }\r\n        this.__activeTexture(activeTextureIndex);\r\n        this.__gl.bindTexture(this.__gl.TEXTURE_CUBE_MAP, null);\r\n    }\r\n    unbindTextures() {\r\n        for (let i = 0; i < this.__activeTextures2D.length; i++) {\r\n            if (this.__activeTextures2D[i] == null) {\r\n                continue;\r\n            }\r\n            this.__activeTexture(i);\r\n            this.__gl.bindTexture(this.__gl.TEXTURE_2D, null);\r\n            delete this.__activeTextures2D[i];\r\n        }\r\n        for (let i = 0; i < this.__activeTexturesCube.length; i++) {\r\n            if (this.__activeTexturesCube[i] == null) {\r\n                continue;\r\n            }\r\n            this.__activeTexture(i);\r\n            this.__gl.bindTexture(this.__gl.TEXTURE_CUBE_MAP, null);\r\n            delete this.__activeTexturesCube[i];\r\n        }\r\n    }\r\n    __getExtension(extension) {\r\n        const gl = this.__gl;\r\n        if (!this.__extensions.has(extension)) {\r\n            const extObj = gl.getExtension(extension.toString());\r\n            if (extObj == null) {\r\n                const text = `The library does not support this environment because the ${extension.toString()} is not available`;\r\n                if (console.error != null) {\r\n                    console.error(text);\r\n                }\r\n                else {\r\n                    console.log(text);\r\n                }\r\n            }\r\n            this.__extensions.set(extension, extObj);\r\n            return extObj;\r\n        }\r\n        return this.__extensions.get(extension);\r\n    }\r\n    setViewport(left, top, width, height) {\r\n        const gl = this.__gl;\r\n        if (this.__viewport_width === width && this.__viewport_height === height && this.__viewport_left === left && this.__viewport_top === top) {\r\n            return;\r\n        }\r\n        else {\r\n            gl.viewport(left, top, width, height);\r\n            this.__viewport_left = left;\r\n            this.__viewport_top = top;\r\n            this.__viewport_width = width;\r\n            this.__viewport_height = height;\r\n        }\r\n    }\r\n    setViewportAsVector4(viewport) {\r\n        const gl = this.__gl;\r\n        if (this.__viewport_width === viewport.z && this.__viewport_height === viewport.w && this.__viewport_left === viewport.x && this.__viewport_top === viewport.y) {\r\n            return;\r\n        }\r\n        else {\r\n            gl.viewport(viewport.x, viewport.y, viewport.z, viewport.w);\r\n            this.__viewport_left = viewport.x;\r\n            this.__viewport_top = viewport.y;\r\n            this.__viewport_width = viewport.z;\r\n            this.__viewport_height = viewport.w;\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLContextWrapper.ts?");

/***/ }),

/***/ "./src/webgl/WebGLExtension.ts":
/*!*************************************!*\
  !*** ./src/webgl/WebGLExtension.ts ***!
  \*************************************/
/*! exports provided: WebGLExtension */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WebGLExtension\", function() { return WebGLExtension; });\n/* harmony import */ var _foundation_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/misc/EnumIO */ \"./src/foundation/misc/EnumIO.ts\");\n\r\nclass WebGLExtensionClass extends _foundation_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"EnumClass\"] {\r\n    constructor({ index, str }) {\r\n        super({ index, str });\r\n    }\r\n}\r\nconst VertexArrayObject = new WebGLExtensionClass({ index: 1, str: 'OES_vertex_array_object' });\r\nconst TextureFloat = new WebGLExtensionClass({ index: 2, str: 'OES_texture_float' });\r\nconst TextureHalfFloat = new WebGLExtensionClass({ index: 3, str: 'OES_texture_half_float' });\r\nconst TextureFloatLinear = new WebGLExtensionClass({ index: 4, str: 'OES_texture_float_linear' });\r\nconst TextureHalfFloatLinear = new WebGLExtensionClass({ index: 5, str: 'OES_texture_half_float_linear' });\r\nconst InstancedArrays = new WebGLExtensionClass({ index: 6, str: 'ANGLE_instanced_arrays' });\r\nconst TextureFilterAnisotropic = new WebGLExtensionClass({ index: 7, str: 'EXT_texture_filter_anisotropic' });\r\nconst ElementIndexUint = new WebGLExtensionClass({ index: 8, str: 'OES_element_index_uint' });\r\nconst ShaderTextureLod = new WebGLExtensionClass({ index: 9, str: 'EXT_shader_texture_lod' });\r\nconst ShaderDerivatives = new WebGLExtensionClass({ index: 10, str: 'OES_standard_derivatives' });\r\nconst DrawBuffers = new WebGLExtensionClass({ index: 11, str: 'WEBGL_draw_buffers' });\r\nconst BlendMinmax = new WebGLExtensionClass({ index: 12, str: 'EXT_blend_minmax' });\r\nconst ColorBufferFloat = new WebGLExtensionClass({ index: 13, str: 'WEBGL_color_buffer_float' });\r\nconst typeList = [VertexArrayObject, TextureFloat, TextureHalfFloat, TextureFloatLinear,\r\n    TextureHalfFloatLinear, InstancedArrays, TextureFilterAnisotropic, ElementIndexUint,\r\n    ShaderTextureLod, ShaderDerivatives, DrawBuffers, BlendMinmax, ColorBufferFloat];\r\nfunction from({ index }) {\r\n    return Object(_foundation_misc_EnumIO__WEBPACK_IMPORTED_MODULE_0__[\"_from\"])({ typeList, index });\r\n}\r\nconst WebGLExtension = Object.freeze({\r\n    VertexArrayObject, TextureFloat, TextureHalfFloat, TextureFloatLinear, TextureHalfFloatLinear,\r\n    InstancedArrays, TextureFilterAnisotropic, ElementIndexUint, ShaderTextureLod,\r\n    ShaderDerivatives, DrawBuffers, BlendMinmax, ColorBufferFloat\r\n});\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLExtension.ts?");

/***/ }),

/***/ "./src/webgl/WebGLResourceRepository.ts":
/*!**********************************************!*\
  !*** ./src/webgl/WebGLResourceRepository.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WebGLResourceRepository; });\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _WebGLContextWrapper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./WebGLContextWrapper */ \"./src/webgl/WebGLContextWrapper.ts\");\n/* harmony import */ var _foundation_math_MathUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/math/MathUtil */ \"./src/foundation/math/MathUtil.ts\");\n/* harmony import */ var _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../foundation/definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _foundation_textures_AbstractTexture__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../foundation/textures/AbstractTexture */ \"./src/foundation/textures/AbstractTexture.ts\");\n/* harmony import */ var _foundation_textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../foundation/textures/RenderTargetTexture */ \"./src/foundation/textures/RenderTargetTexture.ts\");\n/* harmony import */ var _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../foundation/definitions/HdriFormat */ \"./src/foundation/definitions/HdriFormat.ts\");\n/* harmony import */ var _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../foundation/math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _foundation_definitions_RenderBufferTarget__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../foundation/definitions/RenderBufferTarget */ \"./src/foundation/definitions/RenderBufferTarget.ts\");\n/* harmony import */ var _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../foundation/misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n/* harmony import */ var _foundation_misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../foundation/misc/DataUtil */ \"./src/foundation/misc/DataUtil.ts\");\n/* harmony import */ var _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../foundation/definitions/BasisCompressionType */ \"./src/foundation/definitions/BasisCompressionType.ts\");\n/* harmony import */ var _WebGLExtension__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./WebGLExtension */ \"./src/webgl/WebGLExtension.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass WebGLResourceRepository extends _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.__webglContexts = new Map();\r\n        this.__resourceCounter = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__webglResources = new Map();\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new (WebGLResourceRepository)();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    addWebGLContext(gl, canvas, asCurrent, isDebug) {\r\n        const glw = new _WebGLContextWrapper__WEBPACK_IMPORTED_MODULE_6__[\"default\"](gl, canvas, isDebug);\r\n        this.__webglContexts.set('default', glw);\r\n        if (asCurrent) {\r\n            this.__glw = glw;\r\n        }\r\n    }\r\n    get currentWebGLContextWrapper() {\r\n        return this.__glw;\r\n    }\r\n    getResourceNumber() {\r\n        return ++this.__resourceCounter;\r\n    }\r\n    getWebGLResource(WebGLResourceHandle) {\r\n        const result = this.__webglResources.get(WebGLResourceHandle);\r\n        return (result != null) ? result : null;\r\n    }\r\n    createIndexBuffer(accessor) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        this.__glw.bindVertexArray(null);\r\n        const ibo = gl.createBuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, ibo);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\r\n        //    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, accessor.bufferView.buffer.getArrayBuffer(), gl.STATIC_DRAW);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, accessor.getTypedArray(), gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n        return resourceHandle;\r\n    }\r\n    createVertexBuffer(accessor) {\r\n        const gl = this.__glw.getRawContext();\r\n        ;\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        this.__glw.bindVertexArray(null);\r\n        const vbo = gl.createBuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, vbo);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n        gl.bufferData(gl.ARRAY_BUFFER, accessor.bufferView.getUint8Array(), gl.STATIC_DRAW);\r\n        //    gl.bufferData(gl.ARRAY_BUFFER, accessor.getTypedArray(), gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        return resourceHandle;\r\n    }\r\n    createVertexBufferFromTypedArray(typedArray) {\r\n        const gl = this.__glw.getRawContext();\r\n        ;\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        this.__glw.bindVertexArray(null);\r\n        const vbo = gl.createBuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, vbo);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n        gl.bufferData(gl.ARRAY_BUFFER, typedArray, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        return resourceHandle;\r\n    }\r\n    resendVertexBuffer(primitive, vboHandles) {\r\n        const gl = this.__glw.getRawContext();\r\n        ;\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        this.__glw.bindVertexArray(null);\r\n        // const vbo = gl.createBuffer();\r\n        // const resourceHandle = this.getResourceNumber();\r\n        // this.__webglResources.set(resourceHandle, vbo!);\r\n        primitive.attributeAccessors.forEach((accessor, i) => {\r\n            const vbo = this.getWebGLResource(vboHandles[i]);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n            gl.bufferData(gl.ARRAY_BUFFER, accessor.bufferView.getUint8Array(), gl.STATIC_DRAW);\r\n            //    gl.bufferData(gl.ARRAY_BUFFER, accessor.getTypedArray(), gl.STATIC_DRAW);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        });\r\n    }\r\n    createVertexArray() {\r\n        const gl = this.__glw;\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const vao = this.__glw.createVertexArray();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, vao);\r\n        return resourceHandle;\r\n    }\r\n    bindTexture2D(textureSlotIndex, textureUid) {\r\n        const texture = this.getWebGLResource(textureUid);\r\n        this.__glw.bindTexture2D(textureSlotIndex, texture);\r\n    }\r\n    bindTextureCube(textureSlotIndex, textureUid) {\r\n        const texture = this.getWebGLResource(textureUid);\r\n        this.__glw.bindTextureCube(textureSlotIndex, texture);\r\n    }\r\n    createVertexDataResources(primitive) {\r\n        const gl = this.__glw.getRawContext();\r\n        const vaoHandle = this.createVertexArray();\r\n        let iboHandle;\r\n        if (primitive.hasIndices()) {\r\n            iboHandle = this.createIndexBuffer(primitive.indicesAccessor);\r\n        }\r\n        const attributesFlags = [];\r\n        for (let i = 0; i < _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].AttributeTypeNumber; i++) {\r\n            attributesFlags[i] = false;\r\n        }\r\n        const vboHandles = [];\r\n        primitive.attributeAccessors.forEach((accessor, i) => {\r\n            const vboHandle = this.createVertexBuffer(accessor);\r\n            const slotIdx = primitive.attributeSemantics[i].getAttributeSlot();\r\n            attributesFlags[slotIdx] = true;\r\n            vboHandles.push(vboHandle);\r\n        });\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n        return { vaoHandle: vaoHandle, iboHandle: iboHandle, vboHandles: vboHandles, attributesFlags: attributesFlags, setComplete: false };\r\n    }\r\n    createVertexBufferAndIndexBuffer(primitive) {\r\n        const gl = this.__glw.getRawContext();\r\n        let iboHandle;\r\n        if (primitive.hasIndices()) {\r\n            iboHandle = this.createIndexBuffer(primitive.indicesAccessor);\r\n        }\r\n        const attributesFlags = [];\r\n        for (let i = 0; i < _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].AttributeTypeNumber; i++) {\r\n            attributesFlags[i] = false;\r\n        }\r\n        const vboHandles = [];\r\n        primitive.attributeAccessors.forEach((accessor, i) => {\r\n            const vboHandle = this.createVertexBuffer(accessor);\r\n            const slotIdx = primitive.attributeSemantics[i].getAttributeSlot();\r\n            attributesFlags[slotIdx] = true;\r\n            vboHandles.push(vboHandle);\r\n        });\r\n        return { vaoHandle: -1, iboHandle: iboHandle, vboHandles: vboHandles, attributesFlags: attributesFlags, setComplete: false };\r\n    }\r\n    createShaderProgram({ materialTypeName, vertexShaderStr, fragmentShaderStr, attributeNames, attributeSemantics }) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n        gl.shaderSource(vertexShader, vertexShaderStr);\r\n        gl.compileShader(vertexShader);\r\n        if (this.__glw.isDebugMode) {\r\n            this.__checkShaderCompileStatus(materialTypeName, vertexShader, vertexShaderStr);\r\n        }\r\n        const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n        gl.shaderSource(fragmentShader, fragmentShaderStr);\r\n        gl.compileShader(fragmentShader);\r\n        if (this.__glw.isDebugMode) {\r\n            this.__checkShaderCompileStatus(materialTypeName, fragmentShader, fragmentShaderStr);\r\n        }\r\n        const shaderProgram = gl.createProgram();\r\n        shaderProgram._gl = gl;\r\n        shaderProgram._materialTypeName = materialTypeName;\r\n        shaderProgram._vertexShaderStr = vertexShaderStr;\r\n        shaderProgram._fragmentShaderStr = fragmentShaderStr;\r\n        gl.attachShader(shaderProgram, vertexShader);\r\n        gl.attachShader(shaderProgram, fragmentShader);\r\n        attributeNames.forEach((attributeName, i) => {\r\n            gl.bindAttribLocation(shaderProgram, attributeSemantics[i].getAttributeSlot(), attributeName);\r\n        });\r\n        gl.linkProgram(shaderProgram);\r\n        if (this.__glw.isDebugMode) {\r\n            this.__checkShaderProgramLinkStatus(materialTypeName, shaderProgram, vertexShaderStr, fragmentShaderStr);\r\n        }\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, shaderProgram);\r\n        gl.deleteShader(vertexShader);\r\n        gl.deleteShader(fragmentShader);\r\n        return resourceHandle;\r\n    }\r\n    __addLineNumber(shaderString) {\r\n        let shaderTextLines = shaderString.split(/\\r\\n|\\r|\\n/);\r\n        let shaderTextWithLineNumber = '';\r\n        for (let i = 0; i < shaderTextLines.length; i++) {\r\n            let lineIndex = i + 1;\r\n            let splitter = ' : ';\r\n            if (lineIndex < 10) {\r\n                splitter = '  : ';\r\n            }\r\n            else if (lineIndex >= 100) {\r\n                splitter = ': ';\r\n            }\r\n            shaderTextWithLineNumber += lineIndex + splitter + shaderTextLines[i] + '\\n';\r\n        }\r\n        return shaderTextWithLineNumber;\r\n    }\r\n    __checkShaderCompileStatus(materialTypeName, shader, shaderText) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            console.log('MaterialTypeName: ' + materialTypeName);\r\n            console.log(this.__addLineNumber(shaderText));\r\n            throw new Error('An error occurred compiling the shaders:' + gl.getShaderInfoLog(shader));\r\n        }\r\n    }\r\n    __checkShaderProgramLinkStatus(materialTypeName, shaderProgram, vertexShaderText, fragmentShaderText) {\r\n        const gl = this.__glw.getRawContext();\r\n        // If creating the shader program failed, alert\r\n        if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\r\n            console.log('MaterialTypeName: ' + materialTypeName);\r\n            console.log(this.__addLineNumber('Vertex Shader:'));\r\n            console.log(this.__addLineNumber(vertexShaderText));\r\n            console.log(this.__addLineNumber('Fragment Shader:'));\r\n            console.log(this.__addLineNumber(fragmentShaderText));\r\n            throw new Error('Unable to initialize the shader program: ' + gl.getProgramInfoLog(shaderProgram));\r\n        }\r\n    }\r\n    setupUniformLocations(shaderProgramUid, dataArray) {\r\n        const gl = this.__glw.getRawContext();\r\n        const shaderProgram = this.getWebGLResource(shaderProgramUid);\r\n        const shaderSemanticsInfoMap = new Map();\r\n        for (let arg of dataArray) {\r\n            shaderSemanticsInfoMap.set(arg.semantic.str, arg);\r\n        }\r\n        for (let data of dataArray) {\r\n            let semanticSingular = data.semantic.str;\r\n            let identifier = semanticSingular;\r\n            let shaderVarName = _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__[\"ShaderSemantics\"].fullSemanticStr(data);\r\n            if (data.index != null) {\r\n                if (shaderVarName.match(/\\[.+?\\]/)) {\r\n                    shaderVarName = shaderVarName.replace(/\\[.+?\\]/g, `[${data.index}]`);\r\n                }\r\n                else {\r\n                    shaderVarName += `[${data.index}]`;\r\n                }\r\n            }\r\n            if (data.none_u_prefix !== true) {\r\n                shaderVarName = 'u_' + shaderVarName;\r\n            }\r\n            const location = gl.getUniformLocation(shaderProgram, shaderVarName);\r\n            if (data.index != null) {\r\n                if (shaderProgram[identifier] == null) {\r\n                    shaderProgram[identifier] = [];\r\n                }\r\n                shaderProgram[identifier][data.index] = location;\r\n            }\r\n            else {\r\n                shaderProgram[identifier] = location;\r\n            }\r\n        }\r\n        if (shaderProgram._shaderSemanticsInfoMap != null) {\r\n            shaderProgram._shaderSemanticsInfoMap = new Map([...shaderProgram._shaderSemanticsInfoMap, ...shaderSemanticsInfoMap]);\r\n        }\r\n        else {\r\n            shaderProgram._shaderSemanticsInfoMap = shaderSemanticsInfoMap;\r\n        }\r\n        return shaderProgram;\r\n    }\r\n    __isUniformValueDirty(isVector, shaderProgram, identifier, { x, y, z, w }, delta = Number.EPSILON) {\r\n        const valueIdentifier = identifier + '_value';\r\n        const value = shaderProgram[valueIdentifier];\r\n        if (value == null) {\r\n            return true;\r\n        }\r\n        let result = false;\r\n        if (isVector) {\r\n            const length = x.length;\r\n            if (length > 4) {\r\n                return true;\r\n            }\r\n            for (let i = 0; i < length; i++) {\r\n                if (Math.abs(x[i] - value[i]) >= delta) {\r\n                    result = true;\r\n                    break;\r\n                }\r\n            }\r\n            shaderProgram[valueIdentifier] = x;\r\n        }\r\n        else {\r\n            const compare = () => {\r\n                if (x != null && Math.abs(x - value[0]) >= delta) {\r\n                    return true;\r\n                }\r\n                if (y != null && Math.abs(y - value[1]) >= delta) {\r\n                    return true;\r\n                }\r\n                if (z != null && Math.abs(z - value[2]) >= delta) {\r\n                    return true;\r\n                }\r\n                if (w != null && Math.abs(w - value[3]) >= delta) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            };\r\n            result = compare();\r\n            shaderProgram[valueIdentifier] = [x, y, z, w];\r\n        }\r\n        return result;\r\n    }\r\n    setUniformValue(shaderProgram, semanticStr, firstTime, value, index) {\r\n        const info = shaderProgram._shaderSemanticsInfoMap.get(semanticStr);\r\n        if (info == null) {\r\n            return false;\r\n        }\r\n        // if (!firstTime) {\r\n        //   const updateInterval = info.updateInterval!;\r\n        //   if (updateInterval != null && updateInterval === ShaderVariableUpdateInterval.FirstTimeOnly) {\r\n        //     return false;\r\n        //   }\r\n        //   // if (!this.__isUniformValueDirty(isVector, shaderProgram, identifier, {x, y, z, w}, delta)) {\r\n        //   //   return false;\r\n        //   // }\r\n        // }\r\n        let setAsMatrix = false;\r\n        let componentNumber = 0;\r\n        if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Mat3) {\r\n            setAsMatrix = true;\r\n            componentNumber = 3;\r\n        }\r\n        else if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Mat4) {\r\n            setAsMatrix = true;\r\n            componentNumber = 4;\r\n        }\r\n        else {\r\n            componentNumber = info.compositionType.getNumberOfComponents();\r\n        }\r\n        const key = semanticStr;\r\n        let updated = false;\r\n        if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Texture2D || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].TextureCube) {\r\n            updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, false, { x: value[0] }, { firstTime: firstTime }, index);\r\n            this.bindTexture(info, value);\r\n        }\r\n        else if (index == null && (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].ScalarArray || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4Array || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3Array || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec2Array)) {\r\n            if (value.v == null) {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, true, { x: value }, { firstTime: firstTime }, index);\r\n            }\r\n            else {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, true, { x: value.v }, { firstTime: firstTime }, index);\r\n            }\r\n        }\r\n        else if (info.compositionType !== _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar) {\r\n            if (value.v == null) {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, false, value, { firstTime: firstTime }, index);\r\n            }\r\n            else {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, true, { x: value.v }, { firstTime: firstTime }, index);\r\n            }\r\n        }\r\n        else {\r\n            // if CompositionType.Scalar, then...\r\n            if (value.v == null) {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, false, { x: value }, { firstTime: firstTime }, index);\r\n            }\r\n            else {\r\n                updated = this.setUniformValueInner(shaderProgram, key, info, setAsMatrix, componentNumber, true, { x: value.v }, { firstTime: firstTime }, index);\r\n            }\r\n        }\r\n        return updated;\r\n    }\r\n    bindTexture(info, value) {\r\n        if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Texture2D) {\r\n            this.bindTexture2D(value[0], (value[1] instanceof _foundation_textures_AbstractTexture__WEBPACK_IMPORTED_MODULE_9__[\"default\"]) ? value[1].cgApiResourceUid : value[1]);\r\n        }\r\n        else if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].TextureCube) {\r\n            this.bindTextureCube(value[0], (value[1] instanceof _foundation_textures_AbstractTexture__WEBPACK_IMPORTED_MODULE_9__[\"default\"]) ? value[1].cgApiResourceUid : value[1]);\r\n        }\r\n    }\r\n    setUniformValueInner(shaderProgram, semanticStr, info, isMatrix, componentNumber, isVector, { x, y, z, w }, { firstTime = true, delta }, index) {\r\n        let identifier = semanticStr;\r\n        let program;\r\n        if (index != null) {\r\n            program = shaderProgram[identifier][index];\r\n        }\r\n        else {\r\n            program = shaderProgram[identifier];\r\n        }\r\n        const gl = this.__glw.getRawContext();\r\n        if (isMatrix) {\r\n            if (componentNumber === 4) {\r\n                gl.uniformMatrix4fv(program, false, x);\r\n            }\r\n            else {\r\n                gl.uniformMatrix3fv(program, false, x);\r\n            }\r\n        }\r\n        else if (isVector) {\r\n            const componentType = info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Int || info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Short || info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Byte;\r\n            if (componentNumber === 1) {\r\n                if (componentType) {\r\n                    gl.uniform1iv(program, x);\r\n                }\r\n                else {\r\n                    gl.uniform1fv(program, x);\r\n                }\r\n            }\r\n            else if (componentNumber === 2) {\r\n                if (componentType) {\r\n                    gl.uniform2iv(program, x);\r\n                }\r\n                else {\r\n                    gl.uniform2fv(program, x);\r\n                }\r\n            }\r\n            else if (componentNumber === 3) {\r\n                if (componentType) {\r\n                    gl.uniform3iv(program, x);\r\n                }\r\n                else {\r\n                    gl.uniform3fv(program, x);\r\n                }\r\n            }\r\n            else if (componentNumber === 4) {\r\n                if (componentType) {\r\n                    gl.uniform4iv(program, x);\r\n                }\r\n                else {\r\n                    gl.uniform4fv(program, x);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            const componentType = info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Int || info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Short || info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Byte;\r\n            if (componentNumber === 1) {\r\n                if (componentType) {\r\n                    gl.uniform1i(program, x);\r\n                }\r\n                else {\r\n                    gl.uniform1f(program, x);\r\n                }\r\n            }\r\n            else if (componentNumber === 2) {\r\n                if (componentType) {\r\n                    gl.uniform2i(program, x, y);\r\n                }\r\n                else {\r\n                    gl.uniform2f(program, x, y);\r\n                }\r\n            }\r\n            else if (componentNumber === 3) {\r\n                if (componentType) {\r\n                    gl.uniform3i(program, x, y, z);\r\n                }\r\n                else {\r\n                    gl.uniform3f(program, x, y, z);\r\n                }\r\n            }\r\n            else if (componentNumber === 4) {\r\n                if (componentType) {\r\n                    gl.uniform4i(program, x, y, z, w);\r\n                }\r\n                else {\r\n                    gl.uniform4f(program, x, y, z, w);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    setVertexDataToPipeline({ vaoHandle, iboHandle, vboHandles }, primitive, instanceIDBufferUid = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].InvalidCGAPIResourceUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        const vao = this.getWebGLResource(vaoHandle);\r\n        // VAO bind\r\n        this.__glw.bindVertexArray(vao);\r\n        // IBO bind\r\n        if (iboHandle != null) {\r\n            const ibo = this.getWebGLResource(iboHandle);\r\n            if (ibo != null) {\r\n                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\r\n            }\r\n            else {\r\n                throw new Error('Nothing Element Array Buffer!');\r\n            }\r\n        }\r\n        // bind vertex attributes to VBO's\r\n        vboHandles.forEach((vboHandle, i) => {\r\n            const vbo = this.getWebGLResource(vboHandle);\r\n            if (vbo != null) {\r\n                gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n            }\r\n            else {\r\n                throw new Error('Nothing Element Array Buffer at index ' + i);\r\n            }\r\n            gl.enableVertexAttribArray(primitive.attributeSemantics[i].getAttributeSlot());\r\n            gl.vertexAttribPointer(primitive.attributeSemantics[i].getAttributeSlot(), primitive.attributeCompositionTypes[i].getNumberOfComponents(), primitive.attributeComponentTypes[i].index, primitive.attributeAccessors[i].normalized, primitive.attributeAccessors[i].byteStride, primitive.attributeAccessors[i].byteOffsetInBufferView);\r\n        });\r\n        /// for InstanceIDBuffer\r\n        if (instanceIDBufferUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].InvalidCGAPIResourceUid) {\r\n            const instanceIDBuffer = this.getWebGLResource(instanceIDBufferUid);\r\n            if (instanceIDBuffer != null) {\r\n                gl.bindBuffer(gl.ARRAY_BUFFER, instanceIDBuffer);\r\n            }\r\n            else {\r\n                throw new Error('Nothing Element Array Buffer at index');\r\n            }\r\n            gl.enableVertexAttribArray(_foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Instance.getAttributeSlot());\r\n            gl.vertexAttribPointer(_foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Instance.getAttributeSlot(), _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar.getNumberOfComponents(), _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float.index, false, 0, 0);\r\n            this.__glw.vertexAttribDivisor(_foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_1__[\"VertexAttribute\"].Instance.getAttributeSlot(), 1);\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        this.__glw.bindVertexArray(null);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n    }\r\n    createTexture(data, { level, internalFormat, width, height, border, format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha }) {\r\n        const gl = this.__glw.getRawContext();\r\n        const texture = gl.createTexture();\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        this.__glw.bindTexture2D(0, texture);\r\n        if (isPremultipliedAlpha) {\r\n            // gl.texParameteri(gl.TEXTURE_2D, gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\r\n        }\r\n        else {\r\n            // gl.texParameteri(gl.TEXTURE_2D, gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        }\r\n        if (data instanceof HTMLImageElement || data instanceof HTMLCanvasElement) {\r\n            if (this.__glw.isWebGL2) {\r\n                gl.texImage2D(gl.TEXTURE_2D, level, _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].RGBA8.index, width, height, border, format.index, _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedByte.index, data);\r\n            }\r\n            else {\r\n                gl.texImage2D(gl.TEXTURE_2D, level, internalFormat.index, format.index, type.index, data);\r\n            }\r\n        }\r\n        else {\r\n            if (this.__glw.isWebGL2) {\r\n                gl.texImage2D(gl.TEXTURE_2D, level, _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].RGB32F.index, width, height, border, format.index, _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].Float.index, data);\r\n            }\r\n            else {\r\n                gl.texImage2D(gl.TEXTURE_2D, level, internalFormat.index, width, height, border, format.index, type.index, data);\r\n            }\r\n        }\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter.index);\r\n        if (_foundation_math_MathUtil__WEBPACK_IMPORTED_MODULE_7__[\"MathUtil\"].isPowerOfTwoTexture(width, height)) {\r\n            if (anisotropy && this.__glw.webgl1ExtTFA) {\r\n                gl.texParameteri(gl.TEXTURE_2D, this.__glw.webgl1ExtTFA.TEXTURE_MAX_ANISOTROPY_EXT, 4);\r\n            }\r\n            else if (this.__glw.webgl1ExtTFA) {\r\n                gl.texParameteri(gl.TEXTURE_2D, this.__glw.webgl1ExtTFA.TEXTURE_MAX_ANISOTROPY_EXT, 1);\r\n            }\r\n            const isGenerateMipmap = generateMipmap && (height !== 1 && width !== 1 && !(this.__glw.isWebGL2 && _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_14__[\"MiscUtil\"].isMobile()));\r\n            if (isGenerateMipmap) {\r\n                gl.generateMipmap(gl.TEXTURE_2D);\r\n            }\r\n        }\r\n        this.__glw.unbindTexture2D(0);\r\n        return resourceHandle;\r\n    }\r\n    createCompressedTextureFromBasis(basisFile, { border, format, type, magFilter, minFilter, wrapS, wrapT, anisotropy, isPremultipliedAlpha }) {\r\n        let basisCompressionType;\r\n        let compressionType;\r\n        const gl = this.__glw.getRawContext();\r\n        const texture = gl.createTexture();\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        const s3tc = gl.getExtension(\"WEBGL_compressed_texture_s3tc\");\r\n        if (s3tc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].BC3;\r\n            compressionType = s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n        }\r\n        const etc1 = gl.getExtension(\"WEBGL_compressed_texture_etc1\");\r\n        if (etc1) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ETC1;\r\n            compressionType = etc1.COMPRESSED_RGB_ETC1_WEBGL;\r\n        }\r\n        const atc = gl.getExtension(\"WEBGL_compressed_texture_atc\");\r\n        if (atc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ATC_RGBA;\r\n            compressionType = atc.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL;\r\n        }\r\n        const etc2 = gl.getExtension(\"WEBGL_compressed_texture_etc\");\r\n        if (etc2) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ETC2;\r\n            compressionType = etc2.COMPRESSED_RGBA8_ETC2_EAC;\r\n        }\r\n        const pvrtc = gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\");\r\n        if (pvrtc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].PVRTC1_RGBA;\r\n            compressionType = pvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n        }\r\n        const astc = gl.getExtension(\"WEBGL_compressed_texture_astc\");\r\n        if (astc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ASTC;\r\n            compressionType = astc.COMPRESSED_RGBA_ASTC_4x4_KHR;\r\n        }\r\n        const mipmapDepth = basisFile.getNumLevels(0);\r\n        if (isPremultipliedAlpha) {\r\n            // gl.texParameteri(gl.TEXTURE_2D, gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\r\n        }\r\n        else {\r\n            // gl.texParameteri(gl.TEXTURE_2D, gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        }\r\n        for (let i = 0; i < mipmapDepth; i++) {\r\n            const width = basisFile.getImageWidth(0, i);\r\n            const height = basisFile.getImageHeight(0, i);\r\n            const textureSource = this.decodeBasisImage(basisFile, basisCompressionType, 0, i);\r\n            gl.compressedTexImage2D(gl.TEXTURE_2D, i, compressionType, width, height, border, textureSource);\r\n        }\r\n        if (mipmapDepth == 0) {\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n            let minFilter_ = minFilter;\r\n            if (minFilter === _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].LinearMipmapLinear) {\r\n                minFilter_ = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear;\r\n            }\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter_.index);\r\n        }\r\n        else {\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter.index);\r\n            if (anisotropy && this.__glw.webgl1ExtTFA) {\r\n                gl.texParameteri(gl.TEXTURE_2D, this.__glw.webgl1ExtTFA.TEXTURE_MAX_ANISOTROPY_EXT, 4);\r\n            }\r\n        }\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT.index);\r\n        this.__glw.unbindTexture2D(0);\r\n        return resourceHandle;\r\n    }\r\n    decodeBasisImage(basisFile, basisCompressionType, imageIndex, levelIndex) {\r\n        const extractSize = basisFile.getImageTranscodedSizeInBytes(imageIndex, levelIndex, basisCompressionType.index);\r\n        const textureSource = new Uint8Array(extractSize);\r\n        if (!basisFile.transcodeImage(textureSource, imageIndex, levelIndex, basisCompressionType.index, 0, 0)) {\r\n            console.error(\"failed to transcode the image.\");\r\n        }\r\n        return textureSource;\r\n    }\r\n    createFrameBufferObject() {\r\n        const gl = this.__glw.getRawContext();\r\n        var fbo = gl.createFramebuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, fbo);\r\n        return resourceHandle;\r\n    }\r\n    attachColorBufferToFrameBufferObject(framebuffer, index, renderable) {\r\n        const gl = this.__glw.getRawContext();\r\n        const fbo = this.getWebGLResource(framebuffer.framebufferUID);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n        const renderableWebGLResource = this.getWebGLResource(renderable.cgApiResourceUid);\r\n        const attachmentId = this.__glw.colorAttachment(index);\r\n        if (renderable instanceof _foundation_textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_10__[\"default\"]) {\r\n            renderable._fbo = framebuffer;\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentId, gl.TEXTURE_2D, renderableWebGLResource, 0);\r\n        }\r\n        else {\r\n            // It's must be RenderBuffer\r\n            renderable._fbo = framebuffer;\r\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachmentId, gl.RENDERBUFFER, renderableWebGLResource);\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n    attachDepthBufferToFrameBufferObject(framebuffer, renderable) {\r\n        this.__attachDepthOrStencilBufferToFrameBufferObject(framebuffer, renderable, 36096); // gl.DEPTH_ATTACHMENT\r\n    }\r\n    attachStencilBufferToFrameBufferObject(framebuffer, renderable) {\r\n        this.__attachDepthOrStencilBufferToFrameBufferObject(framebuffer, renderable, 36128); // gl.STENCIL_ATTACHMENT\r\n    }\r\n    attachDepthStencilBufferToFrameBufferObject(framebuffer, renderable) {\r\n        this.__attachDepthOrStencilBufferToFrameBufferObject(framebuffer, renderable, 33306); // gl.DEPTH_STENCIL_ATTACHMENT\r\n    }\r\n    __attachDepthOrStencilBufferToFrameBufferObject(framebuffer, renderable, attachmentType) {\r\n        const gl = this.__glw.getRawContext();\r\n        const fbo = this.getWebGLResource(framebuffer.framebufferUID);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n        const renderableWebGLResource = this.getWebGLResource(renderable.cgApiResourceUid);\r\n        if (renderable instanceof _foundation_textures_RenderTargetTexture__WEBPACK_IMPORTED_MODULE_10__[\"default\"]) {\r\n            renderable._fbo = framebuffer;\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.TEXTURE_2D, renderableWebGLResource, 0);\r\n        }\r\n        else {\r\n            // It's must be RenderBuffer\r\n            renderable._fbo = framebuffer;\r\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachmentType, gl.RENDERBUFFER, renderableWebGLResource);\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n    createRenderBuffer(width, height, internalFormat) {\r\n        const gl = this.__glw.getRawContext();\r\n        var renderBuffer = gl.createRenderbuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, renderBuffer);\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\r\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl[internalFormat.str], width, height);\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n        return resourceHandle;\r\n    }\r\n    setDrawTargets(framebuffer) {\r\n        if (framebuffer) {\r\n            this.__glw.drawBuffers(framebuffer.colorAttachmentsRenderBufferTargets);\r\n        }\r\n        else {\r\n            this.__glw.drawBuffers([_foundation_definitions_RenderBufferTarget__WEBPACK_IMPORTED_MODULE_13__[\"RenderBufferTarget\"].Back]);\r\n        }\r\n    }\r\n    bindFramebuffer(framebuffer) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (framebuffer) {\r\n            const fboUid = framebuffer.cgApiResourceUid;\r\n            const fbo = this.getWebGLResource(fboUid);\r\n            gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n        }\r\n        else {\r\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        }\r\n    }\r\n    unbindFramebuffer() {\r\n        const gl = this.__glw.getRawContext();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n    createRenderTargetTexture({ width, height, level, internalFormat, format, type, magFilter, minFilter, wrapS, wrapT }) {\r\n        const gl = this.__glw.getRawContext();\r\n        const texture = gl.createTexture();\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        this.__glw.bindTexture2D(0, texture);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS.index);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT.index);\r\n        if (\r\n        // if WebGL2\r\n        this.__glw.isWebGL2 &&\r\n            // if DEPTH_COMPONENT\r\n            (internalFormat.index === 6402 || internalFormat.index === 33189 ||\r\n                internalFormat.index === 33190 || internalFormat.index === 33191)) {\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_COMPARE_FUNC, gl.LESS);\r\n        }\r\n        if (this.__glw.isWebGL2) {\r\n            gl.texImage2D(gl.TEXTURE_2D, level, _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].RGBA8.index, width, height, 0, format.index, _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedByte.index, null);\r\n        }\r\n        else {\r\n            gl.texImage2D(gl.TEXTURE_2D, level, internalFormat.index, width, height, 0, format.index, type.index, null);\r\n        }\r\n        this.__glw.unbindTexture2D(0);\r\n        return resourceHandle;\r\n    }\r\n    createCubeTexture(mipLevelCount, images, width, height) {\r\n        const gl = this.__glw.getRawContext();\r\n        const texture = gl.createTexture();\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        this.__glw.bindTextureCube(0, texture);\r\n        gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        if (images[0].posX.hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].HDR &&\r\n            this.__glw.isNotSupportWebGL1Extension(_WebGLExtension__WEBPACK_IMPORTED_MODULE_17__[\"WebGLExtension\"].TextureFloatLinear)) {\r\n            if (mipLevelCount >= 2) {\r\n                gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.NEAREST_MIPMAP_NEAREST);\r\n            }\r\n            else {\r\n                gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n            }\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        }\r\n        else {\r\n            if (mipLevelCount >= 2) {\r\n                gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\r\n            }\r\n            else {\r\n                gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n            }\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        }\r\n        const loadImageToGPU = (image, cubeMapSide, i) => {\r\n            if (image.hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].HDR) {\r\n                if (this.__glw.isWebGL2) {\r\n                    gl.texImage2D(cubeMapSide, i, gl.RGB32F, image.width, image.height, 0, gl.RGB, gl.FLOAT, image.dataFloat);\r\n                }\r\n                else {\r\n                    gl.texImage2D(cubeMapSide, i, gl.RGB, image.width, image.height, 0, gl.RGB, gl.FLOAT, image.dataFloat);\r\n                }\r\n            }\r\n            else if (image instanceof HTMLImageElement || image instanceof HTMLCanvasElement) {\r\n                gl.texImage2D(cubeMapSide, i, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n            }\r\n            else {\r\n                gl.texImage2D(cubeMapSide, i, gl.RGBA, width / (i + 1), height / (i + 1), 0, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n            }\r\n        };\r\n        for (let i = 0; i < images.length; i++) {\r\n            const image = images[i];\r\n            loadImageToGPU(image.posX, gl.TEXTURE_CUBE_MAP_POSITIVE_X, i);\r\n            loadImageToGPU(image.negX, gl.TEXTURE_CUBE_MAP_NEGATIVE_X, i);\r\n            loadImageToGPU(image.posY, gl.TEXTURE_CUBE_MAP_POSITIVE_Y, i);\r\n            loadImageToGPU(image.negY, gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, i);\r\n            loadImageToGPU(image.posZ, gl.TEXTURE_CUBE_MAP_POSITIVE_Z, i);\r\n            loadImageToGPU(image.negZ, gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, i);\r\n        }\r\n        this.__glw.unbindTextureCube(0);\r\n        return resourceHandle;\r\n    }\r\n    /**\r\n     * Create Cube Texture from image files.\r\n     * @param baseUri the base uri to load images;\r\n     * @param mipLevelCount the number of mip levels (include root level). if no mipmap, the value should be 1;\r\n     * @returns the WebGLResourceHandle for the generated Cube Texture\r\n     */\r\n    async createCubeTextureFromFiles(baseUri, mipLevelCount, isNamePosNeg, hdriFormat) {\r\n        const gl = this.__glw.getRawContext();\r\n        const imageArgs = [];\r\n        let width = 0;\r\n        let height = 0;\r\n        for (let i = 0; i < mipLevelCount; i++) {\r\n            const loadOneLevel = () => {\r\n                return new Promise((resolve, reject) => {\r\n                    let loadedCount = 0;\r\n                    const images = [];\r\n                    let extension = '.jpg';\r\n                    if (hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].HDR) {\r\n                        extension = '.hdr';\r\n                    }\r\n                    else if (hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].RGBE_PNG) {\r\n                        extension = '.RGBE.PNG';\r\n                    }\r\n                    let posX = '_right_';\r\n                    let negX = '_left_';\r\n                    let posY = '_top_';\r\n                    let negY = '_bottom_';\r\n                    let posZ = '_front_';\r\n                    let negZ = '_back_';\r\n                    if (isNamePosNeg) {\r\n                        posX = '_posx_';\r\n                        negX = '_negx_';\r\n                        posY = '_posy_';\r\n                        negY = '_negy_';\r\n                        posZ = '_posz_';\r\n                        negZ = '_negz_';\r\n                    }\r\n                    let faces = [\r\n                        [baseUri + posX + i + extension, gl.TEXTURE_CUBE_MAP_POSITIVE_X],\r\n                        [baseUri + negX + i + extension, gl.TEXTURE_CUBE_MAP_NEGATIVE_X],\r\n                        [baseUri + posY + i + extension, gl.TEXTURE_CUBE_MAP_POSITIVE_Y],\r\n                        [baseUri + negY + i + extension, gl.TEXTURE_CUBE_MAP_NEGATIVE_Y],\r\n                        [baseUri + posZ + i + extension, gl.TEXTURE_CUBE_MAP_POSITIVE_Z],\r\n                        [baseUri + negZ + i + extension, gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]\r\n                    ];\r\n                    for (var j = 0; j < faces.length; j++) {\r\n                        const face = faces[j][1];\r\n                        let image;\r\n                        if (hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].HDR || hdriFormat === _foundation_definitions_HdriFormat__WEBPACK_IMPORTED_MODULE_11__[\"HdriFormat\"].RGB9_E5_PNG) {\r\n                            image = new HDRImage();\r\n                        }\r\n                        else {\r\n                            image = new Image();\r\n                        }\r\n                        image.hdriFormat = hdriFormat;\r\n                        image.side = face;\r\n                        image.uri = faces[j][0];\r\n                        image.crossOrigin = \"Anonymous\";\r\n                        image.onload = () => {\r\n                            loadedCount++;\r\n                            images.push(image);\r\n                            if (loadedCount === 6) {\r\n                                resolve(images);\r\n                            }\r\n                        };\r\n                        image.onerror = () => {\r\n                            reject(image.uri);\r\n                        };\r\n                        image.src = faces[j][0];\r\n                    }\r\n                });\r\n            };\r\n            let images;\r\n            try {\r\n                images = await loadOneLevel();\r\n            }\r\n            catch (e) {\r\n                // Try again once\r\n                try {\r\n                    images = await loadOneLevel();\r\n                }\r\n                catch (uri) {\r\n                    // Give up\r\n                    console.error(`failed to load ${uri}`);\r\n                }\r\n            }\r\n            const imageObj = {};\r\n            for (let image of images) {\r\n                switch (image.side) {\r\n                    case gl.TEXTURE_CUBE_MAP_POSITIVE_X:\r\n                        imageObj.posX = image;\r\n                        break;\r\n                    case gl.TEXTURE_CUBE_MAP_POSITIVE_Y:\r\n                        imageObj.posY = image;\r\n                        break;\r\n                    case gl.TEXTURE_CUBE_MAP_POSITIVE_Z:\r\n                        imageObj.posZ = image;\r\n                        break;\r\n                    case gl.TEXTURE_CUBE_MAP_NEGATIVE_X:\r\n                        imageObj.negX = image;\r\n                        break;\r\n                    case gl.TEXTURE_CUBE_MAP_NEGATIVE_Y:\r\n                        imageObj.negY = image;\r\n                        break;\r\n                    case gl.TEXTURE_CUBE_MAP_NEGATIVE_Z:\r\n                        imageObj.negZ = image;\r\n                        break;\r\n                }\r\n                if (i === 0) {\r\n                    width = image.width;\r\n                    height = image.height;\r\n                }\r\n            }\r\n            imageArgs.push(imageObj);\r\n        }\r\n        return this.createCubeTexture(mipLevelCount, imageArgs, width, height);\r\n    }\r\n    createCubeTextureFromBasis(basisFile, { magFilter = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear, minFilter = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].LinearMipmapLinear, wrapS = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, wrapT = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Repeat, border = 0 }) {\r\n        const gl = this.__glw.getRawContext();\r\n        let basisCompressionType;\r\n        let compressionType;\r\n        const texture = gl.createTexture();\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        this.__glw.bindTextureCube(0, texture);\r\n        const s3tc = gl.getExtension(\"WEBGL_compressed_texture_s3tc\");\r\n        if (s3tc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].BC3;\r\n            compressionType = s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n        }\r\n        const etc1 = gl.getExtension(\"WEBGL_compressed_texture_etc1\");\r\n        if (etc1) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ETC1;\r\n            compressionType = etc1.COMPRESSED_RGB_ETC1_WEBGL;\r\n        }\r\n        const atc = gl.getExtension(\"WEBGL_compressed_texture_atc\");\r\n        if (atc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ATC_RGBA;\r\n            compressionType = atc.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL;\r\n        }\r\n        const etc2 = gl.getExtension(\"WEBGL_compressed_texture_etc\");\r\n        if (etc2) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ETC2;\r\n            compressionType = etc2.COMPRESSED_RGBA8_ETC2_EAC;\r\n        }\r\n        const pvrtc = gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\");\r\n        if (pvrtc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].PVRTC1_RGBA;\r\n            compressionType = pvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n        }\r\n        const astc = gl.getExtension(\"WEBGL_compressed_texture_astc\");\r\n        if (astc) {\r\n            basisCompressionType = _foundation_definitions_BasisCompressionType__WEBPACK_IMPORTED_MODULE_16__[\"BasisCompressionType\"].ASTC;\r\n            compressionType = astc.COMPRESSED_RGBA_ASTC_4x4_KHR;\r\n        }\r\n        const numImages = basisFile.getNumImages();\r\n        const mipmapDepth = basisFile.getNumLevels(0);\r\n        gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, wrapS.index);\r\n        gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, wrapT.index);\r\n        if (mipmapDepth >= 2) {\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, minFilter.index);\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n        }\r\n        else {\r\n            let minFilter_ = minFilter;\r\n            if (minFilter === _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].LinearMipmapLinear) {\r\n                minFilter_ = _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Linear;\r\n            }\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, minFilter_.index);\r\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, magFilter.index);\r\n        }\r\n        for (let i = 0; i < mipmapDepth; i++) {\r\n            for (let j = 0; j < numImages; j++) {\r\n                const width = basisFile.getImageWidth(j, i);\r\n                const height = basisFile.getImageHeight(j, i);\r\n                const textureSource = this.decodeBasisImage(basisFile, basisCompressionType, j, i);\r\n                gl.compressedTexImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + j, i, compressionType, width, height, border, textureSource);\r\n            }\r\n        }\r\n        this.__glw.unbindTextureCube(0);\r\n        return resourceHandle;\r\n    }\r\n    createDummyBlackCubeTexture() {\r\n        const base64 = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPj/HwADBwIAMCbHYQAAAABJRU5ErkJggg==';\r\n        const arrayBuffer = this.__createDummyTextureInner(base64);\r\n        const typedArray = new Uint8Array(arrayBuffer);\r\n        return this.createCubeTexture(1, [{ posX: typedArray, negX: typedArray, posY: typedArray, negY: typedArray, posZ: typedArray, negZ: typedArray }], 1, 1);\r\n    }\r\n    createDummyCubeTexture(rgbaStr = 'rgba(0,0,0,1)') {\r\n        var canvas = document.createElement(\"canvas\");\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.fillStyle = rgbaStr;\r\n        ctx.fillRect(0, 0, 1, 1);\r\n        return this.createCubeTexture(1, [{ posX: canvas, negX: canvas, posY: canvas, negY: canvas, posZ: canvas, negZ: canvas }], 1, 1);\r\n    }\r\n    setWebGLTextureDirectly(webGLTexture) {\r\n        const texture = webGLTexture;\r\n        const resourceHandle = this.getResourceNumber();\r\n        texture._resourceUid = resourceHandle;\r\n        this.__webglResources.set(resourceHandle, texture);\r\n        return resourceHandle;\r\n    }\r\n    async createTextureFromDataUri(dataUri, { level, internalFormat, border, format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha }) {\r\n        return new Promise((resolve) => {\r\n            const img = new Image();\r\n            if (!dataUri.match(/^data:/)) {\r\n                img.crossOrigin = 'Anonymous';\r\n            }\r\n            img.onload = () => {\r\n                const width = img.width;\r\n                const height = img.height;\r\n                let texture = this.createTexture(img, { level, internalFormat, width, height, border, format, type, magFilter, minFilter, wrapS, wrapT, generateMipmap, anisotropy, isPremultipliedAlpha });\r\n                resolve(texture);\r\n            };\r\n            img.src = dataUri;\r\n        });\r\n    }\r\n    updateTexture(textureUid, typedArray, { level, xoffset, yoffset, width, height, format, type }) {\r\n        const gl = this.__glw.getRawContext();\r\n        ;\r\n        const texture = this.getWebGLResource(textureUid);\r\n        this.__glw.bindTexture2D(0, texture);\r\n        gl.texSubImage2D(gl.TEXTURE_2D, level, 0, 0, width, height, format.index, type.index, typedArray);\r\n        this.__glw.unbindTexture2D(0);\r\n    }\r\n    deleteFrameBufferObject(frameBufferObjectHandle) {\r\n        const fbo = this.getWebGLResource(frameBufferObjectHandle);\r\n        const gl = this.__glw.getRawContext();\r\n        if (fbo != null) {\r\n            gl.deleteFramebuffer(fbo);\r\n            this.__webglResources.delete(frameBufferObjectHandle);\r\n        }\r\n    }\r\n    deleteRenderBuffer(renderBufferUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        const renderBuffer = this.getWebGLResource(renderBufferUid);\r\n        gl.deleteRenderbuffer(renderBuffer);\r\n        this.__webglResources.delete(renderBufferUid);\r\n    }\r\n    deleteTexture(textureHandle) {\r\n        const texture = this.getWebGLResource(textureHandle);\r\n        const gl = this.__glw.getRawContext();\r\n        if (texture != null) {\r\n            gl.deleteTexture(texture);\r\n            this.__webglResources.delete(textureHandle);\r\n        }\r\n    }\r\n    createDummyTexture(rgbaStr = \"rgba(255,255,255,1)\") {\r\n        var canvas = document.createElement(\"canvas\");\r\n        canvas.width = 1;\r\n        canvas.height = 1;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.fillStyle = rgbaStr;\r\n        ctx.fillRect(0, 0, 1, 1);\r\n        return this.createTexture(canvas, {\r\n            level: 0, internalFormat: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_3__[\"PixelFormat\"].RGBA, width: 1, height: 1,\r\n            border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_3__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedByte, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest,\r\n            wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: false\r\n        });\r\n    }\r\n    createDummyBlackTexture() {\r\n        const base64 = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPj/HwADBwIAMCbHYQAAAABJRU5ErkJggg==';\r\n        return this.__createDummyTextureInner(base64);\r\n    }\r\n    createDummyWhiteTexture() {\r\n        const base64 = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5/hPwAIAgL/4d1j8wAAAABJRU5ErkJggg==';\r\n        return this.__createDummyTextureInner(base64);\r\n    }\r\n    createDummyNormalTexture() {\r\n        const base64 = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mOsr///HwAGgAL+v1RumAAAAABJRU5ErkJggg==';\r\n        return this.__createDummyTextureInner(base64);\r\n    }\r\n    __createDummyTextureInner(base64) {\r\n        const arrayBuffer = _foundation_misc_DataUtil__WEBPACK_IMPORTED_MODULE_15__[\"default\"].base64ToArrayBuffer(base64);\r\n        return this.createTexture(new Uint8Array(arrayBuffer), {\r\n            level: 0, internalFormat: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_3__[\"PixelFormat\"].RGBA, width: 1, height: 1,\r\n            border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_3__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_5__[\"ComponentType\"].UnsignedByte, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].Nearest,\r\n            wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_2__[\"TextureParameter\"].ClampToEdge, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: false\r\n        });\r\n    }\r\n    createUniformBuffer(bufferView) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const ubo = gl.createBuffer();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, ubo);\r\n        gl.bindBuffer(gl.UNIFORM_BUFFER, ubo);\r\n        gl.bufferData(gl.UNIFORM_BUFFER, bufferView, gl.DYNAMIC_DRAW);\r\n        gl.bindBuffer(gl.UNIFORM_BUFFER, null);\r\n        return resourceHandle;\r\n    }\r\n    updateUniformBuffer(uboUid, bufferView) {\r\n        const gl = this.__glw.getRawContext();\r\n        const ubo = this.getWebGLResource(uboUid);\r\n        gl.bindBuffer(gl.UNIFORM_BUFFER, ubo);\r\n        gl.bufferSubData(gl.UNIFORM_BUFFER, 0, bufferView, 0);\r\n        gl.bindBuffer(gl.UNIFORM_BUFFER, null);\r\n    }\r\n    bindUniformBlock(shaderProgramUid, blockName, blockIndex) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const shaderProgram = this.getWebGLResource(shaderProgramUid);\r\n        const block = gl.getUniformBlockIndex(shaderProgram, blockName);\r\n        gl.uniformBlockBinding(shaderProgram, block, blockIndex);\r\n    }\r\n    bindUniformBufferBase(blockIndex, uboUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            throw new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const ubo = this.getWebGLResource(uboUid);\r\n        gl.bindBufferBase(gl.UNIFORM_BUFFER, blockIndex, ubo);\r\n    }\r\n    deleteUniformBuffer(uboUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        if (gl == null) {\r\n            new Error(\"No WebGLRenderingContext set as Default.\");\r\n        }\r\n        const ubo = this.getWebGLResource(uboUid);\r\n        this.__webglResources.delete(uboUid);\r\n        gl.deleteBuffer(ubo);\r\n    }\r\n    createTransformFeedback() {\r\n        const gl = this.__glw.getRawContext();\r\n        var transformFeedback = gl.createTransformFeedback();\r\n        const resourceHandle = this.getResourceNumber();\r\n        this.__webglResources.set(resourceHandle, transformFeedback);\r\n        gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK, transformFeedback);\r\n        return resourceHandle;\r\n    }\r\n    deleteTransformFeedback(transformFeedbackUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        const transformFeedback = this.getWebGLResource(transformFeedbackUid);\r\n        gl.deleteTransformFeedback(transformFeedback);\r\n        this.__webglResources.delete(transformFeedbackUid);\r\n    }\r\n    setViewport(viewport) {\r\n        var _a, _b;\r\n        if (viewport) {\r\n            (_a = this.__glw) === null || _a === void 0 ? void 0 : _a.setViewportAsVector4(viewport);\r\n        }\r\n        else {\r\n            (_b = this.__glw) === null || _b === void 0 ? void 0 : _b.setViewport(0, 0, this.__glw.width, this.__glw.height);\r\n        }\r\n    }\r\n    clearFrameBuffer(renderPass) {\r\n        const gl = this.__glw.getRawContext();\r\n        let bufferBit = 0;\r\n        if (renderPass.toClearColorBuffer) {\r\n            gl.clearColor(renderPass.clearColor.x, renderPass.clearColor.y, renderPass.clearColor.z, renderPass.clearColor.w);\r\n            bufferBit |= gl.COLOR_BUFFER_BIT;\r\n        }\r\n        if (renderPass.toClearDepthBuffer) {\r\n            gl.clearDepth(renderPass.clearDepth);\r\n            bufferBit |= gl.DEPTH_BUFFER_BIT;\r\n        }\r\n        if (renderPass.toClearStencilBuffer) {\r\n            gl.clearStencil(renderPass.clearStencil);\r\n            bufferBit |= gl.STENCIL_BUFFER_BIT;\r\n        }\r\n        if (bufferBit !== 0) {\r\n            gl.clear(bufferBit);\r\n        }\r\n    }\r\n    deleteVertexDataResources(vertexHandles) {\r\n        const gl = this.__glw.getRawContext();\r\n        const iboHandle = vertexHandles.iboHandle;\r\n        if (iboHandle) {\r\n            const ibo = this.getWebGLResource(iboHandle);\r\n            gl.deleteBuffer(ibo);\r\n        }\r\n        const vboHandles = vertexHandles.vboHandles;\r\n        for (let vboHandle of vboHandles) {\r\n            const vbo = this.getWebGLResource(vboHandle);\r\n            gl.deleteBuffer(vbo);\r\n        }\r\n        const vaoHandle = vertexHandles.vaoHandle;\r\n        const vao = this.getWebGLResource(vaoHandle);\r\n        this.__glw.deleteVertexArray(vao);\r\n    }\r\n    deleteVertexArray(vaoHandle) {\r\n        const vao = this.getWebGLResource(vaoHandle);\r\n        this.__glw.deleteVertexArray(vao);\r\n    }\r\n    deleteVertexBuffer(vboUid) {\r\n        const gl = this.__glw.getRawContext();\r\n        const vbo = this.getWebGLResource(vboUid);\r\n        gl.deleteBuffer(vbo);\r\n    }\r\n    resizeCanvas(width, height) {\r\n        this.__glw.width = width;\r\n        this.__glw.height = height;\r\n        this.__glw.canvas.width = width;\r\n        this.__glw.canvas.height = height;\r\n        this.__glw.setViewportAsVector4(new _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_12__[\"default\"](0, 0, width, height));\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLResourceRepository.ts?");

/***/ }),

/***/ "./src/webgl/WebGLStrategyCommonMethod.ts":
/*!************************************************!*\
  !*** ./src/webgl/WebGLStrategyCommonMethod.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _foundation_definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/definitions/AlphaMode */ \"./src/foundation/definitions/AlphaMode.ts\");\n/* harmony import */ var _foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/components/MeshRendererComponent */ \"./src/foundation/components/MeshRendererComponent.ts\");\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n\r\n\r\n\r\nlet lastIsTransparentMode;\r\nlet lastBlendEquationMode;\r\nlet lastBlendEquationModeAlpha;\r\nlet lastBlendFuncSrcFactor;\r\nlet lastBlendFuncDstFactor;\r\nlet lastBlendFuncAlphaSrcFactor;\r\nlet lastBlendFuncAlphaDstFactor;\r\nlet lastCullFace;\r\nlet lastFrontFaceCCW;\r\nfunction setCullAndBlendSettings(material, renderPass, gl) {\r\n    const cullFace = material.cullFace;\r\n    const cullFrontFaceCCW = material.cullFrontFaceCCW;\r\n    setCull(cullFace, cullFrontFaceCCW, gl);\r\n    setBlendSettings(material, gl);\r\n}\r\nfunction setCull(cullFace, cullFrontFaceCCW, gl) {\r\n    if (lastCullFace !== cullFace) {\r\n        if (cullFace) {\r\n            gl.enable(gl.CULL_FACE);\r\n        }\r\n        else {\r\n            gl.disable(gl.CULL_FACE);\r\n        }\r\n        lastCullFace = cullFace;\r\n    }\r\n    if (cullFace === true && lastFrontFaceCCW !== cullFrontFaceCCW) {\r\n        if (cullFrontFaceCCW) {\r\n            gl.frontFace(gl.CCW);\r\n        }\r\n        else {\r\n            gl.frontFace(gl.CW);\r\n        }\r\n        lastFrontFaceCCW = cullFrontFaceCCW;\r\n    }\r\n}\r\nfunction setBlendSettings(material, gl) {\r\n    const isBlendMode = material.isBlend();\r\n    if (lastIsTransparentMode !== isBlendMode) {\r\n        if (isBlendMode) {\r\n            gl.enable(gl.BLEND);\r\n        }\r\n        else {\r\n            gl.disable(gl.BLEND);\r\n        }\r\n        lastIsTransparentMode = isBlendMode;\r\n    }\r\n    if (material.alphaMode === _foundation_definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_0__[\"AlphaMode\"].Translucent) {\r\n        setBlendEquationMode(material.blendEquationMode, material.blendEquationModeAlpha, gl);\r\n        setBlendFuncSrcFactor(material.blendFuncSrcFactor, material.blendFuncDstFactor, material.blendFuncAlphaSrcFactor, material.blendFuncAlphaDstFactor, gl);\r\n    }\r\n    else if (material.alphaMode === _foundation_definitions_AlphaMode__WEBPACK_IMPORTED_MODULE_0__[\"AlphaMode\"].Additive) {\r\n        setBlendEquationMode(32774, null, gl); // gl.FUNC_ADD\r\n        setBlendFuncSrcFactor(1, 1, null, null, gl); // gl.ONE\r\n    }\r\n}\r\nfunction setBlendEquationMode(blendEquationMode, blendEquationModeAlpha, gl) {\r\n    const needUpdateBlendEquation = differentWithLastBlendEquation(blendEquationMode, blendEquationModeAlpha);\r\n    if (needUpdateBlendEquation) {\r\n        if (blendEquationModeAlpha != null) {\r\n            gl.blendEquationSeparate(blendEquationMode, blendEquationModeAlpha);\r\n        }\r\n        else {\r\n            gl.blendEquation(blendEquationMode);\r\n        }\r\n        lastBlendEquationMode = blendEquationMode;\r\n        lastBlendEquationModeAlpha = blendEquationModeAlpha;\r\n    }\r\n}\r\nfunction differentWithLastBlendEquation(equationMode, equationModeAlpha) {\r\n    const result = (lastBlendEquationMode != equationMode ||\r\n        lastBlendEquationModeAlpha != equationModeAlpha);\r\n    return result;\r\n}\r\nfunction setBlendFuncSrcFactor(blendFuncSrcFactor, blendFuncDstFactor, blendFuncAlphaSrcFactor, blendFuncAlphaDstFactor, gl) {\r\n    const needUpdateBlendFunc = differentWithLastBlendFuncFactor(blendFuncSrcFactor, blendFuncDstFactor, blendFuncAlphaSrcFactor, blendFuncAlphaDstFactor);\r\n    if (needUpdateBlendFunc) {\r\n        if (blendFuncAlphaSrcFactor != null) {\r\n            gl.blendFuncSeparate(blendFuncSrcFactor, blendFuncDstFactor, blendFuncAlphaSrcFactor, blendFuncAlphaDstFactor);\r\n        }\r\n        else {\r\n            gl.blendFunc(blendFuncSrcFactor, blendFuncDstFactor);\r\n        }\r\n        lastBlendFuncSrcFactor = blendFuncSrcFactor;\r\n        lastBlendFuncDstFactor = blendFuncDstFactor;\r\n        lastBlendFuncAlphaSrcFactor = blendFuncAlphaSrcFactor;\r\n        lastBlendFuncAlphaDstFactor = blendFuncAlphaDstFactor;\r\n    }\r\n}\r\nfunction differentWithLastBlendFuncFactor(srcFactor, dstFactor, alphaSrcFactor, alphaDstFactor) {\r\n    const result = (lastBlendFuncSrcFactor != srcFactor ||\r\n        lastBlendFuncDstFactor != dstFactor ||\r\n        lastBlendFuncAlphaSrcFactor != alphaSrcFactor ||\r\n        lastBlendFuncAlphaDstFactor != alphaDstFactor);\r\n    return result;\r\n}\r\nfunction startDepthMasking(idx, gl, renderPass) {\r\n    if (_foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isDepthMaskTrueForTransparencies) {\r\n        return;\r\n    }\r\n    if (idx === _foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].firstTransparentIndex) {\r\n        gl.depthMask(false);\r\n    }\r\n}\r\nfunction endDepthMasking(idx, gl, renderPass) {\r\n    if (idx === _foundation_components_MeshRendererComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].lastTransparentIndex) {\r\n        gl.depthMask(true);\r\n    }\r\n}\r\nfunction isMeshSetup(meshComponent) {\r\n    if (meshComponent.mesh.variationVBOUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid) {\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        let count = 0;\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            if (primitive.vertexHandles != null) {\r\n                count++;\r\n            }\r\n        }\r\n        if (primitiveNum === count) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nfunction isMaterialsSetup(meshComponent) {\r\n    if (meshComponent.mesh.variationVBOUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid) {\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        let count = 0;\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            if (primitive.material != null && primitive.material._shaderProgramUid !== -1) {\r\n                count++;\r\n            }\r\n        }\r\n        if (primitiveNum === count) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object.freeze({ setCullAndBlendSettings, startDepthMasking, endDepthMasking, isMeshSetup, isMaterialsSetup }));\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLStrategyCommonMethod.ts?");

/***/ }),

/***/ "./src/webgl/WebGLStrategyFastestWebGL1.ts":
/*!*************************************************!*\
  !*** ./src/webgl/WebGLStrategyFastestWebGL1.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WebGLStrategyFastestWebGL1; });\n/* harmony import */ var _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLResourceRepository */ \"./src/webgl/WebGLResourceRepository.ts\");\n/* harmony import */ var _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _foundation_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../foundation/components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../foundation/definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _foundation_materials_core_Material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../foundation/materials/core/Material */ \"./src/foundation/materials/core/Material.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_core_Component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../foundation/core/Component */ \"./src/foundation/core/Component.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../foundation/core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../foundation/definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../foundation/components/LightComponent */ \"./src/foundation/components/LightComponent.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../foundation/components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n/* harmony import */ var _foundation_core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../foundation/core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../foundation/misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n/* harmony import */ var _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./WebGLStrategyCommonMethod */ \"./src/webgl/WebGLStrategyCommonMethod.ts\");\n/* harmony import */ var _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../foundation/definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../foundation/system/ModuleManager */ \"./src/foundation/system/ModuleManager.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass WebGLStrategyFastestWebGL1 {\r\n    constructor() {\r\n        this.__webglResourceRepository = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        this.__dataTextureUid = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__lastShader = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__lastRenderPassTickCount = -1;\r\n    }\r\n    get vertexShaderMethodDefinitions_dataTexture() {\r\n        return `\n\n  mat4 get_worldMatrix(float instanceId)\n  {\n    highp float index = ${_foundation_core_Component__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getLocationOffsetOfMemberOfComponent(_foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_12__[\"default\"], 'worldMatrix')}.0 + 4.0 * instanceId;\n    highp float powWidthVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength}.0;\n    highp float powHeightVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength}.0;\n    vec2 arg = vec2(1.0/powWidthVal, 1.0/powHeightVal);\n    // highp vec2 arg = vec2(1.0/powWidthVal, 1.0/powWidthVal/powHeightVal);\n\n    vec4 col0 = fetchElement(u_dataTexture, index + 0.0, arg);\n    vec4 col1 = fetchElement(u_dataTexture, index + 1.0, arg);\n    vec4 col2 = fetchElement(u_dataTexture, index + 2.0, arg);\n    vec4 col3 = fetchElement(u_dataTexture, index + 3.0, arg);\n\n    mat4 matrix = mat4(\n      col0.x, col0.y, col0.z, col0.w,\n      col1.x, col1.y, col1.z, col1.w,\n      col2.x, col2.y, col2.z, col2.w,\n      col3.x, col3.y, col3.z, col3.w\n      );\n\n    return matrix;\n  }\n\n\n  mat3 get_normalMatrix(float instanceId) {\n    float index = ${_foundation_core_Component__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getLocationOffsetOfMemberOfComponent(_foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_12__[\"default\"], 'normalMatrix')}.0 + 3.0 * instanceId;\n    float powWidthVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength}.0;\n    float powHeightVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength}.0;\n    vec2 arg = vec2(1.0/powWidthVal, 1.0/powHeightVal);\n  //  vec2 arg = vec2(1.0/powWidthVal, 1.0/powWidthVal/powHeightVal);\n\n    vec4 col0 = fetchElement(u_dataTexture, index + 0.0, arg);\n    vec4 col1 = fetchElement(u_dataTexture, index + 1.0, arg);\n    vec4 col2 = fetchElement(u_dataTexture, index + 2.0, arg);\n\n    mat3 matrix = mat3(\n      col0.x, col0.y, col0.z,\n      col0.w, col1.x, col1.y,\n      col1.z, col1.w, col2.x\n      );\n\n    return matrix;\n  }\n\n#ifdef RN_IS_MORPHING\n  vec3 get_position(float vertexId, vec3 basePosition) {\n    vec3 position = basePosition;\n    for (int i=0; i<${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_16__[\"default\"].maxVertexMorphNumberInShader}; i++) {\n      float index = u_dataTextureMorphOffsetPosition[i] + 1.0 * vertexId;\n      float powWidthVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength}.0;\n      float powHeightVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength}.0;\n      vec2 arg = vec2(1.0/powWidthVal, 1.0/powHeightVal);\n    //  vec2 arg = vec2(1.0/powWidthVal, 1.0/powWidthVal/powHeightVal);\n      vec3 addPos = fetchElement(u_dataTexture, index + 0.0, arg).xyz;\n      position += addPos * u_morphWeights[i];\n      if (i == u_morphTargetNumber-1) {\n        break;\n      }\n    }\n\n    return position;\n  }\n#endif\n  `;\r\n    }\r\n    setupShaderProgram(meshComponent) {\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            const material = primitive.material;\r\n            if (material == null || material.isEmptyMaterial()) {\r\n                continue;\r\n            }\r\n            if (material._shaderProgramUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].InvalidCGAPIResourceUid) {\r\n                continue;\r\n            }\r\n            const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n            const gl = glw.getRawContext();\r\n            const isPointSprite = primitive.primitiveMode.index === gl.POINTS;\r\n            try {\r\n                this.setupDefaultShaderSemantics(material, isPointSprite);\r\n                primitive._backupMaterial();\r\n            }\r\n            catch (e) {\r\n                console.log(e);\r\n                primitive._restoreMaterial();\r\n                this.setupDefaultShaderSemantics(primitive._prevMaterial, isPointSprite);\r\n            }\r\n        }\r\n    }\r\n    setupDefaultShaderSemantics(material, isPointSprite) {\r\n        material.createProgram(this.vertexShaderMethodDefinitions_dataTexture, this.__getShaderProperty);\r\n        if (isPointSprite) {\r\n            this.__webglResourceRepository.setupUniformLocations(material._shaderProgramUid, [\r\n                {\r\n                    semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__[\"ShaderSemantics\"].PointSize, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Scalar, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                    stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_14__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_VALUE, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_22__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n                },\r\n                {\r\n                    semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__[\"ShaderSemantics\"].PointDistanceAttenuation, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec3, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float,\r\n                    stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_14__[\"ShaderType\"].PixelShader, min: 0, max: 1, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_22__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n                },\r\n            ]);\r\n        }\r\n        material.setUniformLocations(material._shaderProgramUid);\r\n        const shaderProgram = this.__webglResourceRepository.getWebGLResource(material._shaderProgramUid);\r\n        const gl = this.__webglResourceRepository.currentWebGLContextWrapper.getRawContext();\r\n        shaderProgram.dataTexture = gl.getUniformLocation(shaderProgram, 'u_dataTexture');\r\n        shaderProgram.currentComponentSIDs = gl.getUniformLocation(shaderProgram, 'u_currentComponentSIDs');\r\n    }\r\n    static __getOffsetOfShaderSemanticsInfo(info) {\r\n        let offset = 1;\r\n        switch (info.compositionType) {\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4Array:\r\n                offset = 4;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat3:\r\n                offset = 3;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat2:\r\n                offset = 2;\r\n                break;\r\n            default:\r\n            // console.error('unknown composition type', info.compositionType.str, memberName);\r\n            // return '';\r\n        }\r\n        return offset;\r\n    }\r\n    __getShaderProperty(materialTypeName, info, propertyIndex, isGlobalData) {\r\n        const returnType = info.compositionType.getGlslStr(info.componentType);\r\n        const indexArray = [];\r\n        let maxIndex = 1;\r\n        let indexStr;\r\n        const isTexture = info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Texture2D || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].TextureCube;\r\n        const methodName = info.semantic.str.replace('.', '_');\r\n        // definition of uniform variable\r\n        let varDef = '';\r\n        //      if (isTexture) {\r\n        const varType = info.compositionType.getGlslStr(info.componentType);\r\n        let varIndexStr = '';\r\n        if (info.maxIndex) {\r\n            varIndexStr = `[${info.maxIndex}]`;\r\n        }\r\n        if (info.needUniformInFastest || isTexture) {\r\n            varDef = `  uniform ${varType} u_${methodName}${varIndexStr};\\n`;\r\n        }\r\n        //    }\r\n        // inner contents of 'get_' shader function\r\n        if (propertyIndex < 0) {\r\n            if (Math.abs(propertyIndex) % _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__[\"ShaderSemanticsClass\"]._scale !== 0) {\r\n                return '';\r\n            }\r\n            const offset = WebGLStrategyFastestWebGL1.__getOffsetOfShaderSemanticsInfo(info);\r\n            for (let i = 0; i < info.maxIndex; i++) {\r\n                const index = _foundation_materials_core_Material__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getLocationOffsetOfMemberOfMaterial(materialTypeName, propertyIndex);\r\n                indexArray.push(index);\r\n            }\r\n            maxIndex = info.maxIndex;\r\n            let arrayStr = `highp float indices[${maxIndex}];`;\r\n            indexArray.forEach((idx, i) => {\r\n                arrayStr += `\\nindices[${i}] = ${idx}.0;`;\r\n            });\r\n            indexStr = `\n        ${arrayStr}\n        highp float idx = 0.0;\n        for (int i=0; i<${maxIndex}; i++) {\n          idx = indices[i] + ${offset}.0 * instanceId;\n          if (i == index) {\n            break;\n          }\n        }`;\r\n        }\r\n        else {\r\n            const typeSize = WebGLStrategyFastestWebGL1.__getOffsetOfShaderSemanticsInfo(info);\r\n            let dataBeginPos = -1;\r\n            if (isGlobalData) {\r\n                const globalDataRepository = _foundation_core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_18__[\"default\"].getInstance();\r\n                dataBeginPos = globalDataRepository.getLocationOffsetOfProperty(propertyIndex);\r\n                //        let maxCount = globalDataRepository.getGlobalPropertyStruct(propertyIndex)!.maxCount;\r\n            }\r\n            else {\r\n                dataBeginPos = _foundation_materials_core_Material__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getLocationOffsetOfMemberOfMaterial(materialTypeName, propertyIndex);\r\n            }\r\n            let instanceSize = typeSize;\r\n            if (_foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].isArray(info.compositionType)) {\r\n                if (info.maxIndex != null) {\r\n                    instanceSize = typeSize * info.maxIndex;\r\n                }\r\n            }\r\n            if (_foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].isArray(info.compositionType)) {\r\n                indexStr = `highp float idx = ${dataBeginPos}.0 + ${instanceSize}.0 * instanceId + ${typeSize}.0 * float(index);`;\r\n            }\r\n            else if (info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4 || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat3 || info.compositionType === _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat2) {\r\n                indexStr = `highp float idx = ${dataBeginPos}.0 + ${instanceSize}.0 * instanceId;`;\r\n            }\r\n            else {\r\n                indexStr = `highp float idx = ${dataBeginPos}.0 + instanceId;`;\r\n            }\r\n        }\r\n        let intStr = '';\r\n        if (info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int && info.compositionType !== _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Scalar) {\r\n            intStr = 'i';\r\n        }\r\n        let firstPartOfInnerFunc = '';\r\n        if (!isTexture) {\r\n            firstPartOfInnerFunc += `\n${returnType} get_${methodName}(highp float instanceId, const int index) {\n  ${indexStr}\n  highp float powWidthVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength}.0;\n  highp float powHeightVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength}.0;\n  highp vec2 arg = vec2(1.0/powWidthVal, 1.0/powHeightVal);\n  highp vec4 col0 = fetchElement(u_dataTexture, idx + 0.0, arg);\n`;\r\n        }\r\n        let str = `${varDef}${firstPartOfInnerFunc}`;\r\n        switch (info.compositionType) {\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec4:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec4Array:\r\n                str += `        highp ${intStr}vec4 val = ${intStr}vec4(col0);`;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec3:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec3Array:\r\n                str += `        highp ${intStr}vec3 val = ${intStr}vec3(col0.xyz);`;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec2:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec2Array:\r\n                str += `        highp ${intStr}vec2 val = ${intStr}vec2(col0.xy);`;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Scalar:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].ScalarArray:\r\n                if (info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Int) {\r\n                    str += `        int val = int(col0.x);`;\r\n                }\r\n                else if (info.componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Bool) {\r\n                    str += `        bool val = bool(col0.x);`;\r\n                }\r\n                else {\r\n                    str += `       float val = col0.x;`;\r\n                }\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4:\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4Array:\r\n                str += `\n        vec4 col1 = fetchElement(u_dataTexture, idx + 1.0, arg);\n        vec4 col2 = fetchElement(u_dataTexture, idx + 2.0, arg);\n        vec4 col3 = fetchElement(u_dataTexture, idx + 3.0, arg);\n\n        mat4 val = mat4(\n          col0.x, col0.y, col0.z, col0.w,\n          col1.x, col1.y, col1.z, col1.w,\n          col2.x, col2.y, col2.z, col2.w,\n          col3.x, col3.y, col3.z, col3.w\n          );\n        `;\r\n                break;\r\n            case _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat3:\r\n                str += `\n        vec4 col1 = fetchElement(u_dataTexture, idx + 1.0, arg);\n        vec4 col2 = fetchElement(u_dataTexture, idx + 2.0, arg);\n        mat3 val = mat3(\n          col0.x, col0.y, col0.z,\n          col0.w, col1.x, col1.y,\n          col1.z, col1.w, col2.x\n          );\n        `;\r\n                break;\r\n            default:\r\n                // console.error('unknown composition type', info.compositionType.str, memberName);\r\n                str += '';\r\n        }\r\n        if (!isTexture) {\r\n            str += `\n      return val;\n    }\n  `;\r\n        }\r\n        return str;\r\n    }\r\n    $load(meshComponent) {\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        WebGLStrategyFastestWebGL1.__currentComponentSIDs = WebGLStrategyFastestWebGL1.__globalDataRepository.getValue(_foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_8__[\"ShaderSemantics\"].CurrentComponentSIDs, 0);\r\n        if (!_WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__[\"default\"].isMaterialsSetup(meshComponent)) {\r\n            this.setupShaderProgram(meshComponent);\r\n        }\r\n        if (!_WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__[\"default\"].isMeshSetup(meshComponent)) {\r\n            const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n            for (let i = 0; i < primitiveNum; i++) {\r\n                const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n                primitive.create3DAPIVertexData();\r\n            }\r\n            meshComponent.mesh.updateVariationVBO();\r\n        }\r\n    }\r\n    $prerender(meshComponent, meshRendererComponent, instanceIDBufferUid) {\r\n        if (meshRendererComponent._readyForRendering) {\r\n            return;\r\n        }\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        if (meshComponent.mesh.isInstanceMesh()) {\r\n            meshRendererComponent._readyForRendering = true;\r\n            return;\r\n        }\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            this.__webglResourceRepository.setVertexDataToPipeline({ vaoHandle: meshComponent.mesh.getVaoUids(i), iboHandle: primitive.vertexHandles.iboHandle, vboHandles: primitive.vertexHandles.vboHandles }, primitive, meshComponent.mesh.variationVBOUid);\r\n        }\r\n        meshRendererComponent._readyForRendering = true;\r\n    }\r\n    __createAndUpdateDataTexture() {\r\n        const memoryManager = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n        const buffer = memoryManager.getBuffer(_foundation_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__[\"BufferUse\"].GPUInstanceData);\r\n        if (buffer == null) {\r\n            return;\r\n        }\r\n        if (this.__dataTextureUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_7__[\"default\"].InvalidCGAPIResourceUid) {\r\n            const bufferSizeInByte = buffer.takenSizeInByte;\r\n            const height = Math.min(Math.ceil(bufferSizeInByte / _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength / 4 / 4), _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength);\r\n            const updateByteSize = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength * height * 4 * 4;\r\n            const dataTextureByteSize = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength * _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength * 4 * 4;\r\n            if (bufferSizeInByte > dataTextureByteSize) {\r\n                console.warn('The buffer size exceeds the size of the data texture.');\r\n            }\r\n            const floatDataTextureBuffer = new Float32Array(buffer.getArrayBuffer(), 0, updateByteSize / 4);\r\n            if (this.__webglResourceRepository.currentWebGLContextWrapper.isWebGL2) {\r\n                this.__webglResourceRepository.updateTexture(this.__dataTextureUid, floatDataTextureBuffer, {\r\n                    level: 0, xoffset: 0, yoffset: 0, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength, height: height,\r\n                    format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float\r\n                });\r\n            }\r\n            else {\r\n                this.__webglResourceRepository.updateTexture(this.__dataTextureUid, floatDataTextureBuffer, {\r\n                    level: 0, xoffset: 0, yoffset: 0, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength, height: height,\r\n                    format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            const morphBuffer = memoryManager.getBuffer(_foundation_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_5__[\"BufferUse\"].GPUVertexData);\r\n            let morphBufferTakenSizeInByte = 0;\r\n            if (morphBuffer != null) {\r\n                morphBufferTakenSizeInByte = morphBuffer.takenSizeInByte;\r\n            }\r\n            let paddingArrayBufferSize = 0;\r\n            const dataTextureByteSize = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength * _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength * 4 * 4;\r\n            if ((buffer.takenSizeInByte + morphBufferTakenSizeInByte) < dataTextureByteSize) {\r\n                paddingArrayBufferSize = dataTextureByteSize - (buffer.takenSizeInByte + morphBufferTakenSizeInByte);\r\n            }\r\n            let morphBufferArrayBuffer = new ArrayBuffer(0);\r\n            if (morphBuffer != null) {\r\n                morphBufferArrayBuffer = morphBuffer.getArrayBuffer();\r\n            }\r\n            const finalArrayBuffer = _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_20__[\"MiscUtil\"].concatArrayBuffers([buffer.getArrayBuffer(), morphBufferArrayBuffer], [buffer.takenSizeInByte, morphBufferTakenSizeInByte], paddingArrayBufferSize);\r\n            if (finalArrayBuffer.byteLength / _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength / 4 / 4 > _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength) {\r\n                console.warn('The buffer size exceeds the size of the data texture.');\r\n            }\r\n            const floatDataTextureBuffer = new Float32Array(finalArrayBuffer);\r\n            const height = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferHeightLength;\r\n            if (this.__webglResourceRepository.currentWebGLContextWrapper.isWebGL2) {\r\n                this.__dataTextureUid = this.__webglResourceRepository.createTexture(floatDataTextureBuffer, {\r\n                    level: 0, internalFormat: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].RGBA32F, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength, height: height,\r\n                    border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Nearest,\r\n                    wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Repeat, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Repeat, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: true\r\n                });\r\n            }\r\n            else {\r\n                this.__dataTextureUid = this.__webglResourceRepository.createTexture(floatDataTextureBuffer, {\r\n                    level: 0, internalFormat: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bufferWidthLength, height: height,\r\n                    border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_2__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_3__[\"ComponentType\"].Float, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Nearest,\r\n                    wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Repeat, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_4__[\"TextureParameter\"].Repeat, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: true\r\n                });\r\n            }\r\n        }\r\n    }\r\n    common_$prerender() {\r\n        // Setup Data Texture\r\n        this.__createAndUpdateDataTexture();\r\n        const componentRepository = _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_13__[\"default\"].getInstance();\r\n        this.__lightComponents = componentRepository.getComponentsWithType(_foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_15__[\"default\"]);\r\n    }\r\n    attachGPUData(primitive) {\r\n        const material = primitive.material;\r\n        const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        const dataTexture = this.__webglResourceRepository.getWebGLResource(this.__dataTextureUid);\r\n        glw.bindTexture2D(0, dataTexture);\r\n        const shaderProgram = this.__webglResourceRepository.getWebGLResource(material._shaderProgramUid);\r\n        var uniform_dataTexture = gl.getUniformLocation(shaderProgram, 'u_dataTexture');\r\n        gl.uniform1i(uniform_dataTexture, 0);\r\n    }\r\n    attachGPUDataInner(gl, shaderProgram) {\r\n        this.__webglResourceRepository.bindTexture2D(0, this.__dataTextureUid);\r\n        var uniform_dataTexture = gl.getUniformLocation(shaderProgram, 'u_dataTexture');\r\n        gl.uniform1i(uniform_dataTexture, 0);\r\n    }\r\n    attachShaderProgram(material) {\r\n        const shaderProgramUid = material._shaderProgramUid;\r\n        if (shaderProgramUid !== this.__lastShader) {\r\n            const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n            const gl = glw.getRawContext();\r\n            const shaderProgram = this.__webglResourceRepository.getWebGLResource(shaderProgramUid);\r\n            gl.useProgram(shaderProgram);\r\n            this.__lastShader = shaderProgramUid;\r\n        }\r\n    }\r\n    attachVertexData(i, primitive, glw, instanceIDBufferUid) {\r\n    }\r\n    attachVertexDataInner(mesh, primitive, primitiveIndex, glw, instanceIDBufferUid) {\r\n        const vertexHandles = primitive.vertexHandles;\r\n        const vao = this.__webglResourceRepository.getWebGLResource(mesh.getVaoUids(primitiveIndex));\r\n        const gl = glw.getRawContext();\r\n        if (vao != null) {\r\n            glw.bindVertexArray(vao);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setVertexDataToPipeline(vertexHandles, primitive, mesh.variationVBOUid);\r\n            const ibo = this.__webglResourceRepository.getWebGLResource(vertexHandles.iboHandle);\r\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\r\n        }\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new (WebGLStrategyFastestWebGL1)();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    __getViewport(renderPass) {\r\n        let viewport = renderPass.getViewport();\r\n        if (viewport == null) {\r\n            viewport = this.__webglResourceRepository.currentWebGLContextWrapper.viewport;\r\n        }\r\n        return viewport;\r\n    }\r\n    __setVRViewport(renderPass, displayIdx) {\r\n        const rnXRModule = _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_23__[\"default\"].getInstance().getModule('xr');\r\n        const webvrSystem = rnXRModule.WebVRSystem.getInstance();\r\n        this.__webglResourceRepository.setViewport(webvrSystem.getViewportAt(this.__getViewport(renderPass), displayIdx));\r\n    }\r\n    __setCurrentComponentSIDsForEachRenderPass(renderPass, displayIdx, isVRMainPass) {\r\n        if (isVRMainPass) {\r\n            const rnXRModule = _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_23__[\"default\"].getInstance().getModule('xr');\r\n            const webvrSystem = rnXRModule.WebVRSystem.getInstance();\r\n            WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__[\"WellKnownComponentTIDs\"].CameraComponentTID] = webvrSystem.getCameraComponentSIDAt(displayIdx);\r\n        }\r\n        else {\r\n            let cameraComponent = renderPass.cameraComponent;\r\n            if (cameraComponent == null) {\r\n                cameraComponent = _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_13__[\"default\"].getInstance().getComponent(_foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_17__[\"default\"], _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_17__[\"default\"].main);\r\n            }\r\n            if (cameraComponent) {\r\n                WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__[\"WellKnownComponentTIDs\"].CameraComponentTID] = cameraComponent.componentSID;\r\n            }\r\n            else {\r\n                WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__[\"WellKnownComponentTIDs\"].CameraComponentTID] = -1;\r\n            }\r\n        }\r\n    }\r\n    __setCurrentComponentSIDsForEachEntity(gl, renderPass, entity) {\r\n        const skeletalComponent = entity.getSkeletal();\r\n        if (skeletalComponent) {\r\n            let index = 0;\r\n            if (skeletalComponent.componentSID < _foundation_core_Config__WEBPACK_IMPORTED_MODULE_16__[\"default\"].maxSkeletonNumber) {\r\n                index = skeletalComponent.componentSID;\r\n            }\r\n            WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__[\"WellKnownComponentTIDs\"].SkeletalComponentTID] = index;\r\n        }\r\n        else {\r\n            WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_19__[\"WellKnownComponentTIDs\"].SkeletalComponentTID] = -1;\r\n        }\r\n    }\r\n    __setCurrentComponentSIDsForEachPrimitive(gl, renderPass, material, entity) {\r\n        WebGLStrategyFastestWebGL1.__currentComponentSIDs.v[0] = material.materialSID;\r\n        gl.uniform1fv(WebGLStrategyFastestWebGL1.__shaderProgram.currentComponentSIDs, WebGLStrategyFastestWebGL1.__currentComponentSIDs.v);\r\n    }\r\n    __getDisplayNumber(isVRMainPass) {\r\n        if (isVRMainPass) {\r\n            return 2;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    }\r\n    common_$render(meshComponentSids, meshComponents, viewMatrix, projectionMatrix, renderPass, renderPassTickCount) {\r\n        const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        const rnXRModule = _foundation_system_ModuleManager__WEBPACK_IMPORTED_MODULE_23__[\"default\"].getInstance().getModule('xr');\r\n        const isVRMainPass = (rnXRModule === null || rnXRModule === void 0 ? void 0 : rnXRModule.WebVRSystem.getInstance().isWebVRMode) && renderPass.isMainPass;\r\n        const displayNumber = this.__getDisplayNumber(isVRMainPass);\r\n        for (let displayIdx = 0; displayIdx < displayNumber; displayIdx++) {\r\n            if (isVRMainPass) {\r\n                this.__setVRViewport(renderPass, displayIdx);\r\n            }\r\n            this.__setCurrentComponentSIDsForEachRenderPass(renderPass, displayIdx, isVRMainPass); // update u_currentComponentSIDs(uniform)\r\n            for (let idx = 0; idx < meshComponentSids.length; idx++) {\r\n                const sid = meshComponentSids[idx];\r\n                if (sid === _foundation_core_Component__WEBPACK_IMPORTED_MODULE_11__[\"default\"].invalidComponentSID) {\r\n                    break;\r\n                }\r\n                const meshComponent = meshComponents[sid];\r\n                if (meshComponent == null) {\r\n                    break;\r\n                }\r\n                const mesh = meshComponent.mesh;\r\n                if (!(mesh && mesh.isOriginalMesh())) {\r\n                    continue;\r\n                }\r\n                _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__[\"default\"].startDepthMasking(idx, gl, renderPass);\r\n                const entity = meshComponent.entity;\r\n                this.__setCurrentComponentSIDsForEachEntity(gl, renderPass, entity);\r\n                const meshRendererComponent = entity.getMeshRenderer();\r\n                const primitiveNum = mesh.getPrimitiveNumber();\r\n                let firstTime = false;\r\n                for (let i = 0; i < primitiveNum; i++) {\r\n                    const primitive = mesh.getPrimitiveAt(i);\r\n                    const material = renderPass.getAppropriateMaterial(primitive, primitive.material);\r\n                    if (material.isEmptyMaterial()) {\r\n                        continue;\r\n                    }\r\n                    const shaderProgramUid = material._shaderProgramUid;\r\n                    if (shaderProgramUid === -1) {\r\n                        continue;\r\n                    }\r\n                    this.attachVertexDataInner(mesh, primitive, i, glw, mesh.variationVBOUid);\r\n                    if (shaderProgramUid !== this.__lastShader) {\r\n                        const shaderProgram = this.__webglResourceRepository.getWebGLResource(shaderProgramUid);\r\n                        gl.useProgram(shaderProgram);\r\n                        gl.uniform1i(shaderProgram.dataTexture, 7);\r\n                        this.__webglResourceRepository.bindTexture2D(7, this.__dataTextureUid);\r\n                        WebGLStrategyFastestWebGL1.__shaderProgram = shaderProgram;\r\n                        firstTime = true;\r\n                    }\r\n                    if (this.__lastMaterial !== material) {\r\n                        firstTime = true;\r\n                        this.__lastMaterial = material;\r\n                    }\r\n                    this.__setCurrentComponentSIDsForEachPrimitive(gl, renderPass, material, entity);\r\n                    _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__[\"default\"].setCullAndBlendSettings(material, renderPass, gl);\r\n                    material.setParametersForGPU({\r\n                        material: material, shaderProgram: WebGLStrategyFastestWebGL1.__shaderProgram, firstTime: firstTime,\r\n                        args: {\r\n                            glw: glw,\r\n                            entity: entity,\r\n                            worldMatrix: entity.getSceneGraph().worldMatrixInner,\r\n                            normalMatrix: entity.getSceneGraph().normalMatrixInner,\r\n                            lightComponents: this.__lightComponents,\r\n                            renderPass: renderPass,\r\n                            primitive: primitive,\r\n                            diffuseCube: meshRendererComponent.diffuseCubeMap,\r\n                            specularCube: meshRendererComponent.specularCubeMap,\r\n                            setUniform: false\r\n                        }\r\n                    });\r\n                    if (primitive.indicesAccessor) {\r\n                        glw.drawElementsInstanced(primitive.primitiveMode.index, primitive.indicesAccessor.elementCount, primitive.indicesAccessor.componentType.index, 0, mesh.instanceCountIncludeOriginal);\r\n                    }\r\n                    else {\r\n                        glw.drawArraysInstanced(primitive.primitiveMode.index, 0, primitive.getVertexCountAsVerticesBased(), mesh.instanceCountIncludeOriginal);\r\n                    }\r\n                    this.__lastShader = shaderProgramUid;\r\n                }\r\n            }\r\n        }\r\n        this.__lastRenderPassTickCount = renderPassTickCount;\r\n        return false;\r\n    }\r\n    $render(idx, meshComponent, worldMatrix, normalMatrix, entity, renderPass, renderPassTickCount, diffuseCube, specularCube) {\r\n        const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_21__[\"default\"].endDepthMasking(idx, gl, renderPass);\r\n    }\r\n}\r\nWebGLStrategyFastestWebGL1.__globalDataRepository = _foundation_core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_18__[\"default\"].getInstance();\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLStrategyFastestWebGL1.ts?");

/***/ }),

/***/ "./src/webgl/WebGLStrategyUniform.ts":
/*!*******************************************!*\
  !*** ./src/webgl/WebGLStrategyUniform.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WebGLStrategyUniform; });\n/* harmony import */ var _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLResourceRepository */ \"./src/webgl/WebGLResourceRepository.ts\");\n/* harmony import */ var _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/components/MeshComponent */ \"./src/foundation/components/MeshComponent.ts\");\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/core/ComponentRepository */ \"./src/foundation/core/ComponentRepository.ts\");\n/* harmony import */ var _foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/components/LightComponent */ \"./src/foundation/components/LightComponent.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/definitions/PixelFormat */ \"./src/foundation/definitions/PixelFormat.ts\");\n/* harmony import */ var _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../foundation/definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n/* harmony import */ var _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../foundation/definitions/TextureParameter */ \"./src/foundation/definitions/TextureParameter.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../foundation/definitions/ShaderVariableUpdateInterval */ \"./src/foundation/definitions/ShaderVariableUpdateInterval.ts\");\n/* harmony import */ var _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../foundation/core/MemoryManager */ \"./src/foundation/core/MemoryManager.ts\");\n/* harmony import */ var _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../foundation/definitions/ShaderType */ \"./src/foundation/definitions/ShaderType.ts\");\n/* harmony import */ var _foundation_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../foundation/definitions/BufferUse */ \"./src/foundation/definitions/BufferUse.ts\");\n/* harmony import */ var _foundation_core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../foundation/core/GlobalDataRepository */ \"./src/foundation/core/GlobalDataRepository.ts\");\n/* harmony import */ var _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../foundation/misc/MiscUtil */ \"./src/foundation/misc/MiscUtil.ts\");\n/* harmony import */ var _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./WebGLStrategyCommonMethod */ \"./src/webgl/WebGLStrategyCommonMethod.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass WebGLStrategyUniform {\r\n    constructor() {\r\n        this.__webglResourceRepository = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        this.__dataTextureUid = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid;\r\n        this.__lastShader = -1;\r\n        this.__lastRenderPassTickCount = -1;\r\n    }\r\n    setupShaderProgram(meshComponent) {\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            const material = primitive.material;\r\n            if (material == null || material.isEmptyMaterial()) {\r\n                continue;\r\n            }\r\n            if (material._shaderProgramUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid) {\r\n                continue;\r\n            }\r\n            const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n            const gl = glw.getRawContext();\r\n            const isPointSprite = primitive.primitiveMode.index === gl.POINTS;\r\n            try {\r\n                this.setupDefaultShaderSemantics(material, isPointSprite);\r\n                primitive._backupMaterial();\r\n            }\r\n            catch (e) {\r\n                console.log(e);\r\n                primitive._restoreMaterial();\r\n                this.setupDefaultShaderSemantics(primitive.material, isPointSprite);\r\n            }\r\n        }\r\n    }\r\n    setupDefaultShaderSemantics(material, isPointSprite) {\r\n        // Shader Setup\r\n        const shaderSemanticsInfos = [\r\n            {\r\n                semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].VertexAttributesExistenceArray, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].ScalarArray, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Int,\r\n                stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, min: 0, max: 1, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n            },\r\n            {\r\n                semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].WorldMatrix, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat4, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float,\r\n                stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n            },\r\n            {\r\n                semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].NormalMatrix, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Mat3, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float,\r\n                stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].VertexShader, min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n            },\r\n        ];\r\n        if (isPointSprite) {\r\n            shaderSemanticsInfos.push({\r\n                semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].PointSize, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Scalar, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float,\r\n                stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, min: 0, max: Number.MAX_VALUE, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n            }, {\r\n                semantic: _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].PointDistanceAttenuation, compositionType: _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_10__[\"CompositionType\"].Vec3, componentType: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float,\r\n                stage: _foundation_definitions_ShaderType__WEBPACK_IMPORTED_MODULE_13__[\"ShaderType\"].PixelShader, min: 0, max: 1, isSystem: true, updateInterval: _foundation_definitions_ShaderVariableUpdateInterval__WEBPACK_IMPORTED_MODULE_11__[\"ShaderVariableUpdateInterval\"].EveryTime\r\n            });\r\n        }\r\n        WebGLStrategyUniform.setupMaterial(material, shaderSemanticsInfos);\r\n    }\r\n    static setupMaterial(material, args) {\r\n        let infoArray;\r\n        if (args != null) {\r\n            infoArray = args;\r\n        }\r\n        else {\r\n            infoArray = material.fieldsInfoArray;\r\n        }\r\n        WebGLStrategyUniform.__vertexShaderMethodDefinitions_uniform =\r\n            `\nuniform mat4 u_worldMatrix;\nuniform mat3 u_normalMatrix;\n\nmat4 get_worldMatrix(float instanceId) {\n  return u_worldMatrix;\n}\n\nmat3 get_normalMatrix(float instanceId) {\n  return u_normalMatrix;\n}\n\n#ifdef RN_IS_MORPHING\n  vec3 get_position(float vertexId, vec3 basePosition) {\n    vec3 position = basePosition;\n    for (int i=0; i<${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_6__[\"default\"].maxVertexMorphNumberInShader}; i++) {\n      float index = u_dataTextureMorphOffsetPosition[i] + 1.0 * vertexId;\n      float powWidthVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength}.0;\n      float powHeightVal = ${_foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength}.0;\n      vec2 arg = vec2(1.0/powWidthVal, 1.0/powHeightVal);\n    //  vec2 arg = vec2(1.0/powWidthVal, 1.0/powWidthVal/powHeightVal);\n      vec3 addPos = fetchElement(u_dataTexture, index + 0.0, arg).xyz;\n      position += addPos * u_morphWeights[i];\n      if (i == u_morphTargetNumber-1) {\n        break;\n      }\n    }\n\n    return position;\n  }\n#endif\n\n  `;\r\n        material.createProgram(WebGLStrategyUniform.__vertexShaderMethodDefinitions_uniform, _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_3__[\"ShaderSemantics\"].getShaderProperty);\r\n        const webglResourceRepository = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\r\n        webglResourceRepository.setupUniformLocations(material._shaderProgramUid, infoArray);\r\n        material.setUniformLocations(material._shaderProgramUid);\r\n        WebGLStrategyUniform.__globalDataRepository.setUniformLocations(material._shaderProgramUid);\r\n        const gl = webglResourceRepository.currentWebGLContextWrapper.getRawContext();\r\n        const shaderProgram = webglResourceRepository.getWebGLResource(material._shaderProgramUid);\r\n        shaderProgram.dataTexture = gl.getUniformLocation(shaderProgram, 'u_dataTexture');\r\n        shaderProgram.currentComponentSIDs = gl.getUniformLocation(shaderProgram, 'u_currentComponentSIDs');\r\n    }\r\n    __isMeshSetup(meshComponent) {\r\n        if (meshComponent.mesh.variationVBOUid !== _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid) {\r\n            const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n            let count = 0;\r\n            for (let i = 0; i < primitiveNum; i++) {\r\n                const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n                if (primitive.vertexHandles != null) {\r\n                    count++;\r\n                }\r\n            }\r\n            if (primitiveNum === count) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    $load(meshComponent) {\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        if (!_WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__[\"default\"].isMaterialsSetup(meshComponent)) {\r\n            this.setupShaderProgram(meshComponent);\r\n        }\r\n        if (!_WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__[\"default\"].isMeshSetup(meshComponent)) {\r\n            const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n            for (let i = 0; i < primitiveNum; i++) {\r\n                const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n                primitive.create3DAPIVertexData();\r\n            }\r\n            meshComponent.mesh.updateVariationVBO();\r\n        }\r\n    }\r\n    $prerender(meshComponent, meshRendererComponent, instanceIDBufferUid) {\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        // if (meshComponent.mesh.weights.length > 0) {\r\n        //   for (let i = 0; i < primitiveNum; i++) {\r\n        //     const primitive = meshComponent!.mesh.getPrimitiveAt(i);\r\n        //     this.__webglResourceRepository.resendVertexBuffer(primitive, primitive.vertexHandles!.vboHandles);\r\n        //   }\r\n        // }\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            this.__webglResourceRepository.setVertexDataToPipeline({ vaoHandle: meshComponent.mesh.getVaoUids(i), iboHandle: primitive.vertexHandles.iboHandle, vboHandles: primitive.vertexHandles.vboHandles }, primitive, meshComponent.mesh.variationVBOUid);\r\n        }\r\n    }\r\n    common_$prerender() {\r\n        const componentRepository = _foundation_core_ComponentRepository__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getInstance();\r\n        this.__lightComponents = componentRepository.getComponentsWithType(_foundation_components_LightComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n        // Setup Data Texture\r\n        if (this.__dataTextureUid === _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid) {\r\n            const memoryManager = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].getInstance();\r\n            const buffer = memoryManager.getBuffer(_foundation_definitions_BufferUse__WEBPACK_IMPORTED_MODULE_14__[\"BufferUse\"].GPUVertexData);\r\n            if (buffer == null) {\r\n                return;\r\n            }\r\n            if (buffer.takenSizeInByte / _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength / 4 > _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength) {\r\n                console.warn('The buffer size exceeds the size of the data texture.');\r\n            }\r\n            let paddingArrayBufferSize = 0;\r\n            if ((buffer.takenSizeInByte) / 4 / 4 < _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength * _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength) {\r\n                paddingArrayBufferSize = _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength * _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength * 4 * 4 - buffer.takenSizeInByte;\r\n            }\r\n            const concatArrayBuffer = _foundation_misc_MiscUtil__WEBPACK_IMPORTED_MODULE_16__[\"MiscUtil\"].concatArrayBuffers([buffer.getArrayBuffer()], [buffer.takenSizeInByte], paddingArrayBufferSize);\r\n            const floatDataTextureBuffer = new Float32Array(concatArrayBuffer);\r\n            if (this.__webglResourceRepository.currentWebGLContextWrapper.isWebGL2) {\r\n                this.__dataTextureUid = this.__webglResourceRepository.createTexture(floatDataTextureBuffer, {\r\n                    level: 0, internalFormat: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].RGBA32F, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength, height: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength,\r\n                    border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_7__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Nearest,\r\n                    wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Repeat, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Repeat, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: true\r\n                });\r\n            }\r\n            else {\r\n                this.__dataTextureUid = this.__webglResourceRepository.createTexture(floatDataTextureBuffer, {\r\n                    level: 0, internalFormat: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_7__[\"PixelFormat\"].RGBA, width: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferWidthLength, height: _foundation_core_MemoryManager__WEBPACK_IMPORTED_MODULE_12__[\"default\"].bufferHeightLength,\r\n                    border: 0, format: _foundation_definitions_PixelFormat__WEBPACK_IMPORTED_MODULE_7__[\"PixelFormat\"].RGBA, type: _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_8__[\"ComponentType\"].Float, magFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Nearest, minFilter: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Nearest,\r\n                    wrapS: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Repeat, wrapT: _foundation_definitions_TextureParameter__WEBPACK_IMPORTED_MODULE_9__[\"TextureParameter\"].Repeat, generateMipmap: false, anisotropy: false, isPremultipliedAlpha: true\r\n                });\r\n            }\r\n        }\r\n    }\r\n    attachGPUData(primitive) {\r\n    }\r\n    attachShaderProgram(material) {\r\n    }\r\n    attachVertexData(i, primitive, glw, instanceIDBufferUid) {\r\n    }\r\n    attachVertexDataInner(mesh, primitive, primitiveIndex, glw, instanceIDBufferUid) {\r\n        const vaoHandles = primitive.vertexHandles;\r\n        const vao = this.__webglResourceRepository.getWebGLResource(mesh.getVaoUids(primitiveIndex));\r\n        const gl = glw.getRawContext();\r\n        if (vao != null) {\r\n            glw.bindVertexArray(vao);\r\n        }\r\n        else {\r\n            this.__webglResourceRepository.setVertexDataToPipeline(vaoHandles, primitive, instanceIDBufferUid);\r\n            const ibo = this.__webglResourceRepository.getWebGLResource(vaoHandles.iboHandle);\r\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\r\n        }\r\n    }\r\n    dettachVertexData(glw) {\r\n        const gl = glw.getRawContext();\r\n        if (glw.bindVertexArray) {\r\n            glw.bindVertexArray(null);\r\n        }\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new WebGLStrategyUniform();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    common_$render(meshComponentSids, meshComponents, viewMatrix, projectionMatrix, renderPass) {\r\n        return false;\r\n    }\r\n    $render(idx, meshComponent, worldMatrix, normalMatrix, entity, renderPass, renderPassTickCount, diffuseCube, specularCube) {\r\n        const glw = this.__webglResourceRepository.currentWebGLContextWrapper;\r\n        const gl = glw.getRawContext();\r\n        _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__[\"default\"].startDepthMasking(idx, gl, renderPass);\r\n        if (meshComponent.mesh == null) {\r\n            _foundation_components_MeshComponent__WEBPACK_IMPORTED_MODULE_1__[\"default\"].alertNoMeshSet(meshComponent);\r\n            return;\r\n        }\r\n        const primitiveNum = meshComponent.mesh.getPrimitiveNumber();\r\n        for (let i = 0; i < primitiveNum; i++) {\r\n            const primitive = meshComponent.mesh.getPrimitiveAt(i);\r\n            this.attachVertexDataInner(meshComponent.mesh, primitive, i, glw, _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_2__[\"default\"].InvalidCGAPIResourceUid);\r\n            const material = renderPass.getAppropriateMaterial(primitive, primitive.material);\r\n            if (material.isEmptyMaterial() || material._shaderProgramUid === -1) {\r\n                continue;\r\n            }\r\n            const shaderProgram = this.__webglResourceRepository.getWebGLResource(material._shaderProgramUid);\r\n            const shaderProgramUid = material._shaderProgramUid;\r\n            let firstTime = false;\r\n            if (renderPassTickCount !== this.__lastRenderPassTickCount) {\r\n                firstTime = true;\r\n            }\r\n            if (shaderProgramUid !== this.__lastShader) {\r\n                gl.useProgram(shaderProgram);\r\n                gl.uniform1i(shaderProgram.dataTexture, 7);\r\n                this.__lastShader = shaderProgramUid;\r\n                firstTime = true;\r\n                this.__webglResourceRepository.bindTexture2D(7, this.__dataTextureUid);\r\n            }\r\n            if (this.__lastMaterial !== material) {\r\n                firstTime = true;\r\n                this.__lastMaterial = material;\r\n            }\r\n            _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__[\"default\"].setCullAndBlendSettings(material, renderPass, gl);\r\n            material.setParametersForGPU({\r\n                material, shaderProgram, firstTime, args: {\r\n                    setUniform: true,\r\n                    glw: glw,\r\n                    entity: entity,\r\n                    primitive: primitive,\r\n                    worldMatrix: worldMatrix,\r\n                    normalMatrix: normalMatrix,\r\n                    lightComponents: this.__lightComponents,\r\n                    renderPass: renderPass,\r\n                    diffuseCube: diffuseCube,\r\n                    specularCube: specularCube\r\n                }\r\n            });\r\n            if (primitive.indicesAccessor) {\r\n                glw.drawElementsInstanced(primitive.primitiveMode.index, primitive.indicesAccessor.elementCount, primitive.indicesAccessor.componentType.index, 0, 1);\r\n            }\r\n            else {\r\n                glw.drawArraysInstanced(primitive.primitiveMode.index, 0, primitive.getVertexCountAsVerticesBased(), 1);\r\n            }\r\n            // this.dettachVertexData(glw);\r\n        }\r\n        _WebGLStrategyCommonMethod__WEBPACK_IMPORTED_MODULE_17__[\"default\"].endDepthMasking(idx, gl, renderPass);\r\n        this.__lastRenderPassTickCount = renderPassTickCount;\r\n    }\r\n}\r\nWebGLStrategyUniform.__globalDataRepository = _foundation_core_GlobalDataRepository__WEBPACK_IMPORTED_MODULE_15__[\"default\"].getInstance();\r\n\n\n//# sourceURL=webpack:///./src/webgl/WebGLStrategyUniform.ts?");

/***/ }),

/***/ "./src/webgl/getRenderingStrategy.ts":
/*!*******************************************!*\
  !*** ./src/webgl/getRenderingStrategy.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _WebGLStrategyUniform__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./WebGLStrategyUniform */ \"./src/webgl/WebGLStrategyUniform.ts\");\n/* harmony import */ var _WebGLStrategyFastestWebGL1__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WebGLStrategyFastestWebGL1 */ \"./src/webgl/WebGLStrategyFastestWebGL1.ts\");\n\r\n\r\n\r\nconst getRenderingStrategy = function (processApproach) {\r\n    // Strategy\r\n    if (processApproach.index === _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__[\"ProcessApproach\"].FastestWebGL1.index) {\r\n        return _WebGLStrategyFastestWebGL1__WEBPACK_IMPORTED_MODULE_2__[\"default\"].getInstance();\r\n    }\r\n    else if (processApproach.index === _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__[\"ProcessApproach\"].UniformWebGL1.index ||\r\n        processApproach.index === _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__[\"ProcessApproach\"].UniformWebGL2.index) {\r\n        return _WebGLStrategyUniform__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n    }\r\n    return _WebGLStrategyUniform__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getInstance();\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (getRenderingStrategy);\r\n\n\n//# sourceURL=webpack:///./src/webgl/getRenderingStrategy.ts?");

/***/ }),

/***/ "./src/webgl/main.ts":
/*!***************************!*\
  !*** ./src/webgl/main.ts ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _getRenderingStrategy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getRenderingStrategy */ \"./src/webgl/getRenderingStrategy.ts\");\n/* harmony import */ var _shaders_GLSLShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shaders/GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _WebGLContextWrapper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WebGLContextWrapper */ \"./src/webgl/WebGLContextWrapper.ts\");\n/* harmony import */ var _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./WebGLResourceRepository */ \"./src/webgl/WebGLResourceRepository.ts\");\n/* harmony import */ var _WebGLStrategyUniform__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./WebGLStrategyUniform */ \"./src/webgl/WebGLStrategyUniform.ts\");\n\r\n\r\n\r\n\r\n\r\nconst WebGL = Object.freeze({\r\n    getRenderingStrategy: _getRenderingStrategy__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n    GLSLShader: _shaders_GLSLShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"],\r\n    WebGLContextWrapper: _WebGLContextWrapper__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n    WebGLResourceRepository: _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n    WebGLStrategyUniform: _WebGLStrategyUniform__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (WebGL);\r\n(0, eval)('this').RnWebGL = WebGL;\r\n\n\n//# sourceURL=webpack:///./src/webgl/main.ts?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.frag":
/*!**************************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.frag ***!
  \**************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin vec3 v_normal_inWorld;\\nin vec4 v_position_inWorld;\\nin float v_instanceID;\\n\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\nconst vec4 bitEnc = vec4(1.,255.,65025.,16581375.);\\r\\nconst vec4 bitDec = 1./bitEnc;\\r\\n\\r\\nvec4 encodeFloatRGBA(float v) {\\r\\n  float val = v;\\r\\n  float r = mod(val, 255.0);\\r\\n  val -= r;\\r\\n  float g = mod(val, 65025.0);\\r\\n  val -= g;\\r\\n  float b = mod(val, 16581375.0);\\r\\n  return vec4(r/255.0, g/65025.0, b/16581375.0, 1.0);\\r\\n}\\r\\n\\n\\nvoid main ()\\n{\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  rt0 = encodeFloatRGBA(v_instanceID);\\n\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.frag?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.vert":
/*!**************************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.vert ***!
  \**************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nin vec3 a_position;\\nin vec3 a_color;\\nin vec3 a_normal;\\nin float a_instanceID;\\nin vec2 a_texcoord;\\nin vec4 a_joint;\\nin vec4 a_weight;\\nout vec3 v_color;\\nout vec3 v_normal_inWorld;\\nout vec4 v_position_inWorld;\\nout vec2 v_texcoord;\\nout float v_instanceID;\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n/* shaderity: @{matricesGetters} */\\n\\nmat3 toNormalMatrix(mat4 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n  a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n  a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n  a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3];\\r\\n\\r\\n  float b00 = a00 * a11 - a01 * a10,\\r\\n  b01 = a00 * a12 - a02 * a10,\\r\\n  b02 = a00 * a13 - a03 * a10,\\r\\n  b03 = a01 * a12 - a02 * a11,\\r\\n  b04 = a01 * a13 - a03 * a11,\\r\\n  b05 = a02 * a13 - a03 * a12,\\r\\n  b06 = a20 * a31 - a21 * a30,\\r\\n  b07 = a20 * a32 - a22 * a30,\\r\\n  b08 = a20 * a33 - a23 * a30,\\r\\n  b09 = a21 * a32 - a22 * a31,\\r\\n  b10 = a21 * a33 - a23 * a31,\\r\\n  b11 = a22 * a33 - a23 * a32;\\r\\n\\r\\n  float determinantVal = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat3(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09, a12 * b08 - a10 * b11 - a13 * b07, a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09, a00 * b11 - a02 * b08 + a03 * b07, a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03, a32 * b02 - a30 * b05 - a33 * b01, a30 * b04 - a31 * b02 + a33 * b00) / determinantVal;\\r\\n}\\r\\n\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n\\r\\nhighp mat4 createMatrixFromQuaternionTransformUniformScale( highp vec4 quaternion, highp vec4 translationScale ) {\\r\\n  highp vec4 q = quaternion;\\r\\n  highp vec3 t = translationScale.xyz;\\r\\n  highp float scale = translationScale.w;\\r\\n\\r\\n  highp float sx = q.x * q.x;\\r\\n  highp float sy = q.y * q.y;\\r\\n  highp float sz = q.z * q.z;\\r\\n  highp float cx = q.y * q.z;\\r\\n  highp float cy = q.x * q.z;\\r\\n  highp float cz = q.x * q.y;\\r\\n  highp float wx = q.w * q.x;\\r\\n  highp float wy = q.w * q.y;\\r\\n  highp float wz = q.w * q.z;\\r\\n\\r\\n  highp mat4 mat = mat4(\\r\\n    1.0 - 2.0 * (sy + sz), 2.0 * (cz + wz), 2.0 * (cy - wy), 0.0,\\r\\n    2.0 * (cz - wz), 1.0 - 2.0 * (sx + sz), 2.0 * (cx + wx), 0.0,\\r\\n    2.0 * (cy + wy), 2.0 * (cx - wx), 1.0 - 2.0 * (sx + sy), 0.0,\\r\\n    t.x, t.y, t.z, 1.0\\r\\n  );\\r\\n\\r\\n  highp mat4 uniformScaleMat = mat4(\\r\\n    scale, 0.0, 0.0, 0.0,\\r\\n    0.0, scale, 0.0, 0.0,\\r\\n    0.0, 0.0, scale, 0.0,\\r\\n    0.0, 0.0, 0.0, 1.0\\r\\n  );\\r\\n\\r\\n  return mat*uniformScaleMat;\\r\\n}\\r\\n\\r\\nhighp vec4 unpackedVec2ToNormalizedVec4(highp vec2 vec_xy, highp float criteria){\\r\\n\\r\\n  highp float r;\\r\\n  highp float g;\\r\\n  highp float b;\\r\\n  highp float a;\\r\\n\\r\\n  highp float ix = floor(vec_xy.x * criteria);\\r\\n  highp float v1x = ix / criteria;\\r\\n  highp float v1y = ix - floor(v1x) * criteria;\\r\\n\\r\\n  r = ( v1x + 1.0 ) / (criteria-1.0);\\r\\n  g = ( v1y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  highp float iy = floor( vec_xy.y * criteria);\\r\\n  highp float v2x = iy / criteria;\\r\\n  highp float v2y = iy - floor(v2x) * criteria;\\r\\n\\r\\n  b = ( v2x + 1.0 ) / (criteria-1.0);\\r\\n  a = ( v2y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  r -= 1.0/criteria;\\r\\n  g -= 1.0/criteria;\\r\\n  b -= 1.0/criteria;\\r\\n  a -= 1.0/criteria;\\r\\n\\r\\n  r = r*2.0-1.0;\\r\\n  g = g*2.0-1.0;\\r\\n  b = b*2.0-1.0;\\r\\n  a = a*2.0-1.0;\\r\\n\\r\\n  return vec4(r, g, b, a);\\r\\n}\\r\\n\\r\\nmat4 getSkinMatrix(float skeletalComponentSID) {\\r\\n\\r\\n#ifdef RN_BONE_DATA_TYPE_MAT4X4\\r\\n  mat4 skinMat = a_weight.x * get_boneMatrix(skeletalComponentSID, int(a_joint.x));\\r\\n  skinMat += a_weight.y * get_boneMatrix(skeletalComponentSID, int(a_joint.y));\\r\\n  skinMat += a_weight.z * get_boneMatrix(skeletalComponentSID, int(a_joint.z));\\r\\n  skinMat += a_weight.w * get_boneMatrix(skeletalComponentSID, int(a_joint.w));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X2)\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.x)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.x)));\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.y)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.y)));\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.z)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.z)));\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.w)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.w)));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X1)\\r\\n  highp vec4 boneCompressedChunksX = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.x));\\r\\n  highp vec4 boneCompressedChunksY = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.y));\\r\\n  highp vec4 boneCompressedChunksZ = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.z));\\r\\n  highp vec4 boneCompressedChunksW = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.w));\\r\\n\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp vec4 boneCompressedInfo = get_boneCompressedInfo(0.0, 0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.zw, criteria.y)*boneCompressedInfo);\\r\\n#endif\\r\\n\\r\\n  return skinMat;\\r\\n}\\r\\n#endif\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\nbool skinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n  )\\r\\n{\\r\\n  mat4 skinMat = getSkinMatrix(skeletalComponentSID);\\r\\n  outPosition_inWorld = skinMat * vec4(inPosition_inLocal, 1.0);\\r\\n  outNormalMatrix = toNormalMatrix(skinMat);\\r\\n  outNormal_inWorld = normalize(outNormalMatrix * inNormal_inLocal);\\r\\n\\r\\n  return true;\\r\\n}\\r\\n#endif\\r\\n\\r\\nbool processGeometryWithMorphingAndSkinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat4 worldMatrix,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n) {\\r\\n  bool isSkinning = false;\\r\\n\\r\\n  vec3 position_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  if (u_morphTargetNumber == 0) {\\r\\n#endif\\r\\n    position_inLocal = inPosition_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  } else {\\r\\n    float vertexIdx = a_baryCentricCoord.w;\\r\\n    position_inLocal = get_position(vertexIdx, inPosition_inLocal);\\r\\n  }\\r\\n#endif\\r\\n\\r\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n  if (skeletalComponentSID >= 0.0) {\\r\\n    isSkinning = skinning(skeletalComponentSID, inNormalMatrix, outNormalMatrix, position_inLocal, outPosition_inWorld, inNormal_inLocal, outNormal_inWorld);\\r\\n  } else {\\r\\n#endif\\r\\n    outNormalMatrix = inNormalMatrix;\\r\\n    outPosition_inWorld = worldMatrix * vec4(position_inLocal, 1.0);\\r\\n    outNormal_inWorld = normalize(inNormalMatrix * inNormal_inLocal);\\r\\n#ifdef RN_IS_SKINNING\\r\\n  }\\r\\n#endif\\r\\n\\r\\n  return isSkinning;\\r\\n}\\r\\n\\n\\n\\nvoid main()\\n{\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  float cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\\n\\n  // Skeletal\\n  processGeometryWithMorphingAndSkinning(\\n    skeletalComponentSID,\\n    worldMatrix,\\n    normalMatrix,\\n    normalMatrix,\\n    a_position,\\n    v_position_inWorld,\\n    a_normal,\\n    v_normal_inWorld\\n  );\\n\\n  gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\\n\\nvec4 position_inWorld = worldMatrix * vec4(a_position, 1.0);\\r\\nvec3 viewPosition = get_viewPosition(cameraSID, 0);\\r\\nfloat distanceFromCamera = length(position_inWorld.xyz - viewPosition);\\r\\nvec3 pointDistanceAttenuation = get_pointDistanceAttenuation(materialSID, 0);\\r\\nfloat distanceAttenuationFactor = sqrt(1.0/(pointDistanceAttenuation.x + pointDistanceAttenuation.y * distanceFromCamera + pointDistanceAttenuation.z * distanceFromCamera * distanceFromCamera));\\r\\nfloat maxPointSize = get_pointSize(materialSID, 0);\\r\\ngl_PointSize = clamp(distanceAttenuationFactor * maxPointSize, 0.0, maxPointSize);\\r\\n\\n\\n  v_instanceID = a_instanceID;\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/EntityUIDOutputSingleShader/EntityUIDOutputSingleShader.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.frag":
/*!**************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.frag ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/**\\n * This file contains source code provided by NVIDIA Corporation.\\n * FXAA antialiasing is developed by NVIDIA.\\n * The codes of this file is modified from original code to work on WebGL1.\\n * The modification for GLSL 100 is referred from Three.js, https://github.com/mrdoob/three.js/blob/5ba4c25bcb74577e1b1e14906f345135610a94f3/examples/js/shaders/FXAAShader.js\\n * The original FXAA code is https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/80e8ba8f5e8935821513207033490735dd3279d8/samples/es3-kepler/FXAA/FXAA3_11.h\\n */\\n\\n//----------------------------------------------------------------------------------\\n// File:        es3-kepler\\\\FXAA/FXAA3_11.h\\n// SDK Version: v3.00\\n// Email:       gameworks@nvidia.com\\n// Site:        http://developer.nvidia.com/\\n//\\n// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\\n//\\n// Redistribution and use in source and binary forms, with or without\\n// modification, are permitted provided that the following conditions\\n// are met:\\n//  * Redistributions of source code must retain the above copyright\\n//    notice, this list of conditions and the following disclaimer.\\n//  * Redistributions in binary form must reproduce the above copyright\\n//    notice, this list of conditions and the following disclaimer in the\\n//    documentation and/or other materials provided with the distribution.\\n//  * Neither the name of NVIDIA CORPORATION nor the names of its\\n//    contributors may be used to endorse or promote products derived\\n//    from this software without specific prior written permission.\\n//\\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS 'AS IS' AND ANY\\n// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\\n// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\\n// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\\n// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\\n// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\\n// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n//\\n//----------------------------------------------------------------------------------\\n/*============================================================================\\n                    NVIDIA FXAA 3.11 by TIMOTHY LOTTES\\n============================================================================*/\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin vec2 v_texcoord;\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n\\n\\n  #define FXAA_PC 1\\n  #define FXAA_QUALITYPRESET 39\\n  #define FXAA_GREEN_AS_LUMA 0\\n  #define FXAA_GLSL_100 1\\n\\n  /*============================================================================\\n                                INTEGRATION KNOBS\\n  ============================================================================*/\\n  //\\n  // FXAA_PS3 and FXAA_360 choose the console algorithm (FXAA3 CONSOLE).\\n  // FXAA_360_OPT is a prototype for the new optimized 360 version.\\n  //\\n  // 1 = Use API.\\n  // 0 = Don't use API.\\n  //\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_PS3\\n  #define FXAA_PS3 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_360\\n  #define FXAA_360 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_360_OPT\\n  #define FXAA_360_OPT 0\\n  #endif\\n  /*==========================================================================*/\\n  #ifndef FXAA_PC\\n  //\\n  // FXAA Quality\\n  // The high quality PC algorithm.\\n  //\\n  #define FXAA_PC 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_PC_CONSOLE\\n  //\\n  // The console algorithm for PC is included\\n  // for developers targeting really low spec machines.\\n  // Likely better to just run FXAA_PC, and use a really low preset.\\n  //\\n  #define FXAA_PC_CONSOLE 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_GLSL_120\\n  #define FXAA_GLSL_120 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_GLSL_130\\n  #define FXAA_GLSL_130 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_HLSL_3\\n  #define FXAA_HLSL_3 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_HLSL_4\\n  #define FXAA_HLSL_4 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_HLSL_5\\n  #define FXAA_HLSL_5 0\\n  #endif\\n  /*==========================================================================*/\\n  #ifndef FXAA_GREEN_AS_LUMA\\n  //\\n  // For those using non-linear color,\\n  // and either not able to get luma in alpha, or not wanting to,\\n  // this enables FXAA to run using green as a proxy for luma.\\n  // So with this enabled, no need to pack luma in alpha.\\n  //\\n  // This will turn off AA on anything which lacks some amount of green.\\n  // Pure red and blue or combination of only R and B, will get no AA.\\n  //\\n  // Might want to lower the settings for both,\\n  //    fxaaConsoleEdgeThresholdMin\\n  //    fxaaQualityEdgeThresholdMin\\n  // In order to insure AA does not get turned off on colors \\n  // which contain a minor amount of green.\\n  //\\n  // 1 = On.\\n  // 0 = Off.\\n  //\\n  #define FXAA_GREEN_AS_LUMA 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_EARLY_EXIT\\n  //\\n  // Controls algorithm's early exit path.\\n  // On PS3 turning this ON adds 2 cycles to the shader.\\n  // On 360 turning this OFF adds 10ths of a millisecond to the shader.\\n  // Turning this off on console will result in a more blurry image.\\n  // So this defaults to on.\\n  //\\n  // 1 = On.\\n  // 0 = Off.\\n  //\\n  #define FXAA_EARLY_EXIT 1\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_DISCARD\\n  //\\n  // Only valid for PC OpenGL currently.\\n  // Probably will not work when FXAA_GREEN_AS_LUMA = 1.\\n  //\\n  // 1 = Use discard on pixels which don't need AA.\\n  //     For APIs which enable concurrent TEX+ROP from same surface.\\n  // 0 = Return unchanged color on pixels which don't need AA.\\n  //\\n  #define FXAA_DISCARD 0\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_FAST_PIXEL_OFFSET\\n  //\\n  // Used for GLSL 120 only.\\n  //\\n  // 1 = GL API supports fast pixel offsets\\n  // 0 = do not use fast pixel offsets\\n  //\\n  #ifdef GLEXT_gpu_shader4\\n  #define FXAA_FAST_PIXEL_OFFSET 1\\n  #endif\\n  #ifdef GLNV_gpu_shader5\\n  #define FXAA_FAST_PIXEL_OFFSET 1\\n  #endif\\n  #ifdef GLARB_gpu_shader5\\n  #define FXAA_FAST_PIXEL_OFFSET 1\\n  #endif\\n  #ifndef FXAA_FAST_PIXEL_OFFSET\\n  #define FXAA_FAST_PIXEL_OFFSET 0\\n  #endif\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_GATHER4_ALPHA\\n  //\\n  // 1 = API supports gather4 on alpha channel.\\n  // 0 = API does not support gather4 on alpha channel.\\n  //\\n  #if (FXAA_HLSL_5 == 1)\\n  #define FXAA_GATHER4_ALPHA 1\\n  #endif\\n  #ifdef GLARB_gpu_shader5\\n  #define FXAA_GATHER4_ALPHA 1\\n  #endif\\n  #ifdef GLNV_gpu_shader5\\n  #define FXAA_GATHER4_ALPHA 1\\n  #endif\\n  #ifndef FXAA_GATHER4_ALPHA\\n  #define FXAA_GATHER4_ALPHA 0\\n  #endif\\n  #endif\\n\\n  /*============================================================================\\n                        FXAA CONSOLE PS3 - TUNING KNOBS\\n  ============================================================================*/\\n  #ifndef FXAA_CONSOLEPS3_EDGE_SHARPNESS\\n  //\\n  // Consoles the sharpness of edges on PS3 only.\\n  // Non-PS3 tuning is done with shader input.\\n  //\\n  // Due to the PS3 being ALU bound,\\n  // there are only two safe values here: 4 and 8.\\n  // These options use the shaders ability to a free *|/ by 2|4|8.\\n  //\\n  // 8.0 is sharper\\n  // 4.0 is softer\\n  // 2.0 is really soft (good for vector graphics inputs)\\n  //\\n  #if 1\\n  #define FXAA_CONSOLEPS3_EDGE_SHARPNESS 8.0\\n  #endif\\n  #if 0\\n  #define FXAA_CONSOLEPS3_EDGE_SHARPNESS 4.0\\n  #endif\\n  #if 0\\n  #define FXAA_CONSOLEPS3_EDGE_SHARPNESS 2.0\\n  #endif\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #ifndef FXAA_CONSOLEPS3_EDGE_THRESHOLD\\n  //\\n  // Only effects PS3.\\n  // Non-PS3 tuning is done with shader input.\\n  //\\n  // The minimum amount of local contrast required to apply algorithm.\\n  // The console setting has a different mapping than the quality setting.\\n  //\\n  // This only applies when FXAA_EARLY_EXIT is 1.\\n  //\\n  // Due to the PS3 being ALU bound,\\n  // there are only two safe values here: 0.25 and 0.125.\\n  // These options use the shaders ability to a free *|/ by 2|4|8.\\n  //\\n  // 0.125 leaves less aliasing, but is softer\\n  // 0.25 leaves more aliasing, and is sharper\\n  //\\n  #if 1\\n  #define FXAA_CONSOLEPS3_EDGE_THRESHOLD 0.125\\n  #else\\n  #define FXAA_CONSOLEPS3_EDGE_THRESHOLD 0.25\\n  #endif\\n  #endif\\n\\n  /*============================================================================\\n                          FXAA QUALITY - TUNING KNOBS\\n  ------------------------------------------------------------------------------\\n  NOTE the other tuning knobs are now in the shader function inputs!\\n  ============================================================================*/\\n  #ifndef FXAA_QUALITYPRESET\\n  //\\n  // Choose the quality preset.\\n  // This needs to be compiled into the shader as it effects code.\\n  // Best option to include multiple presets is to \\n  // in each shader define the preset, then include this file.\\n  // \\n  // OPTIONS\\n  // -----------------------------------------------------------------------\\n  // 10 to 15 - default medium dither (10=fastest, 15=highest quality)\\n  // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\\n  // 39       - no dither, very expensive \\n  //\\n  // NOTES\\n  // -----------------------------------------------------------------------\\n  // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\\n  // 13 = about same speed as FXAA 3.9 and better than 12\\n  // 23 = closest to FXAA 3.9 visually and performance wise\\n  //  _ = the lowest digit is directly related to performance\\n  // _  = the highest digit is directly related to style\\n  // \\n  #define FXAA_QUALITYPRESET 12\\n  #endif\\n\\n\\n  /*============================================================================\\n                             FXAA QUALITY - PRESETS\\n  ============================================================================*/\\n\\n  /*============================================================================\\n                       FXAA QUALITY - MEDIUM DITHER PRESETS\\n  ============================================================================*/\\n  #if(FXAA_QUALITYPRESET == 10)\\n#define FXAA_QUALITYPS 3\\n#define FXAA_QUALITYP0 1.5\\n#define FXAA_QUALITYP1 3.0\\n#define FXAA_QUALITYP2 12.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 11)\\n#define FXAA_QUALITYPS 4\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 3.0\\n#define FXAA_QUALITYP3 12.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 12)\\n#define FXAA_QUALITYPS 5\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 4.0\\n#define FXAA_QUALITYP4 12.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 13)\\n#define FXAA_QUALITYPS 6\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 4.0\\n#define FXAA_QUALITYP5 12.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 14)\\n#define FXAA_QUALITYPS 7\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 4.0\\n#define FXAA_QUALITYP6 12.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 15)\\n#define FXAA_QUALITYPS 8\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 4.0\\n#define FXAA_QUALITYP7 12.0\\n#endif\\n\\n/*============================================================================\\n                     FXAA QUALITY - LOW DITHER PRESETS\\n============================================================================*/\\n#if (FXAA_QUALITYPRESET == 20)\\n#define FXAA_QUALITYPS 3\\n#define FXAA_QUALITYP0 1.5\\n#define FXAA_QUALITYP1 2.0\\n#define FXAA_QUALITYP2 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 21)\\n#define FXAA_QUALITYPS 4\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 22)\\n#define FXAA_QUALITYPS 5\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 23)\\n#define FXAA_QUALITYPS 6\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 24)\\n#define FXAA_QUALITYPS 7\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 3.0\\n#define FXAA_QUALITYP6 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 25)\\n#define FXAA_QUALITYPS 8\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 4.0\\n#define FXAA_QUALITYP7 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 26)\\n#define FXAA_QUALITYPS 9\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 2.0\\n#define FXAA_QUALITYP7 4.0\\n#define FXAA_QUALITYP8 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 27)\\n#define FXAA_QUALITYPS 10\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 2.0\\n#define FXAA_QUALITYP7 2.0\\n#define FXAA_QUALITYP8 4.0\\n#define FXAA_QUALITYP9 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 28)\\n#define FXAA_QUALITYPS 11\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 2.0\\n#define FXAA_QUALITYP7 2.0\\n#define FXAA_QUALITYP8 2.0\\n#define FXAA_QUALITYP9 4.0\\n#define FXAA_QUALITYP10 8.0\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_QUALITYPRESET == 29)\\n#define FXAA_QUALITYPS 12\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.5\\n#define FXAA_QUALITYP2 2.0\\n#define FXAA_QUALITYP3 2.0\\n#define FXAA_QUALITYP4 2.0\\n#define FXAA_QUALITYP5 2.0\\n#define FXAA_QUALITYP6 2.0\\n#define FXAA_QUALITYP7 2.0\\n#define FXAA_QUALITYP8 2.0\\n#define FXAA_QUALITYP9 2.0\\n#define FXAA_QUALITYP10 4.0\\n#define FXAA_QUALITYP11 8.0\\n#endif\\n\\n/*============================================================================\\n                     FXAA QUALITY - EXTREME QUALITY\\n============================================================================*/\\n#if (FXAA_QUALITYPRESET == 39)\\n#define FXAA_QUALITYPS 12\\n#define FXAA_QUALITYP0 1.0\\n#define FXAA_QUALITYP1 1.0\\n#define FXAA_QUALITYP2 1.0\\n#define FXAA_QUALITYP3 1.0\\n#define FXAA_QUALITYP4 1.0\\n#define FXAA_QUALITYP5 1.5\\n#define FXAA_QUALITYP6 2.0\\n#define FXAA_QUALITYP7 2.0\\n#define FXAA_QUALITYP8 2.0\\n#define FXAA_QUALITYP9 2.0\\n#define FXAA_QUALITYP10 4.0\\n#define FXAA_QUALITYP11 8.0\\n#endif\\n\\n\\n\\n/*============================================================================\\n                                API PORTING\\n============================================================================*/\\n#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)\\n#define FxaaBool bool\\n#define FxaaDiscard discard\\n#define FxaaFloat float\\n#define FxaaFloat2 vec2\\n#define FxaaFloat3 vec3\\n#define FxaaFloat4 vec4\\n#define FxaaHalf float\\n#define FxaaHalf2 vec2\\n#define FxaaHalf3 vec3\\n#define FxaaHalf4 vec4\\n#define FxaaInt2 ivec2\\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\\n#define FxaaTex sampler2D\\n#else\\n#define FxaaBool bool\\n#define FxaaDiscard clip(-1)\\n#define FxaaFloat float\\n#define FxaaFloat2 float2\\n#define FxaaFloat3 float3\\n#define FxaaFloat4 float4\\n#define FxaaHalf half\\n#define FxaaHalf2 half2\\n#define FxaaHalf3 half3\\n#define FxaaHalf4 half4\\n#define FxaaSat(x) saturate(x)\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_GLSL_100 == 1)\\n#define FxaaTexTop(t, p) texture2D(t, p, 0.0)\\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_GLSL_120 == 1)\\n// Requires,\\n//  #version 120\\n// And at least,\\n//  #extension GLEXT_gpu_shader4 : enable\\n//  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)\\n#define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\\n#if (FXAA_FAST_PIXEL_OFFSET == 1)\\n#define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)\\n#else\\n#define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\\n#endif\\n#if (FXAA_GATHER4_ALPHA == 1)\\n// use #extension GLARB_gpu_shader5 : enable\\n#define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\\n#define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\\n#define FxaaTexGreen4(t, p) textureGather(t, p, 1)\\n#define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\\n#endif\\n#endif\\n/*--------------------------------------------------------------------------*/\\n#if (FXAA_GLSL_130 == 1)\\n// Requires \\\"#version 130\\\" or better\\n#define FxaaTexTop(t, p) textureLod(t, p, 0.0)\\n#define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)\\n#if (FXAA_GATHER4_ALPHA == 1)\\n// use #extension GLARB_gpu_shader5 : enable\\n#define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\\n#define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\\n#define FxaaTexGreen4(t, p) textureGather(t, p, 1)\\n#define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\\n#endif\\n#endif\\n\\n\\n/*============================================================================\\n                   GREEN AS LUMA OPTION SUPPORT FUNCTION\\n============================================================================*/\\n#if (FXAA_GREEN_AS_LUMA == 0)\\n  FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return dot(rgba.rgb, vec3(0.298912, 0.586611, 0.114478)); }\\n  // FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }\\n#else\\n  FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\\n#endif\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n/*============================================================================\\n                             FXAA3 QUALITY - PC\\n============================================================================*/\\n#if (FXAA_PC == 1)\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat4 FxaaPixelShader(\\n    //\\n    // Use noperspective interpolation here (turn off perspective interpolation).\\n    // {xy} = center of pixel\\n    FxaaFloat2 pos,\\n    //\\n    // Used only for FXAA Console, and not used on the 360 version.\\n    // Use noperspective interpolation here (turn off perspective interpolation).\\n    // {xy} = upper left of pixel\\n    // {zw} = lower right of pixel\\n    FxaaFloat4 fxaaConsolePosPos,\\n    //\\n    // Input color texture.\\n    // {rgb_} = color in linear or perceptual color space\\n    // if (FXAA_GREEN_AS_LUMA == 0)\\n    //     {_a} = luma in perceptual color space (not linear)\\n    FxaaTex tex,\\n    //\\n    // Only used on the optimized 360 version of FXAA Console.\\n    // For everything but 360, just use the same input here as for \\\"tex\\\".\\n    // For 360, same texture, just alias with a 2nd sampler.\\n    // This sampler needs to have an exponent bias of -1.\\n    FxaaTex fxaaConsole360TexExpBiasNegOne,\\n    //\\n    // Only used on the optimized 360 version of FXAA Console.\\n    // For everything but 360, just use the same input here as for \\\"tex\\\".\\n    // For 360, same texture, just alias with a 3nd sampler.\\n    // This sampler needs to have an exponent bias of -2.\\n    FxaaTex fxaaConsole360TexExpBiasNegTwo,\\n    //\\n    // Only used on FXAA Quality.\\n    // This must be from a constant/uniform.\\n    // {x_} = 1.0/screenWidthInPixels\\n    // {_y} = 1.0/screenHeightInPixels\\n    FxaaFloat2 fxaaQualityRcpFrame,\\n    //\\n    // Only used on FXAA Console.\\n    // This must be from a constant/uniform.\\n    // This effects sub-pixel AA quality and inversely sharpness.\\n    //   Where N ranges between,\\n    //     N = 0.50 (default)\\n    //     N = 0.33 (sharper)\\n    // {x_} = -N/screenWidthInPixels\\n    // {_y} = -N/screenHeightInPixels\\n    // {z_} =  N/screenWidthInPixels\\n    // {_w} =  N/screenHeightInPixels\\n    FxaaFloat4 fxaaConsoleRcpFrameOpt,\\n    //\\n    // Only used on FXAA Console.\\n    // Not used on 360, but used on PS3 and PC.\\n    // This must be from a constant/uniform.\\n    // {x_} = -2.0/screenWidthInPixels\\n    // {_y} = -2.0/screenHeightInPixels\\n    // {z_} =  2.0/screenWidthInPixels\\n    // {_w} =  2.0/screenHeightInPixels\\n    FxaaFloat4 fxaaConsoleRcpFrameOpt2,\\n    //\\n    // Only used on FXAA Console.\\n    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.\\n    // This must be from a constant/uniform.\\n    // {x_} =  8.0/screenWidthInPixels\\n    // {_y} =  8.0/screenHeightInPixels\\n    // {z_} = -4.0/screenWidthInPixels\\n    // {_w} = -4.0/screenHeightInPixels\\n    FxaaFloat4 fxaaConsole360RcpFrameOpt2,\\n    //\\n    // Only used on FXAA Quality.\\n    // This used to be the FXAA_QUALITYSUBPIX define.\\n    // It is here now to allow easier tuning.\\n    // Choose the amount of sub-pixel aliasing removal.\\n    // This can effect sharpness.\\n    //   1.00 - upper limit (softer)\\n    //   0.75 - default amount of filtering\\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\\n    //   0.25 - almost off\\n    //   0.00 - completely off\\n    FxaaFloat fxaaQualitySubpix,\\n    //\\n    // Only used on FXAA Quality.\\n    // This used to be the FXAA_QUALITYEDGE_THRESHOLD define.\\n    // It is here now to allow easier tuning.\\n    // The minimum amount of local contrast required to apply algorithm.\\n    //   0.333 - too little (faster)\\n    //   0.250 - low quality\\n    //   0.166 - default\\n    //   0.125 - high quality \\n    //   0.063 - overkill (slower)\\n    FxaaFloat fxaaQualityEdgeThreshold,\\n    //\\n    // Only used on FXAA Quality.\\n    // This used to be the FXAA_QUALITYEDGE_THRESHOLD_MIN define.\\n    // It is here now to allow easier tuning.\\n    // Trims the algorithm from processing darks.\\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\\n    //   0.0625 - high quality (faster)\\n    //   0.0312 - visible limit (slower)\\n    // Special notes when using FXAA_GREEN_AS_LUMA,\\n    //   Likely want to set this to zero.\\n    //   As colors that are mostly not-green\\n    //   will appear very dark in the green channel!\\n    //   Tune by looking at mostly non-green content,\\n    //   then start at zero and increase until aliasing is a problem.\\n    FxaaFloat fxaaQualityEdgeThresholdMin,\\n    // \\n    // Only used on FXAA Console.\\n    // This used to be the FXAA_CONSOLEEDGE_SHARPNESS define.\\n    // It is here now to allow easier tuning.\\n    // This does not effect PS3, as this needs to be compiled in.\\n    //   Use FXAA_CONSOLEPS3_EDGE_SHARPNESS for PS3.\\n    //   Due to the PS3 being ALU bound,\\n    //   there are only three safe values here: 2 and 4 and 8.\\n    //   These options use the shaders ability to a free *|/ by 2|4|8.\\n    // For all other platforms can be a non-power of two.\\n    //   8.0 is sharper (default!!!)\\n    //   4.0 is softer\\n    //   2.0 is really soft (good only for vector graphics inputs)\\n    FxaaFloat fxaaConsoleEdgeSharpness,\\n    //\\n    // Only used on FXAA Console.\\n    // This used to be the FXAA_CONSOLEEDGE_THRESHOLD define.\\n    // It is here now to allow easier tuning.\\n    // This does not effect PS3, as this needs to be compiled in.\\n    //   Use FXAA_CONSOLEPS3_EDGE_THRESHOLD for PS3.\\n    //   Due to the PS3 being ALU bound,\\n    //   there are only two safe values here: 1/4 and 1/8.\\n    //   These options use the shaders ability to a free *|/ by 2|4|8.\\n    // The console setting has a different mapping than the quality setting.\\n    // Other platforms can use other values.\\n    //   0.125 leaves less aliasing, but is softer (default!!!)\\n    //   0.25 leaves more aliasing, and is sharper\\n    FxaaFloat fxaaConsoleEdgeThreshold,\\n    //\\n    // Only used on FXAA Console.\\n    // This used to be the FXAA_CONSOLEEDGE_THRESHOLD_MIN define.\\n    // It is here now to allow easier tuning.\\n    // Trims the algorithm from processing darks.\\n    // The console setting has a different mapping than the quality setting.\\n    // This only applies when FXAA_EARLY_EXIT is 1.\\n    // This does not apply to PS3, \\n    // PS3 was simplified to avoid more shader instructions.\\n    //   0.06 - faster but more aliasing in darks\\n    //   0.05 - default\\n    //   0.04 - slower and less aliasing in darks\\n    // Special notes when using FXAA_GREEN_AS_LUMA,\\n    //   Likely want to set this to zero.\\n    //   As colors that are mostly not-green\\n    //   will appear very dark in the green channel!\\n    //   Tune by looking at mostly non-green content,\\n    //   then start at zero and increase until aliasing is a problem.\\n    FxaaFloat fxaaConsoleEdgeThresholdMin,\\n    //    \\n    // Extra constants for 360 FXAA Console only.\\n    // Use zeros or anything else for other platforms.\\n    // These must be in physical constant registers and NOT immedates.\\n    // Immedates will result in compiler un-optimizing.\\n    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)\\n    FxaaFloat4 fxaaConsole360ConstDir\\n  ) {\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat2 posM;\\n  posM.x = pos.x;\\n  posM.y = pos.y;\\n  #if (FXAA_GATHER4_ALPHA == 1)\\n  #if (FXAA_DISCARD == 0)\\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\\n  #if (FXAA_GREEN_AS_LUMA == 0)\\n  #define lumaM rgbyM.w\\n  #else\\n  #define lumaM rgbyM.y\\n  #endif\\n  #endif\\n  #if (FXAA_GREEN_AS_LUMA == 0)\\n    FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);\\n  FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));\\n  #else\\n  FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);\\n  FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));\\n  #endif\\n  #if (FXAA_DISCARD == 1)\\n  #define lumaM luma4A.w\\n  #endif\\n  #define lumaE luma4A.z\\n  #define lumaS luma4A.x\\n  #define lumaSE luma4A.y\\n  #define lumaNW luma4B.w\\n  #define lumaN luma4B.z\\n  #define lumaW luma4B.x\\n  #else\\n  FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\\n  #if (FXAA_GREEN_AS_LUMA == 0)\\n  #define lumaM rgbyM.w\\n  #else\\n  #define lumaM rgbyM.y\\n  #endif\\n  #if (FXAA_GLSL_100 == 1)\\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(0.0, 1.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(1.0, 0.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(0.0, -1.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));\\n  #else\\n  FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(0, 1), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, 0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(0, -1), fxaaQualityRcpFrame.xy));\\n  #endif\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat maxSM = max(lumaS, lumaM);\\n  FxaaFloat minSM = min(lumaS, lumaM);\\n  FxaaFloat maxESM = max(lumaE, maxSM);\\n  FxaaFloat minESM = min(lumaE, minSM);\\n  FxaaFloat maxWN = max(lumaN, lumaW);\\n  FxaaFloat minWN = min(lumaN, lumaW);\\n  FxaaFloat rangeMax = max(maxWN, maxESM);\\n  FxaaFloat rangeMin = min(minWN, minESM);\\n  FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\\n  FxaaFloat range = rangeMax - rangeMin;\\n  FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\\n  FxaaBool earlyExit = range < rangeMaxClamped;\\n  /*--------------------------------------------------------------------------*/\\n  if (earlyExit)\\n  #if (FXAA_DISCARD == 1)\\n    FxaaDiscard;\\n  #else\\n  return rgbyM;\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  #if (FXAA_GATHER4_ALPHA == 0)\\n  #if (FXAA_GLSL_100 == 1)\\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, -1.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(1.0, 1.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(1.0, -1.0), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));\\n  #else\\n  FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, -1), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, 1), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\\n  #endif\\n  #else\\n  FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));\\n  FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\\n  #endif\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat lumaNS = lumaN + lumaS;\\n  FxaaFloat lumaWE = lumaW + lumaE;\\n  FxaaFloat subpixRcpRange = 1.0 / range;\\n  FxaaFloat subpixNSWE = lumaNS + lumaWE;\\n  FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\\n  FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat lumaNESE = lumaNE + lumaSE;\\n  FxaaFloat lumaNWNE = lumaNW + lumaNE;\\n  FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\\n  FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat lumaNWSW = lumaNW + lumaSW;\\n  FxaaFloat lumaSWSE = lumaSW + lumaSE;\\n  FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\\n  FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\\n  FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\\n  FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\\n  FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\\n  FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\\n  FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\\n  FxaaBool horzSpan = edgeHorz >= edgeVert;\\n  FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\\n  /*--------------------------------------------------------------------------*/\\n  if (!horzSpan) lumaN = lumaW;\\n  if (!horzSpan) lumaS = lumaE;\\n  if (horzSpan) lengthSign = fxaaQualityRcpFrame.y;\\n  FxaaFloat subpixB = (subpixA * (1.0 / 12.0)) - lumaM;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat gradientN = lumaN - lumaM;\\n  FxaaFloat gradientS = lumaS - lumaM;\\n  FxaaFloat lumaNN = lumaN + lumaM;\\n  FxaaFloat lumaSS = lumaS + lumaM;\\n  FxaaBool pairN = abs(gradientN) >= abs(gradientS);\\n  FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\\n  if (pairN) lengthSign = -lengthSign;\\n  FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat2 posB;\\n  posB.x = posM.x;\\n  posB.y = posM.y;\\n  FxaaFloat2 offNP;\\n  offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\\n  offNP.y = (horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\\n  if (!horzSpan) posB.x += lengthSign * 0.5;\\n  if (horzSpan) posB.y += lengthSign * 0.5;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat2 posN;\\n  posN.x = posB.x - offNP.x * FXAA_QUALITYP0;\\n  posN.y = posB.y - offNP.y * FXAA_QUALITYP0;\\n  FxaaFloat2 posP;\\n  posP.x = posB.x + offNP.x * FXAA_QUALITYP0;\\n  posP.y = posB.y + offNP.y * FXAA_QUALITYP0;\\n  FxaaFloat subpixD = ((-2.0) * subpixC) + 3.0;\\n  FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\\n  FxaaFloat subpixE = subpixC * subpixC;\\n  FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\\n  /*--------------------------------------------------------------------------*/\\n  if (!pairN) lumaNN = lumaSS;\\n  FxaaFloat gradientScaled = gradient * 1.0 / 4.0;\\n  FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\\n  FxaaFloat subpixF = subpixD * subpixE;\\n  FxaaBool lumaMLTZero = lumaMM < 0.0;\\n  /*--------------------------------------------------------------------------*/\\n  lumaEndN -= lumaNN * 0.5;\\n  lumaEndP -= lumaNN * 0.5;\\n  FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\\n  FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\\n  if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP1;\\n  if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP1;\\n  FxaaBool doneNP = (!doneN) || (!doneP);\\n  if (!doneP) posP.x += offNP.x * FXAA_QUALITYP1;\\n  if (!doneP) posP.y += offNP.y * FXAA_QUALITYP1;\\n  /*--------------------------------------------------------------------------*/\\n  if (doneNP) {\\n    if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n    if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n    if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n    if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n    doneN = abs(lumaEndN) >= gradientScaled;\\n    doneP = abs(lumaEndP) >= gradientScaled;\\n    if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP2;\\n    if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP2;\\n    doneNP = (!doneN) || (!doneP);\\n    if (!doneP) posP.x += offNP.x * FXAA_QUALITYP2;\\n    if (!doneP) posP.y += offNP.y * FXAA_QUALITYP2;\\n    /*--------------------------------------------------------------------------*/\\n    #if (FXAA_QUALITYPS > 3)\\n      if (doneNP) {\\n        if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n        if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n        if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n        if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n        doneN = abs(lumaEndN) >= gradientScaled;\\n        doneP = abs(lumaEndP) >= gradientScaled;\\n        if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP3;\\n        if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP3;\\n        doneNP = (!doneN) || (!doneP);\\n        if (!doneP) posP.x += offNP.x * FXAA_QUALITYP3;\\n        if (!doneP) posP.y += offNP.y * FXAA_QUALITYP3;\\n        /*--------------------------------------------------------------------------*/\\n        #if (FXAA_QUALITYPS > 4)\\n          if (doneNP) {\\n            if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n            if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n            if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n            if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n            doneN = abs(lumaEndN) >= gradientScaled;\\n            doneP = abs(lumaEndP) >= gradientScaled;\\n            if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP4;\\n            if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP4;\\n            doneNP = (!doneN) || (!doneP);\\n            if (!doneP) posP.x += offNP.x * FXAA_QUALITYP4;\\n            if (!doneP) posP.y += offNP.y * FXAA_QUALITYP4;\\n            /*--------------------------------------------------------------------------*/\\n            #if (FXAA_QUALITYPS > 5)\\n              if (doneNP) {\\n                if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                doneN = abs(lumaEndN) >= gradientScaled;\\n                doneP = abs(lumaEndP) >= gradientScaled;\\n                if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP5;\\n                if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP5;\\n                doneNP = (!doneN) || (!doneP);\\n                if (!doneP) posP.x += offNP.x * FXAA_QUALITYP5;\\n                if (!doneP) posP.y += offNP.y * FXAA_QUALITYP5;\\n                /*--------------------------------------------------------------------------*/\\n                #if (FXAA_QUALITYPS > 6)\\n                  if (doneNP) {\\n                    if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                    if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                    if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                    if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                    doneN = abs(lumaEndN) >= gradientScaled;\\n                    doneP = abs(lumaEndP) >= gradientScaled;\\n                    if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP6;\\n                    if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP6;\\n                    doneNP = (!doneN) || (!doneP);\\n                    if (!doneP) posP.x += offNP.x * FXAA_QUALITYP6;\\n                    if (!doneP) posP.y += offNP.y * FXAA_QUALITYP6;\\n                    /*--------------------------------------------------------------------------*/\\n                    #if (FXAA_QUALITYPS > 7)\\n                      if (doneNP) {\\n                        if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                        if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                        if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                        if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                        doneN = abs(lumaEndN) >= gradientScaled;\\n                        doneP = abs(lumaEndP) >= gradientScaled;\\n                        if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP7;\\n                        if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP7;\\n                        doneNP = (!doneN) || (!doneP);\\n                        if (!doneP) posP.x += offNP.x * FXAA_QUALITYP7;\\n                        if (!doneP) posP.y += offNP.y * FXAA_QUALITYP7;\\n                        /*--------------------------------------------------------------------------*/\\n                        #if (FXAA_QUALITYPS > 8)\\n                          if (doneNP) {\\n                            if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                            if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                            if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                            if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                            doneN = abs(lumaEndN) >= gradientScaled;\\n                            doneP = abs(lumaEndP) >= gradientScaled;\\n                            if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP8;\\n                            if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP8;\\n                            doneNP = (!doneN) || (!doneP);\\n                            if (!doneP) posP.x += offNP.x * FXAA_QUALITYP8;\\n                            if (!doneP) posP.y += offNP.y * FXAA_QUALITYP8;\\n                            /*--------------------------------------------------------------------------*/\\n                            #if (FXAA_QUALITYPS > 9)\\n                              if (doneNP) {\\n                                if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                                if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                                if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                                if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                                doneN = abs(lumaEndN) >= gradientScaled;\\n                                doneP = abs(lumaEndP) >= gradientScaled;\\n                                if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP9;\\n                                if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP9;\\n                                doneNP = (!doneN) || (!doneP);\\n                                if (!doneP) posP.x += offNP.x * FXAA_QUALITYP9;\\n                                if (!doneP) posP.y += offNP.y * FXAA_QUALITYP9;\\n                                /*--------------------------------------------------------------------------*/\\n                                #if (FXAA_QUALITYPS > 10)\\n                                  if (doneNP) {\\n                                    if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                                    if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                                    if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                                    if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                                    doneN = abs(lumaEndN) >= gradientScaled;\\n                                    doneP = abs(lumaEndP) >= gradientScaled;\\n                                    if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP10;\\n                                    if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP10;\\n                                    doneNP = (!doneN) || (!doneP);\\n                                    if (!doneP) posP.x += offNP.x * FXAA_QUALITYP10;\\n                                    if (!doneP) posP.y += offNP.y * FXAA_QUALITYP10;\\n                                    /*--------------------------------------------------------------------------*/\\n                                    #if (FXAA_QUALITYPS > 11)\\n                                      if (doneNP) {\\n                                        if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                                        if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                                        if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                                        if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                                        doneN = abs(lumaEndN) >= gradientScaled;\\n                                        doneP = abs(lumaEndP) >= gradientScaled;\\n                                        if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP11;\\n                                        if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP11;\\n                                        doneNP = (!doneN) || (!doneP);\\n                                        if (!doneP) posP.x += offNP.x * FXAA_QUALITYP11;\\n                                        if (!doneP) posP.y += offNP.y * FXAA_QUALITYP11;\\n                                        /*--------------------------------------------------------------------------*/\\n                                        #if (FXAA_QUALITYPS > 12)\\n                                          if (doneNP) {\\n                                            if (!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\\n                                            if (!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\\n                                            if (!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\\n                                            if (!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\\n                                            doneN = abs(lumaEndN) >= gradientScaled;\\n                                            doneP = abs(lumaEndP) >= gradientScaled;\\n                                            if (!doneN) posN.x -= offNP.x * FXAA_QUALITYP12;\\n                                            if (!doneN) posN.y -= offNP.y * FXAA_QUALITYP12;\\n                                            doneNP = (!doneN) || (!doneP);\\n                                            if (!doneP) posP.x += offNP.x * FXAA_QUALITYP12;\\n                                            if (!doneP) posP.y += offNP.y * FXAA_QUALITYP12;\\n                                            /*--------------------------------------------------------------------------*/\\n                                          }\\n                                        #endif\\n                                        /*--------------------------------------------------------------------------*/\\n                                      }\\n                                    #endif\\n                                    /*--------------------------------------------------------------------------*/\\n                                  }\\n                                #endif\\n                                /*--------------------------------------------------------------------------*/\\n                              }\\n                            #endif\\n                            /*--------------------------------------------------------------------------*/\\n                          }\\n                        #endif\\n                        /*--------------------------------------------------------------------------*/\\n                      }\\n                    #endif\\n                    /*--------------------------------------------------------------------------*/\\n                  }\\n                #endif\\n                /*--------------------------------------------------------------------------*/\\n              }\\n            #endif\\n            /*--------------------------------------------------------------------------*/\\n          }\\n        #endif\\n        /*--------------------------------------------------------------------------*/\\n      }\\n    #endif\\n    /*--------------------------------------------------------------------------*/\\n  }\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat dstN = posM.x - posN.x;\\n  FxaaFloat dstP = posP.x - posM.x;\\n  if (!horzSpan) dstN = posM.y - posN.y;\\n  if (!horzSpan) dstP = posP.y - posM.y;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\\n  FxaaFloat spanLength = (dstP + dstN);\\n  FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\\n  FxaaFloat spanLengthRcp = 1.0 / spanLength;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaBool directionN = dstN < dstP;\\n  FxaaFloat dst = min(dstN, dstP);\\n  FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\\n  FxaaFloat subpixG = subpixF * subpixF;\\n  FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\\n  FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\\n  /*--------------------------------------------------------------------------*/\\n  FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\\n  FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\\n  if (!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\\n  if (horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\\n  #if (FXAA_DISCARD == 1)\\n    return FxaaTexTop(tex, posM);\\n  #else\\n  return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\\n  #endif\\n}\\n/*==========================================================================*/\\n#endif\\n\\n\\nvoid main(){\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  vec2 screenInfo = get_screenInfo(materialSID, 0);\\n  rt0 = FxaaPixelShader(\\n      v_texcoord,\\n      vec4(0.0),\\n      u_baseColorTexture,\\n      u_baseColorTexture,\\n      u_baseColorTexture,\\n      1.0 / screenInfo,\\n      vec4(0.0),\\n      vec4(0.0),\\n      vec4(0.0),\\n      0.75,\\n      0.166,\\n      0.0833,\\n      0.0,\\n      0.0,\\n      0.0,\\n      vec4(0.0)\\n  );\\n  rt0.a = 1.0;\\n\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.frag?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.vert":
/*!**************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.vert ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin float a_instanceID;\\nin vec2 a_texcoord;\\nin vec3 a_position;\\nout vec2 v_texcoord;\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n/* shaderity: @{matricesGetters} */\\n\\nvoid main(){\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\nfloat cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\r\\nmat4 worldMatrix = get_worldMatrix(a_instanceID);\\r\\nmat4 viewMatrix = get_viewMatrix(cameraSID, 0);\\r\\nmat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\\r\\ngl_Position = projectionMatrix * viewMatrix * worldMatrix * vec4(a_position, 1.0);\\n\\n  v_texcoord = a_texcoord;\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/FXAA3QualityShader/FXAA3QualitySingleShader.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.frag":
/*!**************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.frag ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin vec2 v_texcoord;\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\nvec3 linearToSrgb(vec3 linearColor) {\\n  return pow(linearColor, vec3(1.0/2.2));\\n}\\n\\nvec3 srgbToLinear(vec3 srgbColor) {\\n  return pow(srgbColor, vec3(2.2));\\n}\\n\\n\\nvoid main ()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\nvec4 baseColor = texture2D(u_baseColorTexture, v_texcoord);\\nbaseColor.rgb = linearToSrgb(baseColor.rgb);\\n\\nrt0 = baseColor;\\n\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.frag?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.vert":
/*!**************************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.vert ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nin float a_instanceID;\\nin vec2 a_texcoord;\\nin vec3 a_position;\\nout vec2 v_texcoord;\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n/* shaderity: @{matricesGetters} */\\n\\nvoid main()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\nfloat cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\r\\nmat4 worldMatrix = get_worldMatrix(a_instanceID);\\r\\nmat4 viewMatrix = get_viewMatrix(cameraSID, 0);\\r\\nmat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\\r\\ngl_Position = projectionMatrix * viewMatrix * worldMatrix * vec4(a_position, 1.0);\\n\\nv_texcoord = a_texcoord;\\n\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/GammaCorrectionShader/GammaCorrectionShader.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.frag":
/*!**************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.frag ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\n#ifdef WEBGL1_EXT_SHADER_TEXTURE_LOD\\r\\n#extension GL_EXT_shader_texture_lod : require\\r\\n#endif\\r\\n\\r\\n#ifdef WEBGL1_EXT_STANDARD_DERIVATIVES\\r\\n#extension GL_OES_standard_derivatives : require\\r\\n#endif\\r\\n\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin vec3 v_color;\\nin vec3 v_normal_inWorld;\\nin vec3 v_tangent_inWorld;\\nin vec3 v_binormal_inWorld;\\nin vec4 v_position_inWorld;\\nin vec2 v_texcoord;\\nin vec3 v_baryCentricCoord;\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\nconst float M_PI = 3.141592653589793;\\r\\nconst float c_MinRoughness = 0.04;\\r\\n\\r\\nfloat angular_n_h(float NH) {\\r\\n  return acos(NH);\\r\\n}\\r\\n\\r\\nfloat sqr(float x) {\\r\\n  return x*x;\\r\\n}\\r\\n\\r\\nfloat d_phong(float NH, float c1) {\\r\\n  return pow(\\r\\n    cos(acos(NH))\\r\\n    , c1\\r\\n  );\\r\\n}\\r\\n\\r\\n// this is from https://www.unrealengine.com/blog/physically-based-shading-on-mobile\\r\\nvec3 envBRDFApprox( vec3 F0, float Roughness, float NoV ) {\\r\\n  const vec4 c0 = vec4(-1, -0.0275, -0.572, 0.022 );\\r\\n  const vec4 c1 = vec4(1, 0.0425, 1.04, -0.04 );\\r\\n  vec4 r = Roughness * c0 + c1;\\r\\n  float a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\\r\\n  vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\r\\n\\r\\n  return F0 * AB.x + AB.y;\\r\\n}\\r\\n\\r\\n// GGX NDF\\r\\nfloat d_ggx(float NH, float alphaRoughness) {\\r\\n  float roughnessSqr = alphaRoughness * alphaRoughness;\\r\\n  float f = (roughnessSqr - 1.0) * NH * NH + 1.0;\\r\\n  return roughnessSqr / (M_PI * f * f);\\r\\n}\\r\\n\\r\\nfloat d_torrance_reiz(float NH, float c3) {\\r\\n  float CosSquared = NH*NH;\\r\\n  float TanSquared = (1.0 - CosSquared)/CosSquared;\\r\\n  //return (1.0/M_PI) * sqr(c3/(CosSquared * (c3*c3 + TanSquared)));  // gamma = 2, aka GGX\\r\\n  return (1.0/sqrt(M_PI)) * (sqr(c3)/(CosSquared * (c3*c3 + TanSquared))); // gamma = 1, D_Berry\\r\\n}\\r\\n\\r\\nfloat d_beckmann(float NH, float m) {\\r\\n  float co = 1.0 / (4.0 * m * m * NH * NH * NH * NH);\\r\\n  float expx = exp((NH * NH - 1.0) / (m * m * NH * NH));\\r\\n  return co * expx;\\r\\n}\\r\\n\\r\\n// the same as glTF WebGL sample\\r\\n// https://github.com/KhronosGroup/glTF-WebGL-PBR/blob/88eda8c5358efe03128b72b6c5f5f6e5b6d023e1/shaders/pbr-frag.glsl#L188\\r\\n// That is, Unreal Engine based approach, but modified to use alphaRoughness (squared artist's roughness parameter),\\r\\n// and based on 'Separable Masking and Shadowing' approximation (propesed by Christophe Schlick)\\r\\n// https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\\r\\nfloat g_shielding(float NL, float NV, float alphaRoughness) {\\r\\n  float r = alphaRoughness;\\r\\n\\r\\n  // Local Shadowing using \\\"Schlick-Smith\\\" Masking Function\\r\\n  float localShadowing = 2.0 * NL / (NL + sqrt(r * r + (1.0 - r * r) * (NL * NL)));\\r\\n\\r\\n  // Local Masking using \\\"Schlick-Smith\\\" Masking Function\\r\\n  float localMasking = 2.0 * NV / (NV + sqrt(r * r + (1.0 - r * r) * (NV * NV)));\\r\\n\\r\\n  return localShadowing * localMasking;\\r\\n}\\r\\n\\r\\n// The code from https://google.github.io/filament/Filament.html#listing_approximatedspecularv\\r\\n// The idea is from [Heitz14] Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs.\\r\\nfloat v_SmithGGXCorrelated(float NL, float NV, float alphaRoughness) {\\r\\n  float a2 = alphaRoughness * alphaRoughness;\\r\\n  float GGXV = NL * sqrt(NV * NV * (1.0 - a2) + a2);\\r\\n  float GGXL = NV * sqrt(NL * NL * (1.0 - a2) + a2);\\r\\n  return 0.5 / (GGXV + GGXL);\\r\\n}\\r\\n\\r\\nfloat v_SmithGGXCorrelatedFast(float NL, float NV, float alphaRoughness) {\\r\\n  float a = alphaRoughness;\\r\\n  float GGXV = NL * (NV * (1.0 - a) + a);\\r\\n  float GGXL = NV * (NL * (1.0 - a) + a);\\r\\n  return 0.5 / (GGXV + GGXL);\\r\\n}\\r\\n\\r\\n// The Schlick Approximation to Fresnel\\r\\nvec3 fresnel(vec3 f0, float VH) {\\r\\n  return vec3(f0) + (vec3(1.0) - f0) * pow(1.0 - VH, 5.0);\\r\\n}\\r\\n\\r\\nvec3 cook_torrance_specular_brdf(float NH, float NL, float NV, vec3 F, float alphaRoughness) {\\r\\n  float D = d_ggx(NH, alphaRoughness);\\r\\n  float V = v_SmithGGXCorrelated(NL, NV, alphaRoughness);\\r\\n  return vec3(D)*vec3(V)*F;\\r\\n//      float G = g_shielding(NL, NV, alphaRoughness);\\r\\n//      return vec3(D)*vec3(G)*F/vec3(4.0*NL*NV);\\r\\n\\r\\n}\\r\\n\\r\\nvec3 diffuse_brdf(vec3 albedo)\\r\\n{\\r\\n  return albedo / M_PI;\\r\\n}\\r\\n\\r\\nvec3 srgbToLinear(vec3 srgbColor) {\\r\\n  return pow(srgbColor, vec3(2.2));\\r\\n}\\r\\n\\r\\nfloat srgbToLinear(float value) {\\r\\n  return pow(value, 2.2);\\r\\n}\\r\\n\\r\\nvec3 linearToSrgb(vec3 linearColor) {\\r\\n  return pow(linearColor, vec3(1.0/2.2));\\r\\n}\\r\\n\\r\\nfloat linearToSrgb(float value) {\\r\\n  return pow(value, 1.0/2.2);\\r\\n}\\r\\n\\r\\nvec3 fresnelSchlickRoughness(vec3 F0, float cosTheta, float roughness)\\r\\n{\\r\\n  return F0 + (max(vec3(1.0 - roughness), F0) - F0) * pow(1.0 - cosTheta, 5.0);\\r\\n}\\r\\n\\r\\nvec3 normalBlendingUDN(sampler2D baseMap, sampler2D detailMap, vec2 baseUv, vec2 detailUv) {\\r\\n  vec3 t = texture2D(baseMap,   baseUv).xyz * 2.0 - 1.0;\\r\\n  vec3 u = texture2D(detailMap, detailUv).xyz * 2.0 - 1.0;\\r\\n  vec3 r = normalize(vec3(t.xy + u.xy, t.z));\\r\\n  return r;\\r\\n}\\r\\n\\r\\nvec2 uvTransform(vec2 scale, vec2 offset, float rotation, vec2 uv) {\\r\\n  mat3 translationMat = mat3(1,0,0, 0,1,0, offset.x, offset.y, 1);\\r\\n  mat3 rotationMat = mat3(\\r\\n      cos(rotation), -sin(rotation), 0,\\r\\n      sin(rotation), cos(rotation), 0,\\r\\n                  0,             0, 1\\r\\n  );\\r\\n  mat3 scaleMat = mat3(scale.x,0,0, 0,scale.y,0, 0,0,1);\\r\\n\\r\\n  mat3 matrix = translationMat * rotationMat * scaleMat;\\r\\n  vec2 uvTransformed = ( matrix * vec3(uv.xy, 1) ).xy;\\r\\n\\r\\n  return uvTransformed;\\r\\n}\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\nvec3 IBLContribution(float materialSID, vec3 n, float NV, vec3 reflection, vec3 albedo, vec3 F0, float userRoughness, vec3 F)\\n{\\n  vec4 iblParameter = get_iblParameter(materialSID, 0);\\n  float mipCount = iblParameter.x;\\n  float lod = (userRoughness * (mipCount - 1.0));\\n\\n  vec4 diffuseTexel = textureCube(u_diffuseEnvTexture, vec3(-n.x, n.y, n.z));\\n  vec3 diffuseLight;\\n  ivec2 hdriFormat = get_hdriFormat(materialSID, 0);\\n  if (hdriFormat.x == 0) {\\n    // LDR_SRGB\\n    diffuseLight = srgbToLinear(diffuseTexel.rgb);\\n  }\\n  else if (hdriFormat.x == 3) {\\n    // RGBE\\n    diffuseLight = diffuseTexel.rgb * pow(2.0, diffuseTexel.a*255.0-128.0);\\n  }\\n  else {\\n    diffuseLight = diffuseTexel.rgb;\\n  }\\n\\n#ifdef WEBGL1_EXT_SHADER_TEXTURE_LOD\\r\\n  vec4 specularTexel = textureCubeLodEXT(u_specularEnvTexture, vec3(-reflection.x, reflection.y, reflection.z), lod);\\r\\n#else\\r\\n  vec4 specularTexel = textureCube(u_specularEnvTexture, vec3(-reflection.x, reflection.y, reflection.z));\\r\\n#endif\\r\\n\\n\\n  vec3 specularLight;\\n  if (hdriFormat.y == 0) {\\n    // LDR_SRGB\\n    specularLight = srgbToLinear(specularTexel.rgb);\\n  }\\n  else if (hdriFormat.y == 3) {\\n    // RGBE\\n    specularLight = specularTexel.rgb * pow(2.0, specularTexel.a*255.0-128.0);\\n  }\\n  else {\\n    specularLight = specularTexel.rgb;\\n  }\\n\\n  vec3 kS = fresnelSchlickRoughness(F0, NV, userRoughness);\\n  vec3 kD = 1.0 - kS;\\n  vec3 diffuse = diffuseLight * albedo * kD;\\n  // vec3 brdf = texture2D(u_brdfLutTexture, vec2(1.0 - NV, 1.0 - userRoughness)).rgb;\\n  // vec3 specular = specularLight * (F0 * brdf.x + brdf.y);\\n  vec3 specular = specularLight * envBRDFApprox(F0, userRoughness, NV);\\n\\n  float IBLDiffuseContribution = iblParameter.y;\\n  float IBLSpecularContribution = iblParameter.z;\\n  diffuse *= IBLDiffuseContribution;\\n  specular *= IBLSpecularContribution;\\n  return diffuse + specular;\\n}\\n\\nfloat edge_ratio(vec3 bary3, float wireframeWidthInner, float wireframeWidthRelativeScale) {\\n  vec3 d = fwidth(bary3);\\n  vec3 x = bary3+vec3(1.0 - wireframeWidthInner)*d;\\n  vec3 a3 = smoothstep(vec3(0.0), d, x);\\n  float factor = min(min(a3.x, a3.y), a3.z);\\n\\n  return clamp((1.0 - factor), 0.0, 1.0);\\n}\\n\\n\\n\\n\\n\\n\\nvoid main ()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  // Normal\\n  vec3 normal_inWorld = normalize(v_normal_inWorld);\\n  vec4 iblParameter = get_iblParameter(materialSID, 0);\\n  float rot = iblParameter.w + 3.1415;\\n  mat3 rotEnvMatrix = mat3(cos(rot), 0.0, -sin(rot), 0.0, 1.0, 0.0, sin(rot), 0.0, cos(rot));\\n  vec3 normal_forEnv = rotEnvMatrix * normal_inWorld;\\n\\n  if (abs(length(v_tangent_inWorld)) > 0.01) {\\n    vec4 normalTextureTransform = get_normalTextureTransform(materialSID, 0);\\n    float normalTextureRotation = get_normalTextureRotation(materialSID, 0);\\n    vec2 normalTexUv = uvTransform(normalTextureTransform.xy, normalTextureTransform.zw, normalTextureRotation, v_texcoord);\\n    vec3 normal = texture2D(u_normalTexture, normalTexUv).xyz*2.0 - 1.0;\\n    vec3 tangent_inWorld = normalize(v_tangent_inWorld);\\n    vec3 binormal_inWorld = normalize(v_binormal_inWorld);\\n    normal_inWorld = normalize(normal_inWorld);\\n\\n    mat3 tbnMat_tangent_to_world = mat3(\\n      tangent_inWorld.x, tangent_inWorld.y, tangent_inWorld.z,\\n      binormal_inWorld.x, binormal_inWorld.y, binormal_inWorld.z,\\n      normal_inWorld.x, normal_inWorld.y, normal_inWorld.z\\n    );\\n\\n    normal = normalize(tbnMat_tangent_to_world * normal);\\n    normal_inWorld = normal;\\n  }\\n\\n\\n\\n  // BaseColorFactor\\n  vec3 baseColor = vec3(0.0, 0.0, 0.0);\\n  float alpha = 1.0;\\n  vec4 baseColorFactor = get_baseColorFactor(materialSID, 0);\\n  if (v_color != baseColor && baseColorFactor.rgb != baseColor) {\\n    baseColor = v_color * baseColorFactor.rgb;\\n    alpha = baseColorFactor.a;\\n  } else if (v_color == baseColor) {\\n    baseColor = baseColorFactor.rgb;\\n    alpha = baseColorFactor.a;\\n  } else if (baseColorFactor.rgb == baseColor) {\\n    baseColor = v_color;\\n  } else {\\n    baseColor = vec3(1.0, 1.0, 1.0);\\n  }\\n\\n\\n  // BaseColor (take account for BaseColorTexture)\\n  vec4 baseColorTextureTransform = get_baseColorTextureTransform(materialSID, 0);\\n  float baseColorTextureRotation = get_baseColorTextureRotation(materialSID, 0);\\n  vec2 baseColorTexUv = uvTransform(baseColorTextureTransform.xy, baseColorTextureTransform.zw, baseColorTextureRotation, v_texcoord);\\nvec4 textureColor = texture2D(u_baseColorTexture, baseColorTexUv);\\n  baseColor *= srgbToLinear(textureColor.rgb);\\n  alpha *= textureColor.a;\\n\\n#ifdef RN_IS_ALPHAMODE_MASK\\r\\n  float alphaCutoff = get_alphaCutoff(materialSID, 0);\\r\\n  if (alpha < alphaCutoff) {\\r\\n    discard;\\r\\n  }\\r\\n#endif\\n\\n#ifdef RN_IS_LIGHTING\\n\\n  // Metallic & Roughness\\n  vec2 metallicRoughnessFactor = get_metallicRoughnessFactor(materialSID, 0);\\n  float userRoughness = metallicRoughnessFactor.y;\\n  float metallic = metallicRoughnessFactor.x;\\n\\n  vec4 metallicRoughnessTextureTransform = get_metallicRoughnessTextureTransform(materialSID, 0);\\n  float metallicRoughnessTextureRotation = get_metallicRoughnessTextureRotation(materialSID, 0);\\n  vec2 metallicRoughnessTexUv = uvTransform(metallicRoughnessTextureTransform.xy, metallicRoughnessTextureTransform.zw, metallicRoughnessTextureRotation, v_texcoord);\\n  vec4 ormTexel = texture2D(u_metallicRoughnessTexture, metallicRoughnessTexUv);\\n  userRoughness = ormTexel.g * userRoughness;\\n  metallic = ormTexel.b * metallic;\\n\\n  userRoughness = clamp(userRoughness, c_MinRoughness, 1.0);\\n  metallic = clamp(metallic, 0.0, 1.0);\\n  float alphaRoughness = userRoughness * userRoughness;\\n\\n  // F0\\n  vec3 diffuseMatAverageF0 = vec3(0.04);\\n  vec3 F0 = mix(diffuseMatAverageF0, baseColor.rgb, metallic);\\n\\n  // Albedo\\n  vec3 albedo = baseColor.rgb * (vec3(1.0) - diffuseMatAverageF0);\\n  albedo.rgb *= (1.0 - metallic);\\n\\n  // ViewDirection\\n  float cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\n  vec3 viewPosition = get_viewPosition(cameraSID, 0);\\n  vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\\n\\n  // NV\\n  float NV = clamp(abs(dot(normal_inWorld, viewDirection)), 0.0, 1.0);\\n\\n  rt0 = vec4(0.0, 0.0, 0.0, alpha);\\n\\n  // Lighting\\n  vec3 diffuse = vec3(0.0, 0.0, 0.0);\\n  for (int i = 0; i < /* shaderity: @{Config.maxLightNumberInShader} */; i++) {\\n    if (i >= lightNumber) {\\n      break;\\n    }\\n\\n    // Light\\n    vec4 gotLightDirection = get_lightDirection(0.0, i);\\n    vec4 gotLightPosition = get_lightPosition(0.0, i);\\n    vec4 gotLightIntensity = get_lightIntensity(0.0, i);\\n    vec3 lightDirection = gotLightDirection.xyz;\\n    vec3 lightIntensity = gotLightIntensity.xyz;\\n    vec3 lightPosition = gotLightPosition.xyz;\\n    float lightType = gotLightPosition.w;\\n    float spotCosCutoff = gotLightDirection.w;\\n    float spotExponent = gotLightIntensity.w;\\n\\n    if (0.75 < lightType) { // is pointlight or spotlight\\n      lightDirection = normalize(lightPosition.xyz - v_position_inWorld.xyz);\\n    }\\n    float spotEffect = 1.0;\\n    if (lightType > 1.75) { // is spotlight\\n      spotEffect = dot(gotLightDirection.xyz, lightDirection);\\n      if (spotEffect > spotCosCutoff) {\\n        spotEffect = pow(spotEffect, spotExponent);\\n      } else {\\n        spotEffect = 0.0;\\n      }\\n    }\\n    //diffuse += 1.0 * max(0.0, dot(normal_inWorld, lightDirection)) * spotEffect * lightIntensity.xyz;\\n\\n    // IncidentLight\\n    vec3 incidentLight = spotEffect * lightIntensity.xyz;\\n    incidentLight *= M_PI;\\n\\n    // Fresnel\\n    vec3 halfVector = normalize(lightDirection + viewDirection);\\n    float VH = clamp(dot(viewDirection, halfVector), 0.0, 1.0);\\n    vec3 F = fresnel(F0, VH);\\n\\n    // Diffuse\\n    vec3 diffuseContrib = (vec3(1.0) - F) * diffuse_brdf(albedo);\\n\\n    // Specular\\n    float NL = clamp(dot(normal_inWorld, lightDirection), 0.0, 1.0);\\n    float NH = clamp(dot(normal_inWorld, halfVector), 0.0, 1.0);\\n    vec3 specularContrib = cook_torrance_specular_brdf(NH, NL, NV, F, alphaRoughness);\\n    vec3 diffuseAndSpecular = (diffuseContrib + specularContrib) * vec3(NL) * incidentLight.rgb;\\n\\n    rt0.xyz += diffuseAndSpecular;\\n//      rt0.xyz += specularContrib * vec3(NL) * incidentLight.rgb;\\n//    rt0.xyz += diffuseContrib * vec3(NL) * incidentLight.rgb;\\n//    rt0.xyz += (vec3(1.0) - F) * diffuse_brdf(albedo);//diffuseContrib;//vec3(NL) * incidentLight.rgb;\\n  }\\n\\n  vec3 reflection = rotEnvMatrix * reflect(-viewDirection, normal_inWorld);\\n\\n  vec3 F = fresnel(F0, NV);\\n  vec3 ibl = IBLContribution(materialSID, normal_forEnv, NV, reflection, albedo, F0, userRoughness, F);\\n  float occlusion = texture2D(u_occlusionTexture, v_texcoord).r;\\n\\n  // Occlution to Indirect Lights\\n  rt0.xyz += ibl * occlusion;\\n#else\\n  rt0 = vec4(baseColor, alpha);\\n#endif\\n\\n  // Emissive\\n  vec3 emissive = srgbToLinear(texture2D(u_emissiveTexture, v_texcoord).xyz);\\n\\n  rt0.xyz += emissive;\\n\\n  bool isOutputHDR = get_isOutputHDR(materialSID, 0);\\n  if(isOutputHDR){\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n    return;\\n  }\\n\\n#ifdef RN_IS_ALPHAMODE_OPAQUE\\r\\n  rt0.a = 1.0;\\r\\n#elif defined(RN_IS_ALPHAMODE_MASK)\\r\\n  rt0.a = 1.0;\\r\\n#endif\\n\\n  // Wireframe\\n  float threshold = 0.001;\\n  vec3 wireframe = get_wireframe(materialSID, 0);\\n  float wireframeWidthInner = wireframe.z;\\n  float wireframeWidthRelativeScale = 1.0;\\n  if (wireframe.x > 0.5 && wireframe.y < 0.5) {\\n    rt0.a = 0.0;\\n  }\\n  vec4 wireframeResult = rt0;\\n  vec4 wireframeColor = vec4(0.2, 0.75, 0.0, 1.0);\\n  float edgeRatio = edge_ratio(v_baryCentricCoord, wireframeWidthInner, wireframeWidthRelativeScale);\\n  float edgeRatioModified = mix(step(threshold, edgeRatio), clamp(edgeRatio*4.0, 0.0, 1.0), wireframeWidthInner / wireframeWidthRelativeScale/4.0);\\n  // if r0.a is 0.0, it is wireframe not on shaded\\n  wireframeResult.rgb = wireframeColor.rgb * edgeRatioModified + rt0.rgb * (1.0 - edgeRatioModified);\\n  wireframeResult.a = max(rt0.a, wireframeColor.a * mix(edgeRatioModified, pow(edgeRatioModified, 100.0), wireframeWidthInner / wireframeWidthRelativeScale/1.0));\\n\\n  if (wireframe.x > 0.5) {\\n    rt0 = wireframeResult;\\n    if (wireframe.y < 0.5 && rt0.a == 0.0) {\\n      discard;\\n    }\\n  }\\n\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.frag?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.vert":
/*!**************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.vert ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nin vec3 a_position;\\nin vec3 a_color;\\nin vec3 a_normal;\\nin vec4 a_tangent;\\nin float a_instanceID;\\nin vec2 a_texcoord;\\nin vec4 a_joint;\\nin vec4 a_weight;\\nin vec4 a_baryCentricCoord;\\nout vec3 v_color;\\nout vec3 v_normal_inWorld;\\nout vec3 v_tangent_inWorld;\\nout vec3 v_binormal_inWorld;\\nout vec4 v_position_inWorld;\\nout vec2 v_texcoord;\\nout vec3 v_baryCentricCoord;\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n/* shaderity: @{matricesGetters} */\\n\\nmat3 toNormalMatrix(mat4 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n  a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n  a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n  a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3];\\r\\n\\r\\n  float b00 = a00 * a11 - a01 * a10,\\r\\n  b01 = a00 * a12 - a02 * a10,\\r\\n  b02 = a00 * a13 - a03 * a10,\\r\\n  b03 = a01 * a12 - a02 * a11,\\r\\n  b04 = a01 * a13 - a03 * a11,\\r\\n  b05 = a02 * a13 - a03 * a12,\\r\\n  b06 = a20 * a31 - a21 * a30,\\r\\n  b07 = a20 * a32 - a22 * a30,\\r\\n  b08 = a20 * a33 - a23 * a30,\\r\\n  b09 = a21 * a32 - a22 * a31,\\r\\n  b10 = a21 * a33 - a23 * a31,\\r\\n  b11 = a22 * a33 - a23 * a32;\\r\\n\\r\\n  float determinantVal = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat3(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09, a12 * b08 - a10 * b11 - a13 * b07, a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09, a00 * b11 - a02 * b08 + a03 * b07, a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03, a32 * b02 - a30 * b05 - a33 * b01, a30 * b04 - a31 * b02 + a33 * b00) / determinantVal;\\r\\n}\\r\\n\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n\\r\\nhighp mat4 createMatrixFromQuaternionTransformUniformScale( highp vec4 quaternion, highp vec4 translationScale ) {\\r\\n  highp vec4 q = quaternion;\\r\\n  highp vec3 t = translationScale.xyz;\\r\\n  highp float scale = translationScale.w;\\r\\n\\r\\n  highp float sx = q.x * q.x;\\r\\n  highp float sy = q.y * q.y;\\r\\n  highp float sz = q.z * q.z;\\r\\n  highp float cx = q.y * q.z;\\r\\n  highp float cy = q.x * q.z;\\r\\n  highp float cz = q.x * q.y;\\r\\n  highp float wx = q.w * q.x;\\r\\n  highp float wy = q.w * q.y;\\r\\n  highp float wz = q.w * q.z;\\r\\n\\r\\n  highp mat4 mat = mat4(\\r\\n    1.0 - 2.0 * (sy + sz), 2.0 * (cz + wz), 2.0 * (cy - wy), 0.0,\\r\\n    2.0 * (cz - wz), 1.0 - 2.0 * (sx + sz), 2.0 * (cx + wx), 0.0,\\r\\n    2.0 * (cy + wy), 2.0 * (cx - wx), 1.0 - 2.0 * (sx + sy), 0.0,\\r\\n    t.x, t.y, t.z, 1.0\\r\\n  );\\r\\n\\r\\n  highp mat4 uniformScaleMat = mat4(\\r\\n    scale, 0.0, 0.0, 0.0,\\r\\n    0.0, scale, 0.0, 0.0,\\r\\n    0.0, 0.0, scale, 0.0,\\r\\n    0.0, 0.0, 0.0, 1.0\\r\\n  );\\r\\n\\r\\n  return mat*uniformScaleMat;\\r\\n}\\r\\n\\r\\nhighp vec4 unpackedVec2ToNormalizedVec4(highp vec2 vec_xy, highp float criteria){\\r\\n\\r\\n  highp float r;\\r\\n  highp float g;\\r\\n  highp float b;\\r\\n  highp float a;\\r\\n\\r\\n  highp float ix = floor(vec_xy.x * criteria);\\r\\n  highp float v1x = ix / criteria;\\r\\n  highp float v1y = ix - floor(v1x) * criteria;\\r\\n\\r\\n  r = ( v1x + 1.0 ) / (criteria-1.0);\\r\\n  g = ( v1y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  highp float iy = floor( vec_xy.y * criteria);\\r\\n  highp float v2x = iy / criteria;\\r\\n  highp float v2y = iy - floor(v2x) * criteria;\\r\\n\\r\\n  b = ( v2x + 1.0 ) / (criteria-1.0);\\r\\n  a = ( v2y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  r -= 1.0/criteria;\\r\\n  g -= 1.0/criteria;\\r\\n  b -= 1.0/criteria;\\r\\n  a -= 1.0/criteria;\\r\\n\\r\\n  r = r*2.0-1.0;\\r\\n  g = g*2.0-1.0;\\r\\n  b = b*2.0-1.0;\\r\\n  a = a*2.0-1.0;\\r\\n\\r\\n  return vec4(r, g, b, a);\\r\\n}\\r\\n\\r\\nmat4 getSkinMatrix(float skeletalComponentSID) {\\r\\n\\r\\n#ifdef RN_BONE_DATA_TYPE_MAT4X4\\r\\n  mat4 skinMat = a_weight.x * get_boneMatrix(skeletalComponentSID, int(a_joint.x));\\r\\n  skinMat += a_weight.y * get_boneMatrix(skeletalComponentSID, int(a_joint.y));\\r\\n  skinMat += a_weight.z * get_boneMatrix(skeletalComponentSID, int(a_joint.z));\\r\\n  skinMat += a_weight.w * get_boneMatrix(skeletalComponentSID, int(a_joint.w));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X2)\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.x)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.x)));\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.y)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.y)));\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.z)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.z)));\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.w)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.w)));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X1)\\r\\n  highp vec4 boneCompressedChunksX = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.x));\\r\\n  highp vec4 boneCompressedChunksY = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.y));\\r\\n  highp vec4 boneCompressedChunksZ = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.z));\\r\\n  highp vec4 boneCompressedChunksW = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.w));\\r\\n\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp vec4 boneCompressedInfo = get_boneCompressedInfo(0.0, 0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.zw, criteria.y)*boneCompressedInfo);\\r\\n#endif\\r\\n\\r\\n  return skinMat;\\r\\n}\\r\\n#endif\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\nbool skinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n  )\\r\\n{\\r\\n  mat4 skinMat = getSkinMatrix(skeletalComponentSID);\\r\\n  outPosition_inWorld = skinMat * vec4(inPosition_inLocal, 1.0);\\r\\n  outNormalMatrix = toNormalMatrix(skinMat);\\r\\n  outNormal_inWorld = normalize(outNormalMatrix * inNormal_inLocal);\\r\\n\\r\\n  return true;\\r\\n}\\r\\n#endif\\r\\n\\r\\nbool processGeometryWithMorphingAndSkinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat4 worldMatrix,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n) {\\r\\n  bool isSkinning = false;\\r\\n\\r\\n  vec3 position_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  if (u_morphTargetNumber == 0) {\\r\\n#endif\\r\\n    position_inLocal = inPosition_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  } else {\\r\\n    float vertexIdx = a_baryCentricCoord.w;\\r\\n    position_inLocal = get_position(vertexIdx, inPosition_inLocal);\\r\\n  }\\r\\n#endif\\r\\n\\r\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n  if (skeletalComponentSID >= 0.0) {\\r\\n    isSkinning = skinning(skeletalComponentSID, inNormalMatrix, outNormalMatrix, position_inLocal, outPosition_inWorld, inNormal_inLocal, outNormal_inWorld);\\r\\n  } else {\\r\\n#endif\\r\\n    outNormalMatrix = inNormalMatrix;\\r\\n    outPosition_inWorld = worldMatrix * vec4(position_inLocal, 1.0);\\r\\n    outNormal_inWorld = normalize(inNormalMatrix * inNormal_inLocal);\\r\\n#ifdef RN_IS_SKINNING\\r\\n  }\\r\\n#endif\\r\\n\\r\\n  return isSkinning;\\r\\n}\\r\\n\\n\\nvoid main()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  float cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\\n\\n  v_color = a_color;\\n\\n  bool isSkinning = false;\\n\\n  isSkinning = processGeometryWithMorphingAndSkinning(\\n    skeletalComponentSID,\\n    worldMatrix,\\n    normalMatrix,\\n    normalMatrix,\\n    a_position,\\n    v_position_inWorld,\\n    a_normal,\\n    v_normal_inWorld\\n  );\\n\\n  gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\\n\\n  v_texcoord = a_texcoord;\\n\\n  if (abs(length(a_normal)) > 0.01) {\\n    // if normal exist\\n    vec3 tangent_inWorld = normalMatrix * a_tangent.xyz;\\n\\n    v_binormal_inWorld = cross(v_normal_inWorld, tangent_inWorld) * a_tangent.w;\\n    v_tangent_inWorld = cross(v_binormal_inWorld, v_normal_inWorld);\\n  }\\n  v_baryCentricCoord = a_baryCentricCoord.xyz;\\n\\nvec4 position_inWorld = worldMatrix * vec4(a_position, 1.0);\\r\\nvec3 viewPosition = get_viewPosition(cameraSID, 0);\\r\\nfloat distanceFromCamera = length(position_inWorld.xyz - viewPosition);\\r\\nvec3 pointDistanceAttenuation = get_pointDistanceAttenuation(materialSID, 0);\\r\\nfloat distanceAttenuationFactor = sqrt(1.0/(pointDistanceAttenuation.x + pointDistanceAttenuation.y * distanceFromCamera + pointDistanceAttenuation.z * distanceFromCamera * distanceFromCamera));\\r\\nfloat maxPointSize = get_pointSize(materialSID, 0);\\r\\ngl_PointSize = clamp(distanceAttenuationFactor * maxPointSize, 0.0, maxPointSize);\\r\\n\\n\\n}\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/PbrSingleShader/PbrSingleShader.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag":
/*!**********************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag ***!
  \**********************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\nin vec3 v_color;\\nin vec3 v_normal_inWorld;\\nin vec4 v_position_inWorld;\\nin vec2 v_texcoord;\\nin vec3 v_baryCentricCoord;\\n\\nuniform int u_shadingModel; // initialValue=0\\nuniform float u_alphaCutoff; // initialValue=0.01\\nuniform float u_shininess; // initialValue=5\\nuniform vec4 u_diffuseColorFactor; // initialValue=(1,1,1,1)\\nuniform sampler2D u_diffuseColorTexture; // initialValue=(0,white)\\nuniform sampler2D u_normalTexture; // initialValue=(1,blue)\\n\\n#ifdef GLSL_ES3\\r\\n  layout(location = 0) out vec4 rt0;\\r\\n#else\\r\\n  vec4 rt0;\\r\\n#endif\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\nvoid main ()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  // Normal\\n  vec3 normal_inWorld = normalize(v_normal_inWorld);\\n\\n  vec4 diffuseColorFactor = get_diffuseColorFactor(materialSID, 0);\\n\\n\\n  // diffuseColor (Considered to be premultiplied alpha)\\n  vec3 diffuseColor = vec3(0.0, 0.0, 0.0);\\n  float alpha = 1.0;\\n  if (v_color != diffuseColor && diffuseColorFactor.rgb != diffuseColor) {\\n    diffuseColor = v_color * diffuseColorFactor.rgb;\\n    alpha = diffuseColorFactor.a;\\n  } else if (v_color == diffuseColor) {\\n    diffuseColor = diffuseColorFactor.rgb;\\n    alpha = diffuseColorFactor.a;\\n  } else if (diffuseColorFactor.rgb == diffuseColor) {\\n    diffuseColor = v_color;\\n  } else {\\n    diffuseColor = vec3(1.0, 1.0, 1.0);\\n  }\\n\\n  // diffuseColorTexture (Considered to be premultiplied alpha)\\n  vec4 textureColor = texture2D(u_diffuseColorTexture, v_texcoord);\\n  diffuseColor *= textureColor.rgb;\\n  alpha *= textureColor.a;\\n\\n#ifdef RN_IS_ALPHAMODE_MASK\\r\\n  float alphaCutoff = get_alphaCutoff(materialSID, 0);\\r\\n  if (alpha < alphaCutoff) {\\r\\n    discard;\\r\\n  }\\r\\n#endif\\n\\n  // Lighting\\n  vec3 shadingColor = vec3(0.0, 0.0, 0.0);\\n#ifdef RN_IS_LIGHTING\\n  int shadingModel = get_shadingModel(materialSID, 0);\\n  if (shadingModel > 0) {\\n\\n    vec3 diffuse = vec3(0.0, 0.0, 0.0);\\n    vec3 specular = vec3(0.0, 0.0, 0.0);\\n    for (int i = 0; i < /* shaderity: @{Config.maxLightNumberInShader} */ ; i++) {\\n      if (i >= lightNumber) {\\n        break;\\n      }\\n\\n      vec4 gotLightDirection = get_lightDirection(0.0, i);\\n      vec4 gotLightPosition = get_lightPosition(0.0, i);\\n      vec4 gotLightIntensity = get_lightIntensity(0.0, i);\\n      vec3 lightDirection = gotLightDirection.xyz;\\n      vec3 lightIntensity = gotLightIntensity.xyz;\\n      vec3 lightPosition = gotLightPosition.xyz;\\n      float lightType = gotLightPosition.w;\\n      float spotCosCutoff = gotLightDirection.w;\\n      float spotExponent = gotLightIntensity.w;\\n\\n      if (0.75 < lightType) { // is pointlight or spotlight\\n        lightDirection = normalize(lightPosition - v_position_inWorld.xyz);\\n      }\\n      float spotEffect = 1.0;\\n      if (lightType > 1.75) { // is spotlight\\n        spotEffect = dot(gotLightDirection.xyz, lightDirection);\\n        if (spotEffect > spotCosCutoff) {\\n          spotEffect = pow(spotEffect, spotExponent);\\n        } else {\\n          spotEffect = 0.0;\\n        }\\n      }\\n\\n      vec3 incidentLight = spotEffect * lightIntensity;\\n\\n\\n\\n      diffuse += diffuseColor * max(0.0, dot(normal_inWorld, lightDirection)) * incidentLight;\\n\\n      float shininess = get_shininess(materialSID, 0);\\n      int shadingModel = get_shadingModel(materialSID, 0);\\n\\n      float cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\n      vec3 viewPosition = get_viewPosition(cameraSID, 0);\\n\\n      if (shadingModel == 2) {// BLINN\\n        // ViewDirection\\n        vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\\n        vec3 halfVector = normalize(lightDirection + viewDirection);\\n        specular += pow(max(0.0, dot(halfVector, normal_inWorld)), shininess);\\n      } else if (shadingModel == 3) { // PHONG\\n        vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\\n        vec3 R = reflect(lightDirection, normal_inWorld);\\n        specular += pow(max(0.0, dot(R, viewDirection)), shininess);\\n      }\\n\\n    }\\n\\n    shadingColor = diffuse + specular;\\n  } else {\\n    shadingColor = diffuseColor;\\n  }\\n#else\\n  shadingColor = diffuseColor;\\n#endif\\n\\n  rt0 = vec4(shadingColor, alpha);\\n  // rt0 = vec4(u_lightNumber, 0.0, 0.0, 1.0);\\n  // rt0 = vec4(1.0, 0.0, 0.0, 1.0);\\n  // rt0 = vec4(normal_inWorld*0.5+0.5, 1.0);\\n\\n#ifdef RN_IS_ALPHAMODE_OPAQUE\\r\\n  rt0.a = 1.0;\\r\\n#elif defined(RN_IS_ALPHAMODE_MASK)\\r\\n  rt0.a = 1.0;\\r\\n#endif\\n\\n#ifdef GLSL_ES3\\r\\n\\r\\n#else\\r\\n  gl_FragColor = rt0;\\r\\n#endif\\r\\n\\n\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.frag?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert":
/*!**********************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert ***!
  \**********************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\n\\n/* shaderity: @{definitions} */\\n\\nin vec3 a_position;\\nin vec3 a_color;\\nin vec3 a_normal;\\nin float a_instanceID;\\nin vec2 a_texcoord;\\nin vec4 a_joint;\\nin vec4 a_weight;\\nin vec4 a_baryCentricCoord;\\nout vec3 v_color;\\nout vec3 v_normal_inWorld;\\nout vec4 v_position_inWorld;\\nout vec2 v_texcoord;\\nout vec3 v_baryCentricCoord;\\n\\nuniform float u_pointSize; // initialValue=30\\nuniform vec3 u_pointDistanceAttenuation; // initialValue=(0,0.1,0.01)\\n\\nuniform float u_materialSID; // skipProcess=true\\r\\nuniform sampler2D u_dataTexture; // skipProcess=true\\r\\n\\r\\n  /*\\r\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\r\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\r\\n  */\\r\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\r\\n  // {\\r\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\r\\n  // }\\r\\n\\r\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\r\\n  highp float t = (index + 0.5) * invSize.x;\\r\\n  highp float x = fract(t);\\r\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\r\\n  return texture2D( tex, vec2(x, y) );\\r\\n}\\r\\n\\r\\n\\r\\nfloat rand(const vec2 co){\\r\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec3 descramble(vec3 v) {\\r\\n  float seed = 0.0;\\r\\n  v.x -= sin(fract(v.y*20.0));\\r\\n  v.z -= cos(fract(-v.y*10.0));\\r\\n  return v;\\r\\n}\\r\\n\\r\\n\\n\\n/* shaderity: @{getters} */\\n\\n/* shaderity: @{matricesGetters} */\\n\\nmat3 toNormalMatrix(mat4 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n  a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n  a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n  a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3];\\r\\n\\r\\n  float b00 = a00 * a11 - a01 * a10,\\r\\n  b01 = a00 * a12 - a02 * a10,\\r\\n  b02 = a00 * a13 - a03 * a10,\\r\\n  b03 = a01 * a12 - a02 * a11,\\r\\n  b04 = a01 * a13 - a03 * a11,\\r\\n  b05 = a02 * a13 - a03 * a12,\\r\\n  b06 = a20 * a31 - a21 * a30,\\r\\n  b07 = a20 * a32 - a22 * a30,\\r\\n  b08 = a20 * a33 - a23 * a30,\\r\\n  b09 = a21 * a32 - a22 * a31,\\r\\n  b10 = a21 * a33 - a23 * a31,\\r\\n  b11 = a22 * a33 - a23 * a32;\\r\\n\\r\\n  float determinantVal = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat3(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09, a12 * b08 - a10 * b11 - a13 * b07, a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09, a00 * b11 - a02 * b08 + a03 * b07, a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03, a32 * b02 - a30 * b05 - a33 * b01, a30 * b04 - a31 * b02 + a33 * b00) / determinantVal;\\r\\n}\\r\\n\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n\\r\\nhighp mat4 createMatrixFromQuaternionTransformUniformScale( highp vec4 quaternion, highp vec4 translationScale ) {\\r\\n  highp vec4 q = quaternion;\\r\\n  highp vec3 t = translationScale.xyz;\\r\\n  highp float scale = translationScale.w;\\r\\n\\r\\n  highp float sx = q.x * q.x;\\r\\n  highp float sy = q.y * q.y;\\r\\n  highp float sz = q.z * q.z;\\r\\n  highp float cx = q.y * q.z;\\r\\n  highp float cy = q.x * q.z;\\r\\n  highp float cz = q.x * q.y;\\r\\n  highp float wx = q.w * q.x;\\r\\n  highp float wy = q.w * q.y;\\r\\n  highp float wz = q.w * q.z;\\r\\n\\r\\n  highp mat4 mat = mat4(\\r\\n    1.0 - 2.0 * (sy + sz), 2.0 * (cz + wz), 2.0 * (cy - wy), 0.0,\\r\\n    2.0 * (cz - wz), 1.0 - 2.0 * (sx + sz), 2.0 * (cx + wx), 0.0,\\r\\n    2.0 * (cy + wy), 2.0 * (cx - wx), 1.0 - 2.0 * (sx + sy), 0.0,\\r\\n    t.x, t.y, t.z, 1.0\\r\\n  );\\r\\n\\r\\n  highp mat4 uniformScaleMat = mat4(\\r\\n    scale, 0.0, 0.0, 0.0,\\r\\n    0.0, scale, 0.0, 0.0,\\r\\n    0.0, 0.0, scale, 0.0,\\r\\n    0.0, 0.0, 0.0, 1.0\\r\\n  );\\r\\n\\r\\n  return mat*uniformScaleMat;\\r\\n}\\r\\n\\r\\nhighp vec4 unpackedVec2ToNormalizedVec4(highp vec2 vec_xy, highp float criteria){\\r\\n\\r\\n  highp float r;\\r\\n  highp float g;\\r\\n  highp float b;\\r\\n  highp float a;\\r\\n\\r\\n  highp float ix = floor(vec_xy.x * criteria);\\r\\n  highp float v1x = ix / criteria;\\r\\n  highp float v1y = ix - floor(v1x) * criteria;\\r\\n\\r\\n  r = ( v1x + 1.0 ) / (criteria-1.0);\\r\\n  g = ( v1y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  highp float iy = floor( vec_xy.y * criteria);\\r\\n  highp float v2x = iy / criteria;\\r\\n  highp float v2y = iy - floor(v2x) * criteria;\\r\\n\\r\\n  b = ( v2x + 1.0 ) / (criteria-1.0);\\r\\n  a = ( v2y + 1.0 ) / (criteria-1.0);\\r\\n\\r\\n  r -= 1.0/criteria;\\r\\n  g -= 1.0/criteria;\\r\\n  b -= 1.0/criteria;\\r\\n  a -= 1.0/criteria;\\r\\n\\r\\n  r = r*2.0-1.0;\\r\\n  g = g*2.0-1.0;\\r\\n  b = b*2.0-1.0;\\r\\n  a = a*2.0-1.0;\\r\\n\\r\\n  return vec4(r, g, b, a);\\r\\n}\\r\\n\\r\\nmat4 getSkinMatrix(float skeletalComponentSID) {\\r\\n\\r\\n#ifdef RN_BONE_DATA_TYPE_MAT4X4\\r\\n  mat4 skinMat = a_weight.x * get_boneMatrix(skeletalComponentSID, int(a_joint.x));\\r\\n  skinMat += a_weight.y * get_boneMatrix(skeletalComponentSID, int(a_joint.y));\\r\\n  skinMat += a_weight.z * get_boneMatrix(skeletalComponentSID, int(a_joint.z));\\r\\n  skinMat += a_weight.w * get_boneMatrix(skeletalComponentSID, int(a_joint.w));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X2)\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.x)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.x)));\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.y)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.y)));\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.z)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.z)));\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.w)),\\r\\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.w)));\\r\\n#elif defined(RN_BONE_DATA_TYPE_VEC4X1)\\r\\n  highp vec4 boneCompressedChunksX = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.x));\\r\\n  highp vec4 boneCompressedChunksY = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.y));\\r\\n  highp vec4 boneCompressedChunksZ = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.z));\\r\\n  highp vec4 boneCompressedChunksW = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.w));\\r\\n\\r\\n  highp vec2 criteria = vec2(4096.0, 4096.0);\\r\\n  highp vec4 boneCompressedInfo = get_boneCompressedInfo(0.0, 0);\\r\\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.zw, criteria.y)*boneCompressedInfo);\\r\\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.xy, criteria.x),\\r\\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.zw, criteria.y)*boneCompressedInfo);\\r\\n#endif\\r\\n\\r\\n  return skinMat;\\r\\n}\\r\\n#endif\\n\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\nbool skinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n  )\\r\\n{\\r\\n  mat4 skinMat = getSkinMatrix(skeletalComponentSID);\\r\\n  outPosition_inWorld = skinMat * vec4(inPosition_inLocal, 1.0);\\r\\n  outNormalMatrix = toNormalMatrix(skinMat);\\r\\n  outNormal_inWorld = normalize(outNormalMatrix * inNormal_inLocal);\\r\\n\\r\\n  return true;\\r\\n}\\r\\n#endif\\r\\n\\r\\nbool processGeometryWithMorphingAndSkinning(\\r\\n  float skeletalComponentSID,\\r\\n  in mat4 worldMatrix,\\r\\n  in mat3 inNormalMatrix,\\r\\n  out mat3 outNormalMatrix,\\r\\n  in vec3 inPosition_inLocal,\\r\\n  out vec4 outPosition_inWorld,\\r\\n  in vec3 inNormal_inLocal,\\r\\n  out vec3 outNormal_inWorld\\r\\n) {\\r\\n  bool isSkinning = false;\\r\\n\\r\\n  vec3 position_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  if (u_morphTargetNumber == 0) {\\r\\n#endif\\r\\n    position_inLocal = inPosition_inLocal;\\r\\n#ifdef RN_IS_MORPHING\\r\\n  } else {\\r\\n    float vertexIdx = a_baryCentricCoord.w;\\r\\n    position_inLocal = get_position(vertexIdx, inPosition_inLocal);\\r\\n  }\\r\\n#endif\\r\\n\\r\\n\\r\\n#ifdef RN_IS_SKINNING\\r\\n  if (skeletalComponentSID >= 0.0) {\\r\\n    isSkinning = skinning(skeletalComponentSID, inNormalMatrix, outNormalMatrix, position_inLocal, outPosition_inWorld, inNormal_inLocal, outNormal_inWorld);\\r\\n  } else {\\r\\n#endif\\r\\n    outNormalMatrix = inNormalMatrix;\\r\\n    outPosition_inWorld = worldMatrix * vec4(position_inLocal, 1.0);\\r\\n    outNormal_inWorld = normalize(inNormalMatrix * inNormal_inLocal);\\r\\n#ifdef RN_IS_SKINNING\\r\\n  }\\r\\n#endif\\r\\n\\r\\n  return isSkinning;\\r\\n}\\r\\n\\n\\nvoid main()\\n{\\n\\n#ifdef RN_IS_FASTEST_MODE\\r\\n  float materialSID = u_currentComponentSIDs[0];\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\r\\n  #endif\\r\\n\\r\\n#else\\r\\n\\r\\n  float materialSID = u_materialSID;\\r\\n\\r\\n  int lightNumber = 0;\\r\\n  #ifdef RN_IS_LIGHTING\\r\\n    lightNumber = get_lightNumber(0.0, 0);\\r\\n  #endif\\r\\n\\r\\n  float skeletalComponentSID = -1.0;\\r\\n  #ifdef RN_IS_SKINNING\\r\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\r\\n  #endif\\r\\n\\r\\n#endif\\r\\n\\n\\n  float cameraSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.CameraComponentTID} */];\\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\\n\\n  // Skeletal\\n  processGeometryWithMorphingAndSkinning(\\n    skeletalComponentSID,\\n    worldMatrix,\\n    normalMatrix,\\n    normalMatrix,\\n    a_position,\\n    v_position_inWorld,\\n    a_normal,\\n    v_normal_inWorld\\n  );\\n\\n  gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\\n\\n\\n  v_color = a_color;\\n  v_normal_inWorld = normalMatrix * a_normal;\\n  v_texcoord = a_texcoord;\\n  v_baryCentricCoord = a_baryCentricCoord.xyz;\\n\\nvec4 position_inWorld = worldMatrix * vec4(a_position, 1.0);\\r\\nvec3 viewPosition = get_viewPosition(cameraSID, 0);\\r\\nfloat distanceFromCamera = length(position_inWorld.xyz - viewPosition);\\r\\nvec3 pointDistanceAttenuation = get_pointDistanceAttenuation(materialSID, 0);\\r\\nfloat distanceAttenuationFactor = sqrt(1.0/(pointDistanceAttenuation.x + pointDistanceAttenuation.y * distanceFromCamera + pointDistanceAttenuation.z * distanceFromCamera * distanceFromCamera));\\r\\nfloat maxPointSize = get_pointSize(materialSID, 0);\\r\\ngl_PointSize = clamp(distanceAttenuationFactor * maxPointSize, 0.0, maxPointSize);\\r\\n\\n\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/classicSingleShader/classicSingleShader.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/common/mainPrerequisites.glsl":
/*!*******************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/common/mainPrerequisites.glsl ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"#ifdef RN_IS_FASTEST_MODE\\n  float materialSID = u_currentComponentSIDs[0];\\n\\n  int lightNumber = 0;\\n  #ifdef RN_IS_LIGHTING\\n    lightNumber = int(u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.LightComponentTID} */]);\\n  #endif\\n\\n  float skeletalComponentSID = -1.0;\\n  #ifdef RN_IS_SKINNING\\n    skeletalComponentSID = u_currentComponentSIDs[/* shaderity: @{WellKnownComponentTIDs.SkeletalComponentTID} */];\\n  #endif\\n\\n#else\\n\\n  float materialSID = u_materialSID;\\n\\n  int lightNumber = 0;\\n  #ifdef RN_IS_LIGHTING\\n    lightNumber = get_lightNumber(0.0, 0);\\n  #endif\\n\\n  float skeletalComponentSID = -1.0;\\n  #ifdef RN_IS_SKINNING\\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\\n  #endif\\n\\n#endif\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/common/mainPrerequisites.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/common/prerequisites.glsl":
/*!***************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/common/prerequisites.glsl ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"uniform float u_materialSID; // skipProcess=true\\nuniform sampler2D u_dataTexture; // skipProcess=true\\n\\n  /*\\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\\n  */\\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\\n  // {\\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\\n  // }\\n\\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\\n  highp float t = (index + 0.5) * invSize.x;\\n  highp float x = fract(t);\\n  highp float y = (floor(t) + 0.5) * invSize.y;\\n  return texture2D( tex, vec2(x, y) );\\n}\\n\\n\\nfloat rand(const vec2 co){\\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\n}\\n\\nvec3 descramble(vec3 v) {\\n  float seed = 0.0;\\n  v.x -= sin(fract(v.y*20.0));\\n  v.z -= cos(fract(-v.y*10.0));\\n  return v;\\n}\\n\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/common/prerequisites.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/Add.glsl":
/*!****************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/Add.glsl ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid add(in float lfs, in float rhs, out float outValue) {\\n  outValue = lfs + rhs;\\n}\\nvoid add(in int lfs, in int rhs, out int outValue) {\\n  outValue = lfs + rhs;\\n}\\nvoid add(in vec2 lfs, in vec2 rhs, out vec2 outValue) {\\n  outValue = lfs + rhs;\\n}\\nvoid add(in vec3 lfs, in vec3 rhs, out vec3 outValue) {\\n  outValue = lfs + rhs;\\n}\\nvoid add(in vec4 lfs, in vec4 rhs, out vec4 outValue) {\\n  outValue = lfs + rhs;\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/Add.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/AttributeNormal.vert":
/*!****************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/AttributeNormal.vert ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nin vec3 a_normal;\\n\\nvoid attributeNormal(out vec3 outValue) {\\n  outValue = a_normal;\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/AttributeNormal.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/AttributePosition.vert":
/*!******************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/AttributePosition.vert ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nin vec4 a_position;\\n\\nvoid attributePosition(out vec4 outValue) {\\n  outValue = a_position;\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/AttributePosition.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/DotProduct.glsl":
/*!***********************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/DotProduct.glsl ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid dotProduct(in vec2 lfs, in vec2 rhs, out float outValue) {\\n  outValue = dot(lfs, rhs);\\n}\\nvoid dotProduct(in vec3 lfs, in vec3 rhs, out float outValue) {\\n  outValue = dot(lfs, rhs);\\n}\\nvoid dotProduct(in vec4 lfs, in vec4 rhs, out float outValue) {\\n  outValue = dot(lfs, rhs);\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/DotProduct.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/Greater.glsl":
/*!********************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/Greater.glsl ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid greater(in float lhs, in float rhs, out bool outValue) {\\n  outValue = lhs > rhs;\\n}\\n\\nvoid greater(in int lhs, in int rhs, out bool outValue) {\\n  outValue = lhs > rhs;\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/Greater.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/Multiply.glsl":
/*!*********************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/Multiply.glsl ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid multiply(in float lfs, in float rhs, out float outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in int lfs, in int rhs, out int outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in mat2 lfs, in mat2 rhs, out mat2 outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in mat3 lfs, in mat3 rhs, out mat3 outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in mat4 lfs, in mat4 rhs, out mat4 outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in mat3 lfs, in vec3 rhs, out vec3 outValue) {\\n  outValue = lfs * rhs;\\n}\\nvoid multiply(in mat4 lfs, in vec4 rhs, out vec4 outValue) {\\n  outValue = lfs * rhs;\\n}\\n\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/Multiply.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/NormalMatrix.vert":
/*!*************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/NormalMatrix.vert ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid normalMatrix(out mat3 outValue) {\\n  outValue = get_normalMatrix(a_instanceID);\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/NormalMatrix.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/Normalize.glsl":
/*!**********************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/Normalize.glsl ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid normalize(in vec2 value, out vec2 outValue) {\\n  outValue = normalize(value);\\n}\\n\\nvoid normalize(in vec3 value, out vec3 outValue) {\\n  outValue = normalize(value);\\n}\\n\\nvoid normalize(in vec4 value, out vec4 outValue) {\\n  outValue = normalize(value);\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/Normalize.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/ProjectionMatrix.vert":
/*!*****************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/ProjectionMatrix.vert ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid projectionMatrix(out mat4 outValue) {\\n  outValue = get_projectionMatrix(a_instanceID, 0);\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/ProjectionMatrix.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/ScalarToVector4.glsl":
/*!****************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/ScalarToVector4.glsl ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid scalarToVector4(in float x, in float y, in float z, in float w, out vec4 outValue) {\\n  outValue.x = x;\\n  outValue.y = y;\\n  outValue.z = z;\\n  outValue.w = w;\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/ScalarToVector4.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/Vector3AndScalarToVector4.glsl":
/*!**************************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/Vector3AndScalarToVector4.glsl ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid vector3AndScalarToVector4(in vec3 xyz, in float w, out vec4 outValue) {\\n  outValue.x = xyz.x;\\n  outValue.y = xyz.y;\\n  outValue.z = xyz.z;\\n  outValue.w = w;\\n}\\n\",\"shaderStage\":\"fragment\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/Vector3AndScalarToVector4.glsl?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/ViewMatrix.vert":
/*!***********************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/ViewMatrix.vert ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid viewMatrix(out mat4 outValue) {\\n  outValue = get_viewMatrix(a_instanceID, 0);\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/ViewMatrix.vert?");

/***/ }),

/***/ "./src/webgl/shaderity_shaders/nodes/WorldMatrix.vert":
/*!************************************************************!*\
  !*** ./src/webgl/shaderity_shaders/nodes/WorldMatrix.vert ***!
  \************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"code\":\"\\nvoid worldMatrix(out mat4 outValue) {\\n  outValue = get_worldMatrix(a_instanceID);\\n}\\n\",\"shaderStage\":\"vertex\"});\n\n//# sourceURL=webpack:///./src/webgl/shaderity_shaders/nodes/WorldMatrix.vert?");

/***/ }),

/***/ "./src/webgl/shaders/DepthEncodeShader.ts":
/*!************************************************!*\
  !*** ./src/webgl/shaders/DepthEncodeShader.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DepthEncodeShader; });\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../foundation/definitions/ShaderNode */ \"./src/foundation/definitions/ShaderNode.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n\r\n\r\n\r\n\r\n\r\nclass DepthEncodeShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.attributeNames = [\r\n            'a_instanceID',\r\n            'a_position', 'a_normal',\r\n            'a_joint', 'a_weight',\r\n        ];\r\n        this.attributeSemantics = [\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Instance,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Position, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Normal,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Joints0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Weights0,\r\n        ];\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new DepthEncodeShader();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getVertexShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_vertex_in;\r\n        const _out = this.glsl_vertex_out;\r\n        return `${_version}\n${this.glslPrecision}\n\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\n\n${_in} vec3 a_position;\n${_in} vec3 a_normal;\n${_in} float a_instanceID;\n${_in} vec4 a_joint;\n${_in} vec4 a_weight;\n\n${_out} vec3 v_normal_inWorld;\n${_out} vec4 v_position_inLocal;\n${_out} vec4 v_position_inWorld;\n\n${this.prerequisites}\n\n${(typeof args.matricesGetters !== 'undefined') ? args.matricesGetters : ''}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\n${this.toNormalMatrix}\n\n${this.getSkinMatrix}\n\n${this.processGeometryWithSkinningOptionally}\n\n  void main(){\n\n    ${this.mainPrerequisites}\n    float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\n    mat4 worldMatrix = get_worldMatrix(a_instanceID);\n    mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\n    mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\n    mat3 normalMatrix = get_normalMatrix(a_instanceID);\n\n    // Skeletal\n    processGeometryWithMorphingAndSkinning(\n      skeletalComponentSID,\n      worldMatrix,\n      normalMatrix,\n      normalMatrix,\n      a_position,\n      v_position_inWorld,\n      a_normal,\n      v_normal_inWorld\n    );\n\n    gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\n\n    v_position_inLocal = gl_Position;\n\n    ${this.pointSprite}\n\n  }\n    `;\r\n    }\r\n    getPixelShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_fragment_in;\r\n        const _def_rt0 = this.glsl_rt0;\r\n        const _def_fragColor = this.glsl_fragColor;\r\n        return `${_version}\n${this.glslPrecision}\n\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\n\n${this.prerequisites}\n\n${_in} vec4 v_position_inLocal;\n${_def_rt0}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\nvec4 encodeDepthToRGBA(float depth){\n  float r = depth;\n  float g = fract(r * 255.0);\n  float b = fract(g * 255.0);\n  float a = fract(b * 255.0);\n  float coef = 1.0 / 255.0;\n  r -= g * coef;\n  g -= b * coef;\n  b -= a * coef;\n  return vec4(r, g, b, a);\n}\n\nvoid main (){\n  ${this.mainPrerequisites}\n\n  float zNear = get_zNearInner(materialSID, 0);\n  float zFar = get_zFarInner(materialSID, 0);\n  float normalizationCoefficient = 1.0 / (zFar - zNear);\n  float linerDepth = normalizationCoefficient * length(v_position_inLocal);\n  vec4 encodedLinearDepth = encodeDepthToRGBA(linerDepth);\n\n  rt0 = encodedLinearDepth;\n\n  ${_def_fragColor}\n}\n`;\r\n    }\r\n    get attributeCompositions() {\r\n        return [\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Scalar,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec4,\r\n        ];\r\n    }\r\n}\r\nDepthEncodeShader.materialElement = _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_2__[\"ShaderNode\"].ClassicShading;\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/DepthEncodeShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/EnvConstantShader.ts":
/*!************************************************!*\
  !*** ./src/webgl/shaders/EnvConstantShader.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EnvConstantShader; });\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../foundation/definitions/ShaderNode */ \"./src/foundation/definitions/ShaderNode.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n\r\n\r\n\r\n\r\nclass EnvConstantShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.attributeNames = [\r\n            'a_position', 'a_color', 'a_normal',\r\n            'a_texcoord',\r\n            'a_instanceID'\r\n        ];\r\n        this.attributeSemantics = [\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Position, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Color0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Normal,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Texcoord0,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Instance\r\n        ];\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new EnvConstantShader();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getVertexShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_vertex_in;\r\n        const _out = this.glsl_vertex_out;\r\n        return `${_version}\n${this.glslPrecision}\n\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\n\n${_in} float a_instanceID;\n${_in} vec2 a_texcoord;\n${_in} vec3 a_position;\n${_in} vec3 a_color;\n${_in} vec3 a_normal;\n\n${_out} vec2 v_texcoord;\n${_out} vec3 v_color;\n${_out} vec3 v_normal_inWorld;\n${_out} vec3 v_position_inWorld;\n\n${this.prerequisites}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\n${(typeof args.matricesGetters !== 'undefined') ? args.matricesGetters : ''}\n\nvoid main(){\n  ${this.mainPrerequisites}\n\n${this.simpleMVPPosition}\n\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\n  v_normal_inWorld = normalMatrix * a_normal;\n\n  v_color = a_color;\n  v_position_inWorld = (worldMatrix * vec4(a_position, 1.0)).xyz;\n  v_texcoord = a_texcoord;\n}`;\r\n    }\r\n    getPixelShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_fragment_in;\r\n        const _def_rt0 = this.glsl_rt0;\r\n        const _def_fragColor = this.glsl_fragColor;\r\n        const _texture = this.glsl_texture;\r\n        const _textureCube = this.glsl_textureCube;\r\n        return `${_version}\n${this.glslPrecision}\n\n\n${this.prerequisites}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\nvec3 linearToSrgb(vec3 linearColor) {\n  return pow(linearColor, vec3(1.0/2.2));\n}\n\nvec3 srgbToLinear(vec3 srgbColor) {\n  return pow(srgbColor, vec3(2.2));\n}\n\n${_in} vec2 v_texcoord;\n${_in} vec3 v_color;\n${_in} vec3 v_normal_inWorld;\n${_in} vec3 v_position_inWorld;\n${_def_rt0}\nvoid main(){\n  ${this.mainPrerequisites}\n\n  // diffuseColor\n  vec3 diffuseColor = vec3(0.0, 0.0, 0.0);\n  float alpha = 1.0;\n  vec4 diffuseColorFactor = get_diffuseColorFactor(materialSID, 0);\n  if (v_color != diffuseColor && diffuseColorFactor.rgb != diffuseColor) {\n    diffuseColor = v_color * diffuseColorFactor.rgb;\n    alpha = diffuseColorFactor.a;\n  } else if (v_color == diffuseColor) {\n    diffuseColor = diffuseColorFactor.rgb;\n    alpha = diffuseColorFactor.a;\n  } else if (diffuseColorFactor.rgb == diffuseColor) {\n    diffuseColor = v_color;\n  } else {\n    diffuseColor = vec3(1.0, 1.0, 1.0);\n  }\n\n  // diffuseColorTexture\n\n  // adapt OpenGL (RenderMan) CubeMap convention\n  float envRotation = get_envRotation(materialSID, 0);\n  float rot = envRotation + 3.1415;\n  mat3 rotEnvMatrix = mat3(cos(rot), 0.0, -sin(rot), 0.0, 1.0, 0.0, sin(rot), 0.0, cos(rot));\n  vec3 envNormal = normalize(rotEnvMatrix * v_position_inWorld);\n  envNormal.x *= -1.0;\n\n  vec4 diffuseTexel = ${_textureCube}(u_colorEnvTexture, envNormal);\n  vec3 textureColor;\n  int EnvHdriFormat = get_EnvHdriFormat(materialSID, 0);\n  if (EnvHdriFormat == 0) { // LDR_SRGB\n    textureColor = srgbToLinear(diffuseTexel.rgb);\n  } else if (EnvHdriFormat == 3) { // RGBE\n    textureColor = diffuseTexel.rgb * pow(2.0, diffuseTexel.a*255.0-128.0);\n  } else {\n    textureColor = diffuseTexel.rgb;\n  }\n  diffuseColor *= textureColor;\n\n  rt0 = vec4(diffuseColor, alpha);\n\n  ${_def_fragColor}\n}`;\r\n    }\r\n    get attributeCompositions() {\r\n        return [\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec3,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Vec2,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_3__[\"CompositionType\"].Scalar\r\n        ];\r\n    }\r\n}\r\nEnvConstantShader.materialElement = _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_2__[\"ShaderNode\"].ClassicShading;\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/EnvConstantShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/GLSLShader.ts":
/*!*****************************************!*\
  !*** ./src/webgl/shaders/GLSLShader.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return GLSLShader; });\n/* harmony import */ var _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../foundation/definitions/ProcessApproach */ \"./src/foundation/definitions/ProcessApproach.ts\");\n/* harmony import */ var _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../foundation/definitions/ShaderSemantics */ \"./src/foundation/definitions/ShaderSemantics.ts\");\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../WebGLResourceRepository */ \"./src/webgl/WebGLResourceRepository.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n/* harmony import */ var _foundation_system_SystemState__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../foundation/system/SystemState */ \"./src/foundation/system/SystemState.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass GLSLShader {\r\n    constructor() {\r\n        this.__webglResourceRepository = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\r\n    }\r\n    get glsl_rt0() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'layout(location = 0) out vec4 rt0;\\n';\r\n        }\r\n        else {\r\n            return 'vec4 rt0;\\n';\r\n        }\r\n    }\r\n    get glsl_fragColor() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper != null && repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return '';\r\n        }\r\n        else {\r\n            return 'gl_FragColor = rt0;\\n';\r\n        }\r\n    }\r\n    get glsl_vertex_in() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'in';\r\n        }\r\n        else {\r\n            return 'attribute';\r\n        }\r\n    }\r\n    get glsl_fragment_in() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'in';\r\n        }\r\n        else {\r\n            return 'varying';\r\n        }\r\n    }\r\n    get glsl_vertex_out() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'out';\r\n        }\r\n        else {\r\n            return 'varying';\r\n        }\r\n    }\r\n    get glsl_vertex_centroid_out() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'centroid out';\r\n        }\r\n        else {\r\n            return 'varying';\r\n        }\r\n    }\r\n    get glsl_texture() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'texture';\r\n        }\r\n        else {\r\n            return 'texture2D';\r\n        }\r\n    }\r\n    get glsl_textureCube() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'texture';\r\n        }\r\n        else {\r\n            return 'textureCube';\r\n        }\r\n    }\r\n    get glsl_textureProj() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return 'textureProj';\r\n        }\r\n        else {\r\n            return 'texture2DProj';\r\n        }\r\n    }\r\n    get glsl_versionText() {\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper != null && repo.currentWebGLContextWrapper.isWebGL2) {\r\n            return '';\r\n            // return '#version 300 es\\n'\r\n        }\r\n        else {\r\n            return '';\r\n        }\r\n    }\r\n    get glslPrecision() {\r\n        return `precision highp float;\nprecision highp int;\n    `;\r\n    }\r\n    static get glslMainBegin() {\r\n        return `\nvoid main() {\n`;\r\n    }\r\n    static get glslMainEnd() {\r\n        return `\n}\n    `;\r\n    }\r\n    getGlslVertexShaderProperies(str = '') {\r\n        return str;\r\n    }\r\n    get glsl1ShaderTextureLodExt() {\r\n        const ext = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().currentWebGLContextWrapper.webgl1ExtSTL;\r\n        return (ext != null) ? '#extension GL_EXT_shader_texture_lod : require' : '';\r\n    }\r\n    get glsl1ShaderDerivativeExt() {\r\n        const ext = _WebGLResourceRepository__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance().currentWebGLContextWrapper.webgl1ExtDRV;\r\n        return (ext != null) ? '#extension GL_OES_standard_derivatives : require' : '';\r\n    }\r\n    get toNormalMatrix() {\r\n        return `\nmat3 toNormalMatrix(mat4 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n  a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n  a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n  a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3];\n\n  float b00 = a00 * a11 - a01 * a10,\n  b01 = a00 * a12 - a02 * a10,\n  b02 = a00 * a13 - a03 * a10,\n  b03 = a01 * a12 - a02 * a11,\n  b04 = a01 * a13 - a03 * a11,\n  b05 = a02 * a13 - a03 * a12,\n  b06 = a20 * a31 - a21 * a30,\n  b07 = a20 * a32 - a22 * a30,\n  b08 = a20 * a33 - a23 * a30,\n  b09 = a21 * a32 - a22 * a31,\n  b10 = a21 * a33 - a23 * a31,\n  b11 = a22 * a33 - a23 * a32;\n\n  float determinantVal = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat3(\n    a11 * b11 - a12 * b10 + a13 * b09, a12 * b08 - a10 * b11 - a13 * b07, a10 * b10 - a11 * b08 + a13 * b06,\n    a02 * b10 - a01 * b11 - a03 * b09, a00 * b11 - a02 * b08 + a03 * b07, a01 * b08 - a00 * b10 - a03 * b06,\n    a31 * b05 - a32 * b04 + a33 * b03, a32 * b02 - a30 * b05 - a33 * b01, a30 * b04 - a31 * b02 + a33 * b00) / determinantVal;\n}`;\r\n    }\r\n    get getSkinMatrix() {\r\n        return `\n#ifdef RN_IS_SKINNING\n\nhighp mat4 createMatrixFromQuaternionTransformUniformScale( highp vec4 quaternion, highp vec4 translationScale ) {\n  highp vec4 q = quaternion;\n  highp vec3 t = translationScale.xyz;\n  highp float scale = translationScale.w;\n\n  highp float sx = q.x * q.x;\n  highp float sy = q.y * q.y;\n  highp float sz = q.z * q.z;\n  highp float cx = q.y * q.z;\n  highp float cy = q.x * q.z;\n  highp float cz = q.x * q.y;\n  highp float wx = q.w * q.x;\n  highp float wy = q.w * q.y;\n  highp float wz = q.w * q.z;\n\n  highp mat4 mat = mat4(\n    1.0 - 2.0 * (sy + sz), 2.0 * (cz + wz), 2.0 * (cy - wy), 0.0,\n    2.0 * (cz - wz), 1.0 - 2.0 * (sx + sz), 2.0 * (cx + wx), 0.0,\n    2.0 * (cy + wy), 2.0 * (cx - wx), 1.0 - 2.0 * (sx + sy), 0.0,\n    t.x, t.y, t.z, 1.0\n  );\n\n  highp mat4 uniformScaleMat = mat4(\n    scale, 0.0, 0.0, 0.0,\n    0.0, scale, 0.0, 0.0,\n    0.0, 0.0, scale, 0.0,\n    0.0, 0.0, 0.0, 1.0\n  );\n\n  return mat*uniformScaleMat;\n}\n\nhighp vec4 unpackedVec2ToNormalizedVec4(highp vec2 vec_xy, highp float criteria){\n\n  highp float r;\n  highp float g;\n  highp float b;\n  highp float a;\n\n  highp float ix = floor(vec_xy.x * criteria);\n  highp float v1x = ix / criteria;\n  highp float v1y = ix - floor(v1x) * criteria;\n\n  r = ( v1x + 1.0 ) / (criteria-1.0);\n  g = ( v1y + 1.0 ) / (criteria-1.0);\n\n  highp float iy = floor( vec_xy.y * criteria);\n  highp float v2x = iy / criteria;\n  highp float v2y = iy - floor(v2x) * criteria;\n\n  b = ( v2x + 1.0 ) / (criteria-1.0);\n  a = ( v2y + 1.0 ) / (criteria-1.0);\n\n  r -= 1.0/criteria;\n  g -= 1.0/criteria;\n  b -= 1.0/criteria;\n  a -= 1.0/criteria;\n\n  r = r*2.0-1.0;\n  g = g*2.0-1.0;\n  b = b*2.0-1.0;\n  a = a*2.0-1.0;\n\n  return vec4(r, g, b, a);\n}\n\nmat4 getSkinMatrix(float skeletalComponentSID) {\n\n#ifdef RN_BONE_DATA_TYPE_MAT4X4\n  mat4 skinMat = a_weight.x * get_boneMatrix(skeletalComponentSID, int(a_joint.x));\n  skinMat += a_weight.y * get_boneMatrix(skeletalComponentSID, int(a_joint.y));\n  skinMat += a_weight.z * get_boneMatrix(skeletalComponentSID, int(a_joint.z));\n  skinMat += a_weight.w * get_boneMatrix(skeletalComponentSID, int(a_joint.w));\n#elif defined(RN_BONE_DATA_TYPE_VEC4X2)\n  highp vec2 criteria = vec2(4096.0, 4096.0);\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.x)),\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.x)));\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.y)),\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.y)));\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.z)),\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.z)));\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\n    get_boneQuaternion(skeletalComponentSID, int(a_joint.w)),\n    get_boneTranslateScale(skeletalComponentSID, int(a_joint.w)));\n#elif defined(RN_BONE_DATA_TYPE_VEC4X1)\n  highp vec4 boneCompressedChunksX = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.x));\n  highp vec4 boneCompressedChunksY = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.y));\n  highp vec4 boneCompressedChunksZ = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.z));\n  highp vec4 boneCompressedChunksW = get_boneCompressedChunk(skeletalComponentSID, int(a_joint.w));\n\n  highp vec2 criteria = vec2(4096.0, 4096.0);\n  highp vec4 boneCompressedInfo = get_boneCompressedInfo(0.0, 0);\n  highp mat4 skinMat = a_weight.x * createMatrixFromQuaternionTransformUniformScale(\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.xy, criteria.x),\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksX.zw, criteria.y)*boneCompressedInfo);\n  skinMat += a_weight.y * createMatrixFromQuaternionTransformUniformScale(\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.xy, criteria.x),\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksY.zw, criteria.y)*boneCompressedInfo);\n  skinMat += a_weight.z * createMatrixFromQuaternionTransformUniformScale(\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.xy, criteria.x),\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksZ.zw, criteria.y)*boneCompressedInfo);\n  skinMat += a_weight.w * createMatrixFromQuaternionTransformUniformScale(\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.xy, criteria.x),\n    unpackedVec2ToNormalizedVec4(boneCompressedChunksW.zw, criteria.y)*boneCompressedInfo);\n#endif\n\n  return skinMat;\n}\n\n#endif\n`;\r\n    }\r\n    get packing() {\r\n        return `\nconst vec4 bitEnc = vec4(1.,255.,65025.,16581375.);\nconst vec4 bitDec = 1./bitEnc;\n\nvec4 encodeFloatRGBA(float v) {\n  float val = v;\n  float r = mod(val, 255.0);\n  val -= r;\n  float g = mod(val, 65025.0);\n  val -= g;\n  float b = mod(val, 16581375.0);\n  return vec4(r/255.0, g/65025.0, b/16581375.0, 1.0);\n}`;\r\n    }\r\n    get processGeometryWithSkinningOptionally() {\r\n        return `\n#ifdef RN_IS_SKINNING\nbool skinning(\n  float skeletalComponentSID,\n  in mat3 inNormalMatrix,\n  out mat3 outNormalMatrix,\n  in vec3 inPosition_inLocal,\n  out vec4 outPosition_inWorld,\n  in vec3 inNormal_inLocal,\n  out vec3 outNormal_inWorld\n  )\n{\n  mat4 skinMat = getSkinMatrix(skeletalComponentSID);\n  outPosition_inWorld = skinMat * vec4(inPosition_inLocal, 1.0);\n  outNormalMatrix = toNormalMatrix(skinMat);\n  outNormal_inWorld = normalize(outNormalMatrix * inNormal_inLocal);\n\n  return true;\n}\n#endif\n\nbool processGeometryWithMorphingAndSkinning(\n  float skeletalComponentSID,\n  in mat4 worldMatrix,\n  in mat3 inNormalMatrix,\n  out mat3 outNormalMatrix,\n  in vec3 inPosition_inLocal,\n  out vec4 outPosition_inWorld,\n  in vec3 inNormal_inLocal,\n  out vec3 outNormal_inWorld\n) {\n  bool isSkinning = false;\n\n  vec3 position_inLocal;\n#ifdef RN_IS_MORPHING\n  if (u_morphTargetNumber == 0) {\n#endif\n    position_inLocal = inPosition_inLocal;\n#ifdef RN_IS_MORPHING\n  } else {\n    float vertexIdx = a_baryCentricCoord.w;\n    position_inLocal = get_position(vertexIdx, inPosition_inLocal);\n  }\n#endif\n\n\n#ifdef RN_IS_SKINNING\n  if (skeletalComponentSID >= 0.0) {\n    isSkinning = skinning(skeletalComponentSID, inNormalMatrix, outNormalMatrix, position_inLocal, outPosition_inWorld, inNormal_inLocal, outNormal_inWorld);\n  } else {\n#endif\n    outNormalMatrix = inNormalMatrix;\n    outPosition_inWorld = worldMatrix * vec4(position_inLocal, 1.0);\n    outNormal_inWorld = normalize(inNormalMatrix * inNormal_inLocal);\n#ifdef RN_IS_SKINNING\n  }\n#endif\n\n  return isSkinning;\n}`;\r\n    }\r\n    get prerequisites() {\r\n        return `uniform float u_materialSID;\nuniform sampler2D u_dataTexture;\n\n  /*\n  * This idea from https://qiita.com/YVT/items/c695ab4b3cf7faa93885\n  * arg = vec2(1. / size.x, 1. / size.x / size.y);\n  */\n  // highp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 arg)\n  // {\n  //   return ${this.glsl_texture}( tex, arg * (index + 0.5) );\n  // }\n\nhighp vec4 fetchElement(highp sampler2D tex, highp float index, highp vec2 invSize){\n  highp float t = (index + 0.5) * invSize.x;\n  highp float x = fract(t);\n  highp float y = (floor(t) + 0.5) * invSize.y;\n  return ${this.glsl_texture}( tex, vec2(x, y) );\n}\n\n\nfloat rand(const vec2 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 descramble(vec3 v) {\n  float seed = 0.0;\n  v.x -= sin(fract(v.y*20.0));\n  v.z -= cos(fract(-v.y*10.0));\n  return v;\n}\n\n`;\r\n    }\r\n    get mainPrerequisites() {\r\n        const processApproach = _foundation_system_SystemState__WEBPACK_IMPORTED_MODULE_5__[\"default\"].currentProcessApproach;\r\n        if (processApproach === _foundation_definitions_ProcessApproach__WEBPACK_IMPORTED_MODULE_0__[\"ProcessApproach\"].FastestWebGL1) {\r\n            return `\n  float materialSID = u_currentComponentSIDs[0];\n\n  int lightNumber = 0;\n  #ifdef RN_IS_LIGHTING\n    lightNumber = int(u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].LightComponentTID}]);\n  #endif\n\n  float skeletalComponentSID = -1.0;\n  #ifdef RN_IS_SKINNING\n    skeletalComponentSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].SkeletalComponentTID}];\n  #endif\n`;\r\n        }\r\n        else {\r\n            return `\n  float materialSID = u_materialSID;\n\n  int lightNumber = 0;\n  #ifdef RN_IS_LIGHTING\n    lightNumber = get_lightNumber(0.0, 0);\n  #endif\n\n  float skeletalComponentSID = -1.0;\n  #ifdef RN_IS_SKINNING\n    skeletalComponentSID = float(get_skinningMode(0.0, 0));\n  #endif\n      `;\r\n        }\r\n    }\r\n    get pointSprite() {\r\n        return `  vec4 position_inWorld = worldMatrix * vec4(a_position, 1.0);\n  vec3 viewPosition = get_viewPosition(cameraSID, 0);\n  float distanceFromCamera = length(position_inWorld.xyz - viewPosition);\n  vec3 pointDistanceAttenuation = get_pointDistanceAttenuation(materialSID, 0);\n  float distanceAttenuationFactor = sqrt(1.0/(pointDistanceAttenuation.x + pointDistanceAttenuation.y * distanceFromCamera + pointDistanceAttenuation.z * distanceFromCamera * distanceFromCamera));\n  float maxPointSize = get_pointSize(materialSID, 0);\n  gl_PointSize = clamp(distanceAttenuationFactor * maxPointSize, 0.0, maxPointSize);`;\r\n    }\r\n    get pbrUniformDefinition() {\r\n        let shaderText = '';\r\n        shaderText += 'uniform vec2 uMetallicRoughnessFactors;\\n';\r\n        shaderText += 'uniform vec3 uBaseColorFactor;\\n';\r\n        shaderText += 'uniform vec2 uOcclusionFactors;';\r\n        shaderText += 'uniform vec3 uEmissiveFactor;';\r\n        shaderText += 'uniform sampler2D uMetallicRoughnessTexture;\\n';\r\n        const occlusionTexture = true; //material.getTextureFromPurpose(GLBoost.TEXTURE_PURPOSE_OCCLUSION);\r\n        if (occlusionTexture) {\r\n            shaderText += 'uniform sampler2D uOcclusionTexture;\\n';\r\n        }\r\n        const emissiveTexture = true; //material.getTextureFromPurpose(GLBoost.TEXTURE_PURPOSE_EMISSIVE);\r\n        if (emissiveTexture) {\r\n            shaderText += 'uniform sampler2D uEmissiveTexture;\\n';\r\n        }\r\n        const diffuseEnvCubeTexture = true; //material.getTextureFromPurpose(GLBoost.TEXTURE_PURPOSE_IBL_DIFFUSE_ENV_CUBE);\r\n        if (diffuseEnvCubeTexture) {\r\n            shaderText += 'uniform sampler2D u_brdfLutTexture;\\n';\r\n            shaderText += 'uniform samplerCube uDiffuseEnvTexture;\\n';\r\n            shaderText += 'uniform samplerCube uSpecularEnvTexture;\\n';\r\n            shaderText += 'uniform vec4 uIBLParameters;\\n'; // Ka * amount of ambient lights\r\n        }\r\n        shaderText += 'uniform vec4 ambient;\\n'; // Ka * amount of ambient lights\r\n        return shaderText;\r\n    }\r\n    get mipmapLevel() {\r\n        return `\n    // https://stackoverflow.com/questions/24388346/how-to-access-automatic-mipmap-level-in-glsl-fragment-shader-texture\n    float mipmapLevel(vec3 uv_as_texel)\n    {\n      vec3  dx_vtc        = dFdx(uv_as_texel);\n      vec3  dy_vtc        = dFdy(uv_as_texel);\n      float delta_max_sqr = max(dot(dx_vtc, dx_vtc), dot(dy_vtc, dy_vtc));\n      float mml = 0.5 * log2(delta_max_sqr);\n      return max( 0.0, mml );\n    }`;\r\n    }\r\n    get pbrMethodDefinition() {\r\n        return `\n    const float M_PI = 3.141592653589793;\n    const float c_MinRoughness = 0.04;\n\n    float angular_n_h(float NH) {\n      return acos(NH);\n    }\n\n    float sqr(float x) {\n      return x*x;\n    }\n\n    float d_phong(float NH, float c1) {\n      return pow(\n        cos(acos(NH))\n        , c1\n      );\n    }\n\n    // this is from https://www.unrealengine.com/blog/physically-based-shading-on-mobile\n    vec3 envBRDFApprox( vec3 F0, float Roughness, float NoV ) {\n      const vec4 c0 = vec4(-1, -0.0275, -0.572, 0.022 );\n      const vec4 c1 = vec4(1, 0.0425, 1.04, -0.04 );\n      vec4 r = Roughness * c0 + c1;\n      float a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n      vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n      return F0 * AB.x + AB.y;\n    }\n\n    // GGX NDF\n    float d_ggx(float NH, float alphaRoughness) {\n      float roughnessSqr = alphaRoughness * alphaRoughness;\n      float f = (roughnessSqr - 1.0) * NH * NH + 1.0;\n      return roughnessSqr / (M_PI * f * f);\n    }\n\n    float d_torrance_reiz(float NH, float c3) {\n      float CosSquared = NH*NH;\n      float TanSquared = (1.0 - CosSquared)/CosSquared;\n      //return (1.0/M_PI) * sqr(c3/(CosSquared * (c3*c3 + TanSquared)));  // gamma = 2, aka GGX\n      return (1.0/sqrt(M_PI)) * (sqr(c3)/(CosSquared * (c3*c3 + TanSquared))); // gamma = 1, D_Berry\n    }\n\n    float d_beckmann(float NH, float m) {\n      float co = 1.0 / (4.0 * m * m * NH * NH * NH * NH);\n      float expx = exp((NH * NH - 1.0) / (m * m * NH * NH));\n      return co * expx;\n    }\n\n    // the same as glTF WebGL sample\n    // https://github.com/KhronosGroup/glTF-WebGL-PBR/blob/88eda8c5358efe03128b72b6c5f5f6e5b6d023e1/shaders/pbr-frag.glsl#L188\n    // That is, Unreal Engine based approach, but modified to use alphaRoughness (squared artist's roughness parameter),\n    // and based on 'Separable Masking and Shadowing' approximation (propesed by Christophe Schlick)\n    // https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\n    float g_shielding(float NL, float NV, float alphaRoughness) {\n      float r = alphaRoughness;\n\n      // Local Shadowing using \"Schlick-Smith\" Masking Function\n      float localShadowing = 2.0 * NL / (NL + sqrt(r * r + (1.0 - r * r) * (NL * NL)));\n\n      // Local Masking using \"Schlick-Smith\" Masking Function\n      float localMasking = 2.0 * NV / (NV + sqrt(r * r + (1.0 - r * r) * (NV * NV)));\n\n      return localShadowing * localMasking;\n    }\n\n    // The code from https://google.github.io/filament/Filament.html#listing_approximatedspecularv\n    // The idea is from [Heitz14] Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs.\n    float v_SmithGGXCorrelated(float NL, float NV, float alphaRoughness) {\n      float a2 = alphaRoughness * alphaRoughness;\n      float GGXV = NL * sqrt(NV * NV * (1.0 - a2) + a2);\n      float GGXL = NV * sqrt(NL * NL * (1.0 - a2) + a2);\n      return 0.5 / (GGXV + GGXL);\n    }\n\n    float v_SmithGGXCorrelatedFast(float NL, float NV, float alphaRoughness) {\n      float a = alphaRoughness;\n      float GGXV = NL * (NV * (1.0 - a) + a);\n      float GGXL = NV * (NL * (1.0 - a) + a);\n      return 0.5 / (GGXV + GGXL);\n    }\n\n    // The Schlick Approximation to Fresnel\n    vec3 fresnel(vec3 f0, float VH) {\n      return vec3(f0) + (vec3(1.0) - f0) * pow(1.0 - VH, 5.0);\n    }\n\n    vec3 cook_torrance_specular_brdf(float NH, float NL, float NV, vec3 F, float alphaRoughness) {\n      float D = d_ggx(NH, alphaRoughness);\n      float V = v_SmithGGXCorrelated(NL, NV, alphaRoughness);\n      return vec3(D)*vec3(V)*F;\n//      float G = g_shielding(NL, NV, alphaRoughness);\n//      return vec3(D)*vec3(G)*F/vec3(4.0*NL*NV);\n\n    }\n\n    vec3 diffuse_brdf(vec3 albedo)\n    {\n      return albedo / M_PI;\n    }\n\n    vec3 srgbToLinear(vec3 srgbColor) {\n      return pow(srgbColor, vec3(2.2));\n    }\n\n    float srgbToLinear(float value) {\n      return pow(value, 2.2);\n    }\n\n    vec3 linearToSrgb(vec3 linearColor) {\n      return pow(linearColor, vec3(1.0/2.2));\n    }\n\n    float linearToSrgb(float value) {\n      return pow(value, 1.0/2.2);\n    }\n\n    vec3 fresnelSchlickRoughness(vec3 F0, float cosTheta, float roughness)\n    {\n      return F0 + (max(vec3(1.0 - roughness), F0) - F0) * pow(1.0 - cosTheta, 5.0);\n    }\n\n    vec3 normalBlendingUDN(sampler2D baseMap, sampler2D detailMap, vec2 baseUv, vec2 detailUv) {\n      vec3 t = ${this.glsl_texture}(baseMap,   baseUv).xyz * 2.0 - 1.0;\n      vec3 u = ${this.glsl_texture}(detailMap, detailUv).xyz * 2.0 - 1.0;\n      vec3 r = normalize(vec3(t.xy + u.xy, t.z));\n      return r;\n    }\n\n    vec2 uvTransform(vec2 scale, vec2 offset, float rotation, vec2 uv) {\n      mat3 translationMat = mat3(1,0,0, 0,1,0, offset.x, offset.y, 1);\n      mat3 rotationMat = mat3(\n          cos(rotation), -sin(rotation), 0,\n          sin(rotation),  cos(rotation), 0,\n                      0,             0, 1\n      );\n      mat3 scaleMat = mat3(scale.x,0,0, 0,scale.y,0, 0,0,1);\n\n      mat3 matrix = translationMat * rotationMat * scaleMat;\n      vec2 uvTransformed = ( matrix * vec3(uv.xy, 1) ).xy;\n\n      return uvTransformed;\n    }\n\n    `;\r\n    }\r\n    get simpleMVPPosition() {\r\n        return `\n  float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_4__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\n  gl_Position = projectionMatrix * viewMatrix * worldMatrix * vec4(a_position, 1.0);\n    `;\r\n    }\r\n    static getStringFromShaderAnyDataType(data) {\r\n        if (data instanceof _foundation_definitions_ShaderSemantics__WEBPACK_IMPORTED_MODULE_1__[\"ShaderSemanticsClass\"]) {\r\n            return 'u_' + data.str;\r\n        }\r\n        else if (data instanceof _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_2__[\"VertexAttributeClass\"]) {\r\n            return data.shaderStr;\r\n        }\r\n        else {\r\n            return data;\r\n        }\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/GLSLShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/MToonShader.ts":
/*!******************************************!*\
  !*** ./src/webgl/shaders/MToonShader.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MToonShader; });\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../foundation/definitions/ShaderNode */ \"./src/foundation/definitions/ShaderNode.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass MToonShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.attributeNames = [\r\n            'a_instanceID',\r\n            'a_texcoord',\r\n            'a_position', 'a_normal', 'a_tangent',\r\n            'a_baryCentricCoord', 'a_joint', 'a_weight',\r\n        ];\r\n        this.attributeSemantics = [\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Instance,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Texcoord0,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Position, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Normal, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Tangent,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].BaryCentricCoord, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Joints0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Weights0,\r\n        ];\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new MToonShader();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getVertexShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _texture = this.glsl_texture;\r\n        const _in = this.glsl_vertex_in;\r\n        const _out = this.glsl_vertex_out;\r\n        return `${_version}\r\n${this.glslPrecision}\r\n\r\n// This shader is based on https://github.com/Santarh/MToon\r\n\r\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\r\n\r\n${_in} float a_instanceID;\r\n${_in} vec2 a_texcoord;\r\n${_in} vec3 a_position;\r\n${_in} vec3 a_normal;\r\n${_in} vec3 a_tangent;\r\n${_in} vec4 a_baryCentricCoord;\r\n${_in} vec4 a_joint;\r\n${_in} vec4 a_weight;\r\n\r\n${_out} vec2 v_texcoord;\r\n${_out} vec3 v_baryCentricCoord;\r\n${_out} vec3 v_binormal_inWorld; // bitangent_inWorld\r\n${_out} vec3 v_normal_inView;\r\n${_out} vec3 v_normal_inWorld;\r\n${_out} vec3 v_tangent_inWorld;\r\n${_out} vec4 v_position_inWorld;\r\n\r\n${this.prerequisites}\r\n\r\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\r\n\r\n${(typeof args.matricesGetters !== 'undefined') ? args.matricesGetters : ''}\r\n\r\n${this.toNormalMatrix}\r\n\r\n${this.getSkinMatrix}\r\n\r\n${this.processGeometryWithSkinningOptionally}\r\n\r\nvoid main(){\r\n  #ifdef RN_MTOON_IS_OUTLINE\r\n    #ifdef RN_MTOON_OUTLINE_NONE\r\n      return;\r\n    #endif\r\n  #endif\r\n  ${this.mainPrerequisites}\r\n\r\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\r\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\r\n  bool isSkinning = false;\r\n  isSkinning = processGeometryWithMorphingAndSkinning(\r\n    skeletalComponentSID,\r\n    worldMatrix,\r\n    normalMatrix,\r\n    normalMatrix,\r\n    a_position,\r\n    v_position_inWorld,\r\n    a_normal,\r\n    v_normal_inWorld\r\n  );\r\n\r\n  float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\r\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\r\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\r\n\r\n  v_normal_inView = vec3(viewMatrix * vec4(v_normal_inWorld, 0.0));\r\n\r\n  #ifndef RN_MTOON_IS_OUTLINE //ndef\r\n    gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\r\n  #else\r\n    #if defined(RN_MTOON_HAS_OUTLINE_WIDTH_TEXTURE)\r\n      float outlineTex = ${_texture}(u_outlineWidthTexture, a_texcoord).r;\r\n    #else\r\n      float outlineTex = 1.0;\r\n    #endif\r\n\r\n    #if defined(RN_MTOON_OUTLINE_WIDTH_WORLD)\r\n      float outlineWidth = get_outlineWidth(materialSID, 0);\r\n      vec3 outlineOffset = 0.01 * outlineWidth * outlineTex * a_normal;\r\n      vec4 worldOutlineOffset = worldMatrix * vec4(outlineOffset, 0.0);\r\n      gl_Position = projectionMatrix * viewMatrix * (v_position_inWorld + worldOutlineOffset);\r\n\r\n    #elif defined(RN_MTOON_OUTLINE_WIDTH_SCREEN)\r\n      vec4 vertex = projectionMatrix * viewMatrix * v_position_inWorld;\r\n\r\n      vec3 clipNormal = (projectionMatrix * vec4(v_normal_inView, 1.0)).xyz;\r\n      vec2 projectedNormal = normalize(clipNormal.xy);\r\n      float outlineScaledMaxDistance = get_outlineScaledMaxDistance(materialSID, 0);\r\n      projectedNormal *= min(vertex.w, outlineScaledMaxDistance);\r\n      float aspect = abs(get_aspect(0.0, 0)); //solo datum\r\n      projectedNormal.x *= aspect;\r\n\r\n      float outlineWidth = get_outlineWidth(materialSID, 0);\r\n      vertex.xy += 0.01 * outlineWidth * outlineTex * projectedNormal * clamp(1.0 - abs(v_normal_inView.z), 0.0, 1.0); // ignore offset when normal toward camera\r\n\r\n      gl_Position = vertex;\r\n    #else\r\n      gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\r\n    #endif\r\n  #endif\r\n\r\n  if (abs(length(a_normal)) > 0.01) {\r\n    // if normal exist\r\n    vec3 tangent_inWorld;\r\n    if (!isSkinning) {\r\n      tangent_inWorld = normalMatrix * a_tangent;\r\n      v_position_inWorld = worldMatrix * vec4(a_position, 1.0);\r\n    }\r\n\r\n    v_binormal_inWorld = cross(v_normal_inWorld, tangent_inWorld);\r\n    v_tangent_inWorld = cross(v_binormal_inWorld, v_normal_inWorld);\r\n  }\r\n\r\n  v_texcoord = a_texcoord;\r\n\r\n  v_baryCentricCoord = a_baryCentricCoord.xyz;\r\n}`;\r\n    }\r\n    getFragmentShader(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_fragment_in;\r\n        const _def_rt0 = this.glsl_rt0;\r\n        const _def_fragColor = this.glsl_fragColor;\r\n        const _texture = this.glsl_texture;\r\n        const _textureCube = this.glsl_textureCube;\r\n        let accessSpecularIBLTexture;\r\n        const repo = this.__webglResourceRepository;\r\n        if (repo.currentWebGLContextWrapper.webgl1ExtSTL) {\r\n            accessSpecularIBLTexture = `vec4 specularTexel = ${_textureCube}LodEXT(u_specularEnvTexture, vec3(-reflection.x, reflection.y, reflection.z), lod);`;\r\n        }\r\n        else {\r\n            accessSpecularIBLTexture = `vec4 specularTexel = ${_textureCube}(u_specularEnvTexture, vec3(-reflection.x, reflection.y, reflection.z));`;\r\n        }\r\n        return `${_version}\r\n${this.glsl1ShaderTextureLodExt}\r\n${this.glsl1ShaderDerivativeExt}\r\n${this.glslPrecision}\r\n\r\n\r\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\r\n\r\n${this.prerequisites}\r\n\r\nconst float EPS_COL = 0.00001;\r\n\r\n${_in} vec2 v_texcoord;\r\n${_in} vec3 v_baryCentricCoord;\r\n${_in} vec3 v_binormal_inWorld; // bitangent_inWorld\r\n${_in} vec3 v_normal_inView;\r\n${_in} vec3 v_normal_inWorld;\r\n${_in} vec3 v_tangent_inWorld;\r\n${_in} vec4 v_position_inWorld;\r\n${_def_rt0}\r\n\r\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\r\n\r\nfloat edge_ratio(vec3 bary3, float wireframeWidthInner, float wireframeWidthRelativeScale) {\r\n  vec3 d = fwidth(bary3);\r\n  vec3 x = bary3+vec3(1.0 - wireframeWidthInner)*d;\r\n  vec3 a3 = smoothstep(vec3(0.0), d, x);\r\n  float factor = min(min(a3.x, a3.y), a3.z);\r\n\r\n  return clamp((1.0 - factor), 0.0, 1.0);\r\n}\r\n\r\nvec3 srgbToLinear(vec3 srgbColor) {\r\n  return pow(srgbColor, vec3(2.2));\r\n}\r\n\r\nvoid main (){\r\n  #ifdef RN_MTOON_IS_OUTLINE\r\n    #ifdef RN_MTOON_OUTLINE_NONE\r\n      discard;\r\n    #endif\r\n  #endif\r\n  ${this.mainPrerequisites}\r\n\r\n\r\n  // TODO\r\n  // uv transform\r\n\r\n  // TODO\r\n  // uv animation\r\n\r\n  // main color\r\n  vec4 litTextureColor = ${_texture}(u_litColorTexture, v_texcoord);\r\n  vec4 litColorFactor = get_litColor(materialSID, 0);\r\n\r\n  // alpha\r\n  float alpha = 1.0;\r\n\r\n  #ifdef RN_ALPHATEST_ON\r\n    alpha = litTextureColor.a * litColorFactor.a;\r\n    float cutoff = get_cutoff(materialSID, 0);\r\n    if(alpha < cutoff) discard;\r\n  #elif defined(RN_ALPHABLEND_ON)\r\n    alpha = litTextureColor.a * litColorFactor.a;\r\n  #endif\r\n\r\n  if (alpha < 0.01) {\r\n    discard;\r\n  }else{\r\n    rt0.w = alpha;\r\n  }\r\n\r\n\r\n  #ifdef RN_MTOON_IS_OUTLINE\r\n    #ifdef RN_MTOON_OUTLINE_COLOR_FIXED\r\n      vec3 outlineColor = get_outlineColor(materialSID, 0);\r\n      rt0.xyz = outlineColor;\r\n\r\n      rt0.xyz = srgbToLinear(rt0.xyz);\r\n      ${_def_fragColor}\r\n      return;\r\n    #endif\r\n  #endif\r\n\r\n\r\n  // Normal\r\n  vec3 normal_inWorld = normalize(v_normal_inWorld);\r\n\r\n  #ifdef RN_MTOON_HAS_BUMPMAP\r\n    if (abs(length(v_tangent_inWorld)) > 0.01) {\r\n      vec3 tangent_inWorld = normalize(v_tangent_inWorld);\r\n      vec3 binormal_inWorld = normalize(v_binormal_inWorld);\r\n\r\n      mat3 tbnMat_tangent_to_world = mat3(\r\n        tangent_inWorld.x, tangent_inWorld.y, tangent_inWorld.z,\r\n        binormal_inWorld.x, binormal_inWorld.y, binormal_inWorld.z,\r\n        normal_inWorld.x, normal_inWorld.y, normal_inWorld.z\r\n      );\r\n\r\n      vec3 normal = ${_texture}(u_normalTexture, v_texcoord).xyz * 2.0 - 1.0;\r\n      float normalScale = get_normalScale(materialSID, 0);\r\n      normal.xy *= normalScale;\r\n      normal_inWorld = normalize(tbnMat_tangent_to_world * normal);\r\n    }\r\n  #endif\r\n\r\n  #ifdef RN_MTOON_IS_OUTLINE\r\n    normal_inWorld *= -1.0;\r\n  #endif\r\n\r\n\r\n  // Lighting, Direct Light\r\n\r\n  float shadowAttenuation = 1.0;\r\n  // TODO: shadowmap computation\r\n\r\n  float receiveShadowRate = get_receiveShadowRate(materialSID, 0);\r\n  float lightAttenuation = shadowAttenuation * mix(1.0, shadowAttenuation, receiveShadowRate * ${_texture}(u_receiveShadowTexture, v_texcoord).r);\r\n\r\n  float shadingGradeRate = get_shadingGradeRate(materialSID, 0);\r\n  float shadingGrade = 1.0 - shadingGradeRate * (1.0 - ${_texture}(u_shadingGradeTexture, v_texcoord).r);\r\n  float lightColorAttenuation = get_lightColorAttenuation(materialSID, 0);\r\n\r\n  vec3 shadeColorFactor = get_shadeColor(materialSID, 0);\r\n  vec3 shadeColor = shadeColorFactor * ${_texture}(u_shadeColorTexture, v_texcoord).xyz;\r\n  shadeColor.xyz = srgbToLinear(shadeColor.xyz);\r\n\r\n  vec3 litColor = litColorFactor.xyz * litTextureColor.xyz;\r\n  litColor.xyz = srgbToLinear(litColor.xyz);\r\n\r\n\r\n  float shadeShift = get_shadeShift(materialSID, 0);\r\n  float shadeToony = get_shadeToony(materialSID, 0);\r\n\r\n  vec3 lightings[${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}];\r\n  #ifdef RN_MTOON_DEBUG_LITSHADERATE\r\n    float lightIntensities[${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}];\r\n  #endif\r\n  for (int i = 0; i < ${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}; i++) {\r\n    if (i >= lightNumber) {\r\n      break;\r\n    }\r\n\r\n    // Rn_Light\r\n    vec4 gotLightDirection = get_lightDirection(0.0, i);\r\n    vec4 gotLightIntensity = get_lightIntensity(0.0, i); //light color\r\n    vec4 gotLightPosition = get_lightPosition(0.0, i);\r\n    vec3 lightDirection = gotLightDirection.xyz;\r\n    vec3 lightColor = gotLightIntensity.xyz;\r\n    vec3 lightPosition = gotLightPosition.xyz;\r\n    float lightType = gotLightPosition.w;\r\n    float spotCosCutoff = gotLightDirection.w;\r\n    float spotExponent = gotLightIntensity.w;\r\n\r\n    float distanceAttenuation = 1.0;\r\n    if (lightType > 0.75) { // is point light or spotlight\r\n      lightDirection = normalize(lightPosition.xyz - v_position_inWorld.xyz);\r\n\r\n      float distance = dot(lightPosition - v_position_inWorld.xyz, lightPosition - v_position_inWorld.xyz);\r\n      distanceAttenuation = 1.0 / pow(distance, 2.0);\r\n    }\r\n\r\n    float spotEffect = 1.0;\r\n    if (lightType > 1.75) { // is spotlight\r\n      spotEffect *= dot(gotLightDirection.xyz, lightDirection);\r\n      if (spotEffect > spotCosCutoff) {\r\n        spotEffect *= pow(clamp(spotEffect, 0.0, 1.0), spotExponent);\r\n      } else {\r\n        spotEffect = 0.0;\r\n      }\r\n    }\r\n\r\n    // lightAttenuation *= distanceAttenuation * spotEffect;\r\n    float dotNL = dot(lightDirection, normal_inWorld);\r\n    float lightIntensity = dotNL * 0.5 + 0.5; // from [-1, +1] to [0, 1]\r\n    lightIntensity = lightIntensity * lightAttenuation; // TODO: receive shadow\r\n    lightIntensity = lightIntensity * shadingGrade; // darker\r\n    lightIntensity = lightIntensity * 2.0 - 1.0; // from [0, 1] to [-1, +1]\r\n\r\n    // tooned. mapping from [minIntensityThreshold, maxIntensityThreshold] to [0, 1]\r\n    float maxIntensityThreshold = mix(1.0, shadeShift, shadeToony);\r\n    float minIntensityThreshold = shadeShift;\r\n    lightIntensity = clamp((lightIntensity - minIntensityThreshold) / max(EPS_COL, (maxIntensityThreshold - minIntensityThreshold)), 0.0, 1.0);\r\n    #ifdef RN_MTOON_DEBUG_LITSHADERATE\r\n      lightIntensities[i] = lightIntensity;\r\n    #endif\r\n\r\n    // Albedo color\r\n    vec3 col = mix(shadeColor, litColor, lightIntensity);\r\n\r\n    // Direct Light\r\n    vec3 lighting = lightColor;\r\n    lighting = mix(lighting, vec3(max(EPS_COL, max(lighting.x, max(lighting.y, lighting.z)))), lightColorAttenuation); // color atten\r\n\r\n\r\n    if(i > 0){\r\n      lighting *= 0.5; // darken if additional light.\r\n      lighting *= min(0.0, dotNL) + 1.0; // darken dotNL < 0 area by using half lambert\r\n      // lighting *= shadowAttenuation; // darken if receiving shadow\r\n      #ifdef RN_ALPHABLEND_ON\r\n        lighting *= step(0.0, dotNL); // darken if transparent. Because Unity's transparent material can't receive shadowAttenuation.\r\n      #endif\r\n    }\r\n\r\n    col *= lighting;\r\n    lightings[i] = lighting;\r\n\r\n    rt0.xyz += col;\r\n\r\n    lightAttenuation = 1.0;\r\n  }\r\n\r\n\r\n  // Indirect Light\r\n  vec3 indirectLighting = get_ambientColor(materialSID, 0);\r\n  indirectLighting = srgbToLinear(indirectLighting);\r\n  indirectLighting = mix(indirectLighting, vec3(max(EPS_COL, max(indirectLighting.x, max(indirectLighting.y, indirectLighting.z)))), lightColorAttenuation); // color atten\r\n  // TODO: use ShadeIrad in www.ppsloan.org/publications/StupidSH36.pdf\r\n\r\n  rt0.xyz += indirectLighting * litColor;\r\n  rt0.xyz = min(rt0.xyz, litColor); // comment out if you want to PBR absolutely.\r\n\r\n\r\n  #ifdef RN_MTOON_IS_OUTLINE\r\n    #ifdef RN_MTOON_OUTLINE_COLOR_MIXED\r\n      vec3 outlineColor = get_outlineColor(materialSID, 0);\r\n      outlineColor = srgbToLinear(outlineColor);\r\n      float outlineLightingMix = get_outlineLightingMix(materialSID, 0);\r\n      rt0.xyz = outlineColor * mix(vec3(1.0), rt0.xyz, outlineLightingMix);\r\n    #endif\r\n  #else\r\n    float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\r\n    vec3 viewPosition = get_viewPosition(cameraSID, 0);\r\n    vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\r\n\r\n    float rimFresnelPower = get_rimFresnelPower(materialSID, 0);\r\n    float rimLift = get_rimLift(materialSID, 0);\r\n    vec3 rimColorFactor = get_rimColor(materialSID, 0);\r\n    vec3 rimTextureColor = ${_texture}(u_rimTexture, v_texcoord).xyz;\r\n    vec3 rimColor = srgbToLinear(rimColorFactor * rimTextureColor);\r\n    vec3 rim = pow(clamp(1.0 - dot(normal_inWorld, viewDirection) + rimLift, 0.0, 1.0), rimFresnelPower) * rimColor;\r\n\r\n    float staticRimLighting = 1.0;\r\n    float rimLightingMix = get_rimLightingMix(materialSID, 0);\r\n    for (int i = 0; i < ${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}; i++) {\r\n      if (i >= lightNumber) break;\r\n\r\n      if(i > 0) staticRimLighting = 0.0;\r\n\r\n      vec3 rimLighting = mix(vec3(staticRimLighting), lightings[i], vec3(rimLightingMix));\r\n      rt0.xyz += rim * rimLighting;\r\n    }\r\n\r\n    // additive matcap\r\n    vec3 cameraUp = get_cameraUp(0.0, 0); //solo datum\r\n    vec3 worldViewUp = normalize(cameraUp - viewDirection * dot(viewDirection, cameraUp));\r\n    vec3 worldViewRight = normalize(cross(viewDirection, worldViewUp));\r\n    vec2 matcapUv = vec2(dot(worldViewRight, normal_inWorld), dot(worldViewUp, normal_inWorld)) * 0.5 + 0.5;\r\n    vec3 matCapColor = srgbToLinear(${_texture}(u_matCapTexture, matcapUv).xyz);\r\n    rt0.xyz += matCapColor;\r\n\r\n\r\n    // Emission\r\n    vec3 emissionColor = get_emissionColor(materialSID, 0);\r\n    vec3 emission = srgbToLinear(${_texture}(u_emissionTexture, v_texcoord).xyz) * emissionColor;\r\n    rt0.xyz += emission;\r\n  #endif\r\n\r\n\r\n  // debug\r\n  #ifdef RN_MTOON_DEBUG_NORMAL\r\n    rt0 = vec4(normal_inWorld * 0.5 + 0.5, alpha);\r\n\r\n    rt0.xyz = srgbToLinear(rt0.xyz);\r\n    ${_def_fragColor}\r\n    return;\r\n  #elif defined(RN_MTOON_DEBUG_LITSHADERATE)\r\n    rt0 = vec4(0.0);\r\n    for (int i = 0; i < ${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}; i++) {\r\n      if (i >= lightNumber) break;\r\n      rt0 += vec4(lightIntensities[i] * lightings[i], alpha);\r\n    }\r\n\r\n    rt0.xyz = srgbToLinear(rt0.xyz);\r\n    ${_def_fragColor}\r\n    return;\r\n  #endif\r\n\r\n\r\n  // Wireframe\r\n  float threshold = 0.001;\r\n  vec3 wireframe = get_wireframe(materialSID, 0);\r\n  float wireframeWidthInner = wireframe.z;\r\n  float wireframeWidthRelativeScale = 1.0;\r\n  if (wireframe.x > 0.5 && wireframe.y < 0.5) {\r\n    rt0.a = 0.0;\r\n  }\r\n  vec4 wireframeResult = rt0;\r\n  vec4 wireframeColor = vec4(0.2, 0.75, 0.0, 1.0);\r\n  float edgeRatio = edge_ratio(v_baryCentricCoord, wireframeWidthInner, wireframeWidthRelativeScale);\r\n  float edgeRatioModified = mix(step(threshold, edgeRatio), clamp(edgeRatio*4.0, 0.0, 1.0), wireframeWidthInner / wireframeWidthRelativeScale/4.0);\r\n  // if r0.a is 0.0, it is wireframe not on shaded\r\n  wireframeResult.rgb = wireframeColor.rgb * edgeRatioModified + rt0.rgb * (1.0 - edgeRatioModified);\r\n  wireframeResult.a = max(rt0.a, wireframeColor.a * mix(edgeRatioModified, pow(edgeRatioModified, 100.0), wireframeWidthInner / wireframeWidthRelativeScale/1.0));\r\n\r\n  if (wireframe.x > 0.5) {\r\n    rt0 = wireframeResult;\r\n    if (wireframe.y < 0.5 && rt0.a == 0.0) {\r\n      discard;\r\n    }\r\n  }\r\n\r\n  ${_def_fragColor}\r\n}\r\n`;\r\n    }\r\n    get pixelShaderDefinitions() {\r\n        return '';\r\n    }\r\n    getPixelShaderBody(args) {\r\n        return this.getFragmentShader(args);\r\n    }\r\n    get attributeCompositions() {\r\n        return [\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec2,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4,\r\n        ];\r\n    }\r\n}\r\nMToonShader.materialElement = _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"ShaderNode\"].PBRShading;\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/MToonShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/ShadowMapDecodeClassicShader.ts":
/*!***********************************************************!*\
  !*** ./src/webgl/shaders/ShadowMapDecodeClassicShader.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ShadowMapDecodeClassicShader; });\n/* harmony import */ var _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../foundation/definitions/VertexAttribute */ \"./src/foundation/definitions/VertexAttribute.ts\");\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../foundation/core/Config */ \"./src/foundation/core/Config.ts\");\n/* harmony import */ var _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../foundation/definitions/ShaderNode */ \"./src/foundation/definitions/ShaderNode.ts\");\n/* harmony import */ var _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../foundation/definitions/CompositionType */ \"./src/foundation/definitions/CompositionType.ts\");\n/* harmony import */ var _foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../foundation/components/WellKnownComponentTIDs */ \"./src/foundation/components/WellKnownComponentTIDs.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass ShadowMapDecodeClassicShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n        this.attributeNames = [\r\n            'a_instanceID',\r\n            'a_texcoord_0', 'a_texcoord_1',\r\n            'a_position', 'a_color', 'a_normal',\r\n            'a_joint', 'a_weight',\r\n        ];\r\n        this.attributeSemantics = [\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Instance,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Texcoord0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Texcoord1,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Position, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Color0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Normal,\r\n            _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Joints0, _foundation_definitions_VertexAttribute__WEBPACK_IMPORTED_MODULE_0__[\"VertexAttribute\"].Weights0,\r\n        ];\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new ShadowMapDecodeClassicShader();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getVertexShaderBody(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_vertex_in;\r\n        const _out = this.glsl_vertex_out;\r\n        return `${_version}\n${this.glslPrecision}\n\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\n\n${_in} vec3 a_position;\n${_in} vec3 a_color;\n${_in} vec3 a_normal;\n${_in} float a_instanceID;\n${_in} vec2 a_texcoord_0;\n${_in} vec2 a_texcoord_1;\n${_in} vec4 a_joint;\n${_in} vec4 a_weight;\n${_out} vec3 v_color;\n${_out} vec3 v_normal_inWorld;\n${_out} vec4 v_position_inWorld;\n${_out} vec2 v_texcoord_0;\n${_out} vec4 v_texcoord_1;\n${_out} vec4 v_projPosition_from_light;\n\n${this.prerequisites}\n\n${(typeof args.matricesGetters !== 'undefined') ? args.matricesGetters : ''}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\n${this.toNormalMatrix}\n\n${this.getSkinMatrix}\n\n${this.processGeometryWithSkinningOptionally}\n\nvoid main(){\n\n  ${this.mainPrerequisites}\n  float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\n  mat4 worldMatrix = get_worldMatrix(a_instanceID);\n  mat4 viewMatrix = get_viewMatrix(cameraSID, 0);\n  mat4 projectionMatrix = get_projectionMatrix(cameraSID, 0);\n  mat3 normalMatrix = get_normalMatrix(a_instanceID);\n\n  // Skeletal\n  processGeometryWithMorphingAndSkinning(\n    skeletalComponentSID,\n    worldMatrix,\n    normalMatrix,\n    normalMatrix,\n    a_position,\n    v_position_inWorld,\n    a_normal,\n    v_normal_inWorld\n  );\n\n  gl_Position = projectionMatrix * viewMatrix * v_position_inWorld;\n\n  ${this.pointSprite}\n\n  // Shadow mapping\n  mat4 lightViewProjectionMatrix = get_lightViewProjectionMatrix(materialSID, 0);\n  v_projPosition_from_light = lightViewProjectionMatrix * v_position_inWorld;\n\n  // Following tMatrix is based on https://wgld.org/d/webgl/w051.html\n  mat4 tMatrix = mat4(\n    0.5, 0.0, 0.0, 0.0,\n    0.0, 0.5, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.5, 0.5, 0.0, 1.0\n  );\n  v_texcoord_1 = tMatrix * v_projPosition_from_light;\n\n  v_color = a_color;\n  v_normal_inWorld = normalMatrix * a_normal;\n  v_texcoord_0 = a_texcoord_0;\n\n}\n`;\r\n    }\r\n    getFragmentShader(args) {\r\n        const _version = this.glsl_versionText;\r\n        const _in = this.glsl_fragment_in;\r\n        const _def_rt0 = this.glsl_rt0;\r\n        const _def_fragColor = this.glsl_fragColor;\r\n        const _texture = this.glsl_texture;\r\n        const _textureProj = this.glsl_textureProj;\r\n        return `${_version}\n${this.glslPrecision}\n\n${(typeof args.definitions !== 'undefined') ? args.definitions : ''}\n\n${this.prerequisites}\n\n${_in} vec3 v_color;\n${_in} vec3 v_normal_inWorld;\n${_in} vec4 v_position_inWorld;\n${_in} vec2 v_texcoord_0;\n${_in} vec4 v_texcoord_1;\n${_in} vec4 v_projPosition_from_light;\n${_def_rt0}\n\n${(typeof args.getters !== 'undefined') ? args.getters : ''}\n\nfloat decodeRGBAToDepth(vec4 RGBA){\n  const float rMask = 1.0;\n  const float gMask = 1.0 / 255.0;\n  const float bMask = 1.0 / (255.0 * 255.0);\n  const float aMask = 1.0 / (255.0 * 255.0 * 255.0);\n  float depth = dot(RGBA, vec4(rMask, gMask, bMask, aMask));\n  return depth;\n}\n\nvoid main (){\n  ${this.mainPrerequisites}\n\n  // Normal\n  vec3 normal_inWorld = normalize(v_normal_inWorld);\n\n  // diffuseColor\n  vec3 diffuseColor = vec3(0.0, 0.0, 0.0);\n  float alpha = 1.0;\n\n  vec4 diffuseColorFactor = get_diffuseColorFactor(materialSID, 0);\n  if (v_color != diffuseColor && diffuseColorFactor.rgb != diffuseColor) {\n    diffuseColor = v_color * diffuseColorFactor.rgb;\n    alpha = diffuseColorFactor.a;\n  } else if (v_color == diffuseColor) {\n    diffuseColor = diffuseColorFactor.rgb;\n    alpha = diffuseColorFactor.a;\n  } else if (diffuseColorFactor.rgb == diffuseColor) {\n    diffuseColor = v_color;\n  } else {\n    diffuseColor = vec3(1.0, 1.0, 1.0);\n  }\n\n  // diffuseColorTexture\n  vec4 textureColor = ${_texture}(u_diffuseColorTexture, v_texcoord_0);\n  if (textureColor.r > 0.05) {\n    diffuseColor *= textureColor.rgb;\n    alpha *= textureColor.a;\n  }\n\n  // shadow mapping\n  if(v_projPosition_from_light.w > 0.0){\n    float zNear = get_zNearInner(materialSID, 0);\n    float zFar = get_zFarInner(materialSID, 0);\n    float normalizationCoefficient = 1.0 / (zFar - zNear);\n\n    vec2 shadowMapUV = v_texcoord_1.xy / v_texcoord_1.w;\n\n    #ifdef RN_IS_DEBUGGING\n      bool inShadowMap = (shadowMapUV.x >= 0.0 && shadowMapUV.x <= 1.0) && (shadowMapUV.y >= 0.0 && shadowMapUV.y <= 1.0);\n      if(inShadowMap == false){\n        rt0 = get_debugColorFactor(materialSID, 0);\n        ${_def_fragColor}\n        return;\n      }\n    #endif\n\n    float measureDepth = normalizationCoefficient * length(v_projPosition_from_light);\n    float textureDepth = decodeRGBAToDepth(${_texture}(u_depthTexture, shadowMapUV));\n    float allowableDepthError = get_allowableDepthError(materialSID, 0);\n\n    if(measureDepth > textureDepth + allowableDepthError){\n      // case of shadow\n      vec4 shadowColorCoefficient = get_shadowColorCoefficient(materialSID, 0);\n      diffuseColor *= shadowColorCoefficient.rgb;\n      alpha *= shadowColorCoefficient.a;\n    }\n  }\n\n  // Lighting\n  vec3 shadingColor = vec3(0.0, 0.0, 0.0);\n  int shadingModel = get_shadingModel(materialSID, 0);\n  if (shadingModel > 0) {\n\n    vec3 diffuse = vec3(0.0, 0.0, 0.0);\n    vec3 specular = vec3(0.0, 0.0, 0.0);\n    int lightNumber = get_lightNumber(materialSID, 0);\n    for (int i = 0; i < ${_foundation_core_Config__WEBPACK_IMPORTED_MODULE_2__[\"default\"].maxLightNumberInShader}; i++) {\n      if (i >= lightNumber) {\n        break;\n      }\n\n      vec4 gotLightDirection = get_lightDirection(0.0, i);\n      vec4 gotLightIntensity = get_lightIntensity(0.0, i);\n      vec4 gotLightPosition = get_lightPosition(0.0, i);\n\n      vec3 lightDirection = gotLightDirection.xyz;\n      vec3 lightIntensity = gotLightIntensity.xyz;\n      vec3 lightPosition = gotLightPosition.xyz;\n      float spotCosCutoff = gotLightDirection.w;\n      float spotExponent = gotLightIntensity.w;\n      float lightType = gotLightPosition.w;\n\n      if (0.75 < lightType) { // is pointlight or spotlight\n        lightDirection = normalize(lightPosition - v_position_inWorld.xyz);\n      }\n      float spotEffect = 1.0;\n      if (lightType > 1.75) { // is spotlight\n        spotEffect = dot(gotLightDirection.xyz, lightDirection);\n        if (spotEffect > spotCosCutoff) {\n          spotEffect = pow(spotEffect, spotExponent);\n        } else {\n          spotEffect = 0.0;\n        }\n      }\n\n      vec3 incidentLight = spotEffect * lightIntensity.xyz;\n//      incidentLight *= M_PI;\n\n      diffuse += diffuseColor * max(0.0, dot(normal_inWorld, lightDirection)) * incidentLight;\n\n      float cameraSID = u_currentComponentSIDs[${_foundation_components_WellKnownComponentTIDs__WEBPACK_IMPORTED_MODULE_5__[\"WellKnownComponentTIDs\"].CameraComponentTID}];\n      vec3 viewPosition = get_viewPosition(cameraSID, 0);\n      float shininess = get_shininess(materialSID, 0);\n      if (shadingModel == 2) {// BLINN\n        // ViewDirection\n        vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\n        vec3 halfVector = normalize(lightDirection + viewDirection);\n        specular += pow(max(0.0, dot(halfVector, normal_inWorld)), shininess);\n      } else if (shadingModel == 3) { // PHONG\n        vec3 viewDirection = normalize(viewPosition - v_position_inWorld.xyz);\n        vec3 R = reflect(lightDirection, normal_inWorld);\n        specular += pow(max(0.0, dot(R, viewDirection)), shininess);\n      }\n\n    }\n\n    shadingColor = diffuse + specular;\n  } else {\n    shadingColor = diffuseColor;\n  }\n\n  rt0 = vec4(shadingColor, alpha);\n  //rt0 = vec4(u_lightNumber, 0.0, 0.0, 1.0);\n\n\n  ${_def_fragColor}\n}\n`;\r\n    }\r\n    getPixelShaderBody(args) {\r\n        return this.getFragmentShader(args);\r\n    }\r\n    get attributeCompositions() {\r\n        return [\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Scalar,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec2, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec2,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec3,\r\n            _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4, _foundation_definitions_CompositionType__WEBPACK_IMPORTED_MODULE_4__[\"CompositionType\"].Vec4,\r\n        ];\r\n    }\r\n}\r\nShadowMapDecodeClassicShader.materialElement = _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_3__[\"ShaderNode\"].ClassicShading;\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/ShadowMapDecodeClassicShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/BlockBeginShader.ts":
/*!*****************************************************!*\
  !*** ./src/webgl/shaders/nodes/BlockBeginShader.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BlockBeginShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n\r\nclass BlockBeginShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(__functionName, __valueInputs, __valueOutputs) {\r\n        super();\r\n        this.__functionName = __functionName;\r\n        this.__valueInputs = __valueInputs;\r\n        this.__valueOutputs = __valueOutputs;\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        let funcStr = `void ${this.__functionName}(\r\nin bool context,\r\n      `;\r\n        for (let i = 0; i < this.__valueInputs.length; i++) {\r\n            const input = this.__valueInputs[i];\r\n            const type = input.compositionType.getGlslStr(input.componentType);\r\n            funcStr += `\r\n        in ${type} value${i},`;\r\n        }\r\n        for (let i = 0; i < this.__valueOutputs.length; i++) {\r\n            const output = this.__valueOutputs[i];\r\n            const type = output.compositionType.getGlslStr(output.componentType);\r\n            funcStr += `\r\n        out ${type} outValue${i}` + ((i === this.__valueOutputs.length - 1) ? '' : ',');\r\n        }\r\n        funcStr += `) {\\n`;\r\n        for (let i = 0; i < this.__valueOutputs.length; i++) {\r\n            funcStr += `\r\n      outValue${i} = value${i};\\n`;\r\n        }\r\n        funcStr += `}`;\r\n        return funcStr;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return this.vertexShaderDefinitions;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/BlockBeginShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/BlockEndShader.ts":
/*!***************************************************!*\
  !*** ./src/webgl/shaders/nodes/BlockEndShader.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return BlockEndShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n\r\nclass BlockEndShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(__functionName, __valueInputs, __valueOutputs) {\r\n        super();\r\n        this.__functionName = __functionName;\r\n        this.__valueInputs = __valueInputs;\r\n        this.__valueOutputs = __valueOutputs;\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        let funcStr = `void ${this.__functionName}(`;\r\n        for (let i = 0; i < this.__valueInputs.length; i++) {\r\n            const input = this.__valueInputs[i];\r\n            const type = input.compositionType.getGlslStr(input.componentType);\r\n            funcStr += `\r\n        in ${type} value${i},`;\r\n        }\r\n        for (let i = 0; i < this.__valueOutputs.length; i++) {\r\n            const output = this.__valueOutputs[i];\r\n            const type = output.compositionType.getGlslStr(output.componentType);\r\n            funcStr += `\r\n        out ${type} outValue${i}` + ((i === this.__valueOutputs.length - 1) ? '' : ',');\r\n        }\r\n        funcStr += `) {\\n`;\r\n        for (let i = 0; i < this.__valueOutputs.length; i++) {\r\n            funcStr += `\r\n      outValue${i} = value${i};\\n`;\r\n        }\r\n        funcStr += `}`;\r\n        return funcStr;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return this.vertexShaderDefinitions;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/BlockEndShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/ConstantVariableShader.ts":
/*!***********************************************************!*\
  !*** ./src/webgl/shaders/nodes/ConstantVariableShader.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ConstantVariableShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../foundation/definitions/ComponentType */ \"./src/foundation/definitions/ComponentType.ts\");\n\r\n\r\nclass ConstantVariableShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(__functionName, __compositionType, __componentType) {\r\n        super();\r\n        this.__functionName = __functionName;\r\n        this.__compositionType = __compositionType;\r\n        this.__componentType = __componentType;\r\n        this.__constantValueStr = '';\r\n    }\r\n    setConstantValue(value) {\r\n        let constant = '';\r\n        if (this.__componentType.isFloatingPoint()) {\r\n            constant = value.glslStrAsFloat;\r\n        }\r\n        else if (this.__componentType.isInteger()) {\r\n            constant = value.glslStrAsInt;\r\n        }\r\n        else if (this.__componentType === _foundation_definitions_ComponentType__WEBPACK_IMPORTED_MODULE_1__[\"ComponentType\"].Bool) {\r\n            constant = value.x ? 'true' : 'false';\r\n        }\r\n        this.__constantValueStr = constant;\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        return `\r\n    void ${this.__functionName}(\r\n      out ${this.__compositionType.getGlslStr(this.__componentType)} outValue) {\r\n      outValue = ${this.__constantValueStr};\r\n    }\r\n    `;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return `\r\n    void ${this.__functionName}(\r\n      out ${this.__compositionType.getGlslStr(this.__componentType)} outValue) {\r\n      outValue = ${this.__constantValueStr};\r\n    }\r\n    `;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/ConstantVariableShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/EndShader.ts":
/*!**********************************************!*\
  !*** ./src/webgl/shaders/nodes/EndShader.ts ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EndShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n/* harmony import */ var _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../foundation/definitions/ShaderNode */ \"./src/foundation/definitions/ShaderNode.ts\");\n\r\n\r\nclass EndShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new EndShader();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        return `\n    void outPosition(in vec4 inPosition) {\n      gl_Position = inPosition;\n    }\n    `;\r\n    }\r\n    ;\r\n    get vertexShaderBody() {\r\n        return `\n\n    `;\r\n    }\r\n    get pixelShaderDefinitions() {\r\n        const _def_fragColor = this.glsl_fragColor;\r\n        let vec4StrOrNot = '';\r\n        if (_def_fragColor !== '') {\r\n            vec4StrOrNot = 'vec4';\r\n        }\r\n        return `\n    void outColor(in vec4 inColor) {\n      ${vec4StrOrNot} rt0 = inColor;\n      ${_def_fragColor}\n    }\n    `;\r\n    }\r\n    get pixelShaderBody() {\r\n        return '';\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\nEndShader.materialElement = _foundation_definitions_ShaderNode__WEBPACK_IMPORTED_MODULE_1__[\"ShaderNode\"].PBRShading;\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/EndShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/IfStatementShader.ts":
/*!******************************************************!*\
  !*** ./src/webgl/shaders/nodes/IfStatementShader.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return IfStatementShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n\r\nclass IfStatementShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor() {\r\n        super();\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        return `\r\n    `;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return `\r\n    `;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/IfStatementShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/UniformDataShader.ts":
/*!******************************************************!*\
  !*** ./src/webgl/shaders/nodes/UniformDataShader.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return UniformDataShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n\r\nclass UniformDataShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(__functionName, __compositionType, __componentType) {\r\n        super();\r\n        this.__functionName = __functionName;\r\n        this.__compositionType = __compositionType;\r\n        this.__componentType = __componentType;\r\n        this.__variableName = '';\r\n        this.__valueStr = '';\r\n    }\r\n    setVariableName(name) {\r\n        this.__variableName = name;\r\n    }\r\n    setDefaultValue(value) {\r\n        this.__valueStr = value.toString();\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        return `\r\n    uniform ${this.__compositionType.getGlslStr(this.__componentType)} u_${this.__variableName}; // initialValue=${this.__valueStr}\r\n    void ${this.__functionName}(out ${this.__compositionType.getGlslStr(this.__componentType)} outValue) {\r\n#ifdef RN_IS_FASTEST_MODE\r\n  float materialSID = u_currentComponentSIDs[0];\r\n#else\r\n  float materialSID = u_materialSID;\r\n#endif\r\n\r\noutValue = get_${this.__variableName}(materialSID, 0);\r\n    }\r\n    `;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return `\r\n    uniform ${this.__compositionType.getGlslStr(this.__componentType)} u_${this.__variableName}; // initialValue=${this.__valueStr}\r\n    void ${this.__functionName}(out ${this.__compositionType.getGlslStr(this.__componentType)} outValue) {\r\n#ifdef RN_IS_FASTEST_MODE\r\n  float materialSID = u_currentComponentSIDs[0];\r\n#else\r\n  float materialSID = u_materialSID;\r\n#endif\r\n\r\noutValue = get_${this.__variableName}(materialSID, 0);\r\n    }\r\n    `;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/UniformDataShader.ts?");

/***/ }),

/***/ "./src/webgl/shaders/nodes/VaryingVariableShader.ts":
/*!**********************************************************!*\
  !*** ./src/webgl/shaders/nodes/VaryingVariableShader.ts ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VaryingVariableShader; });\n/* harmony import */ var _GLSLShader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../GLSLShader */ \"./src/webgl/shaders/GLSLShader.ts\");\n\r\nclass VaryingVariableShader extends _GLSLShader__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(__functionName, __compositionType, __componentType) {\r\n        super();\r\n        this.__functionName = __functionName;\r\n        this.__compositionType = __compositionType;\r\n        this.__componentType = __componentType;\r\n        this.__variableName = '';\r\n    }\r\n    setVariableName(name) {\r\n        this.__variableName = name;\r\n    }\r\n    get vertexShaderDefinitions() {\r\n        return `\r\n    out ${this.__compositionType.getGlslStr(this.__componentType)} ${this.__variableName};\r\n    void ${this.__functionName}(\r\n      in ${this.__compositionType.getGlslStr(this.__componentType)} value) {\r\n      ${this.__variableName} = value;\r\n    }\r\n    `;\r\n    }\r\n    ;\r\n    get pixelShaderDefinitions() {\r\n        return `\r\n    in ${this.__compositionType.getGlslStr(this.__componentType)} ${this.__variableName};\r\n    void ${this.__functionName}(\r\n      out ${this.__compositionType.getGlslStr(this.__componentType)} outValue) {\r\n      outValue = ${this.__variableName};\r\n    }\r\n    `;\r\n    }\r\n    get attributeNames() {\r\n        return [];\r\n    }\r\n    get attributeSemantics() {\r\n        return [];\r\n    }\r\n    get attributeCompositions() {\r\n        return [];\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/webgl/shaders/nodes/VaryingVariableShader.ts?");

/***/ }),

/***/ "./src/xr/WebVRSystem.ts":
/*!*******************************!*\
  !*** ./src/xr/WebVRSystem.ts ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WebVRSystem; });\n/* harmony import */ var _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../foundation/renderer/CGAPIResourceRepository */ \"./src/foundation/renderer/CGAPIResourceRepository.ts\");\n/* harmony import */ var _foundation_math_Vector3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../foundation/math/Vector3 */ \"./src/foundation/math/Vector3.ts\");\n/* harmony import */ var _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../foundation/math/Matrix44 */ \"./src/foundation/math/Matrix44.ts\");\n/* harmony import */ var _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../foundation/math/MutableMatrix44 */ \"./src/foundation/math/MutableMatrix44.ts\");\n/* harmony import */ var _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../foundation/math/Vector4 */ \"./src/foundation/math/Vector4.ts\");\n/* harmony import */ var _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../foundation/core/EntityRepository */ \"./src/foundation/core/EntityRepository.ts\");\n/* harmony import */ var _foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../foundation/components/TransformComponent */ \"./src/foundation/components/TransformComponent.ts\");\n/* harmony import */ var _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../foundation/components/SceneGraphComponent */ \"./src/foundation/components/SceneGraphComponent.ts\");\n/* harmony import */ var _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../foundation/components/CameraComponent */ \"./src/foundation/components/CameraComponent.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass WebVRSystem {\r\n    constructor() {\r\n        this.__isWebVRMode = false;\r\n        this.__requestedToEnterWebVR = false;\r\n        this.__isReadyForWebVR = false;\r\n        this.__defaultUserSittingPositionInVR = new _foundation_math_Vector3__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0.0, 1.1, 1.5);\r\n        this.__invertSittingToStandingTransform = _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].identity();\r\n        this.__minRenderWidthFromUser = 0;\r\n        this.__minRenderHeightFromUser = 0;\r\n        this.__canvasWidthBackup = 0;\r\n        this.__canvasHeightBackup = 0;\r\n        this.__leftViewMatrix = _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\n        this.__rightViewMatrix = _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"].identity();\r\n        const repo = _foundation_core_EntityRepository__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getInstance();\r\n        this.__leftCameraEntity = repo.createEntity([_foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"], _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"], _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_8__[\"default\"]]);\r\n        this.__rightCameraEntity = repo.createEntity([_foundation_components_TransformComponent__WEBPACK_IMPORTED_MODULE_6__[\"default\"], _foundation_components_SceneGraphComponent__WEBPACK_IMPORTED_MODULE_7__[\"default\"], _foundation_components_CameraComponent__WEBPACK_IMPORTED_MODULE_8__[\"default\"]]);\r\n    }\r\n    static getInstance() {\r\n        if (!this.__instance) {\r\n            this.__instance = new WebVRSystem();\r\n        }\r\n        return this.__instance;\r\n    }\r\n    getFrameData() {\r\n        if (this.__webvrDisplay == null) {\r\n            return;\r\n        }\r\n        this.__webvrDisplay.getFrameData(this.__webvrFrameData);\r\n        if (this.__webvrDisplay.stageParameters) {\r\n            this.__invertSittingToStandingTransform = _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].invert(new _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.__webvrDisplay.stageParameters.sittingToStandingTransform, true));\r\n        }\r\n        else {\r\n            this.__invertSittingToStandingTransform = _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].invert(_foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].translate(this.__defaultUserSittingPositionInVR));\r\n        }\r\n    }\r\n    async enterWebVR(initialUserSittingPositionIfStageParametersDoNotExist, minRenderWidth, minRenderHeight) {\r\n        return new Promise((resolve, reject) => {\r\n            const webglResourceRepository = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getWebGLResourceRepository();\r\n            const glw = webglResourceRepository.currentWebGLContextWrapper;\r\n            if (glw != null && this.__webvrDisplay != null && !this.__webvrDisplay.isPresenting) {\r\n                if (initialUserSittingPositionIfStageParametersDoNotExist != null) {\r\n                    this.__defaultUserSittingPositionInVR = initialUserSittingPositionIfStageParametersDoNotExist;\r\n                }\r\n                if (minRenderWidth != null) {\r\n                    this.__minRenderWidthFromUser = minRenderWidth;\r\n                }\r\n                if (minRenderHeight != null) {\r\n                    this.__minRenderHeightFromUser = minRenderHeight;\r\n                }\r\n                this.__vrDisplay = this.__webvrDisplay;\r\n                const leftEye = this.__webvrDisplay.getEyeParameters(\"left\");\r\n                const rightEye = this.__webvrDisplay.getEyeParameters(\"right\");\r\n                this.__canvasWidthBackup = glw.width;\r\n                this.__canvasHeightBackup = glw.height;\r\n                if (this.__minRenderWidthFromUser > leftEye.renderWidth &&\r\n                    this.__minRenderHeightFromUser > rightEye.renderWidth) {\r\n                    webglResourceRepository.resizeCanvas(this.__minRenderWidthFromUser * 2, this.__minRenderHeightFromUser);\r\n                }\r\n                else {\r\n                    webglResourceRepository.resizeCanvas(Math.max(leftEye.renderWidth, rightEye.renderWidth) * 2, Math.max(leftEye.renderHeight, rightEye.renderHeight));\r\n                }\r\n                this.__webvrDisplay\r\n                    .requestPresent([{ source: glw.canvas }])\r\n                    .then(() => {\r\n                    this.__requestedToEnterWebVR = true;\r\n                    console.info(\"requestPresent is succeeded.\");\r\n                    resolve();\r\n                })\r\n                    .catch(() => {\r\n                    console.error(\"Failed to requestPresent. Please check your VR Setting, or something wrong with your VR system?\");\r\n                    reject();\r\n                });\r\n            }\r\n            else {\r\n                reject(\"WebGL context or WebVRDisplay is not ready yet.\");\r\n            }\r\n        });\r\n    }\r\n    async readyForWebVR(requestButtonDom) {\r\n        return new Promise((resolve, reject) => {\r\n            const glw = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getWebGLResourceRepository().currentWebGLContextWrapper;\r\n            if (glw == null) {\r\n                reject(\"WebGL Context is not ready yet.\");\r\n                return;\r\n            }\r\n            if (window.VRFrameData) {\r\n                this.__webvrFrameData = new window.VRFrameData();\r\n            }\r\n            else {\r\n                reject(\"WebVR is not supported in this environment.\");\r\n            }\r\n            if (navigator.getVRDisplays) {\r\n                navigator\r\n                    .getVRDisplays()\r\n                    .then((vrDisplays) => {\r\n                    if (vrDisplays.length > 0) {\r\n                        const webvrDisplay = vrDisplays[vrDisplays.length - 1];\r\n                        webvrDisplay.depthNear = 0.01;\r\n                        webvrDisplay.depthFar = 10000;\r\n                        if (webvrDisplay.capabilities.canPresent) {\r\n                            this.__webvrDisplay = webvrDisplay;\r\n                            if (requestButtonDom) {\r\n                                requestButtonDom.style.display = \"block\";\r\n                            }\r\n                            else {\r\n                                const paragrach = document.createElement(\"p\");\r\n                                const anchor = document.createElement(\"a\");\r\n                                anchor.setAttribute(\"id\", \"enter-vr\");\r\n                                const enterVr = document.createTextNode(\"Enter VR\");\r\n                                anchor.appendChild(enterVr);\r\n                                paragrach.appendChild(anchor);\r\n                                const canvas = glw.canvas;\r\n                                canvas.parentNode.insertBefore(paragrach, canvas);\r\n                                window.addEventListener(\"click\", this.enterWebVR.bind(this));\r\n                            }\r\n                            this.__isReadyForWebVR = true;\r\n                            resolve();\r\n                        }\r\n                        else {\r\n                            console.error(\"Can't requestPresent now. try again.\");\r\n                            reject();\r\n                        }\r\n                    }\r\n                    else {\r\n                        console.error(\"Failed to get VR Display. Please check your VR Setting, or something wrong with your VR system?\");\r\n                        reject();\r\n                    }\r\n                })\r\n                    .catch(() => {\r\n                    console.error(\"Failed to get VR Displays. Please check your VR Setting.\");\r\n                    reject();\r\n                });\r\n            }\r\n            else {\r\n                console.error(\"Your browser does not support WebVR. Or it is disabled. Check again.\");\r\n                reject();\r\n            }\r\n        });\r\n    }\r\n    async exitWebVR() {\r\n        this.__isWebVRMode = false;\r\n        if (this.__webvrDisplay && this.__webvrDisplay.isPresenting) {\r\n            await this.__webvrDisplay.exitPresent();\r\n        }\r\n        const webglResourceRepository = _foundation_renderer_CGAPIResourceRepository__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getWebGLResourceRepository();\r\n        webglResourceRepository.resizeCanvas(this.__canvasWidthBackup, this.__canvasHeightBackup);\r\n        this.__isReadyForWebVR = false;\r\n    }\r\n    async disableWebVR() {\r\n        this.__isWebVRMode = false;\r\n        this.__requestedToEnterWebVR = false;\r\n        this.__isReadyForWebVR = false;\r\n        if (this.__webvrDisplay && this.__webvrDisplay.isPresenting) {\r\n            await this.__webvrDisplay.exitPresent();\r\n        }\r\n        this.__webvrDisplay = void 0;\r\n    }\r\n    get isWebVRMode() {\r\n        return this.__isWebVRMode;\r\n    }\r\n    get isReadyForWebVR() {\r\n        return this.__isReadyForWebVR;\r\n    }\r\n    webVrSubmitFrame() {\r\n        if (this.__webvrDisplay && this.__webvrDisplay.isPresenting) {\r\n            this.__webvrDisplay.submitFrame();\r\n        }\r\n    }\r\n    get webVrFrameData() {\r\n        return this.__webvrFrameData;\r\n    }\r\n    get leftViewMatrix() {\r\n        _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiplyTo(new _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.__webvrFrameData.leftViewMatrix, true), this.__invertSittingToStandingTransform, this.__leftViewMatrix);\r\n        return this.__leftViewMatrix;\r\n    }\r\n    get rightViewMatrix() {\r\n        _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"].multiplyTo(new _foundation_math_Matrix44__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.__webvrFrameData.rightViewMatrix, true), this.__invertSittingToStandingTransform, this.__rightViewMatrix);\r\n        return this.__rightViewMatrix;\r\n    }\r\n    get leftProjectionMatrix() {\r\n        return new _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this.__webvrFrameData.leftProjectionMatrix, true);\r\n    }\r\n    get rightProjectionMatrix() {\r\n        return new _foundation_math_MutableMatrix44__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this.__webvrFrameData.rightProjectionMatrix, true);\r\n    }\r\n    getLeftViewport(originalViewport) {\r\n        return new _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](originalViewport.x, originalViewport.y, originalViewport.z * 0.5, originalViewport.w);\r\n    }\r\n    getRightViewport(originalViewport) {\r\n        return new _foundation_math_Vector4__WEBPACK_IMPORTED_MODULE_4__[\"default\"](originalViewport.z * 0.5, originalViewport.y, originalViewport.z * 0.5, originalViewport.w);\r\n    }\r\n    getViewMatrixAt(index) {\r\n        if (index === 0) {\r\n            return this.leftViewMatrix;\r\n        }\r\n        else {\r\n            return this.rightViewMatrix;\r\n        }\r\n    }\r\n    getProjectMatrixAt(index) {\r\n        if (index === 0) {\r\n            return this.leftProjectionMatrix;\r\n        }\r\n        else {\r\n            return this.rightProjectionMatrix;\r\n        }\r\n    }\r\n    getViewportAt(viewport, index) {\r\n        if (index === 0) {\r\n            return this.getLeftViewport(viewport);\r\n        }\r\n        else {\r\n            return this.getRightViewport(viewport);\r\n        }\r\n    }\r\n    get vrDisplay() {\r\n        return this.__vrDisplay;\r\n    }\r\n    setValuesToGlobalDataRepository() {\r\n        this.__leftCameraEntity.getCamera().viewMatrix = this.leftViewMatrix;\r\n        this.__rightCameraEntity.getCamera().viewMatrix = this.rightViewMatrix;\r\n        this.__leftCameraEntity.getCamera().projectionMatrix = this.leftProjectionMatrix;\r\n        this.__rightCameraEntity.getCamera().projectionMatrix = this.rightProjectionMatrix;\r\n        this.__leftCameraEntity.getCamera().setValuesToGlobalDataRepository();\r\n        this.__rightCameraEntity.getCamera().setValuesToGlobalDataRepository();\r\n    }\r\n    getCameraComponentSIDAt(index) {\r\n        if (index === 0) {\r\n            return this.__leftCameraEntity.getCamera().componentSID;\r\n        }\r\n        else {\r\n            return this.__rightCameraEntity.getCamera().componentSID;\r\n        }\r\n    }\r\n    get requestedToEnterWebVR() {\r\n        return this.__requestedToEnterWebVR;\r\n    }\r\n    _setIsWebVRMode() {\r\n        this.__isWebVRMode = true;\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./src/xr/WebVRSystem.ts?");

/***/ })

/******/ });
(0,eval)('this').Rn.VERSION='version: 0.2.6 branch: chore/gitignore';

(0,eval)('this').Rn.VERSION='version: 0.2.6-mod branch: chore/gitignore';

exports.ids=["xr"],exports.modules={94:function(e,t,i){"use strict";i.r(t);var r=i(10),s=i(1),a=i(22),n=i(14),o=i(11),_=i(37),h=i(40),l=i(35),d=i(15),c=function(e,t,i,r){return new(i||(i=Promise))((function(s,a){function n(e){try{_(r.next(e))}catch(e){a(e)}}function o(e){try{_(r.throw(e))}catch(e){a(e)}}function _(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,o)}_((r=r.apply(e,t||[])).next())}))};class g{constructor(){this.__isWebVRMode=!1,this.__requestedToEnterWebVR=!1,this.__isReadyForWebVR=!1,this.__defaultUserSittingPositionInVR=new s.b(0,1.1,1.5),this.__invertSittingToStandingTransform=a.a.identity(),this.__minRenderWidthFromUser=0,this.__minRenderHeightFromUser=0,this.__canvasWidthBackup=0,this.__canvasHeightBackup=0,this.__leftViewMatrix=n.a.identity(),this.__rightViewMatrix=n.a.identity();const e=_.a.getInstance();this.__leftCameraEntity=e.createEntity([h.a,l.a,d.a]),this.__rightCameraEntity=e.createEntity([h.a,l.a,d.a])}static getInstance(){return this.__instance||(this.__instance=new g),this.__instance}getFrameData(){null!=this.__webvrDisplay&&(this.__webvrDisplay.getFrameData(this.__webvrFrameData),this.__webvrDisplay.stageParameters?this.__invertSittingToStandingTransform=a.a.invert(new a.a(this.__webvrDisplay.stageParameters.sittingToStandingTransform,!0)):this.__invertSittingToStandingTransform=a.a.invert(a.a.translate(this.__defaultUserSittingPositionInVR)))}enterWebVR(e,t,i){return c(this,void 0,void 0,(function*(){return new Promise((s,a)=>{const n=r.a.getWebGLResourceRepository(),o=n.currentWebGLContextWrapper;if(null==o||null==this.__webvrDisplay||this.__webvrDisplay.isPresenting)a("WebGL context or WebVRDisplay is not ready yet.");else{null!=e&&(this.__defaultUserSittingPositionInVR=e),null!=t&&(this.__minRenderWidthFromUser=t),null!=i&&(this.__minRenderHeightFromUser=i),this.__vrDisplay=this.__webvrDisplay;const r=this.__webvrDisplay.getEyeParameters("left"),_=this.__webvrDisplay.getEyeParameters("right");this.__canvasWidthBackup=o.width,this.__canvasHeightBackup=o.height,this.__minRenderWidthFromUser>r.renderWidth&&this.__minRenderHeightFromUser>_.renderWidth?n.resizeCanvas(2*this.__minRenderWidthFromUser,this.__minRenderHeightFromUser):n.resizeCanvas(2*Math.max(r.renderWidth,_.renderWidth),Math.max(r.renderHeight,_.renderHeight)),this.__webvrDisplay.requestPresent([{source:o.canvas}]).then(()=>{this.__requestedToEnterWebVR=!0,console.info("requestPresent is succeeded."),s()}).catch(()=>{console.error("Failed to requestPresent. Please check your VR Setting, or something wrong with your VR system?"),a()})}})}))}readyForWebVR(e){return c(this,void 0,void 0,(function*(){return new Promise((t,i)=>{const s=r.a.getWebGLResourceRepository().currentWebGLContextWrapper;null!=s?(window.VRFrameData?this.__webvrFrameData=new window.VRFrameData:i("WebVR is not supported in this environment."),navigator.getVRDisplays?navigator.getVRDisplays().then(r=>{if(r.length>0){const a=r[r.length-1];if(a.depthNear=.01,a.depthFar=1e4,a.capabilities.canPresent){if(this.__webvrDisplay=a,e)e.style.display="block";else{const e=document.createElement("p"),t=document.createElement("a");t.setAttribute("id","enter-vr");const i=document.createTextNode("Enter VR");t.appendChild(i),e.appendChild(t);const r=s.canvas;r.parentNode.insertBefore(e,r),window.addEventListener("click",this.enterWebVR.bind(this))}this.__isReadyForWebVR=!0,t()}else console.error("Can't requestPresent now. try again."),i()}else console.error("Failed to get VR Display. Please check your VR Setting, or something wrong with your VR system?"),i()}).catch(()=>{console.error("Failed to get VR Displays. Please check your VR Setting."),i()}):(console.error("Your browser does not support WebVR. Or it is disabled. Check again."),i())):i("WebGL Context is not ready yet.")})}))}exitWebVR(){return c(this,void 0,void 0,(function*(){this.__isWebVRMode=!1,this.__webvrDisplay&&this.__webvrDisplay.isPresenting&&(yield this.__webvrDisplay.exitPresent()),r.a.getWebGLResourceRepository().resizeCanvas(this.__canvasWidthBackup,this.__canvasHeightBackup),this.__isReadyForWebVR=!1}))}disableWebVR(){return c(this,void 0,void 0,(function*(){this.__isWebVRMode=!1,this.__requestedToEnterWebVR=!1,this.__isReadyForWebVR=!1,this.__webvrDisplay&&this.__webvrDisplay.isPresenting&&(yield this.__webvrDisplay.exitPresent()),this.__webvrDisplay=void 0}))}get isWebVRMode(){return this.__isWebVRMode}get isReadyForWebVR(){return this.__isReadyForWebVR}webVrSubmitFrame(){this.__webvrDisplay&&this.__webvrDisplay.isPresenting&&this.__webvrDisplay.submitFrame()}get webVrFrameData(){return this.__webvrFrameData}get leftViewMatrix(){return a.a.multiplyTo(new a.a(this.__webvrFrameData.leftViewMatrix,!0),this.__invertSittingToStandingTransform,this.__leftViewMatrix),this.__leftViewMatrix}get rightViewMatrix(){return a.a.multiplyTo(new a.a(this.__webvrFrameData.rightViewMatrix,!0),this.__invertSittingToStandingTransform,this.__rightViewMatrix),this.__rightViewMatrix}get leftProjectionMatrix(){return new n.a(this.__webvrFrameData.leftProjectionMatrix,!0)}get rightProjectionMatrix(){return new n.a(this.__webvrFrameData.rightProjectionMatrix,!0)}getLeftViewport(e){return new o.b(e.x,e.y,.5*e.z,e.w)}getRightViewport(e){return new o.b(.5*e.z,e.y,.5*e.z,e.w)}getViewMatrixAt(e){return 0===e?this.leftViewMatrix:this.rightViewMatrix}getProjectMatrixAt(e){return 0===e?this.leftProjectionMatrix:this.rightProjectionMatrix}getViewportAt(e,t){return 0===t?this.getLeftViewport(e):this.getRightViewport(e)}get vrDisplay(){return this.__vrDisplay}setValuesToGlobalDataRepository(){this.__leftCameraEntity.getCamera().viewMatrix=this.leftViewMatrix,this.__rightCameraEntity.getCamera().viewMatrix=this.rightViewMatrix,this.__leftCameraEntity.getCamera().projectionMatrix=this.leftProjectionMatrix,this.__rightCameraEntity.getCamera().projectionMatrix=this.rightProjectionMatrix,this.__leftCameraEntity.getCamera().setValuesToGlobalDataRepository(),this.__rightCameraEntity.getCamera().setValuesToGlobalDataRepository()}getCameraComponentSIDAt(e){return 0===e?this.__leftCameraEntity.getCamera().componentSID:this.__rightCameraEntity.getCamera().componentSID}get requestedToEnterWebVR(){return this.__requestedToEnterWebVR}_setIsWebVRMode(){this.__isWebVRMode=!0}}const u=Object.freeze({WebVRSystem:g});t.default=u;"undefined"!=typeof exports&&(Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u),(0,eval)("this").RnXR=u}};
(window.webpackJsonp=window.webpackJsonp||[]).push([["sparkgear"],{69:function(e,t,r){"use strict";r.r(t);var n,a=r(17),_=r(22),o=r(6),i=r(11),S=r(32),s=r(13),P=r(20),u=r(33),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),p=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return c(t,e),Object.defineProperty(t,"componentTID",{get:function(){return _.a.SparkGearComponentTID},enumerable:!0,configurable:!0}),t.common_$load=function(){if(!t.__isInitialized){var e=u.a.getInstance().getModule("webgl");t.SPFX_Initialize(e.WebGLResourceRepository.getInstance())}},t.prototype.$logic=function(){this.isPlaying()||this.play();var e=s.a.getInstance().getComponent(S.a,S.a.main),r=t.__tmp_indentityMatrix,n=t.__tmp_indentityMatrix;e&&(r=e.viewMatrix,n=e.projectionMatrix),t.SPARK_SetCameraMatrix(r,n),t.SPFX_Update(1);var a=this.__sceneGraphComponent.worldMatrixInner;_SPARK_Instance_SetTransformFor3D(this.__hSPFXInst,a.v[0],a.v[4],a.v[8],a.v[12],a.v[1],a.v[5],a.v[9],a.v[13],a.v[2],a.v[6],a.v[10],a.v[14],a.v[3],a.v[7],a.v[11],a.v[15]),this.moveStageTo(o.a.Render)},t.prototype.$render=function(){this.onAfterRender(),this.moveStageTo(o.a.Logic)},t.prototype.$load=function(){var e=this;if(null!=this.url){var r,n,a,_,i=t;r=this.url,n="arraybuffer",a=function(t){var r=new Uint8Array(t);i.SPARK_BackupStatus();var n=window.Module.ccall("SPARK_Data_Create","number",["string","number","array","number"],[e.url,e.url.length,r,r.length]);e.__hSPFXInst=_SPARK_Instance_Create(n),_SPARK_Data_Delete(n),i.SPARK_RestoreStatus(),e.moveStageTo(o.a.Logic)},(_=new XMLHttpRequest).open("GET",r,!0),_.responseType=n,_.onload=function(){switch(_.status){case 200:a(_.response);break;default:console.error("Failed to load ("+_.status+") : "+r)}},_.send(null)}},t.prototype.$create=function(){this.__sceneGraphComponent=this.__entityRepository.getComponentOfEntity(this.__entityUid,P.a),this.moveStageTo(o.a.Load)},t.prototype.onBeforeRender=function(){},t.prototype.onAfterRender=function(){var e=t;e.SPARK_BackupStatus(),_SPARK_Draw(this.__hSPFXInst),e.SPARK_RestoreStatus()},t.prototype.play=function(){_SPARK_Instance_Play(this.__hSPFXInst,1,!1,0)},t.prototype.stop=function(){_SPARK_Instance_Stop(this.__hSPFXInst)},t.prototype.pause=function(){_SPARK_Instance_Pause(this.__hSPFXInst)},t.prototype.isPlaying=function(){return _SPARK_Instance_IsPlaying(this.__hSPFXInst)},t.prototype.kickTrigger=function(e){_SPARK_Instance_KickTrigger(this.__hSPFXInst,e)},t.SPARK_BackupStatus=function(){var e=t,r=e.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext();e.SPFX_ArrayBuffer=r.getParameter(r.ARRAY_BUFFER_BINDING),e.SPFX_ElementArrayBuffer=r.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING),e.SPFX_CurrentProgram=r.getParameter(r.CURRENT_PROGRAM),e.SPFX_FrontFace=r.getParameter(r.FRONT_FACE),e.SPFX_DepthFunc=r.getParameter(r.DEPTH_FUNC),e.SPFX_DepthWriteMask=r.getParameter(r.DEPTH_WRITEMASK),e.SPFX_StencilTestEnabled=r.isEnabled(r.STENCIL_TEST),e.SPFX_DepthTestEnabled=r.isEnabled(r.DEPTH_TEST),e.SPFX_CullFaceEnabled=r.isEnabled(r.CULL_FACE),e.SPFX_BlendEnabled=r.isEnabled(r.BLEND),e.SPFX_BlendSrcRgb=r.getParameter(r.BLEND_SRC_RGB),e.SPFX_BlendDstRgb=r.getParameter(r.BLEND_DST_RGB),e.SPFX_BlendSrcAlpha=r.getParameter(r.BLEND_SRC_ALPHA),e.SPFX_BlendDstAlpha=r.getParameter(r.BLEND_DST_ALPHA),e.SPFX_ActiveTexture=r.getParameter(r.ACTIVE_TEXTURE);for(var n=0;n<8;n++)r.activeTexture(r.TEXTURE0+n),e.SPFX_Texture[n]=r.getParameter(r.TEXTURE_BINDING_2D);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1)},t.SPFX_Uninitialize=function(){var e=t;e.SPARK_BackupStatus(),_SPARK_Uninitialize(),e.SPARK_RestoreStatus()},t.SPARK_SetCameraMatrix=function(e,t){_SPARK_SetMatrix(0,e.v[0],e.v[1],e.v[2],e.v[3],e.v[4],e.v[5],e.v[6],e.v[7],e.v[8],e.v[9],e.v[10],e.v[11],e.v[12],e.v[13],e.v[14],e.v[15]),_SPARK_SetMatrix(1,t.v[0],t.v[1],t.v[2],t.v[3],t.v[4],t.v[5],t.v[6],t.v[7],t.v[8],t.v[9],t.v[10],t.v[11],t.v[12],t.v[13],t.v[14],t.v[15])},t.SPARK_Draw=function(){var e=t;e.SPARK_BackupStatus(),_SPARK_DrawAll(),e.SPARK_RestoreStatus()},t.SPARK_DrawDebugInfo=function(e){var r=t;r.SPARK_BackupStatus(),_SPARK_DrawDebugInfo(e),r.SPARK_RestoreStatus()},t.__isInitialized=!1,t.SPFX_Texture=[],t.__tmp_indentityMatrix=i.a.identity(),t.SPARK_RestoreStatus=function(){var e=t,r=e.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext();r.useProgram(e.SPFX_CurrentProgram),r.bindBuffer(r.ARRAY_BUFFER,e.SPFX_ArrayBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.SPFX_ElementArrayBuffer),r.frontFace(e.SPFX_FrontFace),r.depthFunc(e.SPFX_DepthFunc),r.depthMask(e.SPFX_DepthWriteMask),r.blendFuncSeparate(e.SPFX_BlendSrcRgb,e.SPFX_BlendDstRgb,e.SPFX_BlendSrcAlpha,e.SPFX_BlendDstAlpha),e.SPFX_StencilTestEnabled?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),e.SPFX_DepthTestEnabled?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),e.SPFX_CullFaceEnabled?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),e.SPFX_BlendEnabled?r.enable(r.BLEND):r.disable(r.BLEND);for(var n=0;n<8;n++)r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,e.SPFX_Texture[n]);r.activeTexture(e.SPFX_ActiveTexture)},t.SPFX_Initialize=function(e){var r=t;if(null!=e.currentWebGLContextWrapper){r.SPFX_WebGLResourceRepository=e,window.GLctx=r.SPFX_WebGLResourceRepository.currentWebGLContextWrapper.getRawContext(),r.SPARK_BackupStatus();var n=r.SPFX_WebGLResourceRepository.currentWebGLContextWrapper;_SPARK_InitializeFor3D(n.width,n.height),r.SPARK_RestoreStatus(),r.__isInitialized=!0}},t.SPFX_Update=function(e){_SPARK_Update(e)},t}(a.a),l=p;s.a.registerComponentClass(p);var R=r(43),F=r(38),v=Object.freeze({SparkGearComponent:l,createSparkGearEntity:function(){return R.a.getInstance().createEntity([F.a,P.a,l])}});t.default=v}}]);